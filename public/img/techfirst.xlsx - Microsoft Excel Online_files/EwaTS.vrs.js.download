'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1341:function(w,D,a){a.r(D);var b={};a.r(b);a.d(b,"ThemesManager",function(){return le});var c={};a.r(c);a.d(c,"OAuthManagerWrapper",function(){return nf});var e={};a.r(e);var f={};a.r(f);a.d(f,"IndexedDB",function(){return dc});var d=a(0),h=a(15),r=a(902),n=a(993),u=a(6),v=a(105),x=a(430),k=a(261),m=a(43),t=a(42),z=a(33),y=a(119),C=a(84),J=a(177);class F{get name(){return"Common.App.OAuth.OAuthPackage"}Oj(B){B.register(270,
"Common.App.OAuth.IOAuthManager").se().Ae(()=>new r.OAuthManager)}init(){const B=C.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Eek(B)}Eek(B){const fa=u.AFrameworkApplication.fa.Ta("FileSource");if(u.AFrameworkApplication.fa.qa("IsO365ConsumerHost")||u.AFrameworkApplication.fa.qa("IsO365CommercialHost")||"WopiTest"===fa){var Na=x.OAuthManagerSettings.Q5a;if(Na&&Na.IsEnabled){var nb=Na.Application,gc=x.OAuthManagerSettings.authority;if(void 0!==nb&&null!==nb&&nb.length&&void 0!==gc&&null!==
gc&&gc.length){var bd=n.a[B.qO],Ra=z.a.Uwa,Tb=B.Mx();try{var qc=new Map;void 0!==qc&&null!==qc?(qc.set("SupportStatus",bd),qc.set("Browser",Ra),qc.set("AuthStrategy",Tb)):qc=null}catch(Vd){qc=null}v.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",qc);var hd=t.a.Kf();B.rE("Core",nb).then(Vd=>{const Be=Math.floor(t.a.Kf()-hd);bd=n.a[B.qO];Ra=z.a.Uwa;Tb=B.Mx();h.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Be,Vd.IsSuccess,bd,Vd.ErrorCode,fa,Ra,Tb);qc&&(qc.set("SupportStatus",bd),qc.set("Browser",Ra),qc.set("AuthStrategy",Tb));var Qe=Object.assign(new J.a,{durationMs:Be,extendedProperties:qc});if(Vd.IsSuccess){if(v.Health.instance.recordKpiSuccess("WacCorePFT",Qe),Vd="Bearer "+Vd.Token,u.AFrameworkApplication.mf.rYb=Vd,Qe=Na.Endpoint){var cf=t.a.Kf();u.AFrameworkApplication.mf.uKa(Qe,1,null,{["Authorization"]:Vd},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(wb=>{var zc=Math.floor(t.a.Kf()-
cf),rd=null;wb.jj?wb="Canceled":wb.Gh?wb="Faulted":(rd=wb.result,wb=rd.succeeded?"Completed":"Failed");zc={["TaskResult"]:wb,["BrowserTokenDurationMS"]:Be,["BrowserValidationDurationMS"]:zc};rd&&(zc.HttpStatus=rd.uh.data.httpStatus,rd.succeeded&&(rd=m.a(rd.uh.data.Lf),zc.ServerValidationDurationMS=rd.ElapsedMilliseconds,zc.ServerValidationResult=rd.ValidatedToken,zc.KMSI=rd.KMSI,zc.Scopes=rd.Scopes,zc.TokenExpirationS=Math.floor(parseInt(rd.Expiration)-(new Date).getTime()/1E3)));h.ULS.sendTraceTag(520632322,
3E3,"Completed"===wb?50:15,y.a.toJSON(zc))})}}else v.Health.instance.recordKpiFailure("WacCorePFT",Vd.ErrorCode,!1,!1,Qe)}).catch(Vd=>{var Be=Math.floor(t.a.Kf()-hd);Be=Object.assign(new J.a,{durationMs:Be,extendedProperties:qc});v.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Vd.toString(),!1,!1,Be)})}}}}dispose(){}static main(){k.a.instance.Mk(new F)}}Object(d.a)(F,"OAuthPackage",null,[3,4]);var K=a(523),L=a(10),S=a(234),W=a(40),G=a(1),O=a(300),T=a(226);class I{}I.$2e="ewa-svg-icon";
Object(d.a)(I,"CssClassNames",null,[]);var N=a(13),R=a(326),V=a(151),sa=a(19);class U{constructor(B,fa){this.Od=null;this.Zh=()=>{this.UBf();this.$.da.mo(this.Zh)};this.$=B;this.vpg={};this.d7d={};this.Od=fa;(fa=this.eef("excelInitialAppSprite"))?(this.pBe(fa),this.$.da.Og?this.UBf():B.da.Ol(this.Zh),this.$.ea.Ja(388,this)):h.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.d7d=null;this.$.da.mo(this.Zh)}TPa(B,fa,Na,nb){Na=void 0===Na?null:Na;nb=
void 0===nb?null:nb;let gc;(gc=this.d7d[B])||(this.d7d[B]=gc=this.wkj(this.vpg[B]));if(!gc)return h.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${B} was not found in loaded SVG sprites.`),null;const bd=gc.cloneNode(!0);if(!bd.style){const Ra=R.b(gc),Tb=R.b(bd),qc={};qc.iconId=B;qc.isOriginalNodeStyleNull=void 0===gc.style||null===gc.style;qc.isOriginalNodeCurrentStyleNull=void 0===gc.currentStyle||null===gc.currentStyle;qc.isClonedNodeCurrentStyleNull=void 0===bd.currentStyle||
null===bd.currentStyle;qc.originalNode=Ra.substring(0,Ra.indexOf(">")+1);qc.clonedNode=Tb.substring(0,Tb.indexOf(">")+1);h.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(qc)}`)}bd.setAttribute("style",`height: ${fa}px; width: ${fa}px;`);nb&&(B=document.createElement("title"),this.Od?this.Od.Ij(B,nb):B.textContent=nb,bd.insertBefore(B,bd.childNodes[0]));if(Na)for(const Ra of Na)Sys.UI.DomElement.addCssClass(bd,Ra);return bd}kfa(B,
fa,Na,nb,gc,bd,Ra,Tb){gc=void 0===gc?0:gc;bd=void 0===bd?0:bd;Ra=void 0===Ra?null:Ra;Tb=void 0===Tb?null:Tb;gc&&bd||(bd=N.DOMElementExtensions.getBoundingClientRect(nb),gc=bd.height,bd=bd.width);if(Ra=this.TPa(B,fa,Ra,Tb))nb.appendChild(Ra),(nb=N.DOMElementExtensions.O1(Ra,"style",null))?Ra.setAttribute("style",nb+` margin: ${(gc-fa)/2}px ${(bd-Na)/2}px;`):h.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${B}`);
return Ra}UBf(){void V.a.resolve(sa.O,{Qa:0}).then(B=>B("excel-uiSlice20-sprite")).then(()=>this.NXg())}NXg(){const B=this.eef("excelUiSlice20Sprite");B?this.pBe(B):h.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}pBe(B){for(const fa of B)fa.type===T.a.b7d&&(this.vpg[fa.id]=fa)}wkj(B){if(!B)return null;const fa=B.viewBox;B=B.children;const Na=document.createElementNS(O.a.e7d,T.a.b7d);Sys.UI.DomElement.addCssClass(Na,I.$2e);Na.setAttribute("focusable","false");
Na.setAttribute("viewBox",fa);this.OXg(Na,B);return Na}OXg(B,fa){for(const nb of fa){const gc=document.createElementNS(O.a.e7d,nb.type);for(let bd in nb){fa=bd;var Na=nb[bd];"className"===fa?gc.setAttribute("class",Na):gc.setAttribute(fa,Na)}B.appendChild(gc)}}eef(B){return(B=window[B])?B.icons:null}}Object(d.a)(U,"SvgIconProvider",null,[619,5]);var ka=a(92);class ja extends S.a{constructor(B){super();this.$=B;this.Md()}create(){const B=[this.YQi()];let fa=null;G.EwaSettings.isChangeGateEnabled("OfficeVSO:7982896_TooltipSanitizationImprovementWithSvgIcons")||
(fa=Object(ka.d)(V.a.resolve(sa.tb,{Qa:0})),B.push(fa));W.TaskExtensions.ya(W.TaskExtensions.Bf(B,this.$.ka),()=>{window.excelInitialAppSprite?this.qd(this.$.ea.Ba(388)||new U(this.$,null===fa||void 0===fa?void 0:fa.result)):h.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}YQi(){return Object(ka.d)(V.a.resolve(sa.O,{Qa:this.Na}).then(B=>Io(function*(){return B("excel-app-intl")})))}static la(B){B.ea.Ja(387,new ja(B))}}Object(d.a)(ja,"SvgIconProviderFactory",
S.a,[]);var Da=a(734),qa=a(54),Ba=a(201),ua=a(62);class pa{constructor(B){this.LDh=B}Ce(){return!1}executeCommand(B,fa){B=fa.command;fa=null;switch(B){case 1243860697:this.LDh.Gak();break;default:fa=Ba.a(B)}return fa||ua.Task.Wa(!0)}qe(B,fa){return 1243860697===fa.command}Ge(){return!1}}Object(d.a)(pa,"SheetDropdownMenuCommandHandler",null,[190]);var Ka=a(86);class $a extends Da.a{constructor(B){super(B)}yf(){Object(Ka.b)("OfficeVSO:7624897_MigrateContextMenuController")?void V.a.resolve(sa.ic,{Qa:this.Na}).then(()=>
{W.TaskExtensions.ya(qa.GetServiceTaskFactory.Vc(this.$.ea,32,33,this.Na),B=>{this.gf([new pa(B.result.Lig)])},this.$.ka)}):this.$.QB(B=>{B.aoc().then(()=>{W.TaskExtensions.ya(qa.GetServiceTaskFactory.Vc(this.$.ea,32,33,this.Na),fa=>{this.gf([new pa(fa.result.Lig)])},this.$.ka)})})}static la(B){Da.a.Nf(392,new $a(B))}}Object(d.a)($a,"SheetDropdownMenuCommandHandlerFactory",Da.a,[]);var ha=a(7),cb=a(88),Ia=a(184),ob=a(14),gb=a(96),Za=a(49),da=a(250),ya=a(175),ib=a(117),vb=a(357),eb=a(139),Ta=a(16),
La=a(41);class fb{constructor(){this.$Xe=new La.a(!0);this.rSc=0}get Vgd(){return this.rSc}get navigationButtonsDisabled(){return!!(this.Vgd&1)}get operationButtonsDisabled(){return!!(this.Vgd&2)}E4g(B,fa){this.$Xe.add(B,fa);this.nV()}nV(){this.rSc=0;La.a.forEach(this.$Xe.Lu,B=>{this.rSc=this.Vgd|B.value})}}Object(d.a)(fb,"SheetTabBarDisabledStateManager",null,[]);var Pb=a(249),Sa=a(36);class Wa{}Wa.PNh="ewa-stb-uir";Wa.BNh="ewa-stb-navarea";Wa.CNh="ewa-stb-navarea-dimensions";Wa.ENh="ewa-stb-navbutton";
Wa.gX="cui-disabled";Wa.DNh="ewa-stb-navareaextra";Wa.$la="cui-img-container";Wa.vNh="ewa-stb-contentarea";Wa.S2e="ewa-stb-left-scrollable";Wa.X2e="ewa-stb-right-scrollable";Wa.NNh="ewa-stb-tabarea";Wa.MNh="ewa-stb-sheettabmoveindicator";Wa.Z2e="ewa-stb-tabs";Wa.k8j="tab-active";Wa.s8j="tab-inactive";Wa.r8j="tab-hover";Wa.ONh="ewa-stb-tabs-ghost";Wa.m8j="tab-anchor-text";Wa.dark="dark";Wa.light="light";Wa.l8j="tab-active-text";Wa.p8j="tab-content-container";Wa.u8j="tab-text";Wa.GNh="ewa-stb-nsv-inactive-svg";
Wa.FNh="ewa-stb-nsv-active-svg";Wa.oMh="ewa_nsv_margin";Wa.wNh="ewa-stb-disable-scrollbar";Wa.ZPi="leave-size-fixed-on-tab-hover-old";Wa.YPi="leave-size-fixed-on-tab-hover";Wa.T2e="ewa-stb-locked-sheet-svg-16px";Wa.xNh="ewa-stb-dropdown-menu-button";Wa.pIh="ewa-active-sheet-menu-item";Object(d.a)(Wa,"CssClassNames",null,[]);var pb=a(775),wa=a(18),hb=a(275),Sb=a(95),Bc=a(202),ab=a(31),qb=a(260),mc=a(48),yb=a(299),vc=a(57),Db=a(77),Ga=a(328),Eb=a(12),Zb=a(109),ic=a(362),mb=a(21),Hb=a(190),Wb=a(385),
Ob=a(381),Gc=a(47),Va=a(235),Jb=a(93);class ub extends Pb.a{constructor(B,fa,Na){Na=void 0===Na?!1:Na;super(B);this.Yfb=this.Zwa=null;this.$=fa;this.L_=Na}get disabled(){return this.L_}dispose(){this.Yfb=this.Zwa=this.$=null;super.dispose()}iV(B){this.L_=B;this.domElement.setAttribute(ha.a.Hwa,B.toString());N.DOMElementExtensions.toggleCssClass(this.domElement,pb.a.gX,B)}}Object(d.a)(ub,"SheetBarButton",Pb.a,[]);var Qa=a(752);class P extends ub{constructor(B,fa,Na,nb){nb=void 0===nb?!1:nb;super(document.createElement("a"),
fa,nb);this.We=gc=>{this.disabled||this.$.Fe(-1935155518,gc.ud,30,null);return!0};this.MNd=gc=>{gc="mouseover"===gc.type||"focus"===gc.type;const bd=Wb.a(this.$)?this.Yfb:this.Zwa;Eb.HelperMethods.xrg(bd,P.ola,P.ola+ha.a.Awd,gc&&!mb.h(this.$).inRangePicker)};this.dk=()=>{this.iV(!0)};this.kj=()=>{mb.h(this.$).cellTextEditBox.Xc||this.iV(!1)};this.Zwa=Na.fd(this.domElement,Ta.a.instance.ia(509),0,P.ola,Ta.a.instance.ia(510),Qa.a.ccd,nb);B.appendChild(this.domElement);this.Me.la("contextmenu",gc=>{Db.g(gc)});
Va.a.instance.ta(ob.a.click,this.domElement,this.We);this.ipa=ib.KeyInputManager.instance.ew(this.domElement,this.We,Jb.a.Yj,Jb.a.o_);mb.h(this.$).cellTextEditBox.yp(this.dk);mb.h(this.$).cellTextEditBox.Utb(this.kj)}dispose(){Va.a.instance.Aa(ob.a.click,this.domElement,this.We);ib.KeyInputManager.instance.Bz(this.domElement,this.ipa);mb.h(this.$)&&mb.h(this.$).cellTextEditBox&&(mb.h(this.$).cellTextEditBox.lp(this.dk),mb.h(this.$).cellTextEditBox.SVd(this.kj));super.dispose()}iV(B){const fa=P.qjg(this.$);
super.iV(B||fa)}static qjg(B){return!B.isEditMode||!B.va.count}}P.ola=wa.a.akd;Object(d.a)(P,"InsertSheetButton",ub,[]);class ta extends ub{constructor(B,fa,Na){super(document.createElement("a"),fa);this.We=nb=>{this.$.Fe(-684145703,nb.ud,0,null);return!0};this.MNd=nb=>{Eb.HelperMethods.xrg(this.lKe,ta.ola,ta.ola+ha.a.Awd,("mouseover"===nb.type||"focus"===nb.type)&&!mb.h(this.$).inRangePicker)};this.$=fa;this.lKe=Na.fd(this.domElement,Ta.a.instance.ia(511),0,ta.ola,Ta.a.instance.ia(512),Qa.a.ccd);
B.appendChild(this.domElement);this.Me.la("contextmenu",nb=>{Db.g(nb)});this.Me.la("mouseover",this.MNd);this.Me.la("mouseout",this.MNd);Va.a.instance.ta(ob.a.click,this.domElement,this.We);this.ipa=ib.KeyInputManager.instance.ew(this.domElement,this.We,Jb.a.Yj,Jb.a.o_)}dispose(){Va.a.instance.Aa(ob.a.click,this.domElement,this.We);ib.KeyInputManager.instance.Bz(this.domElement,this.ipa);this.lKe=null;super.dispose()}}ta.ola=wa.a.akd;Object(d.a)(ta,"InsertTemplateButton",ub,[]);class Z{constructor(B,
fa){this.sheetName=null;this.newSheetIndex=0;this.sheetName=B;this.newSheetIndex=fa}getSheetName(){return this.sheetName}}Object(d.a)(Z,"MacroRecorderSheetReorderedPayload",null,[134]);var aa=a(94);class Ea extends Pb.a{constructor(B,fa){super(document.createElement("div"));this.xU=()=>{h.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.D8f(!1,"OnSheetsChanged")};this.C7i=()=>{this.al()};this.B7i=()=>{this.zk()};this.$=B;this.U8j=fa;this.JX=!1;this.FWb=0}dispose(){this.zk();
super.dispose()}Gak(){this.D8f(!0,"TogglerSheetDropdownMenu")}D8f(B,fa){h.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${fa}, toggle: ${B}, toggleStateId: ${this.FWb}`);B&&(this.FWb+=1);const Na=this.$.Jd.Le("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${fa}, toggle: ${B}, toggleStateId: ${this.FWb}, sheetCount: ${this.$.va.count}`);B=this.Duh();appChrome.renderSheetDropdownMenu(this.domElement,this.U8j,B,this.FWb,this.C7i,this.B7i,
()=>{Na.stop()},Wb.a(this.$))}Duh(){const B=this.$.va,fa=[];for(let nb=0;nb<B.count;nb++){var Na=Object(eb.a)(Zb.a,B.getItem(nb));0===Na.DC&&(Na=this.Cuh(Na),fa.push(Na))}return fa}Cuh(B){const fa={};fa.key=B.name;fa.text=B.name;fa.onClick=this.Euh(B);B.active&&(fa.className=Wb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Wa.pIh);return fa}Euh(B){return()=>{const fa=new aa.a(-1876836819,0,this.$.ee,30,null);this.$.Ha.kd(fa,{[ha.a.C2d]:B.name})}}al(){if(!this.JX){const B=this.$.va;B.Fi(this.xU);
B.c5c(this.xU);B.C0(this.xU);B.Dka(this.xU);B.yKa(this.xU);B.vCe(this.xU);B.X2a(this.xU);this.JX=!0}}zk(){if(this.JX){const B=this.$.va;B.hj(this.xU);B.NVd(this.xU);B.daa(this.xU);B.ara(this.xU);B.RVa(this.xU);B.H7f(this.xU);B.ZQb(this.xU);this.JX=!1}}}Object(d.a)(Ea,"SheetDropdownMenu",Pb.a,[734,5]);var za=a(335);class bb extends ub{constructor(B,fa,Na){super(document.createElement("a"),B,!0);this.Zh=()=>{this.iV(!1);this.$.da.mo(this.Zh)};this.We=nb=>{this.yrg(nb.ud);return!0};this.onKeyDown=nb=>
13===nb.Ca.keyCode||32===nb.Ca.keyCode?(this.yrg(nb.ud),!0):!1;this.Zwa=fa.fd(this.domElement,Ta.a.instance.ia(513),0,wa.a.uNh,Ta.a.instance.ia(513),Qa.a.Vmi,this.disabled);this.domElement.classList.add(Wa.xNh);Na.appendChild(this.domElement);this.RFh();this.dxj()}dispose(){this.Nfk();super.dispose()}iV(B){super.iV(B||!this.$.da.MAa)}RFh(){const B=this.$.da;B.Og?this.iV(!1):B.Ol(this.Zh)}yrg(B){this.disabled||(h.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${za.a[B]}`),
this.$.Ha.kd(new aa.a(1243860697,B,this.$.ee,30,null)))}dxj(){Va.a.instance.ta(ob.a.click,this.domElement,this.We);ib.KeyInputManager.instance.ta(ob.a.Rd,this.domElement,this.onKeyDown)}Nfk(){Va.a.instance.Aa(ob.a.click,this.domElement,this.We);ib.KeyInputManager.instance.Aa(ob.a.Rd,this.domElement,this.onKeyDown)}}Object(d.a)(bb,"SheetDropdownMenuAnchor",ub,[]);var Mb=a(65),zb=a(192),oa=a(149),Xa=a(200),bc=a(142),Ac=a(59),Xc=a(221),Ed=a(212),Qd=a(186),zd=a(143);class fe{constructor(B){this.sheet=
B;this.altText=Ta.a.instance.ia(1994)}S2(){return this.sheet.active}UAd(){return this.sheet.isLockPausedInSession}usa(){return this.sheet.Ej?Qa.a.R0f:Qa.a.zfk}c7d(){return 16}ixa(){return null}jxa(){return Wa.T2e}G8d(){return null}av(){return null}P6c(){return!0}}Object(d.a)(fe,"LockPausedSheetIconDataSource",null,[652]);class jd{constructor(B){this.sheet=B;this.altText=Ta.a.instance.ia(1993)}S2(){return this.sheet.active}UAd(){return this.sheet.Ej}usa(){return Qa.a.R0f}c7d(){return 16}ixa(){return null}jxa(){return Wa.T2e}G8d(){return null}av(){return null}P6c(){return!0}}
Object(d.a)(jd,"LockedSheetIconDataSource",null,[652]);class Xb{constructor(B,fa,Na){this.sheet=B;this.altText=Ta.a.instance.ia(1908);this.Wak=fa;this.o_j=Na}S2(){return this.sheet.active}UAd(){return this.sheet.dg.KD}ixa(){return this.S2()?Wa.FNh:Wa.GNh}usa(){return!this.S2()&&this.o_j()?Qa.a.NWj:Qa.a.MWj}c7d(){return 14}jxa(){return Wa.oMh}G8d(){return this.sheet.dg.htb}av(){return this.Wak}P6c(){return!1}}Object(d.a)(Xb,"NamedSeetViewSheetIconDataSource",null,[652]);var Lc=a(181),Bd=a(148);class Nc{constructor(B,
fa){this.xXc=this.t5=this.zFa=this.nr=null;this.uwf=!1;this.h1c=this.usa=this.jxa=this.ixa=null;this.BQ=()=>{this.dataSource.S2()&&W.TaskExtensions.ya(this.mCf,()=>{dialogControls.renderToolTip(this.dataSource.av(),"SheetIconTooltip",this.dataSource.G8d(),this.dV,10,!1,!1,1)},this.$.ka,3)};this.AQ=()=>{this.dataSource.S2()&&this.clearToolTip()};this.$=B;this.dataSource=fa}get Me(){return this.t5||(this.t5=Bd.a.instance.Zf(this.dV))}get mCf(){if(this.xXc)return this.xXc;const B=new Lc.a;this.$.QB(fa=>
{W.TaskExtensions.ya(fa.XBf(),()=>{B.setResult(!0)},this.$.ka,3)});return this.xXc=B.task}get dV(){return this.h1c}gwg(){if(this.dV&&(this.nr||this.zFa)){var B=this.dataSource.usa();this.usa!==B&&(this.zFa&&this.zFa.parentNode.removeChild(this.zFa),this.wqf(),this.usa=B);B=this.dataSource.ixa();this.ixa!==B&&(this.yEj(this.zFa,this.ixa,B),this.ixa=B);B=this.dataSource.jxa();this.jxa!==B&&(this.xEj(this.dV,this.jxa,B),this.jxa=B);this.dataSource.av()&&!this.dataSource.S2()&&this.clearToolTip()}}M0j(B,
fa,Na){this.oyi(B,fa,Na);N.DOMElementExtensions.setVisible(this.dV,this.dataSource.UAd())}clearToolTip(){W.TaskExtensions.ya(this.mCf,()=>{dialogControls.clearToolTip(this.dataSource.av())},this.$.ka,3)}oyi(B,fa,Na){this.dV&&this.uwf!==B&&(this.dV.parentNode.removeChild(this.dV),this.jxa=this.ixa=this.usa=this.h1c=null,this.dataSource.av()&&(this.Me.detach("mouseover",!0),this.Me.detach("mouseout",!0)));this.dV||(this.h1c=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.dV,pb.a.$la),
Sys.UI.DomElement.addCssClass(this.dV,wa.a.nH),B===this.dataSource.P6c()?fa.appendChild(this.dV):fa.insertBefore(this.dV,Na),this.wqf(),this.dataSource.av()&&(this.Me.la("mouseover",this.BQ,!0),this.Me.la("mouseout",this.AQ,!0)),this.uwf=B)}yEj(B,fa,Na){B&&(Sys.UI.DomElement.removeCssClass(B,fa),Sys.UI.DomElement.addCssClass(B,Na))}xEj(B,fa,Na){fa&&Sys.UI.DomElement.removeCssClass(B,fa);Na&&Sys.UI.DomElement.addCssClass(B,Na)}dispose(){gb.a.Ma(this.t5)}wqf(){const B=this.$.ea.Ba(388);B?(this.zFa=
B.TPa(this.dataSource.usa(),this.dataSource.c7d()))?this.dV.appendChild(this.zFa):h.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.usa()} was not found.`):h.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(d.a)(Nc,"SheetIcon",null,[5]);var rb=a(367),va=a(103),yc=a(173);class Zc extends va.a{constructor(B,fa){super(B.domElement);this.onKeyDown=Na=>{121===Na.keyCode&&Na.shiftKey&&!this.Wra.disabled&&
(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Wra.anchor),Db.g(Na))};this.vga=Na=>{if(!this.$.isEditMode||this.Wra.disabled)return!0;this.rename(!1,Na.ud);return!0};this.jo=Na=>this.Wra.disabled?!0:this.showContextMenu(Na.clientPoint,Na.ud,Na.Nd);this.xve=B;this.$=fa;Va.a.instance.ta(ob.a.om,B.domElement,this.vga);rb.a.instance.ta(B.domElement,this.jo);this.Me.la("keydown",this.onKeyDown)}get Wra(){return this.xve}dispose(){this.Wra&&(Va.a.instance.Aa(ob.a.om,this.Wra.domElement,this.vga),rb.a.instance.Aa(this.Wra.domElement,
this.jo),this.xve=null);this.$=null;super.dispose()}showContextMenu(B,fa,Na){this.Wra.activate(fa,ab.a.byf());fa=new aa.a(-1075099431,fa,this.$.ee,30,null);let nb;return!yc.a(nb=this.$.Ha.kd(fa,{[ha.a.Nig]:B,[Zc.DWj]:this.Wra.sheet,[ha.a.Oig]:Na}))&&(6!==nb.status||nb.result)}rename(B,fa){this.$.Fe(817296323,fa,B?19:0,null)}}Zc.DWj="Sheet";Object(d.a)(Zc,"SheetOpsSheetClickHelper",va.a,[]);var cc=a(64);class Le extends ub{constructor(B,fa,Na,nb,gc){super(document.createElement("li"),B);this.BWj=100;
this.CWj=500;this.xPe=this.wPe=0;this.lVe=.5;this.JX=this.A2d=!1;this.color=this.cSc=this.yM=this.ZLb=this.zR=null;this.krc=this.ovf=!1;this.Adc="#BEBBB8";this.yPc=null;this.onKeyDown=bd=>13!==bd.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.jC=bd=>32!==bd.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.BQ=()=>{this.disabled||this.r4.ZT||this.Ora(!0,void 0,"OnMouseOver")};this.AQ=()=>{this.disabled||this.Ora(!1,void 0,"OnMouseOut")};this.CNb=()=>{this.r4.ZT||(this.q5j(),
Object(cc.c)(this.sheet.sheetProcessedData)||mb.h(this.$).hra(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.n$=()=>{this.f0e(!1);return!1};this.We=bd=>{if(this.disabled)return!0;const Ra=mb.h(this.$);this.sheet.active||3!==bd.ud||!ab.a.cSa()&&!this.mJb||Ra.Xc||Ra.Jk||Ra.wzb();this.activateSheet(bd.ud);return 3!==bd.ud};this.onPointerDown=bd=>{if(this.disabled)return!0;this.f0e(!0);mb.h(this.$).inRangePicker&&h.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var Ra=3===bd.ud;if(2===bd.ud||Ra&&this.lBa)this.Ora(!0,!Ra,"OnPointerDown"),Ra=ua.Task.delay(Ra?this.CWj:this.BWj).Nr(()=>!0),this.FIb&&(this.krc=!0,this.r4.tDc=W.TaskExtensions.ya(Ra,()=>{this.krc&&this.r4.yfj(this,bd)},this.ka,11));return!1};this.Li=bd=>{if(this.disabled||!this.FIb&&G.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.krc=!1;this.Ora(2===bd.ud,void 0,"OnPointerUp");this.r4.tDc&&(W.TaskExtensions.ya(this.r4.tDc,()=>{this.r4.xfj()},
this.ka,11),this.r4.tDc=null);return!1};this.HQ=()=>{this.krc=!1;this.A2d||this.Ora(!1,void 0,"OnTouchMove");return!1};this.oOe=new Zc(this,B);this.mJb=ab.a.mJb();this.wPe=18;this.xPe=20;this.$=B;this.y4b=nb;this.r4=gc;this.FIb=gc.qEe();this.Muh();this.Moh();this.zwd=B.Jd.Yh("UserAction",this.name);this.TAd=!1;N.DOMElementExtensions.wz(this.domElement,ha.a.Kt,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.yM);this.Vra=new Xa.a;B=new jd(this.sheet);this.Vra.add(new Nc(this.$,
B));this.$.da.iUb&&(B=new fe(this.sheet),this.Vra.add(new Nc(this.$,B)));B=new Xb(this.sheet,this.r4.aHc,()=>this.color?Le.O3d(this.color):!1);this.ZLb=new Nc(this.$,B);this.Vra.add(this.ZLb);this.lBa=this.r4.lBa;this.Mlb();this.Ayj();this.qJe=new yb.a(this.domElement,1);fa.insertBefore(this.domElement,Na);Wb.a(this.$)&&this.Zwg(!0)}get gyh(){return this.cSc||(this.cSc=Ed.a.jr("#F5F5F5"))}get name(){return this.zR.innerText}set name(B){this.zR&&(this.zR.innerText=B,this.SLc(),this.$wg())}get sheet(){return this.y4b}get anchor(){return this.yPc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(B){this.anchor.tabIndex=
B}q9h(){return N.DOMElementExtensions.Vh(this.anchor)?this.anchor:null}dispose(){if(this.JX){da.a.instance.Aa(ob.a.pointerDown,this.domElement,this.onPointerDown);ib.KeyInputManager.instance.Aa(ob.a.Rd,this.domElement,this.onKeyDown);ib.KeyInputManager.instance.Aa(ob.a.Iq,this.domElement,this.jC);Va.a.instance.Aa(ob.a.click,this.domElement,this.We);da.a.instance.Aa(ob.a.lZ,this.domElement,this.CNb);da.a.instance.Aa(ob.a.aE,this.domElement,this.n$);if(this.FIb||G.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))da.a.instance.Aa(ob.a.ri,
this.domElement,this.Li),this.lBa&&(ya.a.instance.Aa(ob.a.hg,this.domElement,this.Li),ya.a.instance.Aa(ob.a.xi,this.domElement,this.HQ));this.JX=!1;this.Adc="#BEBBB8"}gb.a.te([this.oOe,this.qJe]);this.zR=this.yM=this.yPc=this.r4=this.qJe=this.oOe=null;if(this.Vra){for(let B of this.Vra)B.dispose();this.Vra=null}this.color=this.y4b=null;super.dispose()}iV(B){B&&this.Ora(!1,!1);super.iV(B)}olg(B){if(Ac.a.mi.XT){this.gYe();var fa=Object(Ka.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(ka.d)(V.a.resolve(sa.Ib,
{Qa:1})):qa.GetServiceTaskFactory.Vc(this.$.ea,322,323,1);W.TaskExtensions.ya(fa,Na=>{zb.UISurfaces.nK().then(nb=>{const gc=Na.result;gc.ISj(nb);gc.show(B);return null},nb=>{h.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${nb}`);return null})},this.ka,3)}}mXg(){if(this.sheet.active&&this.$.Ir){var B=this.$.Ir,fa=mb.h(this.$),Na=fa.mk;if(this.sheet.dg.KD){if(!this.ZLb){const nb=new Xb(this.sheet,this.r4.aHc,()=>this.color?Le.O3d(this.color):
!1);this.ZLb=new Nc(this.$,nb);this.Vra.add(this.ZLb)}Na&&fa.zlb(1);B.classList.add(wa.a.e5e);B=Le.nff(ha.a.FIf);fa=Le.nff(ha.a.dKd);"true"===B&&"true"===fa?this.$.da.A3d&&this.$.da.DUb&&(this.sheet.dg.hQ?(B=1,oa.a.ay(ha.a.dKd,"false",oa.a.VY),this.$.da.DUb=!1):B=0,oa.a.ay(ha.a.FIf,"false",oa.a.VY),this.$.da.A3d=!1,this.olg(B)):this.sheet.dg.hQ&&"true"===fa&&this.$.da.DUb&&(oa.a.ay(ha.a.dKd,"false",oa.a.VY),this.$.da.DUb=!1,this.olg(2))}else this.gYe(),Na&&fa.zlb(0),B.classList.remove(wa.a.e5e)}}gYe(){const B=
Object(Ka.a)({Wpa:322,new:sa.Ib,registry:this.$.ea,zo:"OfficeVSO:7629405_namedSheetViewPublic_Migration"});B&&B.dismiss()}Mlb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.ibb()?Wa.k8j:Wa.s8j;G.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.zR.parentNode.classList.add(Wa.YPi):this.zR.parentNode.classList.add(Wa.ZPi);this.$wg();this.N0j();this.fxg();this.SLc();this.mXg()}wfj(){this.A2d=!0;this.Ora(!0,!0,"OnSheetReorderStarted")}vfj(){this.A2d=
!1;this.Ora(!1,void 0,"OnSheetReorderEnded")}activate(B,fa){B=void 0===B?0:B;fa=void 0===fa?!1:fa;this.tac()||(this.sheet.activate({scenario:"switchSheet"}),fa&&mb.h(this.$).focus(),B={["InputMethod"]:za.a[B],["AppMode"]:this.$.ee,["Location"]:"canvas"},zd.b(this.$).Xe(bc.a.yWj,B))}Zwg(B){this.Adc=B?"#797775":"#BEBBB8";this.lVe=B?-.5:.5;this.cSc=B?Ed.a.jr("#3B3A39"):Ed.a.jr("#F5F5F5");this.fxg()}oPj(B){this.FIb=B}IMd(B){B.tcd();this.FMe(B)}FMe(B){B.C5a();this.sheet.activate({scenario:"switchSheet"})}oUg(B){B=
new aa.a(-1876836819,B,this.$.ee,30,null);return this.$.Ha.kd(B,{[ha.a.C2d]:this.sheet.name})}$wg(){this.zR.parentNode.setAttribute("sheet-title",this.zR.innerText)}SLc(){const B=this.Q2h();this.anchor.setAttribute(ha.a.Aw,B);this.anchor.setAttribute(ha.a.cda,this.sheet.active.toString())}Q2h(){const B=this.sheet.dg.KD,fa=this.sheet.dg.htb,Na=this.sheet.Ej,nb=this.sheet.isLockPausedInSession;return B&&Na?String.format(Ta.a.instance.gd(20),this.name,fa):B&&nb?String.format(Ta.a.instance.gd(22),this.name,
fa):B?String.format(Ta.a.instance.gd(19),this.name,fa):Na?String.format(Ta.a.instance.gd(18),this.name):nb?String.format(Ta.a.instance.gd(21),this.name):this.name}activateSheet(B){B=void 0===B?0:B;if(ab.a.byf()){if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.tac())return ua.Task.Wa(!1);Qd.a.current.dR="ActivateSheet";mb.h(this.$).FNc.navigationStart("SwitchSheet");this.sheet.activate({scenario:"switchSheet"});return ua.Task.Wa(!0)}return this.oUg(B)}fxg(){const B=
this.sheet.tabColor;this.color=B?Ed.a.jr(B):this.gyh;this.ovf=Le.O3d(this.color);this.Ora(!1,void 0,"UpdateTabColor")}Ora(B,fa,Na){fa=void 0===fa?!1:fa;Na=void 0===Na?null:Na;if(this.sheet){Na=this.sheet.active;var nb=this.ibb(),gc=!!this.sheet.tabColor,bd=Ed.a.BL(Na||nb?Xc.a.white:this.color);this.yM.style.background="";Na||nb?(gc&&(G.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.vQa?this.xUj():this.wUj()),this.yM.style.height=this.wPe.toString()+
"px"):(this.yM.style.filter="",this.yM.style.backgroundColor=bd,this.yM.style.height=this.xPe.toString()+"px");this.zR.className=Na?Wa.l8j:nb?Wa.dark:this.ovf?Wa.light:Wa.dark;for(let Ra of this.Vra)Ra.gwg();B&&!gc&&(this.yM.style.backgroundColor="#E1DFDD");N.DOMElementExtensions.toggleCssClass(this.domElement,Wa.r8j,B);fa?(gc||(this.yM.style.backgroundColor=this.Adc),this.domElement.style.backgroundColor=this.Adc):(gc||(this.yM.style.backgroundColor=""),this.domElement.style.backgroundColor="");
this.zR.style.fontWeight=Na||nb?"600":""}else h.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Na}`)}wUj(){const B=this.yM.style,fa=Ed.a.BL(Le.Afh(this.color,this.lVe));B.background=fa}xUj(){this.yM.style.background="transparent"}Moh(){this.yPc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Wa.m8j;N.DOMElementExtensions.wz(this.anchor,ha.a.bvb,null,null);
this.tabIndex=-1}Muh(){this.yM=document.createElement("span");this.yM.className=Wa.p8j;this.zR=document.createElement("span");this.zR.className=Wa.u8j;this.zR.dir=this.sheet.rtlName?"rtl":"ltr";this.yM.appendChild(this.zR)}N0j(){const B=this.$.TO;for(let fa of this.Vra)fa.M0j(B,this.yM,this.zR)}ibb(){return mb.h(this.$).ibb(this.sheet)}q5j(){this.zwd.start();this.TAd=!0}f0e(B){this.TAd&&(this.zwd.stop(),h.ULS.sendTraceTag(537153686,0,50,m.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,
["Hovering time"]:this.zwd.Ee,["Has been clicked"]:B})),this.TAd=!1)}Ayj(){da.a.instance.ta(ob.a.pointerDown,this.domElement,this.onPointerDown);ib.KeyInputManager.instance.ta(ob.a.Rd,this.domElement,this.onKeyDown);ib.KeyInputManager.instance.ta(ob.a.Iq,this.domElement,this.jC);this.Me.la("mouseover",this.BQ);this.Me.la("mouseout",this.AQ);da.a.instance.ta(ob.a.lZ,this.domElement,this.CNb);da.a.instance.ta(ob.a.aE,this.domElement,this.n$);if(this.FIb||G.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))da.a.instance.ta(ob.a.ri,
this.domElement,this.Li),this.lBa&&(ya.a.instance.ta(ob.a.hg,this.domElement,this.Li),ya.a.instance.ta(ob.a.xi,this.domElement,this.HQ));Va.a.instance.ta(ob.a.click,this.domElement,this.We);this.JX=!0}tac(){const B=this.$.ea.Ba(65);return B&&B.yoa()?(B.KEc(),this.FMe(B),!0):!1}static nff(B){let fa=oa.a.get(B);fa||(oa.a.ay(B,"true",oa.a.VY),fa=oa.a.get(B));return fa}static Afh(B,fa){if(1<fa||-1>fa)return B;let Na=B.r,nb=B.g;B=B.b;0<fa?(Na=Na*(1-fa)+255*fa,nb=nb*(1-fa)+255*fa,B=B*(1-fa)+255*fa):(Na*=
1+fa,nb*=1+fa,B*=1+fa);return Xc.a.YBb(Math.round(Na),Math.round(nb),Math.round(B))}static O3d(B){return 128>=(222*B.r+707*B.g+71*B.b)/1E3}}Object(d.a)(Le,"SheetTabButton",ub,[]);class Re extends ub{constructor(B,fa,Na){super(document.createElement("a"),fa);this.ola=wa.a.akd;Na.fd(this.domElement,Ta.a.instance.ia(713),0,this.ola,Ta.a.instance.ia(713),Qa.a.ccd,!0);B.appendChild(this.domElement);this.Me.la("contextmenu",nb=>{Db.g(nb)})}}Object(d.a)(Re,"WorkbookProtectionButton",ub,[]);var Ib=a(56),
Yc=a(50),Cb=a(66);class pc extends Pb.a{constructor(B,fa,Na){Na=void 0===Na?null:Na;super(fa);this.sheetTabActivatePreviousHidden=Ta.a.instance.ia(722);this.sheetTabActivateNextHidden=Ta.a.instance.ia(724);this.svgIconProvider=null;this.tj=[];this.nQ=Array(6);this.mKd=Array(6);this.oXa=this.nGb=this.MT=this.mjb=this.I2d=this.H2d=this.Lo=null;this.isRtl=!1;this.MY=this.LB=0;this.pfc=this.sDc=!1;this.aAc=this.vra=0;this.uP=this.B7=this.fea=this.Afc=null;this.Xlc=this.GF=0;this.UVb=null;this.IJb=-1;
this.p7=null;this.fzc=0;this.XIc=-1;this.Mqa=0;this.gya=new fb;this.jWc=!1;this.tDc=this.eHc=this.dHc=this.vve=this.l3=null;this.sne=!1;this.uve=null;this.cG=(nb,gc)=>{this.HUf(gc.item)};this.gDa=(nb,gc)=>{nb=this.$.va.na.index;for(let bd=0,Ra=this.tj.length;bd<Ra;bd++){const Tb=this.hY(bd);if(Tb.name===gc.oldName){Tb.name=gc.newName;this.T3();bd===nb&&this.Bha(6);break}}};this.LUf=(nb,gc)=>{(nb=this.lBb(gc.item))&&nb.Mlb()};this.MUf=(nb,gc)=>{gc.visible?(this.iXa(!1),this.IUf(gc.item)):this.HUf(gc.item)};
this.aqa=nb=>{this.ZT?(this.p7=nb,this.pXb()):(this.p7&&(this.aAc+=this.p7.clientPoint.x-nb.clientPoint.x),this.p7=nb,Math.abs(this.aAc)>=this.DDh&&this.pXb());return!0};this.HQ=nb=>{nb.Ca.preventDefault();return!1};this.mdg=nb=>{this.jdg(nb,!0)};this.ldg=nb=>{this.jdg(nb,!1)};this.bqa=nb=>{if(this.ZT){this.pfc=this.NEi(nb);let gc;nb=(gc=this.hY(this.GF+1))?gc.sheet:null;this.reorderSheets(nb,this.GF+1===this.F2d,!0)}this.CX();return!0};this.cm=(nb,gc)=>{gc.dE&&this.zae(gc.dE);this.jGc(!1);this.T3();
gc.na&&(this.zae(gc.na),this.Bha(6),this.da.tqa())};this.aLf=(nb,gc)=>{this.KMc(gc.item)};this.bLf=(nb,gc)=>{this.KMc(gc.item)};this.cLf=(nb,gc)=>{this.KMc(gc.item)};this.PTa=(nb,gc)=>{this.KMc(gc.item)};this.OCa=()=>{this.Pad()};this.kf=()=>{this.isVisible=!this.da.isNamedObjectViewMode;this.Pad();this.Qed();if(Cb.d(this.$)||Cb.e(this.$))Yc.PageLoadTrackingInfo.instance.haa(ha.a.bFa,["sheetTabBar"]),Yc.PageLoadTrackingInfo.instance.gaa(ha.a.bFa,["sheetTabBar"]);this.yed();this.T3();this.iXa(!0);
this.Bha(6)};this.Lk=()=>{this.isVisible&&(this.T3(),this.Bha(6))};this.vh=()=>{Object(vb.a)(P,this.MT)===Sb.m(this.$.tg)&&this.yed();for(const nb of this.tj)nb.oPj(!Sb.m(this.$.tg))};this.KUf=(nb,gc)=>{this.oEj(gc.item,gc.isUserOperation)};this.WNb=(nb,gc)=>{this.IUf(gc.item)};this.onKeyDown=nb=>{switch(nb.keyCode){case 9:var gc=this.domElement.querySelectorAll(N.DOMElementExtensions.Us);const bd=N.DOMElementExtensions.Jn(gc);gc=N.DOMElementExtensions.BD(gc);N.DOMElementExtensions.TEa(nb,bd,gc);
break;case 39:case 37:N.DOMElementExtensions.hgg(nb,this.domElement.querySelectorAll(N.DOMElementExtensions.Us),39===nb.keyCode?!this.isRtl:this.isRtl)}h.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${nb.keyCode}`)};this.onScroll=()=>{this.Lo.scrollLeft!==this.vra&&this.Y9j()};this.DQ=nb=>{if(nb.ctrlKey||nb.X6)return!1;this.Lo.scrollLeft+=Math.floor(30*nb.sta);if(this.ZT){const gc=this.Fdf("OnMouseWheel");gc&&this.f7d(0<nb.sta,gc.x+gc.width/2)}return!0};this.FQ=(nb,gc)=>
{if(this.gya)this.Blf("PartialInteractivity",gc.oS?3:0);else{this.CX(!1);this.h1d(gc.oS);for(const bd of this.mIe)bd&&bd.iV(gc.oS);for(const bd of this.tj)bd&&bd.iV(gc.oS)}};this.ZMb=(nb,gc)=>{nb=0;gc.rze&&(nb=2|(gc.EWj?1:0));this.Blf("ComponentRangePicker",nb)};this.$=B;this.da=this.$.da;this.Hfc=!G.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Ixf=!this.$.Yw;this.sne=!z.a.WB;this.BGi=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",
!1);this.e0i=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.d0i=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.DDh=this.$.xa.SheetTabDragStartPixelThreshold;this.FUa=this.GUa=-1;this.Tcd=!1;this.svgIconProvider=Na;this.cF=new yb.a(this.domElement,3);this.domElement.classList.add(Wa.PNh);this.wsh();this.bqh();this.xsh();document.getElementById(ha.a.Uea)||this.Cth();this.jGc(!0);this.kf(null,null);B=this.$.va;B.Fi(this.cm);B.c5c(this.OCa);B.C0(this.cG);B.Dka(this.WNb);B.yKa(this.gDa);
B.vCe(this.KUf);B.X2a(this.MUf);B.q_g(this.LUf);B.r5c(this.aLf);B.sCe(this.bLf);B.tCe(this.cLf);B.uCe(this.PTa);this.$.Pm(this.kf);this.$.tB(this.Lk);hb.a(this.$).Wj(this);this.$.ea.Ja(32,this);G.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.da.zw(this.vh);this.cHc=this.lg.Zf(this.domElement);this.cHc.la("keydown",this.onKeyDown);Gc.a(this.$).qr()&&this.FQ(null,new Ob.a(!0));Gc.a(this.$).gi.Fka(this.FQ);mb.h(this.$).TBe(this.ZMb);this.cHc.la("mousedown",
nb=>{nb.preventDefault()});Ia.a.instance.ta(ob.a.XF,this.domElement,this.DQ);this.G2d=this.lg.Zf(this.Lo);this.G2d.la("scroll",this.onScroll);this.Y9j=Ga.b(()=>{this.T3()},200,this.$.ka,mc.a.KWj,!0);this.$.NH(ha.a.V2j);this.Ixf&&(this.uve=new Ea(this.$,this.oXa.domElement));Yc.PageLoadTrackingInfo.instance.rha(ha.a.bFa,["sheetTabBar"])}get de(){return this.domElement}get Vh(){return this.isVisible}get Tf(){return qb.a.E2d}get ZT(){return this.jWc}get F2d(){return this.tj.length}get aHc(){return this.vve}get lBa(){return this.sne}get navigationButtonsDisabled(){return!!this.gya&&
this.gya.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.gya&&this.gya.operationButtonsDisabled}get q0i(){return this.$.TO?[wa.a.R2e,wa.a.V2e,wa.a.W2e,wa.a.Q2e,wa.a.Hgc,wa.a.Hgc]:[wa.a.Q2e,wa.a.W2e,wa.a.V2e,wa.a.R2e,wa.a.Hgc,wa.a.Hgc]}get nKd(){return this.$.TO?[null,Qa.a.gQe,Qa.a.eQe]:[null,Qa.a.eQe,Qa.a.gQe]}get j_f(){return this.$.TO?[null,Qa.a.hQe,Qa.a.fQe]:[null,Qa.a.fQe,Qa.a.hQe]}get lKb(){if(this.isRtl){if(z.a.ND)return 0;if(z.a.hh)return-1*(this.Lo.scrollWidth-this.Lo.clientWidth);
if(z.a.WB)return this.Lo.scrollWidth-this.Lo.clientWidth;h.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get eSb(){if(this.isRtl){if(z.a.ND)return this.Lo.scrollWidth-this.Lo.clientWidth;if(z.a.hh||z.a.WB)return 0;h.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Lo.scrollWidth-this.Lo.clientWidth}get mIe(){return this.gya?[this.MT,this.nGb]:[this.MT,this.nGb,this.oXa]}get t8j(){return this.tj.concat(this.oXa)}get Lig(){return this.uve}fd(B,
fa,Na,nb,gc,bd,Ra){Ra=void 0===Ra?!1:Ra;B.removeAttribute("Href");B.setAttribute(ha.a.wf,ha.a.zv);B.className=Wa.ENh;B.title=fa;B.tabIndex=0;bd?Na=this.svgIconProvider.kfa(bd,12,12,B,24,24):(fa=document.createElement("span"),fa.className=wa.a.uih,fa.classList.add(pb.a.$la),fa.tabIndex=-1,B.appendChild(fa),bd=document.createElement("img"),bd.src=vc.a.di(Na),bd.className=nb,bd.alt=gc,bd.tabIndex=-1,fa.appendChild(bd),Na=bd);Ra&&B.classList.add(pb.a.gX);return Na}dispose(){if(this.$){var B=this.$.va;
B.hj(this.cm);B.NVd(this.OCa);B.daa(this.cG);B.ara(this.WNb);B.RVa(this.gDa);B.H7f(this.KUf);B.ZQb(this.MUf);B.fCj(this.LUf);B.dWd(this.aLf);B.E7f(this.bLf);B.F7f(this.cLf);B.G7f(this.PTa);this.$.Rn(this.kf);this.$.iE(this.Lk);Gc.a(this.$)&&Gc.a(this.$).gi.bra(this.FQ);this.gya&&mb.h(this.$).k7f(this.ZMb);Ia.a.instance.Aa(ob.a.XF,this.domElement,this.DQ)}gb.a.te(this.mKd);this.mKd=null;if(this.nQ)for(B=0;B<this.nQ.length;B++){const fa=N.DOMElementExtensions.JH(this.nQ[B],this.domElement,!1,"a");fa&&
Za.a.Xqa(fa)}gb.a.Ma(this.cF);gb.a.Ma(this.cHc);gb.a.Ma(this.G2d);this.G2d=this.cHc=this.nGb=this.MT=this.cF=null;this.$&&this.CX(!1);this.fea=null;this.A0d(null,"Dispose");this.UVb=this.uP=this.Afc=null;this.Pad();this.mjb=this.I2d=this.H2d=this.Lo=this.nQ=this.$=this.da=null;super.dispose()}$h(B,fa){if(!fa){h.ULS.shipAssertTag(537153760,0,0<this.tj.length,"There is no sheet tab button.");if(!this.tj.length)return!1;B=null;for(const Na of this.tj)if(B=Na.q9h())break;if(!B)return h.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;N.DOMElementExtensions.setFocus(B)}return!fa}nj(B){return N.DOMElementExtensions.Eh(this.de,B)}Vk(){}yl(){}reorderSheets(B,fa,Na){if(this.l3&&this.l3!==B){const nb=this.l3.index;this.nEj(this.l3,B,fa);B=B?B.index-1:fa?this.$.va.count-1:0;nb!==B&&(this.AUi(nb,B,Na),this.AGh(this.l3.name,B))}}gli(B){B=this.Oma(B);return-1!==B&&this.LB<=B&&B<=this.MY?this.tj[B].domElement:null}ikk(B){for(var fa=0;fa<this.nQ.length;fa++){const Na=this.nQ[fa];if(Na&&this.svgIconProvider){const nb=
Na.parentNode;this.N6f(Na);nb&&(this.nQ[fa]=this.svgIconProvider.kfa(B?this.j_f[fa]:this.nKd[fa],12,12,nb,24,24))}}for(fa=0;fa<this.tj.length;fa++)this.tj[fa].Zwg(B);this.oXa&&this.oXa.Zwa&&this.Ywg(Qa.a.Wmi,this.oXa,B);this.MT&&this.MT.Zwa&&this.Ywg(Qa.a.ykh,this.MT,B)}Ywg(B,fa,Na){fa.Yfb||(fa.Yfb=this.svgIconProvider.kfa(B,12,12,fa.Zwa.parentNode,24,24));fa.Yfb&&(N.DOMElementExtensions.setVisible(fa.Zwa,!Na),N.DOMElementExtensions.setVisible(fa.Yfb,Na))}yfj(B,fa){var Na=mb.h(this.$);const nb=Na.inRangePicker,
gc=Eb.HelperMethods.Vs(fa);if(Na.Xc&&!nb){const bd=Na.pr?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Ra;Ra=[Object(Hb.a)(Na.cellTextEditBox.textBox.GFa)];Hb.b(this.$).YFa(gc.rawEvent,bd,Ra);Na.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Na=this.lBa&&3===fa.ud;!(2===fa.ud&&gc.button===Sys.UI.MouseButton.leftButton||Na)||nb||this.ZT||Gc.a(this.$).qr()||(Na&&B.wfj(),this.IJb=fa.clientPoint.x,this.p7=fa,this.i8g(B))}xfj(){this.T3()}qEe(){return this.$.isEditMode&&!Sb.m(this.$.tg)}T3(){const B=
Eb.HelperMethods.qU(()=>{this.dik();this.bUj();this.h1d()});h.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${B}`)}bUj(){const B=this.MY===this.tj.length-1;N.DOMElementExtensions.toggleCssClass(this.mjb,this.$.TO?Wa.X2e:Wa.S2e,!!this.LB);N.DOMElementExtensions.toggleCssClass(this.mjb,this.$.TO?Wa.S2e:Wa.X2e,!B)}h1d(B){B=void 0===B?!1:B;const fa=!this.LB,Na=this.MY===this.tj.length-1;this.Lgg(4,this.sheetTabActivatePreviousHidden,!fa);this.Lgg(5,
this.sheetTabActivateNextHidden,!Na);this.yGc(0,fa||B);this.yGc(1,fa||B);this.yGc(2,Na||B);this.yGc(3,Na||B)}Lgg(B,fa,Na){if(B=this.nQ[B]){N.DOMElementExtensions.setVisible(B,Na);var nb=this.sff(B);nb.title="img"===B.nodeName?B.alt=0<this.tj.length&&Na?fa:"":B.title=0<this.tj.length&&Na?fa:"";nb.tabIndex=Na?0:-1}}sff(B){return B.parentNode}yGc(B,fa){if(B=this.nQ[B])B=this.sff(B),void 0!==B&&null!==B&&(!this.tj.length||fa?(B.classList.add(pb.a.gX),B.setAttribute(ha.a.Hwa,"true")):(B.classList.remove(pb.a.gX),
B.setAttribute(ha.a.Hwa,"false")))}iXa(B){const fa=this.$.TO?this.tj.length-1:0;let Na=this.Yhf(this.$.TO?0:this.tj.length-1);Na&&(Na.borderRightWidth=B?"1px":"0");this.LB!==this.MY&&(Na=this.Yhf(fa))&&(Na.borderRightWidth="0")}lBe(B,fa){this.tj||(this.tj=[]);-1===fa?this.tj.push(B):this.tj.splice(fa,0,B)}Xcc(B,fa){let Na=-1,nb=null;fa||(Na=this.Fci(B.index),-1!==Na&&(nb=this.QPa(Na)));B=new Le(this.$,this.Lo,nb,B,this);this.lBe(B,Na);N.DOMElementExtensions.setVisible(B.domElement,!0)}Bha(B){const fa=
Eb.HelperMethods.qU(()=>{switch(B){case 0:this.bFc(0);break;case 1:this.bFc(this.LB-1);break;case 2:this.bFc(this.LB+1);break;case 3:this.scrollIntoView(this.tj.length-1);break;case 4:this.LB&&1<=this.tj.length&&(this.cze(this.LB-1),this.OZd());break;case 5:this.MY!==this.tj.length-1&&1<=this.tj.length&&(this.cze(this.MY+1),this.OZd());break;case 6:this.OZd()}});this.Hfc&&this.ZT&&this.pXb();h.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${B}, duration = ${fa}`)}cze(B){(B=
this.hY(B))&&B.activate()}GWh(B){if(0===B.DC){const fa=this.$.va;let Na=0;for(let nb=0,gc=fa.count;nb<gc;nb++){const bd=Object(eb.a)(Zb.a,fa.getItem(nb));if(bd===B)return Na;0===bd.DC&&Na++}}return-1}uWh(B){const fa=this.$.va;for(let Na=B.index+1,nb=fa.count;Na<nb;Na++)if(B=Object(eb.a)(Zb.a,fa.getItem(Na)),0===B.DC)return B;return null}Oma(B){for(let fa=0;fa<this.tj.length;fa++){const Na=this.hY(fa);if(!Na)h.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${fa}] is null even though index is not out of bounds!`);
else if(Na.sheet===B)return fa}return-1}lBb(B){B=this.Oma(B);return this.hY(B)}AUi(B,fa,Na){const nb={};nb.a=this.$.xa.UserSessionId;nb.b=Na;nb.c=this.pfc;nb.d=B;nb.e=fa;nb.f=this.$.va.count;Ib.b().Wg(2,nb,Na)}nEj(B,fa,Na){const nb=Object(eb.a)(ic.a,this.$.va);fa?(fa=fa.index,fa=B.index<fa?fa-1:fa):fa=Na?nb.count-1:0;nb.reorderSheet(B,fa,!0)}BRj(B){mb.h(this.$).Ti.Ar(B)}i8g(B){if(!this.sDc){const fa=this.domElement.ownerDocument.body;da.a.instance.ta(ob.a.vn,document.documentElement,this.aqa);this.lBa&&
(ya.a.instance.ta(ob.a.xi,document.documentElement,this.aqa),ya.a.instance.ta(ob.a.xi,this.domElement,this.HQ));da.a.instance.ta(ob.a.ri,document.documentElement,this.bqa);ya.a.instance.ta(ob.a.hg,fa,this.bqa);this.sDc=!0}this.l3=B.sheet;this.pfc=!1;this.uP=null;this.Afc=B;this.fea=B.domElement;this.A0d(N.DOMElementExtensions.getBoundingClientRect(this.fea),"BeginSheetTabButtonDrag")}CX(B){B=void 0===B?!0:B;if(this.sDc){this.BRj(ha.a.jY);const fa=this.domElement.ownerDocument.body;da.a.instance.Aa(ob.a.vn,
document.documentElement,this.aqa);this.lBa&&(ya.a.instance.Aa(ob.a.xi,document.documentElement,this.aqa),ya.a.instance.Aa(ob.a.xi,this.domElement,this.HQ));da.a.instance.Aa(ob.a.ri,document.documentElement,this.bqa);ya.a.instance.Aa(ob.a.hg,fa,this.bqa);this.jWc=this.sDc=!1}this.aAc=0;this.pfc=!1;this.l3=null;this.fea&&(this.fea.style.visibility="visible",this.fea=null);this.Afc=null;this.A0d(null,"EndSheetTabButtonDrag");this.uP&&(this.uP.parentNode&&this.uP.parentNode.removeChild(this.uP),this.uP=
null);this.KGj(B)}KGj(B){this.r6d(B);this.GF=this.IJb=-1}AGh(B,fa){const Na=this.$.pa,nb=Na?Na.ua:null;this.$.userOperationManager.enqueueOperation(new Bc.a(557,0,(gc,bd,Ra)=>{const Tb=nb.Ra(9,null);Tb.sheetName=B;Tb.newSheetIndex=fa;return Mb.g(nb,"ReorderSheets",Tb,gc,bd,Ra,null,0)},64,()=>new Z(B,fa)),null)}hY(B){return 0<=B&&B<this.tj.length?this.tj[B]:null}Ohi(B){return(B=this.hY(B))?B.sheet:null}QPa(B){return(B=this.hY(B))?B.domElement:null}Yhf(B){return(B=this.QPa(B))?B.style:null}Fci(B){const fa=
this.$.va;B+=1;let Na=-1;const nb=this.tj?this.tj.length:0;for(;B<fa.count;){const gc=Object(eb.a)(Zb.a,fa.getItem(B));if(0===gc.DC){for(Na=0;Na<nb&&this.Ohi(Na)!==gc;Na++);break}B++}return-1===Na||Na===nb?-1:Na}HUf(B){var fa=this.lBb(B);fa&&(this.ZT&&(h.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),G.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.CX()),
this.Lo.removeChild(fa.domElement),fa=Array.indexOf(this.tj,fa),this.tj.splice(fa,1),this.T3(),(!this.isRtl&&fa===this.tj.length||this.isRtl&&!fa)&&this.iXa(!0),this.Hfc&&this.ZT?B===this.l3?(this.CX(),this.Bha(6)):this.pXb():this.Bha(6))}IUf(B){const fa=Object(eb.a)(Zb.a,B);this.ZT&&(h.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),G.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.CX());if(0===fa.DC){this.iXa(!1);var Na=this.Oma(B);-1===Na&&(h.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.Xcc(fa,!1),Na=this.Oma(B));this.Klf(Na,!0)}}oEj(B,fa){const Na=this.lBb(B);Na&&(this.ZT&&!fa&&(h.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),G.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.CX()),B=this.f8j(B,Na),!G.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&B&&fa&&B.vfj())}f8j(B,fa){var Na=Array.indexOf(this.tj,fa);const nb=this.GWh(Object(eb.a)(Zb.a,B));if(-1===nb||-1===Na)return null;this.iXa(!1);({kXh:this.LB,ZOi:this.MY}=pc.kEj(Na,nb,this.LB,this.MY));fa&&fa.domElement.parentNode===this.Lo&&(this.Lo.removeChild(fa.domElement),this.tj.splice(Na,1));fa=this.uWh(B);Na=this.Oma(fa);fa=new Le(this.$,this.Lo,this.QPa(Na),Object(eb.a)(Zb.a,
B),this);this.lBe(fa,Na);Na=this.Oma(B);this.Klf(Na,!1);return fa}pHh(){const B=this.tj?this.tj.length:0,fa=this.LB,Na=this.MY;for(let nb=0;nb<B;nb++){const gc=this.hY(nb),bd=nb>=fa;gc&&(gc.tabIndex=bd&&nb<=Na?0:-1)}}Rgk(){const B=this.tj?this.tj.length:0;for(let fa=0;fa<B;fa++){const Na=this.hY(fa);Na&&Na.Mlb()}}Klf(B,fa){fa&&B<=this.LB&&this.LB++;this.pHh();this.iXa(!0);this.T3();this.Hfc&&this.ZT&&this.pXb()}jGc(B){const fa=this.$.TO;if(B||this.isRtl!==fa)this.isRtl=fa,this.domElement.classList.remove(this.isRtl?
wa.a.U2e:wa.a.Y2e),this.domElement.classList.add(this.isRtl?wa.a.Y2e:wa.a.U2e),this.domElement.dir=this.isRtl?"rtl":"ltr",this.Rgk();B||this.iXa(!0);for(B=0;B<this.nQ.length;B++)0!==B&&3!==B&&4!==B&&5!==B&&this.Mgg(B)}wsh(){const B=this.H2d=document.createElement("div");B.className=Wa.BNh;B.classList.add(Wa.CNh);this.domElement.appendChild(B);this.ITe(B,1,717,716);this.ITe(B,2,719,718);this.Ixf&&(this.oXa=new bb(this.$,this,B))}xsh(){const B=this.I2d=document.createElement("div");B.className=Wa.DNh;
this.domElement.appendChild(B);this.yed()}Cth(){const B=document.getElementById(ha.a.zWj),fa=document.getElementById(ha.a.AWj);B&&!fa&&h.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${B.parentNode.id}. progressBar div has child: ${!!B.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(ha.a.x2d)}`);const Na=ab.a.Nxf(this.$);if(Na&&B&&fa)this.domElement.appendChild(B),this.dHc=B.firstChild,
this.eHc=document.getElementById(ha.a.x2d),fa.style.visibility="visible";else{const nb=document.createElement("div"),gc=document.createElement("div");nb.className=wa.a.KNh;gc.className=wa.a.INh;gc.id=ha.a.w2d;gc.style.display="none";const bd=document.createElement("div");bd.className=wa.a.LNh;const Ra=document.createElement("div");Ra.className=wa.a.JNh;const Tb=document.createElement("div");Tb.className=wa.a.HNh;gc.appendChild(bd);gc.appendChild(Ra);gc.appendChild(Tb);nb.appendChild(gc);this.domElement.appendChild(nb);
this.dHc=gc;this.eHc=Ra;h.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Na,B,fa)}}Mgg(B){var fa=this.nQ[B];if(fa){const Na=fa.parentNode;this.N6f(fa);fa=Wb.a(this.$)?this.j_f[B]:this.nKd[B];this.nQ[B]=this.svgIconProvider.kfa(fa,12,12,Na,24,24)}}N6f(B){(null===B||void 0===B?0:B.parentNode)&&B.parentNode.removeChild(B)}bqh(){const B=
this.mjb=document.createElement("div");B.className=Wa.vNh;this.domElement.appendChild(B);this.Fuh(B)}Fuh(B){const fa=document.createElement("div");fa.className=Wa.NNh;fa.classList.add(Wa.wNh);this.$.printingEnabled||fa.classList.add(Sa.a.Z4e);B.appendChild(fa);this.Lo=document.createElement("ul");N.DOMElementExtensions.wz(this.Lo,ha.a.A7c,null,null);this.Lo.className=Sa.a.Z2e;fa.appendChild(this.Lo);this.qsh();this.vve=document.createElement("div");this.aHc.id="SheetIconTooltipContainer";fa.appendChild(this.aHc)}qsh(){const B=
document.createElement("div"),fa=document.createElement("div"),Na=vc.a.Ebf(wa.a.JOh);fa.className=wa.a.yih;fa.appendChild(Na);B.appendChild(fa);B.className=Wa.MNh;N.DOMElementExtensions.setVisible(B,!1);this.Lo.appendChild(B)}Qed(){const B=this.$.va;for(let fa=0,Na=B.count;fa<Na;fa++){const nb=Object(eb.a)(Zb.a,B.getItem(fa));0===nb.DC&&(this.Xcc(nb,!0),nb.active&&nb.activate({scenario:"createSheetTabs"}))}}Pad(){gb.a.te(this.tj);this.tj=[];this.MY=this.LB=0}ITe(B,fa,Na,nb){const gc=document.createElement("a");
B.appendChild(gc);B=this.nKd[fa];this.nQ[fa]=this.fd(gc,Ta.a.instance.ia(nb),0,this.q0i[fa],Ta.a.instance.ia(Na),B);if(5===fa||4===fa)N.DOMElementExtensions.JH(this.nQ[fa],gc,!1,"span").style.marginTop="10px";this.Mgg(fa);Na=this.mKd[fa]=this.lg.Zf(gc);da.a.instance.ta(ob.a.pointerDown,gc,Ra=>Ra.ctrlKey&&this.T6i(fa)?!0:this.MRf(fa));da.a.instance.ta(ob.a.ri,gc,()=>this.NRf());ya.a.instance.ta(ob.a.hg,gc,()=>this.NRf());da.a.instance.ta(ob.a.pointerOut,gc,()=>this.Had());ib.KeyInputManager.instance.ta(ob.a.Rd,
gc,Ra=>13!==Ra.Ca.keyCode&&32!==Ra.Ca.keyCode||this.Tcd?!1:(this.Tcd=!0,this.MRf(fa)));ib.KeyInputManager.instance.ta(ob.a.Hf,gc,Ra=>13===Ra.Ca.keyCode||32===Ra.Ca.keyCode?(this.Tcd=!1,this.Had()):!1);const bd=this.qEe();nb=Ra=>{"mouseup"===Ra.type&&this.ZT||Db.g(Ra);!gc.classList.contains(pb.a.gX)&&bd&&this.dcj(Ra,fa)};Na.la("mouseover",nb);Na.la("mouseout",nb);Na.la("focus",nb);Na.la("blur",nb);bd&&Na.la("mouseup",nb)}NEi(B){let fa=!1;const Na=this.$.oh;Na&&(fa=t.a.UT(N.DOMElementExtensions.getBoundingClientRect(Na),
B.clientPoint));return fa}pXb(){if(!this.uP){h.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.uP=this.fea.cloneNode(!0);if(!this.Mbg(this.uP,this.fea,!0,"UpdateDragAndDropState"))return;this.fea.style.visibility="hidden";this.uP.classList.add(Wa.ONh);this.uP.style.borderRightWidth="";this.Xlc=this.p7.clientPoint.x-this.B7.width/2;this.uP.style.left=this.Xlc+"px";this.GF=this.Oma(this.l3);0>this.GF&&h.ULS.sendTraceTag(537153742,
0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Hfc&&(this.GF=this.Oma(this.l3));var B=N.DOMElementExtensions.getBoundingClientRect(this.Lo);const fa=B.x;B=B.x+B.width;let Na=this.p7.clientPoint.x-this.B7.width/2;Na=Math.min(Na,B-this.B7.width);Na=Math.max(Na,fa);this.uP.style.transform="translateX("+Math.abs(Na-this.Xlc)*(this.Xlc<Na?1:-1)+"px)";const nb=this.p7.clientPoint.x>this.IJb;let gc=this.p7.clientPoint.x;Na>=B-this.B7.width?(gc=B-this.B7.width/2,this.KZd()||this.Mqa||
(h.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.fzc=this.Lo.scrollLeft,this.Mqa=window.requestAnimationFrame(this.mdg))):Na<=fa?(gc=fa+this.B7.width/2,this.JZd()||this.Mqa||(h.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.fzc=this.Lo.scrollLeft,this.Mqa=window.requestAnimationFrame(this.ldg))):
this.Mqa&&(h.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.r6d());this.p7.clientPoint.x!==this.IJb&&(this.f7d(nb,gc),this.IJb=this.p7.clientPoint.x);this.jWc=!0}f7d(B,fa){let Na;for(;(()=>{let nb=this.EDh(fa,B);({V$b:Na}=nb);return nb})().returnValue;)this.UVb=Na,this.u3g(B)}u3g(B){if(this.UVb){var fa=(B?1:-1)*this.B7.width;if(B&&!this.$.TO||!B&&this.$.TO){var Na=this.fea;var nb=this.GF+1;var gc=!0}else Na=
(nb=this.hY(this.GF+1))?nb.domElement:null,nb=this.GF-1,gc=!1;if(this.Mbg(this.UVb,Na,gc,"AnimateSheetSwap")){h.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.GF} and other sheet-index ${nb}. amount of sheets in the bar: ${this.F2d} isMovingRight: ${B}`);0<=this.GF&&this.GF<this.tj.length&&0<=nb&&nb<this.tj.length?(B=this.tj[nb],this.tj[nb]=this.tj[this.GF],this.tj[this.GF]=B):(h.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.tj.length}, ghostIndex: ${this.GF}, swappedSheetIndex: ${nb}`),
this.CX());this.GF=nb;var bd=this.UVb;bd.style.transform="translateX("+fa+"px)";window.requestAnimationFrame(()=>{bd.style.transform="translateX(0px)"})}}}Mbg(B,fa,Na,nb){const gc=bd=>bd?`Node ID: ${bd.id} , Node class: ${bd.className}, Node name: ${bd.nodeName},`:null;try{return this.Lo.insertBefore(B,fa),!0}catch(bd){return B=this.lBb(this.l3),h.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
B?B!==this.Afc?"Changed":"NoChange":"Removed",nb,gc(fa),gc(fa.parentNode),gc(this.Lo),Na,this.GF,this.F2d,bd),this.CX(),!1}}EDh(B,fa){var Na=this.$.TO===fa?this.hY(this.GF-1):this.hY(this.GF+1);if(!Na)return{returnValue:!1,V$b:null};Na=Na.domElement;const nb=N.DOMElementExtensions.getBoundingClientRect(Na);return this.B7?fa?{returnValue:B+this.B7.width/2>=nb.x+.5*nb.width,V$b:Na}:{returnValue:B-this.B7.width/2<=nb.x+.5*nb.width,V$b:Na}:(h.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.CX(),{returnValue:!1,V$b:Na})}jdg(B,fa){let Na;Na=fa?this.mdg:this.ldg;if(-1===this.XIc)this.XIc=B,this.Mqa=window.requestAnimationFrame(Na);else{B=Math.floor((B-this.XIc)/1E3*300);var nb=this.eSb>this.lKb?1:-1;this.scrollLeft(Math.abs(this.Lo.scrollLeft-(fa?this.fzc+B*nb:this.fzc-B*nb))*(fa?-1:1));if(B=this.Fdf("ScrollStep"))this.f7d(fa,B.x+B.width/2),fa&&!this.KZd()||!fa&&!this.JZd()?this.Mqa=window.requestAnimationFrame(Na):(h.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.r6d())}}KZd(){const B=this.eSb>this.lKb;return B&&this.vra>=this.eSb||!B&&this.vra<=this.eSb}JZd(){const B=this.eSb>this.lKb;return B&&this.vra<=this.lKb||!B&&this.vra>=this.lKb}r6d(B){B=void 0===B?!0:B;this.Lo&&(this.vra=this.Lo.scrollLeft);window.cancelAnimationFrame(this.Mqa);this.Mqa=0;this.XIc=-1;B&&this.T3()}A0d(B,fa){B||h.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${fa}`);this.B7=B}T6i(B){return 2===B?(this.Bha(3),
!0):1===B?(this.Bha(0),!0):!1}MRf(B){h.ULS.shipAssertTag(537153732,0,-1===this.GUa&&-1===this.FUa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.GUa&&(window.clearTimeout(this.GUa),this.GUa=-1);-1!==this.FUa&&(window.clearInterval(this.FUa),this.FUa=-1);this.Bha(B);this.GUa=window.setTimeout(()=>{this.G5j(B)},this.e0i);return!0}G5j(B){this.FUa=window.setInterval(()=>{this.Bha(B)},this.d0i)}NRf(){this.Had();
return!this.ZT}Had(){window.clearTimeout(this.GUa);window.clearInterval(this.FUa);this.FUa=this.GUa=-1;return!0}dcj(B,fa){const Na=this.mqc(fa),nb=5===fa;"mouseup"!==B.type||!nb&&4!==fa||(Na||this.reorderSheets(null,nb,!1),this.CX())}mqc(B){return!!N.DOMElementExtensions.bqd(this.nQ[B],"a").title}KMc(B){this.zae(B);this.T3()}zae(B){(B=this.lBb(B))&&B.Mlb()}OZd(){var B=this.$.va;if(B.na&&(!Cb.e(this.$)||B.count))if(B=this.Oma(B.na),-1===B)h.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var fa=this.QPa(B);B<this.LB?this.bFc(B):B>this.LB&&!this.wDd(fa)&&this.scrollIntoView(B)}}dik(){this.LB=0;this.MY=this.tj.length-1;let B=!1;for(let fa=0;fa<this.tj.length;fa++){const Na=this.hY(fa);if(!Na)break;const nb=this.wDd(Na.domElement);Na.tabIndex=nb?0:-1;if(!B&&nb)this.LB=fa,B=!0;else if(B&&!nb){this.MY=fa-1;break}}}bFc(B){this.$.va.count&&(this.tj.length||this.Qed(),this.Zeg(this.QPa(Math.max(0,Math.min(B,this.tj.length-1)))),this.T3())}scrollIntoView(B){h.ULS.shipAssertTag(537153697,
0,B>=this.LB,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.va.count){this.tj.length||this.Qed();var fa=this.QPa(Math.max(0,Math.min(B,this.tj.length-1))),Na=this.QPa(this.LB);if(!this.wDd(fa)){fa=N.DOMElementExtensions.getBoundingClientRect(fa);var nb=N.DOMElementExtensions.getBoundingClientRect(this.mjb);fa=this.isRtl?nb.x-fa.x:fa.x+fa.width-(nb.x+nb.width);for(nb=0;Na&&nb<fa;){const gc=N.DOMElementExtensions.getBoundingClientRect(Na);
nb+=gc.width;Na=Na.nextSibling}Na?this.Zeg(Na):h.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.LB}, lastVisibleSheetTabIndex = ${this.MY}, scroll to index: ${B}`)}this.T3()}}Zeg(B){const fa=N.DOMElementExtensions.getBoundingClientRect(this.Lo);B=N.DOMElementExtensions.getBoundingClientRect(B);this.isRtl?this.scrollLeft(Math.floor(fa.x+fa.width-(B.x+B.width+.5))):this.scrollLeft(Math.ceil(fa.x-B.x-.5))}scrollLeft(B){(0>
B&&this.KZd()||0<B&&this.JZd())&&h.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const fa=this.Lo.scrollLeft;if(this.isRtl){if(z.a.ND||z.a.hh){this.Lo.scrollLeft=this.vra=fa-B;return}if(z.a.QF){this.Lo.scrollLeft=this.vra=fa+B;return}h.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Lo.scrollLeft=this.vra=fa-B}wDd(B){B=N.DOMElementExtensions.getBoundingClientRect(B);const fa=N.DOMElementExtensions.getBoundingClientRect(this.mjb);
return B&&fa?B.x>=fa.x-1&&B.x+B.width<=fa.x+fa.width+1:(h.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Rsh(){const B=this.I2d;P.qjg(this.$)?(gb.a.Ma(this.MT),this.MT=new P(B,this.$,this,!0)):(gb.a.Ma(this.MT),Sb.m(this.$.tg)?this.MT=new Re(B,this.$,this):this.MT=new P(B,this.$,this))}RTe(B,fa){var Na=this.$.va;if(!this.$.isEditMode||!Na.count)gb.a.Ma(fa),fa=null;else if(!fa)if(Na=this.H2d,Sb.m(this.$.tg))fa=new Re(Na,
this.$,this);else switch(B){case 0:fa=new P(Na,this.$,this);break;case 1:fa=new ta(Na,this.$,this);break;default:h.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return fa}yed(){this.BGi?(this.MT=this.RTe(0,this.MT),this.nGb=this.RTe(1,this.nGb)):this.Rsh()}Fdf(B){const fa=N.DOMElementExtensions.getBoundingClientRect(this.uP);
fa||(h.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${B}: GetBoundingClientRect returned null for the dragged sheet.`),this.CX());return fa}Blf(B,fa){this.gya.E4g(B,fa);this.CX(!1);this.h1d(this.navigationButtonsDisabled);for(const Na of this.t8j)Na&&Na.iV(this.navigationButtonsDisabled);for(const Na of this.mIe)Na&&Na.iV(this.operationButtonsDisabled)}static kEj(B,fa,Na,nb){B<Na?(fa>Na&&Na--,fa>nb&&nb--):B>nb?(fa<Na&&Na++,fa<nb&&nb++):fa<Na&&Na++;return{kXh:Na,ZOi:nb}}}Object(d.a)(pc,"SheetTabBarControl",
Pb.a,[620,5,33]);class Mc extends S.a{constructor(B){super();this.$=B;this.Md()}create(){const B=this.$.Ad;if(cb.a(this.$.xa,1))Yc.PageLoadTrackingInfo.instance.BRb(ha.a.bFa,["sheetTabBar"]);else{var fa=document.getElementById(B+ha.a.Zfd);if(fa){Yc.PageLoadTrackingInfo.instance.Kra(ha.a.bFa);var Na=qa.GetServiceTaskFactory.Vc(this.$.ea,388,387,this.Na);W.TaskExtensions.ya(W.TaskExtensions.Bf([Na],this.$.ka),()=>{this.qd(this.$.ea.Ba(32)||new pc(this.$,fa,Na.result))},this.$.ka,3)}else Yc.PageLoadTrackingInfo.instance.BRb(ha.a.bFa,
["sheetTabBar"])}}static la(B){B.ea.Ja(33,new Mc(B))}}Object(d.a)(Mc,"SheetTabBarFactory",S.a,[]);var xd=a(32),Nd=a(334),te=a(361),tb=a(384),Gb=a(35),fd=a(248),lc=a(295);class $c{constructor(B,fa,Na,nb){this.red=B;this.green=fa;this.blue=Na;this.alpha=nb}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(d.a)($c,"ColorObject",null,[]);class Md{constructor(B){this.m0=this.nJ=null;this.m$c=B}get head(){return this.nJ}get v7d(){return this.m0}KWe(B){this.head&&
(B.pre?B.next?(B.pre.next=B.next,B.next.pre=B.pre):(this.m0=B.pre,this.v7d.next=null):B.next?(this.nJ=B.next,this.head.pre=null):this.m0=this.nJ=null,B.next=null,B.pre=null)}bYg(B){this.head?(B.next=this.head,this.nJ=B,B.next.pre=this.head):this.m0=this.nJ=B}Xqd(){if(!this.head)return null;const B=new Xa.a;let fa=this.head;for(;fa;)if(B.add(fa.value),fa=fa.next,B.count>this.m$c){h.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return B}}
Object(d.a)(Md,"CustomLinkedList",null,[]);class dd{constructor(B){this.pre=this.next=null;this.value=B}}Object(d.a)(dd,"CustomLinkedListNode",null,[]);class ee{constructor(B){this.m$c=B;this.Nvc={};this.Ocb=new Md(B);this.count=0}add(B,fa){B&&fa?(fa=new dd(fa),this.contains(B)?this.Ocb.KWe(this.Nvc[B]):this.count<this.m$c?this.count++:(delete this.Nvc[this.Ocb.v7d.value.toString()],this.Ocb.KWe(this.Ocb.v7d)),this.Ocb.bYg(fa),this.Nvc[B]=fa):h.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${B} or Value ${fa} is null.`)}Xqd(){return this.Ocb.Xqd()}contains(B){return B?
B in this.Nvc:!1}}Object(d.a)(ee,"MRUCache",null,[]);var Tc=a(153);class wd extends Tc.a{constructor(B,fa,Na,nb){nb=void 0===nb?null:nb;super(!1,!1,!0);this.moreColorsHelper=null;this.zjh=(gc,bd)=>{this.APe(gc,bd)};this.$=B;this.kvi=fa;this.sxd=Na;this.BPe=nb}ni(){const B=Ta.a.instance.ia(1346),fa={};fa[wd.wCg]=this.kvi;fa[wd.OAg]=wd.RYb;fa[wd.pCg]=wd.RYb;fa[wd.IDg]=wd.RYb;fa[wd.zDg]=wd.RYb;fa[wd.bDg]=Ta.a.instance.ia(2105);fa[wd.jCg]=Ta.a.instance.ia(2089);fa[wd.UAg]=Ta.a.instance.ia(2076);fa[wd.nCg]=
Ta.a.instance.ia(1347);fa[wd.PAg]=Ta.a.instance.ia(1348);this.sxd!==wd.QAg&&(fa[wd.RAg]=wd.ALPHA,fa[wd.ALPHA]=this.sxd,h.ULS.sendTraceTag(537155398,0,50,`More Colors:: Initial Alpha Value : ${this.sxd}`));this.initializeAndShow(B,this.zjh,{[wd.VBg]:wd.uBg,[wd.VAg]:fa})}APe(B,fa){fa=fa[wd.zOc];1===B&&this.MJf(Ed.a.wha(fa));this.BPe&&this.BPe(1===B,1===B?fa:null)}MJf(B){this.moreColorsHelper||(this.moreColorsHelper=this.$.ea.Ba(398));B=Xc.a.IH(Ed.a.fK(B,!1));this.moreColorsHelper.tZd(B.r,B.g,B.b,te.a.oOc)}}
wd.wCg="initColor";wd.VBg="id";wd.uBg="ColorPickerDialog";wd.VAg="bodyControls";wd.zOc="selectedColorText";wd.pCg="hueAriaLabel";wd.IDg="transparencyAriaLabel";wd.zDg="svAriaLabel";wd.RYb="Use left & right arrows keys to change values in color picker & hue slider";wd.ALPHA="alpha";wd.nOc="alphaValue";wd.OAg="alphaAriaLabel";wd.RAg="alphaSliderType";wd.QAg=-1;wd.NCg=100;wd.bDg="redLabel";wd.UAg="blueLabel";wd.jCg="greenLabel";wd.nCg="hexLabel";wd.PAg="alphaLabel";Object(d.a)(wd,"MoreColorsDialog",
Tc.a,[]);var Kb=a(532);class Vc extends wd{constructor(B,fa,Na,nb,gc){super(B,nb,gc);this.commandName=null;this.Lrf=!1;this.command=fa;this.hf=Na;this.avi=gc}ni(){super.ni();this.commandName=Ib.b().pl(this.hf.command);h.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.hf.Hg}`)}APe(B,fa){if(1===B)if(B=this.$.Jd.Yh("UserAction",this.commandName),B.start(),Kb.a(B),fa)if(wd.zOc in fa){var Na=fa[wd.zOc];if(B=Ed.a.wha(Na)){Na=
new aa.a(this.command,this.hf.method,this.hf.mode,this.hf.Hg,this.hf.tabName?this.hf.tabName:1378078823===this.command||-400966242===this.command?ha.a.SDa:ha.a.TQ);var nb={};nb.Color=B;nb.UILocation=this.hf.Hg;wd.nOc in fa&&(this.avi!==fa[wd.nOc]&&(this.Lrf=!0),nb.Alpha=(fa[wd.nOc]/wd.NCg).toString(),h.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ha.kd(Na,nb);this.$.fh();this.MJf(B);fa={["Command"]:this.commandName,["Location"]:this.hf.Hg};fa.AlphaApplied=
this.Lrf.toString();zd.b(this.$).Xe(bc.a.YZi,fa,null,!0)}else this.hide(),h.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Na}, Command: ${this.commandName}`)}else this.hide(),h.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),h.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(d.a)(Vc,"MoreColorsRibbonDialog",wd,[]);
class Hd{constructor(B,fa){this.ste="00FFFF";this.tte="0000FF";this.P3f="00FFFF";this.Q3f="BF7000";this.oVa=null;this.Vef=!1;this.$oe=null;this.V9i=Na=>{if(!fd.a(Na)){Na=Na.Result;this.oVa=new ee(10);for(let gc=Na.length-1;0<=gc;gc--){var nb=Na[gc];nb=new $c(nb.Red,nb.Green,nb.Blue,nb.Alpha);this.oVa.add(nb.toString(),nb)}this.YYf();h.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.U9i=()=>{h.ULS.sendTraceTag(537155394,
0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.$F=()=>{this.Fld()};this.$=B;this.wKb=fa;this.$.ea.Ja(398,this);this.$.da.Og?this.Fld():this.$.da.Ol(this.$F)}get sKb(){return this.$oe}get pVa(){return this.ste}set pVa(B){this.ste=B}get Ugb(){return this.tte}set Ugb(B){this.tte=B}get DBc(){return this.P3f}set DBc(B){this.P3f=B}get EBc(){return this.Q3f}set EBc(B){this.Q3f=B}iKb(B,fa,Na,nb){nb=void 0===nb?-1:nb;return this.wKb?W.TaskExtensions.ya(this.wKb,()=>{(new Vc(this.$,
B,fa,Na,nb)).ni()},this.$.ka):null}GPi(B,fa){var Na=void 0;Na=void 0===Na?-1:Na;fa=void 0===fa?null:fa;this.wKb&&W.TaskExtensions.ya(this.wKb,()=>{(new wd(this.$,B,Na,fa)).ni()},this.$.ka)}Ffi(B){let fa=null;switch(B){case "QueryRecentFillColor":fa=this.pVa;break;case "QueryRecentFontColor":fa=this.Ugb;break;case "QueryRecentShapesFillColor":fa=this.DBc;break;case "QueryRecentShapesOutlineColor":fa=this.EBc}return fa?xd.a.x9a(fa):null}dispose(){this.wKb=null;this.$&&this.$.da.mo(this.$F)}Fld(){if(this.$.isEditMode)if(this.oVa)this.YYf();
else{this.Vef&&h.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var B=this.$.pa.ua;this.$.userOperationManager.enqueueOperation(new Bc.a(1009,0,(fa,Na,nb)=>{fa=lc.b.call(null,fa,this.V9i);Na=lc.a.call(null,Na,this.U9i);const gc=B.Ra(1,null);return Mb.g(B,"GetMRUColors",gc,fa,Na,nb,null,4)},80),null);this.Vef=!0}}YYf(){var B=this.oVa.Xqd();if(B){this.$oe=new Xa.a;for(let fa of B)B=fa,B=new Xc.a(B.red,
B.green,B.blue),this.sKb.add(Ed.a.BL(B))}}tZd(B,fa,Na,nb){this.oVa||(this.oVa=new ee(10));const gc=new $c(B,fa,Na,nb);this.oVa.add(gc.toString(),gc);this.saveMRUColor(null,B,fa,Na,nb)}dha(B,fa,Na){(B||this.$.isEditMode)&&this.Xjg(B.SqmControlId)&&(B=Xc.a.IH(Ed.a.fK(fa,!1)))&&(this.tZd(B.r,B.g,B.b,te.a.oOc),Na={["Command"]:Ib.b().pl(Na.command),["Location"]:Nd.a[Na.Hg],["InputMethod"]:za.a[Na.method]},zd.b(this.$).Xe(bc.a.dha,Na,null,!0))}Xjg(B){return!!B&&B.startsWith("RecentColorPicker")}saveMRUColor(B,
fa,Na,nb,gc){return tb.a(this.$.userOperationManager,(bd,Ra,Tb)=>{var qc=this.$.pa.ua;bd=lc.b(bd,Hd.xej());Ra=lc.a(Ra,Hd.wej());const hd=qc.Ra(9,null);hd.bRed=fa;hd.bGreen=Na;hd.bBlue=nb;hd.bAlpha=gc;return Mb.g(qc,"SaveMRUColor",hd,bd,Ra,Tb,null,0)},bd=>new Bc.a(1008,0,bd),B)}static xej(){return B=>{Gb.a.Bh(B.Errors)?h.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):h.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static wej(){return()=>
{h.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(d.a)(Hd,"MoreColorsHelper",null,[561,5]);class Xd extends S.a{constructor(B){super();this.$=B;this.Md()}create(){const B=new Lc.a;this.$.QB(Na=>{Na=Na.XBf();W.TaskExtensions.ya(Na,()=>{B.setResult(!0)},this.$.ka)});const fa=B.task;this.qd(this.$.ea.Ba(398)||new Hd(this.$,fa))}static la(B){B.ea.Ja(397,new Xd(B))}}Object(d.a)(Xd,"MoreColorsHelperFactory",S.a,[]);var qe=a(733),$d=a(793);class de{constructor(){this.lSg=
new Xa.a;this.mSg=new Xa.a}get yYa(){return this.lSg}get Fqg(){return this.mSg}get OI(){return this.O9j}VXg(B,fa){this.yYa.add(B);this.Fqg.add(fa)}WXg(B,fa){this.O9j={CJd:B,rId:fa}}}Object(d.a)(de,"ThemeInfoCache",null,[]);let le=class{constructor(B){this.yYa=this.kO=null;this.fqc=!1;this.T7d=null;this.qvc=new Set;this.xkb=this.vWc=!1;this.dBb=0;this.K$i=fa=>{this.fqc=!1;if(!fa||fd.a(fa))h.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${fa?Gb.a.me(fa.Errors):
"(no result)"}]`),this.ACd&&this.nag();else if(this.ACd&&(this.dBb=0),fa=fa.Result){this.Nn&&null!==this.kO&&this.Pkh(fa);this.kO=new de;if(this.RF){this.yYa=fa.ThemeColors;this.T7d=[];for(var Na=0;10>Na;Na++)this.T7d.push($d.a.APa(Xc.a.IH(this.yYa[Na])));for(Na=0;6>Na;Na++)for(let nb=0;10>nb;nb++){const gc=Ed.a.wha(Ed.a.RI(this.yYa[10*Na+nb])),bd=$d.a.Sbi(Na,nb,this.T7d[nb],this.yYa[nb]);this.kO.VXg(gc,bd)}}this.Nn&&(this.kO.WXg(fa.MinorFont,fa.MajorFont),this.xkb=!1);this.vWc=!1;this.iha()}else h.ULS.sendTraceTag(556656003,
0,10,"ThemesManager: The obtained ThemeInfo is null")};this.J$i=()=>{this.fqc=!1;this.ACd&&this.nag()};this.nag=()=>{3>this.dBb?(this.dBb++,h.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.dBb}`),this.Ihc(null,!0)):(this.dBb=0,h.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.nyc=()=>{this.kO&&(h.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),
this.Nn?this.xkb=!0:this.kO=null,this.Ihc(null,!0))};this.Qe=(fa,Na)=>{this.kO&&(h.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),Na.aI&&(this.vWc=!0))};this.kC=()=>{this.qvc.clear()};this.$=B;this.$.da.jM(this.nyc);this.$.da.Pl(this.Qe);this.$.Ha.Y2a(this.kC);this.RF=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Nn=G.EwaSettings.Nn();this.ACd=G.EwaSettings.isChangeGateEnabled("OfficeVSO:7396333_RetryFetchThemeInfoApi")}get ykb(){return!this.kO||
this.xkb?null:this.kO.yYa}get Eqg(){return!this.kO||this.xkb?null:this.kO.Fqg}get OI(){return!this.kO||this.xkb?null:this.kO.OI}get EDd(){return this.vWc}Ihc(B,fa){if(this.$.isEditMode||(void 0===fa?0:fa))if(!this.kO||this.EDd||this.xkb)if(B&&""!==B&&this.qvc.add(B),!this.fqc){this.fqc=!0;B=this.$.pa.ua;fa=this.K$i;var Na=this.J$i;const nb=B.Ra(1,null);Mb.g(B,"GetThemeInfo",nb,fa,Na,null,null,4)}}getThemeColor(B){let fa,Na=-1;fa=-1;if(!this.ykb)return h.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),
{returnValue:!1,themeIndex:-1,KFa:fa};for(let nb=0;nb<this.ykb.count;nb++)if(B===this.ykb.ma(nb)){Na=nb;break}if(-1!==Na)return fa=Math.floor(Na/10),{returnValue:!0,themeIndex:Na%10,KFa:fa};h.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,KFa:fa}}iha(){for(let B of this.qvc)this.$.frame.Cz(B);this.qvc.clear()}Pkh(B){const fa=this.kO.OI.rId;this.kO.OI.CJd===B.MinorFont&&fa===B.MajorFont||h.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};
le=Object(qe.a)([Object(V.d)(sa.Ic),Object(qe.b)(0,Object(sa.R)())],le);Object(d.a)(le,"ThemesManager",null,[526]);class $b extends S.a{constructor(B){super();this.$=B;this.Md()}create(){let B=this.$.ea.Ba(422);B||(B=new le(this.$),this.$.ea.Ja(422,B));this.qd(B)}static la(B){B.ea.Ja(421,new $b(B))}}Object(d.a)($b,"ThemesManagerFactory",S.a,[]);String(b);window.___1688279147246_closurehack=b;var wc=a(2),gd=a(573),Ud=a(570),ne=a(387),rc=a(623);class kd{constructor(){this.Alt=this.DisplayColor=this.Color=
null}}Object(d.a)(kd,"ColorCellProps",null,[]);var qd=a(238),oe=a(222),Yd=a(272),We=a(24);class He{constructor(B){this.lQc=null;this.$=B;this.grid=mb.h(this.$)}get borderFormatManager(){this.lQc||(this.lQc=this.$.ea.Ba(296));return this.lQc}B$h(B){let fa=null;switch(B){case 467002767:B={};this.$.wl(B);fa=Object(eb.a)(ic.a,this.$.va).Zhf(B.SheetName,!0);break;case -236759591:fa=this.F3h();break;case 1970784898:fa=this.udf(0);break;case 1650812936:case 1378078823:fa=this.udf(1);break;case -400966242:fa=
this.getShapeOutlineColor();break;default:h.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${B}'`)}return fa}F3h(){let B=null;this.borderFormatManager&&(B=this.borderFormatManager.m7);(B="black"===B?"000000":B)&&(B=xd.a.x9a(B));return B}getShapeOutlineColor(){let B=null;if(this.grid.ha.Va&&this.grid.ha.Va.Yd){const fa=this.grid.ha.Va.Yd.floatingObject;5===fa.type&&fa.xd&&-1!==fa.xd.ShapeOutlineColor&&(B=
Ed.a.RI(fa.xd.ShapeOutlineColor),B=B.toUpperCase())}return B}udf(B){let fa=null;if(this.grid.ha.Va&&this.grid.ha.Va.Yd){var Na=this.grid.ha.Va.Yd.floatingObject;5===Na.type&&Na.xd?1===B&&-1!==Na.xd.ShapeFillColor?(fa=Ed.a.RI(Na.xd.ShapeFillColor),fa=fa.toUpperCase()):h.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):h.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");
return fa}Na=this.grid.h7("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.ra.selectedRanges,1,!0);try{for(Na.$$rst();Na.$$mn();){const nb=Na.$$cu().cell;if(!nb)continue;let gc="#000000";if(0===B){gc=nb.color;if(G.EwaSettings.rd()&&this.grid.Xc)return this.t9h();nb.hasRichText&&(gc=this.u9h(nb))}else if(1===B){const bd=nb.backgroundColor;gc=We.a.compare(bd,"transparent",!0)&&bd?nb.backgroundColor:null}if(!fa)fa=gc;else if(fa!==gc){fa=null;break}}}finally{Na&&Na.dispose()}return fa}t9h(){var B=
null,fa=this.grid.Vd,Na=this.grid.cellTextEditBox.formattedText;if(Na){B=Na.TextRuns;const nb=qd.a.map(B,gc=>gc.StartIndex);Na=Na.Fonts;fa=fa.textBox.caretPosition;fa=Eb.HelperMethods.C7e(new oe.a(nb),nb.length,fa,Eb.HelperMethods.mI);B=Na[B[fa].FontID].Color}return B?B.toUpperCase():null}u9h(B){B=Yd.a(B.formattedText.Fonts);if(Yd.e(B,32))(B=Ed.a.wha(Ed.a.RI(B.FontColor)))&&(B="#"+B.toUpperCase());else return null;return B}}Object(d.a)(He,"ColorHighlighterHelper",null,[588]);var bf=a(325);class ef{constructor(B,
fa,Na){this.CBc=this.yVb=this.JFa=null;this.Gdg="-1";this.$=B;this.moreColorsHelper=fa;this.themesManager=Na;this.yPe=new He(B);this.RF=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}$ef(B,fa,Na,nb,gc,bd,Ra,Tb,qc){fa=void 0===fa?null:fa;Na=void 0===Na?null:Na;nb=void 0===nb?null:nb;Tb=void 0===Tb?null:Tb;return this.fX(null!=fa,null!=Na,null!=nb,null!=Tb,!0,B,fa,Na,nb,void 0===gc?null:gc,void 0===bd?null:bd,void 0===Ra?null:Ra,Tb,void 0===qc?null:qc)}nii(B,fa,Na,nb){return this.fX(B,
fa,Na,nb,!1)}aff(B,fa,Na,nb,gc,bd){const Ra=[];B=this.$ef(B,void 0===fa?null:fa,void 0===Na?null:Na,void 0===nb?null:nb,void 0,void 0,void 0,void 0===gc?null:gc,void 0===bd?null:bd);for(let Tb=0,qc=B.length;Tb<qc;Tb++)Ra.push(bf.r(B[Tb]));return Ra}fX(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd,Vd,Be,Qe,cf){bd=void 0===bd?null:bd;Ra=void 0===Ra?null:Ra;Tb=void 0===Tb?null:Tb;qc=void 0===qc?null:qc;hd=void 0===hd?null:hd;Vd=void 0===Vd?null:Vd;Be=void 0===Be?null:Be;Qe=void 0===Qe?null:Qe;cf=void 0===cf?null:cf;
h.ULS.shipAssertTag(537154456,0,!gc||null!=bd,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const wb=[];let zc=null,rd=3,ce=null,Me=null,ra=null;this.qHh();if(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.jnj(cf))return h.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${cf} menu opening`),wb;B&&(gc&&null==Ra?h.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):
wb.push(this.OPa(ef.y7g,this.t_h(ef.eIe,Ra,Be,Vd))));gc&&null!=bd&&this.yPe&&(Me=ce="-1",zc=this.yPe.B$h(bd))&&(h.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${bd} is not null .`),zc=Ed.a.wha(zc),rd=this.Zdf(zc),ce=this.ssd(zc,rd,0,!0),Me=this.ssd(zc,rd,1,!1));wb.push(this.OPa(ef.N9j,this.Snd(ef.Dqg,ce,this.JFa,bd,hd,Vd),1341));wb.push(this.OPa(ef.a5j,this.Snd(ef.$4j,Me,this.yVb,bd,hd,Vd),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.hnj(),
gc&&(ra="-1",zc&&(ra=this.ssd(zc,rd,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.sKb&&0<this.moreColorsHelper.sKb.count&&wb.push(this.OPa(ef.ovj,this.Snd(ef.nvj,ra,this.CBc,bd,hd,Vd),1349)));fa&&(gc&&null==Tb?h.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):wb.push(this.OPa(ef.c1i,this.w_h(ef.QNe,Tb,this.Z4h(Tb),Be,Vd))));!Na||G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&
this.$.isEditMode||(u.AFrameworkApplication.pN("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HighlightWhenCFExperiment",!1)&&(gc&&!qc?h.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):wb.push(this.OPa(ef.Zsi,this.$_h(ef.Snf,qc)))));nb&&(gc&&null==Qe?h.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):
wb.push(this.OPa(ef.ZZi,this.w0h(ef.WHf,Qe,this.Xbi(Qe)))));return wb}ssd(B,fa,Na,nb){3===fa&&(fa=this.Zdf(B));return this.RF&&0===Na&&fa===Na?this.Gdg.toLowerCase():fa===Na?nb?B.toLowerCase():B:"-1"}Zdf(B){if(!B)return 3;const fa=B.toLowerCase();if(this.RF){if(this.JFa&&this.dMi(fa,this.JFa))return 0}else if(this.JFa&&this.zzd(fa,this.JFa))return 0;return this.yVb&&this.zzd(B,this.yVb)?1:this.CBc&&this.zzd(fa,this.CBc)?2:3}OPa(B,fa,Na){Na=void 0===Na?null:Na;B=Object(wc.a)(new Ud.a,{Id:B,Title:null!=
Na?Ta.a.instance.ia(Na):"",ControlList:[],ControlsId:B+".Controls"});B.ControlList.push(fa);return B}w_h(B,fa,Na,nb,gc){return this.o$e(B,fa,Na,wa.a.d3e,"transparent",void 0===nb?null:nb,void 0===gc?null:gc)}$_h(B,fa){return Object(wc.a)(new ne.a,{Command:null!=fa?fa.toString():null,LabelText:Ta.a.instance.ia(1433),Id:B,ExternalId:this.b9a(B,fa),ExternalImageId:"JotNotebookColor2_20"})}t_h(B,fa,Na,nb){return this.o$e(B,fa,542,wa.a.c3e,"000000",void 0===Na?null:Na,void 0===nb?null:nb)}o$e(B,fa,Na,
nb,gc,bd,Ra){bd=void 0===bd?null:bd;Ra=void 0===Ra?null:Ra;return Object(wc.a)(new ne.a,{Command:null!=fa?fa.toString():null,CommandPreviewId:null!=bd?bd.toString():null,CommandRevertId:null!=Ra?Ra.toString():null,MenuItemsStatefulData:this.Gbi(B,fa,gc),LabelText:Ta.a.instance.ia(Na),Id:B,ExternalId:this.b9a(B,fa),Image16by16:vc.a.di(1),Image16by16Class:nb})}Gbi(B,fa,Na){const nb={};B=this.b9a(B,fa);nb[B]={};nb[B].iconColor=Na;return nb}zzd(B,fa){for(let Na=0;Na<fa.length;Na++)if(B===fa[Na].Color)return!0;
return!1}sKi(B,fa){B=Ed.a.jr(B);fa=Ed.a.jr(fa);return 1>=Math.abs(B.r-fa.r)&&1>=Math.abs(B.g-fa.g)&&1>=Math.abs(B.b-fa.b)?!0:!1}dMi(B,fa){for(let Na=0;Na<fa.length;Na++){const nb=fa[Na].Color;if(this.sKi(B,nb))return this.Gdg=nb.toLowerCase(),!0}return!1}Snd(B,fa,Na,nb,gc,bd){gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;return Object(wc.a)(new rc.a,{McuLayout:!0,Command:null!=nb?nb.toString():null,CommandPreviewId:null!=gc?gc.toString():null,CommandRevertId:null!=bd?bd.toString():null,Width:10,Id:`${B}.ColorPicker`,
SelectedColorId:fa,Colors:Na,Stateful:!0,ExternalId:this.b9a(B,nb),McuExternalId:`${this.b9a(B,nb)}.MCU`})}b9a(B,fa){return`${B}.${null!=fa?fa.toString():""}`}Xic(...B){const fa=[];for(let Na=0,nb=B.length;Na<nb;Na+=2)fa.push(Object(wc.a)(new kd,{Color:B[Na],DisplayColor:Ed.a.BL(Xc.a.IH(parseInt(String("0x"+B[Na]),16))),Alt:Object(vb.a)(String,B[Na+1])&&this.$?B[Na+1]:Ta.a.instance.ia(B[Na+1])}));return fa}w0h(B,fa,Na){const nb=wa.a.u3e;B=Object(wc.a)(new ne.a,{Command:null!=fa?fa.toString():null,
LabelText:Ta.a.instance.ia(Na),Id:B,ExternalId:this.b9a(B,fa),Image16by16:vc.a.di(1),Image16by16Class:nb});B.ShouldTakeFocus=!1;return B}qHh(){this.JFa||(this.JFa=this.Xic("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",
1383,"e7c6b4",1384,"adcbf8",1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",
1419));this.yVb||(this.yVb=this.Xic("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}hnj(){this.moreColorsHelper.Fld();if(this.moreColorsHelper.sKb){var B=this.moreColorsHelper.sKb;const fa=[];for(let Na of B)B=Ed.a.wha(Na.substr(1)),fa.push(B,Na);this.CBc=this.Xic(...fa)}}jnj(B){this.themesManager.Ihc(B);if(this.themesManager.ykb&&this.themesManager.Eqg&&!this.themesManager.EDd){B=this.themesManager.ykb;
const fa=this.themesManager.Eqg,Na=[];for(let nb=0;nb<B.count;nb++)Na.push(B.ma(nb),fa.ma(nb));this.JFa=this.Xic(...Na);return!0}return!1}Xbi(B){switch(B){case -458147525:B=1344;break;case 1610379174:B=1345;break;default:B=1343}return B}Z4h(B){switch(B){case 1549407384:B=541;break;case -1744769642:B=539;break;default:B=540}return B}}ef.c1i="NoColor";ef.y7g="Automatic";ef.N9j="ThemeColors";ef.a5j="StandardColors";ef.ovj="RecentColors";ef.QNe="ClearColor";ef.Zsi="HighlightWhen";ef.Snf="HighlightWhen";
ef.eIe="AutomaticColor";ef.Dqg="ThemeColorPicker";ef.$4j="StandardColorPicker";ef.ZZi="MoreColors";ef.WHf="MoreColors";ef.nvj="RecentColorPicker";Object(d.a)(ef,"ColorPickerBuilder",null,[]);class nc{constructor(){this.sections=null}}Object(d.a)(nc,"ColorPickerButtonMenuProps",null,[]);class id{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(d.a)(id,"ColorPickerButtonMenuSection",null,[]);class Dd{constructor(){this.id=this.label=this.color=null;this.index=
0}}Object(d.a)(Dd,"ColorPickerColorProps",null,[]);class fc{constructor(){this.type=0;this.label=null}}Object(d.a)(fc,"ColorPickerSectionButtonProps",null,[]);class Oa{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(d.a)(Oa,"ColorPickerSectionColorSwatchProps",null,[]);class Lb{constructor(){this.row=this.index=0}}Object(d.a)(Lb,"ThemeColorInfo",null,[]);class Fc{constructor(B,fa,Na,nb){this.$=B;this.bE=fa;this.moreColorsHelper=Na;this.themesManager=nb;this.cMi=
G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(B){B=this.bE.mif(B.automaticColor,B.clearColor,B.highlightWhen,B.moreColors);const fa=new nc;fa.sections=this.yfi(B);return fa}showMoreColorsDialog(B,fa){this.moreColorsHelper.GPi(B,fa)}onColorUsed(B){B=Xc.a.IH(Ed.a.fK(Ed.a.wha(B),!1));this.moreColorsHelper.tZd(B.r,B.g,B.b,te.a.oOc)}getThemeColor(B){const fa=Ed.a.wha(B);let Na,nb;if(!(()=>{let gc=this.themesManager.getThemeColor(fa);({themeIndex:Na,
KFa:nb}=gc);return gc})().returnValue)return h.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;B=new Lb;B.index=Na;B.row=nb;return B}yfi(B){const fa=[];for(let nb=0;nb<B.length;nb++){var Na=Object(eb.a)(Ud.a,B[nb]);const gc=new id;gc.title=Na.Title;const bd=Object(eb.a)(rc.a,Na.ControlList[0]);bd?(gc.type=1,gc.colorSwatchProps=this.m5h(bd),fa.push(gc)):(Na=Object(eb.a)(ne.a,Na.ControlList[0]))&&null!=this.Gbf(Na.Id)?(gc.type=2,gc.buttonProps=
new fc,gc.buttonProps.type=this.Gbf(Na.Id),gc.buttonProps.label=Na.LabelText,fa.push(gc)):h.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return fa}m5h(B){const fa=new Oa,Na=B.Colors;fa.colors=Array(Na.length);fa.notifyOnColorUsed=this.moreColorsHelper.Xjg(B.ExternalId);fa.isThemeColorSection=this.cMi&&!!B.ExternalId&&B.ExternalId.includes(ef.Dqg);for(B=0;B<Na.length;B++)fa.colors[B]=new Dd,fa.colors[B].id=Na[B].DisplayColor,fa.colors[B].color=Na[B].DisplayColor,
fa.colors[B].label=Na[B].Alt,fa.colors[B].index=B;return fa}Gbf(B){switch(B){case ef.WHf:return 1;case ef.QNe:return 2;case ef.eIe:return 3;case ef.Snf:return 4}return null}}Object(d.a)(Fc,"ColorPickerButtonController",null,[573]);class Wc{constructor(B,fa,Na){this.gs=this.Wl=null;this.$=B;this.moreColorsHelper=fa;this.vbh();this.ubh();this.themesManager=Na;this.lbc=new ef(B,fa,Na)}vbh(){this.Wl={};this.Wl.style0=1535;this.Wl.style1=1536;this.Wl.style2=1537;this.Wl.style3=1538;this.Wl.style4=1539;
this.Wl.style5=1540;this.Wl.style6=1541;this.Wl.style7=1542;this.Wl.style8=1543;this.Wl.style9=1544;this.Wl.style10=1545;this.Wl.style11=1546;this.Wl.style12=1547;this.Wl.style13=1548;this.Wl.style14=1549;this.Wl.style15=1550;this.Wl.style16=1551;this.Wl.style17=1552;this.Wl.style18=1553;this.Wl.style19=1554;this.Wl.style20=1555;this.Wl.style21=1556;this.Wl.style22=1557;this.Wl.style23=1558;this.Wl.style24=1559;this.Wl.style25=1560;this.Wl.style26=1561;this.Wl.style27=1562;this.Wl.style28=1563;this.Wl.style29=
1564;this.Wl.style30=1565;this.Wl.style31=1566;this.Wl.style32=1567;this.Wl.style33=1568;this.Wl.style34=1569;this.Wl.style35=1570;this.Wl.style36=1571;this.Wl.style37=1572;this.Wl.style38=1573;this.Wl.style39=1574;this.Wl.style40=1575;this.Wl.style41=1576}ubh(){this.gs={};this.gs.style0=1507;this.gs.style1=1508;this.gs.style2=1509;this.gs.style3=1510;this.gs.style4=1511;this.gs.style5=1512;this.gs.style6=1513;this.gs.style7=1514;this.gs.style8=1515;this.gs.style9=1516;this.gs.style10=1517;this.gs.style11=
1518;this.gs.style12=1519;this.gs.style13=1520;this.gs.style14=1521;this.gs.style15=1522;this.gs.style16=1523;this.gs.style17=1524;this.gs.style18=1525;this.gs.style19=1526;this.gs.style20=1527;this.gs.style21=1528;this.gs.style22=1529;this.gs.style23=1530;this.gs.style24=1531;this.gs.style25=1532;this.gs.style26=1533;this.gs.style27=1534}Hbf(B){return bf.i(this.lbc.aff(B,null,null,null,null,null))}Ljc(B,fa,Na,nb,gc,bd,Ra,Tb,qc){fa=void 0===fa?null:fa;Na=void 0===Na?null:Na;nb=void 0===nb?null:nb;
gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;Ra=void 0===Ra?null:Ra;Tb=void 0===Tb?null:Tb;qc=void 0===qc?null:qc;return Object(wc.a)(new gd.a,{MenuSectionList:this.lbc.$ef(B,fa,Na,nb,gc,bd,Ra,Tb,qc),UpdateDynamically:!0})}mif(B,fa,Na,nb){return this.lbc.nii(B,fa,Na,nb)}n5h(B,fa,Na,nb,gc,bd){return this.lbc.aff(B,void 0===fa?null:fa,void 0===Na?null:Na,void 0===nb?null:nb,void 0===gc?null:gc,void 0===bd?null:bd)}ylc(B,fa){return(void 0===fa?0:fa)?this.gs[B]:this.Wl[B]}Oph(){return new Fc(this.$,
this,this.moreColorsHelper,this.themesManager)}}Object(d.a)(Wc,"PopulateDynamicHelper",null,[560]);class td extends S.a{constructor(B,fa){super();this.bE=null;this.$=fa;B.Ja(111,this);this.Md()}create(){if(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)||G.EwaSettings.Nn()){const B=qa.GetServiceTaskFactory.Vc(this.$.ea,398,397,this.Na),fa=Object(Ka.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?Object(ka.d)(V.a.resolve(sa.Ic,{Qa:this.Na})):qa.GetServiceTaskFactory.Vc(this.$.ea,
422,421,this.Na);W.TaskExtensions.ya(W.TaskExtensions.Bf([B,fa],this.ka),()=>{this.qd(this.bE||(this.bE=new Wc(this.$,B.result,fa.result)))},this.ka,3)}else W.TaskExtensions.ya(qa.GetServiceTaskFactory.Vc(this.$.ea,398,397,this.Na),B=>{this.qd(this.bE||(this.bE=new Wc(this.$,B.result,null)))},this.ka,3)}}Object(d.a)(td,"PopulateDynamicHelperFactory",S.a,[]);var na=a(938);class Pa{constructor(B,fa,Na,nb,gc,bd,Ra,Tb,qc){this.lGe=fa;this.dIe=void 0===Na?null:Na;this.PNe=void 0===gc?null:gc;this.Rnf=
void 0===bd?null:bd;this.VHf=void 0===Tb?null:Tb;this.bE=B;this.menuId=void 0===qc?null:qc}M0(){let B="";const fa=this.bE.n5h(this.lGe,this.dIe,this.PNe,this.Rnf,this.VHf,this.menuId);for(const Na of fa)B+=Na;return B}cH(){return this.bE.Ljc(this.lGe,this.dIe,this.PNe,this.Rnf,void 0,void 0,void 0,this.VHf,this.menuId)}}Object(d.a)(Pa,"RibbonColorPicker",null,[572]);var lb=a(579);class Nb{constructor(B,fa){this._id=B;this.WE=void 0===fa?"":fa}get id(){return this._id}get text(){return this.WE}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");
}set label(B){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}M0(){return`<Label id="${this._id}" LabelText="${this.WE}" />`}YU(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}BTb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");
}QZ(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");}Lac(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}lla(){return Object(wc.a)(new lb.a,{Id:this.id,LabelText:this.text})}}Object(d.a)(Nb,"RibbonLabel",null,[575,571,572]);class xc{constructor(B){this.rNg=[];this.id=B}get ve(){return this.rNg}M0(){return bf.q(this.cH())}cH(){const B=Object(wc.a)(new gd.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const fa of this.ve)Object(vb.a)(Pa,
fa)?B.MenuSectionList.push(...Object(eb.a)(Pa,fa).cH().MenuSectionList):B.MenuSectionList.push(fa.e$b());return B}}Object(d.a)(xc,"RibbonMenu",null,[574,572]);class Oc{constructor(){this.title=null;this.C_=[];this.Rs="Menu16";this.irg=this.Xlg=this.Ylg=!0}get buttons(){return this.C_}M0(){return bf.r(this.e$b())}e$b(){const B=Object(wc.a)(new Ud.a,{ControlList:[]});if(1===this.buttons.length&&Object(vb.a)(570,this.buttons[0]))B.ControlList.push(this.buttons[0].d$b());else{let Na="";for(let nb=0;nb<
this.buttons.length;nb++){var fa=Object(eb.a)(571,this.buttons[nb]);fa&&(fa=fa.lla(),B.ControlList.push(fa),Na+=fa.Id)}B.ControlsId=Na+".Controls"}B.Title=this.title;B.DisplayMode=this.Rs;B.ShowMenuSectionTitleIcon=this.Ylg;B.ShowMenuSectionTitleBackground=this.Xlg;B.MenuSectionTitleFocusable=this.irg;return B}}Object(d.a)(Oc,"RibbonMenuSection",null,[323,572]);class yd{constructor(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd,Vd,Be,Qe){Qe=void 0===Qe?null:Qe;this.id=B;this.command=Na;this.aZf=nb;this.populateOnlyOnce=
gc;this.bVa=bd;this.enj=Ra;this.alt=Tb;this.p8b=qc;this.width=hd;this.Y2g=Vd;this.vS=Be;this.$ua=new xc(fa);this.bHe=Qe;nb&&Ra&&(B=new Oc,B.Rs="MenuLoading",fa=new Nb(fa+"LoadingLabel"),B.buttons.push(fa),this.menu.ve.push(B))}M0(){return this.z$g()}get menu(){return this.$ua}z$g(){let B=bf.d(this.id,this.command,this.aZf,this.populateOnlyOnce,this.bVa,this.enj,this.alt,this.p8b,this.width);const fa=B.indexOf(" />");B=B.substring(0,fa);B+=` ${"AllowDefaultContent"}="${this.Y2g.toString()}"`;B+=` ${"AutoComplete"}="${this.vS?
"true":"false"}"`;this.bHe&&(B+=` ${"ArrowImgId"}="${this.bHe}"`);B=B+">"+this.menu.M0();return B+"</ComboBox>"}}Object(d.a)(yd,"RibbonComboBox",null,[576,572]);var Sd=a(1059),ve=a(939);class Ee extends ve.a{constructor(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd,Vd,Be,Qe){Be=void 0===Be?null:Be;Qe=void 0===Qe?null:Qe;super(B,fa,Na,gc,bd,Ra,Tb,Vd,0);this.Mob=null;this.s5=0===qc?null:Ta.a.instance.ia(qc);this.fYc=hd;this.ZZc=nb;this.DRg=Be;this.Qo=Qe}get description(){return this.s5}get iCb(){return this.Mob}get menuItemId(){return this.fYc}get bVa(){return this.ZZc}get styles(){return this.DRg}get data(){return this.Qo}M0(){return bf.n(this.lla())}z0d(B){this.s5=
B}toString(){this.iCb||(this.Mob=this.M0());return this.iCb}lla(){const B=new Sd.a;this.Qhc(B);B.MenuItemId=this.menuItemId;B.QueryCommand=this.bVa;B.Description=this.description;B.Styles=this.styles;B.Data=this.data;return B}}Object(d.a)(Ee,"RibbonComboBoxItem",ve.a,[324,571,572]);var Ue=a(578);class hf extends ve.a{constructor(B,fa,Na,nb,gc,bd,Ra,Tb){super(B,Na,nb,gc,bd,Ra,Tb,!1,0);this.populateOnlyOnce=!1;this.AJb=this.menuCloseCommand=this.menuOpenCommand=this.mz=null;this.$ua=new xc(fa);this.Yof=
!0}get menu(){return this.$ua}M0(){return bf.o(this.lla())}lla(){const B=new Ue.a;this.Qhc(B);B.PopulateOnlyOnce=this.populateOnlyOnce;B.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();B.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();B.PopulateQueryCommand=this.mz;B.KeyTip=this.AJb;B.Menu=this.menu.cH();B.ImageIsVisible=this.Yof;return B}}Object(d.a)(hf,"RibbonFlyoutAnchor",ve.a,[325,571,572]);var Rb=a(1233),ed=a(597);class pd{constructor(){this.y8a=
[];this.id=null;this.width=0;this.title=this.uma=null}M0(){return bf.p(this.d$b())}vv(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd){nb=void 0===nb?0:nb;gc=void 0===gc?null:gc;bd=void 0===bd?null:bd;Ra=void 0===Ra?null:Ra;Tb=void 0===Tb?null:Tb;hd=void 0===hd?null:hd;this.yqf(this.y8a.length,B,fa,Na,0===nb?void 0===qc?null:qc:Ta.a.instance.ia(nb),gc,bd,Ra,Tb,hd)}yqf(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd){bd=void 0===bd?null:bd;Ra=void 0===Ra?null:Ra;Tb=void 0===Tb?null:Tb;qc=void 0===qc?null:qc;hd=void 0===hd?null:hd;(B>this.y8a.length||
0>B)&&Error.argumentOutOfRange("Invalid Index");this.y8a.splice(B,0,Object(wc.a)(new Rb.a,{Id:fa,Command:Na.toString(),QueryCommand:null!==nb&&void 0!==nb?nb:null,Alt:gc,MenuItemId:bd,Icon:Ra,Image:Tb?vc.a.di(Tb):null,ImageClass:qc,LabelText:hd}))}d$b(B){B=void 0===B?!1:B;let fa=null,Na=null;switch(this.uma){case "Size120by20":fa=this.Svb(120,20,B);Na=this.Qvb(130,30,B);break;case "Size90by21":fa=this.Svb(90,21,B);Na=this.Qvb(100,33,B);break;case "Size24by24With7Options":fa=this.Svb(28,28,B);Na=this.Qvb(34,
38,B);break;case "Size24by24":fa=this.Svb(28,28,B);Na=this.Qvb(38,38,B);break;case "Size112by64":fa=this.Svb(24,24,B),Na=this.Qvb(112,64,B)}for(B=0;B<this.y8a.length;B++)this.y8a[B].FullIconStyle=fa;return Object(wc.a)(new ed.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.uma,GalleryItems:this.y8a,GalleryStyle:Na})}Svb(B,fa,Na){const nb={},gc={};gc.width=B;gc.height=fa;Na&&(gc.alignSelf="center",gc.marginBottom="4px");nb.root=gc;return nb}Qvb(B,fa,
Na){const nb={},gc={},bd={};bd.width=B;bd.height=fa;gc.root=bd;Na&&(gc.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});nb.galleryButtonInExpanded=gc;return nb}}Object(d.a)(pd,"RibbonGallery",null,[570,572]);var ie=a(1050);class Ce{constructor(B){this.bE=void 0===B?null:B}Qt(B){return new xc(void 0===B?null:B)}He(){return new Oc}fd(B){var fa=La.a.Ve(Ce.E4a,B.toString());if(fa)return fa;switch(B){case 236:return this.Xo(B,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.Xo(B,
"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.Xo(B,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Ke(B,"ContextMenu.Show.ChartTaskPane",1221897806,wa.a.w4e,4,983);case 287:return this.Ke(B,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.gk(B,"DataLabels.None.BoxWhisker",374300079,wa.a.e4e,929,930,1600);case 0:return this.gk(B,"DataLabels.None.Column",374300079,wa.a.d4e,929,930,1600);case 1:return this.gk(B,
"DataLabels.None.Line",374300079,wa.a.f4e,929,930,1600);case 2:return this.gk(B,"DataLabels.None.Pie",374300079,wa.a.g4e,929,930,1600);case 3:return this.gk(B,"DataLabels.Show.Column",-1809877936,wa.a.Rgc,931,932,1601);case 143:return this.gk(B,"DataLabels.Show.Funnel",-1809877936,wa.a.Rgc,931,934,1601);case 144:return this.gk(B,"DataLabels.Show.Treemap",-1809877936,wa.a.pkd,931,938,1601);case 145:return this.gk(B,"DataLabels.Show.Sunburst",-1809877936,wa.a.okd,931,934,1601);case 4:return this.gk(B,
"DataLabels.Center.Column",-1996266048,wa.a.Rgc,933,934,1602);case 5:return this.gk(B,"DataLabels.Center.Line",-1996266048,wa.a.Z3e,933,934,1602);case 6:return this.gk(B,"DataLabels.Center.Pie",-1996266048,wa.a.okd,933,934,1602);case 7:return this.gk(B,"DataLabels.InsideEnd.Column",493396546,wa.a.$3e,935,936,1603);case 8:return this.gk(B,"DataLabels.InsideEnd.Pie",493396546,wa.a.a4e,935,936,1603);case 9:return this.gk(B,"DataLabels.InsideBase.Column",1599247052,wa.a.pkd,937,938,1604);case 10:return this.gk(B,
"DataLabels.OutsideEnd.Column",342855531,wa.a.h4e,939,940,1605);case 11:return this.gk(B,"DataLabels.OutsideEnd.Pie",342855531,wa.a.i4e,939,940,1605);case 140:return this.gk(B,"DataLabels.Left.BoxWhisker",-472675112,wa.a.c4e,941,942,1606);case 12:return this.gk(B,"DataLabels.Left.Line",-472675112,wa.a.b4e,941,942,1606);case 142:return this.gk(B,"DataLabels.Right.BoxWhisker",-1774499423,wa.a.k4e,943,944,1607);case 13:return this.gk(B,"DataLabels.Right.Line",-1774499423,wa.a.j4e,943,944,1607);case 138:return this.gk(B,
"DataLabels.Above.BoxWhisker",-204160914,wa.a.V3e,945,946,1608);case 14:return this.gk(B,"DataLabels.Above.Line",-204160914,wa.a.l4e,945,946,1608);case 139:return this.gk(B,"DataLabels.Below.BoxWhisker",-87783054,wa.a.W3e,947,948,1609);case 15:return this.gk(B,"DataLabels.Below.Line",-87783054,wa.a.Y3e,947,948,1609);case 16:return this.gk(B,"DataLabels.BestFit.Pie",1650379138,wa.a.X3e,949,950,1610);case 17:return this.gk(B,"Axes.Horizontal.None",895828731,wa.a.K3e,929,951,1613);case 18:return this.gk(B,
"Axes.Horizontal.ShowLTR",683614408,wa.a.mkd,952,953,1614);case 19:return this.gk(B,"Axes.Horizontal.NoLabels",-1612014670,wa.a.J3e,956,957,1615);case 20:return this.gk(B,"Axes.Horizontal.ShowRTL",1259259728,wa.a.L3e,958,959,1616);case 21:return this.gk(B,"Axes.Horizontal.Default",683614408,wa.a.mkd,954,955,1617);case 22:return this.gk(B,"Axes.Horizontal.Thousands",-220179662,wa.a.M3e,960,961,1618);case 23:return this.gk(B,"Axes.Horizontal.Millions",1534680966,wa.a.I3e,962,963,1619);case 24:return this.gk(B,
"Axes.Horizontal.Billions",-238895611,wa.a.G3e,964,965,1620);case 25:return this.gk(B,"Axes.Horizontal.LogScale",-892714755,wa.a.H3e,966,967,1621);case 26:return this.gk(B,"Axes.Vertical.None",2006508979,wa.a.R3e,929,951,1613);case 27:return this.gk(B,"Axes.Vertical.Default",252405382,wa.a.T3e,954,955,1617);case 28:return this.gk(B,"Axes.Vertical.Thousands",670842692,wa.a.U3e,960,961,1618);case 29:return this.gk(B,"Axes.Vertical.Millions",-572426128,wa.a.P3e,962,963,1619);case 30:return this.gk(B,
"Axes.Vertical.Billions",-806496391,wa.a.N3e,964,965,1620);case 31:return this.gk(B,"Axes.Vertical.LogScale",-1700998151,wa.a.O3e,966,967,1621);case 32:return this.gk(B,"Axes.Vertical.NoLabels",2104548628,wa.a.Q3e,956,957,1615);case 33:return this.gk(B,"Axes.Vertical.ShowRTL",1717508862,wa.a.S3e,958,959,1616);case 34:return this.gk(B,"Gridlines.Horizontal.None",80515665,wa.a.q4e,929,970,1624);case 35:return this.gk(B,"Gridlines.Horizontal.Major",-306129902,wa.a.n4e,972,973,1625);case 36:return this.gk(B,
"Gridlines.Horizontal.Minor",2147076534,wa.a.o4e,975,976,1626);case 37:return this.gk(B,"Gridlines.Horizontal.MajorMinor",-1253752845,wa.a.p4e,978,979,1627);case 38:return this.gk(B,"Gridlines.Vertical.None",1711257557,wa.a.v4e,929,971,1624);case 39:return this.gk(B,"Gridlines.Vertical.Major",-1772953364,wa.a.s4e,972,974,1625);case 40:return this.gk(B,"Gridlines.Vertical.Minor",680253336,wa.a.t4e,975,977,1626);case 41:return this.gk(B,"Gridlines.Vertical.MajorMinor",-215161981,wa.a.u4e,978,980,1627);
case 135:return this.Ke(B,"ContextMenu.NumberFormating",2105621672,wa.a.dkd,1,476,135!==B);case 300:return this.Ke(B,"ContextMenu.FormatCells",2055979337,null,1,477,300!==B,void 0,"PaintBrushandBucket_20");case 136:return this.Ke(B,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,wa.a.dkd,1,476,136!==B);case 42:return this.Ke(B,"ContextMenu.Cut",-1985798686,wa.a.h3e,1,12);case 43:return this.Ke(B,"ContextMenu.Copy",-911352779,wa.a.g3e,1,11);case 212:return this.Ke(B,"ContextMenu.InsertCopiedCells",
-160032004,wa.a.Gkd,3,15);case 213:return this.Ke(B,"ContextMenu.InsertCutCells",-1065525230,wa.a.Gkd,3,21);case 44:case 57:return this.Ke(B,"ContextMenu.Paste",237279923,wa.a.hkd,1,13,44!==B,"Paste");case 248:return this.Ke(B,"PasteAdvancedOptionsGallery",237279923,wa.a.hkd,1,13,44!==B,"Paste");case 45:case 120:return this.Ke(B,"ContextMenu.EditHyperlink",-1583422759,wa.a.vkd,8,1140,45!==B,"EditHyperlink");case 46:case 121:return this.Ke(B,"ContextMenu.InsertHyperlink",-1583422759,wa.a.vkd,8,1141,
46!==B,"InsertHyperlink");case 47:case 122:return this.Ke(B,"ContextMenu.RemoveHyperlink",-1253126584,wa.a.ykd,8,1142,47!==B,"RemoveHyperlink");case 48:case 123:return this.Ke(B,"ContextMenu.RemoveHyperlinks",-1253126584,wa.a.ykd,8,1143,48!==B,"RemoveHyperlinks");case 250:return this.Xo(B,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Ke(B,"ContextMenu.InsertCellsShiftRight",1035996630,wa.a.q3e,1,165===B||173===B?341:342,173===B||188===B,"InsertCellsShiftRight");
case 166:case 174:return this.Ke(B,"ContextMenu.InsertCellsShiftDown",1035996630,wa.a.p3e,1,344,166!==B,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Ke(B,"ContextMenu.DeleteCellsShiftLeft",1035996630,wa.a.k3e,1,167===B||175===B?342:341,175===B||190===B,"DeleteCellsShiftLeft");case 168:case 176:return this.Ke(B,"ContextMenu.DeleteCellsShiftUp",1035996630,wa.a.l3e,1,343,168!==B,"DeleteCellsShiftUp");case 177:case 181:return this.Ke(B,"ContextMenu.InsertRowsSheet",-1113896058,
wa.a.ekd,1,429,177!==B,"InsertRows");case 49:case 116:return this.Ke(B,"ContextMenu.InsertRows",-1113896058,wa.a.ekd,1,346,49!==B,"InsertRows");case 161:case 169:return this.Ke(B,"ContextMenu.InsertRowsTable",942362098,wa.a.s3e,1,421,161!==B,"InsertRowsTable");case 50:case 117:return this.Ke(B,"ContextMenu.InsertColumns",1415868706,wa.a.MAb,1,406,50!==B,"InsertColumns");case 288:case 289:return this.Ke(B,"ContextMenu.InsertColumns",1415868706,wa.a.MAb,1,408,288!==B,"InsertColumns");case 178:case 182:return this.Ke(B,
"ContextMenu.InsertColumnsSheet",1415868706,wa.a.MAb,1,426,178!==B,"InsertColumns");case 290:case 291:return this.Ke(B,"ContextMenu.InsertColumnsSheet",1415868706,wa.a.MAb,1,428,290!==B,"InsertColumns");case 191:case 192:case 162:case 170:return this.Ke(B,"ContextMenu.InsertColumnsTable",622604322,wa.a.r3e,1,162===B||170===B?419:420,170===B||192===B,"InsertColumnsTable");case 179:case 183:return this.Ke(B,"ContextMenu.DeleteRowsSheet",1554436520,wa.a.Ngc,1,429,179!==B,"DeleteRows");case 51:case 118:return this.Ke(B,
"ContextMenu.DeleteRows",1554436520,wa.a.Ngc,1,410,51!==B,"DeleteRows");case 163:case 171:return this.Ke(B,"ContextMenu.DeleteRowsTable",1405456548,wa.a.Ngc,1,418,163!==B,"DeleteRowsTable");case 180:case 184:return this.Ke(B,"ContextMenu.DeleteColumnsSheet",674605324,wa.a.Mgc,1,426,180!==B,"DeleteColumns");case 52:case 119:return this.Ke(B,"ContextMenu.DeleteColumns",674605324,wa.a.Mgc,1,411,52!==B,"DeleteColumns");case 164:case 172:return this.Ke(B,"ContextMenu.DeleteColumnsTable",284490184,wa.a.Mgc,
1,417,164!==B,"DeleteColumnsTable");case 53:case 124:return this.Xo(B,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==B,"OpenHyperlink");case 263:return this.Ke(B,"SheetOpsContextMenu.ShowChanges",1834994092,wa.a.zkd,8,443,void 0,ha.a.T_j);case 264:return this.Ke(B,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Ke(B,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Ke(B,
"GridContextMenu.ShowChanges",1834994092,wa.a.zkd,8,443,void 0,ha.a.Bkg);case 54:return this.Ke(B,"ContextMenu.InsertSheet",-1935155518,wa.a.t3e,1,514);case 56:case 127:return this.Ke(B,"ContextMenu.DeleteSheet",1880294140,wa.a.n3e,1,515,56!==B,"DeleteSheet");case 55:return this.Xo(B,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Xo(B,"ContextMenu.ReorderSheet",-383100692,517,125!==B,"ReorderSheet");case 158:return this.Xo(B,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.Xo(B,
"ContextMenu.HideSheet",1458540255,519,112!==B,"HideSheet");case 113:case 115:return this.Xo(B,"ContextMenu.UnhideSheet",1129633328,520,113!==B,"UnhideSheet");case 277:return this.Ke(B,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Ke(B,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Ke(B,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Xo(B,
"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Ke(B,"ContextMenu.PivotExpand",-1687560254,wa.a.jkd,9,1168);case 244:return this.Ke(B,"ContextMenu.PivotCollapse",1176256599,wa.a.ikd,9,1169);case 245:return this.Ke(B,"ContextMenu.PivotExpandEntireField",-1751201991,wa.a.jkd,9,1170);case 246:return this.Ke(B,"ContextMenu.PivotCollapseEntireField",-232434744,wa.a.ikd,9,1171);case 247:return this.Ke(B,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");
case 301:return this.Ke(B,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,Qa.a.Slj);case 59:return this.Ke(B,"ContextMenu.PivotFieldListShow",2140436015,wa.a.kkd,9,1173);case 58:return this.Ke(B,"ContextMenu.PivotFieldListHide",-1006032470,wa.a.kkd,9,1174);case 258:return this.Ke(B,"ContextMenu.PivotSettingsPaneShow",1529441790,wa.a.OAb,17,636);case 257:return this.Ke(B,"ContextMenu.PivotSettingsPaneHide",1529441790,wa.a.OAb,17,637);case 259:return this.Xo(B,"ContextMenu.PivotTableNoSubtotal",
-2016405815,638);case 260:return this.Xo(B,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.Xo(B,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return fa=60!==B,this.Xo(B,fa?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,fa,null);case 61:case 65:return fa=61!==B,this.Xo(B,fa?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,fa,null);case 62:case 66:return fa=62!==B,this.Xo(B,
fa?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,fa,null);case 63:case 67:return fa=63!==B,this.Xo(B,fa?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,fa,null);case 68:case 72:return fa=68!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,wa.a.Igc,9,1093,fa,null);case 69:case 73:return fa=69!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToRowLabelsDisabled":
"ContextMenu.FieldWellMoveToRowLabels",74086617,wa.a.L7a,9,1094,fa,null);case 70:case 74:return fa=70!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,wa.a.K7a,9,1095,fa,null);case 71:case 75:return fa=71!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,wa.a.Jgc,9,1098,fa,null);case 76:return this.Ke(B,"ContextMenu.FieldWellRemoveField",-1092351914,wa.a.i3e,9,1099);case 77:return this.Ke(B,
"ContextMenu.FieldWellValueFieldSettings",-2141589616,wa.a.F3e,9,1100);case 79:case 83:return this.Ke(B,"ContextMenu.FieldListMoveToReportFilter",359279088,wa.a.Igc,9,1082,79!==B,null);case 80:case 84:return this.Ke(B,"ContextMenu.FieldListMoveToRowLabels",-67292059,wa.a.L7a,9,1083,80!==B,null);case 81:case 85:return this.Ke(B,"ContextMenu.FieldListMoveToColumnsLabels",745182485,wa.a.K7a,9,1084,81!==B,null);case 82:case 86:return this.Ke(B,"ContextMenu.FieldListMoveToValues",926905850,wa.a.Jgc,9,
1087,82!==B,null);case 95:case 97:return fa=95!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,wa.a.L7a,9,1096,fa,null);case 96:case 98:return fa=96!==B,this.Ke(B,fa?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,wa.a.K7a,9,1097,fa,null);case 78:return this.Ke(B,"ContextMenu.FieldListAddAsSlicer",547535945,wa.a.bkd,9,1088);case 91:case 93:return this.Ke(B,"ContextMenu.FieldListMoveToRowChartLabels",
-67292059,wa.a.L7a,9,1085,91!==B,null);case 92:case 94:return this.Ke(B,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,wa.a.K7a,9,1086,92!==B,null);case 99:return this.Ke(B,"ContextMenu.BIExploreShowCallout",1529658657,wa.a.Kgc,9,1193);case 100:return this.Ke(B,"ContextMenu.ContextMenuRefresh",2054778433,wa.a.A3e,9,1181);case 102:return this.Ke(B,"ContextMenu.EditCell",324156914,wa.a.xkd,8,579);case 101:return this.Ke(B,"Contextenu.DeleteChart",2045211913,wa.a.tkd,8,578);case 146:return this.Ke(B,
"Contextenu.AltText",1804967129,wa.a.ukd,8,817);case 302:return this.Ke(B,"ContextMenu.CellImageAltText",1516436924,wa.a.ukd,8,817);case 147:return this.Ke(B,"ContextMenu.EditShapeText",-445658892,wa.a.F4e,8,818);case 186:return this.Ke(B,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Ke(B,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",Qa.a.bringForward);case 282:return this.Ke(B,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",
Qa.a.bringToFront);case 283:return this.Ke(B,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",Qa.a.sendBackward);case 284:return this.Ke(B,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",Qa.a.sendToBack);case 273:return this.Ke(B,"ContextMenu.OfficeScriptsViewScript",-585097204,wa.a.b3e,8,2151);case 160:return this.Ke(B,"ContextMenu.InsertComment",-1667294294,wa.a.H4e,8,1146);case 221:return this.Ke(B,"ContextMenu.DeleteComment",467845448,wa.a.E4e,
8,1162);case 159:return this.Ke(B,"ContextMenu.InsertReply",-1667294294,wa.a.I4e,8,1145);case 226:return this.Ke(B,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.Ke(B,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Ke(B,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Ke(B,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");
case 230:return this.Xo(B,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.cX(B,"Form.InsertForm",1305810481,wa.a.gkd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.cX(B,"Form.ViewForm",330035228,wa.a.gkd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.cX(B,"Form.EditForm",1305810481,wa.a.o3e,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.cX(B,"Form.DeleteForm",-509039657,wa.a.j3e,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.cX(B,"Form.ShareForm",
1334518759,wa.a.B3e,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.Xo(B,"ContextMenu.ClearContent",-848953656,445,148!==B);case 150:case 151:return this.Ke(B,"ContextMenu.RowHeight",2040891415,wa.a.J4e,8,434,151===B);case 152:case 153:return this.Ke(B,"ContextMenu.ColumnWidth",957527587,wa.a.D4e,8,433,153===B);case 108:case 154:return this.Xo(B,"ContextMenu.HideRows",1051390410,432,154===B);case 110:case 156:return this.Xo(B,"ContextMenu.UnhideRows",1542466017,439,156===B);case 109:case 155:return this.Xo(B,
"ContextMenu.HideColumns",-706918724,438,155===B);case 111:case 157:return this.Xo(B,"ContextMenu.UnhideColumns",369708605,440,157===B);case 216:return this.Xo(B,"ContextMenu.ShowCard",-843616717,1786,216!==B);case 217:return this.Xo(B,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Ke(B,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Ke(B,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");
case 305:return this.Ke(B,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Xo(B,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===B);case 218:case 269:return this.Xo(B,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===B);case 220:case 271:return this.Xo(B,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===B);case 219:case 270:return this.Xo(B,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===
B);case 234:return this.Ke(B,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.Ke(B,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Ke(B,"ContextMenu.FilterByValue",1803952894,null,1,222);case 223:return this.Ke(B,"ContextMenu.SortAscending",-1010737776,wa.a.D3e,1,228);case 292:return this.Xo(B,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.Xo(B,"ContextMenu.PutSelectedFontColorOnTop",
-764711886,231);case 294:return this.Xo(B,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Ke(B,"ContextMenu.SortDescending",2123420468,wa.a.E3e,1,229);case 225:return this.Ke(B,"ContextMenu.SortCustom",-207540907,wa.a.Qgc,1,233);case 232:return this.Ke(B,"ContextMenu.ConvertToRange",323142015,wa.a.f3e,1,740);case 272:return this.Ke(B,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,wa.a.xkd,8,661);case 239:return this.Ke(B,"ContextMenu.IgnoreError",886009118,
wa.a.wkd,8,2112,239!==B);case 240:return this.Ke(B,"ContextMenu.IgnoreErrors",886009118,wa.a.wkd,8,2113,240!==B);case 241:return this.Xo(B,"ContextMenu.ShowError",-1779556985,2114,241!==B);case 251:return this.Ke(B,"ContextMenu.SlicerRefresh",-231711729,wa.a.z3e,0,2177,251!==B);case 252:return this.Ke(B,"ContextMenu.SlicerClearFilter",-1909381757,wa.a.m3e,0,2178,252!==B);case 254:return this.Xo(B,"ContextMenu.SlicerDelete",2045211913,2181,254!==B);case 253:return this.Ke(B,"ContextMenu.SlicerMultiSelect",
2108047455,wa.a.fkd,0,2180,253!==B);case 255:return this.Ke(B,"ContextMenu.SlicerSortAscending",-923375148,wa.a.Sgc,8,2183,255!==B);case 256:return this.Ke(B,"ContextMenu.SlicerSortDescending",1164937340,wa.a.Tgc,8,2182,256!==B);case 267:return this.Ke(B,"ContextMenu.SlicerSettingsPaneShow",522377926,wa.a.OAb,17,636);case 266:return this.Ke(B,"ContextMenu.SlicerSettingsPaneHide",522377926,wa.a.OAb,17,637);case 128:return this.Axa(B,-619033944,1,1438);case 129:return this.Axa(B,-619033944,2,1440);
case 130:return this.Axa(B,-619033944,3,1442);case 131:return this.Axa(B,-619033944,4,1443);case 132:return this.f7(B,-1736601456,7,1447);case 133:return this.f7(B,-1736601456,8,1449);case 134:return this.f7(B,-1736601456,0,1450);case 196:return this.Axa(B,-2136556471,1,1438);case 198:return this.Axa(B,-2136556471,2,1440);case 200:return this.Axa(B,-2136556471,3,1442);case 201:return this.Axa(B,-2136556471,4,1443);case 204:return this.f7(B,1201641489,0,1447);case 205:return this.f7(B,1201641489,1,
1448);case 206:return this.f7(B,1201641489,7,1449);case 207:return this.f7(B,1201641489,2,1450);case 208:return this.f7(B,1201641489,4,1451);case 209:return this.f7(B,1201641489,3,1452);case 210:return this.f7(B,1201641489,5,1453);case 211:return this.f7(B,1201641489,6,1454);case 274:return this.Ke(B,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.Ke(B,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Ke(B,
"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 299:return this.Ke(B,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 285:return this.Ke(B,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Ke(B,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}cX(B,fa,Na,nb,gc,bd,Ra,Tb,qc,hd,Vd,Be){fa=new na.a(fa,Ra,Na,null,gc,
nb,bd,Ra,Tb,qc,hd,Vd,!0,void 0===Be?null:Be);return Ce.E4a[B.toString()]=fa}Ke(B,fa,Na,nb,gc,bd,Ra,Tb,qc){qc=void 0===qc?null:qc;return this.cX(B,fa,Na,qc?null:nb,gc,"Image16by16",bd,0,void 0===Tb?null:Tb,void 0===Ra?!1:Ra,0,qc)}Hed(B,fa,Na,nb,gc,bd){return new Ee(B,0,-1006427574,null,Na,fa,nb,0,0,gc,!1,null,void 0===bd?null:bd)}xTe(B,fa){return new Nb(B,void 0===fa?"":fa)}Soh(B,fa,Na,nb){return new ie.a(B,0,fa,null,8,null,"None",0,0,null,!1,0,Na,nb)}KMa(B,fa,Na,nb,gc,bd,Ra,Tb,qc){Tb=void 0===Tb?
null:Tb;qc=void 0===qc?!1:qc;let hd=La.a.Ve(Ce.E4a,B);if(hd)return hd;hd=new na.a(B,0,Na,null,3,null,"None",0,0,bd,Ra,0);hd.QZ(fa);hd.label=fa;hd.z0d(qc?null:fa);hd.BTb(gc,nb,Tb);return Ce.E4a[B]=hd}dVd(B){this.hzd(B)&&delete Ce.E4a[B]}hzd(B){return B in Ce.E4a}Fx(B,fa,Na,nb){B=new hf(B,fa,0,nb,3,null,"None",0);B.QZ(Na);B.label=Na;return B}Qdd(B,fa,Na,nb,gc,bd){B=new hf(B,fa,0,nb,gc,bd,"Image16by16",0);B.QZ(Na);B.label=Na;return B}Ndd(B,fa,Na,nb,gc){return new Pa(this.bE,B,null,null,void 0===fa?null:
fa,null,void 0===Na?null:Na,void 0===nb?null:nb,void 0===gc?null:gc)}qF(B,fa,Na,nb){Na=void 0===Na?null:Na;nb=void 0===nb?null:nb;return Object(wc.a)(new pd,{id:B,width:fa,uma:Na,title:nb})}gk(B,fa,Na,nb,gc,bd,Ra){return this.cX(B,fa,Na,nb,4,"Image32by32",gc,bd,null,!1,Ra)}Xo(B,fa,Na,nb,gc,bd){return this.cX(B,fa,Na,null,1,"None",nb,0,void 0===bd?null:bd,void 0===gc?!1:gc,0)}pSe(B,fa,Na,nb,gc,bd){return this.cX(B,fa,Na,nb,4,"Image16by16",gc,0,bd.toString(),!1,0)}f7(B,fa,Na,nb){return this.pSe(B,"OutlineDashStylePresent,"+
Na,fa,wa.a.Lgc,nb,Na)}Axa(B,fa,Na,nb){return this.pSe(B,"OutlineWidthPresent,"+Na,fa,wa.a.Pgc,nb,Na)}}Ce.E4a={};Object(d.a)(Ce,"RibbonControlsManager",null,[559]);class Pe extends S.a{constructor(B){super();this.Ya=null;this.$=B;this.Md()}create(){var B=this.$;const fa=qa.GetServiceTaskFactory.create(B.ea,111,this.ka,this.Na);B=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(ka.d)(V.a.resolve(sa.w,{Qa:this.Na})):qa.GetServiceTaskFactory.create(B.ea,155,
this.ka,this.Na);W.TaskExtensions.ya(W.TaskExtensions.Bf([fa,B],this.ka),()=>{this.qd(this.Ya||(this.Ya=new Ce(fa.result)))},this.ka,3)}static la(B){B.ea.Ja(102,new Pe(B))}}Object(d.a)(Pe,"RibbonControlsFactory",S.a,[]);var lf=a(899);let nf=class{constructor(B){this.GCa=B}rE(B,fa){return this.GCa?this.GCa.rE(B,fa).then(Na=>{Na.IsSuccess||h.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+Na.ErrorMessage+" Error code: "+Na.ErrorCode+" App name: "+B);return Object(wc.a)(new lf.a,
{IsSuccess:Na.IsSuccess,Token:Na.Token,ErrorCode:Na.ErrorCode,ErrorMessage:Na.ErrorMessage})}):(h.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(wc.a)(new lf.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}fab(){return this.GCa?this.GCa.fab():null}};nf=Object(qe.a)([Object(V.d)(sa.Nb),Object(qe.b)(0,Object(sa.Mb)())],nf);Object(d.a)(nf,"OAuthManagerWrapper",null,[499]);Object(V.b)(sa.Mb)(()=>
C.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var If=a(193),Ff=a(34);class Mf{constructor(B){this.keyPath=B}}Object(d.a)(Mf,"KeyPathClass",null,[]);let dc=class extends If.a{constructor(B){super();this.ckb=this.Rfd=null;this.IVe=1;this.o0a=null;this.$=B}get indexedDBFactory(){this.o0a||(window.indexedDB?this.o0a=window.indexedDB:window.webkitIndexedDB?this.o0a=window.webkitIndexedDB:window.mozIndexedDB?this.o0a=window.mozIndexedDB:window.msIndexedDB&&(this.o0a=window.msIndexedDB));return this.o0a}get initialized(){return!!this.Rfd&&
!!this.ckb}initialize(B,fa,Na){this.Rfd=B;this.ckb=fa;this.IVe=Na}Rh(){try{return G.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&z.a.rBa||z.a.hh&&91===z.a.qBb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(B){return h.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${B.message}`),!1}}pib(B){return this.Rh()&&this.initialized?W.TaskExtensions.e7(this.dPd(),fa=>{if(void 0===fa.result&&G.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
fa=fa.result;this.Ecc(fa);const Na=Ff.a.$a.eg.m;this.Nsd(fa,!1).put(B);h.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${Ff.a.$a.eg.m-Na} Millisecond.`);return!0},this.ka):(h.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),ua.Task.Wa(!1))}Bgd(B){return this.Rh()&&this.initialized?W.TaskExtensions.e7(this.dPd(),fa=>{if(void 0===fa.result&&G.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
fa=fa.result;this.Ecc(fa);const Na=Ff.a.$a.eg.m;this.Nsd(fa,!1)["delete"](B);h.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${Ff.a.$a.eg.m-Na} Millisecond.`);return!0},this.ka):(h.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),ua.Task.Wa(!1))}h9a(B){return this.Rh()&&this.initialized?W.TaskExtensions.anh(this.dPd(),fa=>void 0===fa.result&&G.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?
ua.Task.Wa(""):this.J9h(fa.result,B),this.ka):(h.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),ua.Task.Wa(""))}Ecc(B){B.objectStoreNames.contains(this.ckb)||B.createObjectStore(this.ckb,new Mf("key"))}dPd(){const B=new Lc.a;let fa;fa=this.indexedDBFactory.open(this.Rfd,this.IVe);fa.onsuccess=()=>{const Na=fa.result;h.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${Na.name} success`);B.setResult(Na)};fa.onupgradeneeded=()=>{const Na=fa.result;
h.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${Na.name} upgrade needed`);try{this.Ecc(Na),h.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${Na.name} upgrade done`)}catch(nb){h.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${nb}`),G.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?B.setResult(void 0):B.setException(Error.create("Failed to upgrade IndexedDB"))}};fa.onerror=Na=>{h.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${Na} failed`);B.setResult(void 0)};
return B.task}Nsd(B,fa){return B.transaction([this.ckb],fa?"readonly":"readwrite").objectStore(this.ckb)}J9h(B,fa){const Na=new Lc.a;this.Ecc(B);const nb=Ff.a.$a.eg.m,gc=this.Nsd(B,!0).get(fa);gc.onsuccess=bd=>{(bd=bd.target.result)?(Na.setResult(bd.value),h.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${Ff.a.$a.eg.m-nb} Millisecond.`)):Na.setResult("")};gc.onerror=()=>{Na.setException(Error.create(gc.error?gc.error.message:"DB error"))};return Na.task}};dc=Object(qe.a)([Object(V.d)(sa.vb,
{Ux:"transient"}),Object(qe.b)(0,Object(sa.R)())],dc);Object(d.a)(dc,"IndexedDB",If.a,[257]);Type.registerNamespace("Common.App.OAuth");F.main();K.a.wk(".ewa-svg-icon{height:100%;width:100%}");L.a.Fa(ja.la);K.a.wk('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
(()=>{L.a.Fa(B=>{Mc.la(B);$a.la(B)})})();(()=>{L.a.Fa(B=>{Xd.la(B)})})();(()=>{L.a.Fa(B=>{Object(Ka.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")||$b.la(B)})})();(()=>{L.a.Fa(B=>{new td(B.ea,B)})})();L.a.Fa(Pe.la);String(c);String(e);String(f);window.___1688279196419_closurehack=c;window.___1688279196419_closurehack=e;window.___1688279196419_closurehack=f},902:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(1330),e=a(993),f;(function(qa){qa[qa.external=0]="external";qa[qa.msa=1]="msa";
qa[qa.aad=2]="aad"})(f||(f={}));Object(w.b)("AuthorityType",f);var d=a(808);class h{constructor(qa){this.uNg=qa}initialize(){return Promise.resolve(0)}Ttc(){return Promise.resolve(0)}rE(){b.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new d.a,{IsSuccess:!0,Token:this.uNg}))}lLc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}IJc(){return!1}bEb(){return"MockAuthTokenStrategy"}}
Object(w.a)(h,"MockAuthTokenStrategy",null,[359]);var r=a(1008);class n{static get(qa,Ba,ua){if(!ua)return qa;let pa=0;return Promise.race([qa,new Promise(Ka=>{pa=window.setTimeout(()=>{Ka(Ba)},ua)})]).then(Ka=>{window.clearTimeout(pa);return Promise.resolve(Ka)}).catch(()=>{window.clearTimeout(pa);return Promise.resolve(Ba)})}}Object(w.a)(n,"PromiseWithTimeout",null,[]);var u=a(6),v=a(430);class x{constructor(qa,Ba,ua,pa,Ka){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=qa;this.scope=Ba;this.silentLogin=ua;this.options=pa;this.correlationId=Ka}}Object(w.a)(x,"TokenRequestParameters",null,[370]);var k=a(33),m=a(84);class t{constructor(){this.vye=null;let qa=u.AFrameworkApplication.fa.Ta(u.AFrameworkApplication.aba),Ba=u.AFrameworkApplication.fa.Ta(u.AFrameworkApplication.Otg);this.V1a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",qa&&""!==qa?qa:"Unspecified",Ba&&""!==Ba?Ba:"Unspecified")}initialize(){return new Promise(qa=>
{m.a.instance.Ed("Common.App.WopiIdentity.IWopiIdentity").execute(Ba=>{this.vye=Ba;qa(0)})})}vk(qa){const Ba=["HTTPS:","API:"];let ua=!1;const pa=qa.toLocaleUpperCase();for(const Ka of Ba)if(pa.startsWith(Ka)){ua=!0;break}return ua||this.aGi(qa)?qa+"/.default":qa}aGi(qa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(qa)}Ttc(){return Promise.resolve(0)}rE(qa,Ba,ua,pa,Ka,$a,ha){if(k.a.wBa){Ka=v.OAuthManagerSettings.uok;if(!Ka)return Ba=Object.assign(new d.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ba);if(!Array.contains(Ka,qa))return Ba=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+qa}),Promise.resolve(Ba)}qa=this.vk(ua);ua=new x(ua,qa,!pa,null,u.AFrameworkApplication.userSessionId);return this.vye.getAccessToken(ua,Ba,ha).then(cb=>Object.assign(new d.a,{IsSuccess:!0,Token:cb.accessToken}),cb=>Object.assign(new d.a,{IsSuccess:!1,ErrorCode:cb}))}lLc(){return Promise.resolve(Object.assign(new d.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}IJc(){return!1}bEb(){return this.V1a}}Object(w.a)(t,"ParentFrameTokenStrategy",null,[359]);var z=a(80),y=a(910),C=a(200);class J{constructor(){this.reject=this.resolve=null;this.startTime=0;this.O0f=this.oIe=null}}Object(w.a)(J,"PromiseWrapper",null,[]);class F{constructor(qa){qa=void 0===qa?0:qa;this.EE=0;this.Xqb=!1;this.Wp=new C.a;this._timeout=
qa}enqueue(qa){return new Promise((Ba,ua)=>{this.Wp.add(Object.assign(new J,{O0f:qa,resolve:Ba,reject:ua}));this.process()})}process(){if(this.Xqb||this.EE===this.Wp.count)return!1;const qa=this.Wp.ma(this.EE++);try{this.Xqb=!0,qa.O0f().then(Ba=>{this.Xqb=!1;this.kcd(qa,Ba,null,!0)}).catch(Ba=>{this.Xqb=!1;this.kcd(qa,null,Ba,!1)})}catch(Ba){this.Xqb=!1,this.kcd(qa,null,Ba,!1)}return!0}kcd(qa,Ba,ua,pa){if(pa){const Ka=()=>{qa.resolve(Ba);this.process()};0<this._timeout?window.setTimeout(()=>{Ka()},
this._timeout):Ka()}else{const Ka=()=>{qa.reject(ua);this.process()};0<this._timeout?window.setTimeout(()=>{Ka()},this._timeout):Ka()}}}Object(w.a)(F,"PromiseQueue",null,[]);class K{constructor(){this.correlationId=this.resolve=null}}Object(w.a)(K,"ResolveWithCorrelation",null,[]);var L=a(139),S=a(153),W=a(780),G=a(183);class O extends S.a{constructor(qa,Ba,ua,pa,Ka,$a){super(!1,!1,!0);this.oie=this.o5=null;this.j0=qa;this.ZOg=ua;this.my=pa;this.KSg=Ka;this.xIa=$a;this.sv=document.createElement("iframe");
this.sv.id="SharedAuthInteractiveFrame";this.sv.setAttribute("name","SharedAuthInteractiveFrame");this.sv.setAttribute("title","SharedAuthInteractiveFrame");this.sv.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.sv.style.border="0";this.sv.style.height="48px";this.sv.style.width="190px";$addHandler(this.sv,"error",Object(z.a)(this,this.tfj,"onSharedAuthFrameError"));qa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.j0,Ba,"?replyUrl=",window.location.protocol,
"//",window.location.host,"&interactive=1","&WacUserType=",u.AFrameworkApplication.userType);this.sv.src=qa;this.AIg=new Promise(ha=>{this.oie=ha});this.qie=!1}NHc(){this.o5={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ZOg,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(z.a)(this,this.jrh,"createFrame"),["resolveDialogStyles"]:this.oie}};this.Fd=5;this.initializeAndShow(CommonUIStrings.l_SignIn,
Object(z.a)(this,this.pWj,"sharedAuthConsentDialogHandler"),this.o5)}bZa(qa,Ba,ua){qa=void 0===qa?!1:qa;Ba=void 0===Ba?!1:Ba;ua=void 0===ua?5:ua;this.o5&&this.o5.bodyControls&&(qa!==Object(L.a)(Object,this.o5.bodyControls).frameLoaded&&(Object(L.a)(Object,this.o5.bodyControls).frameLoaded=qa),Ba!==Object(L.a)(Object,this.o5.bodyControls).frameLoadSuccess&&(Object(L.a)(Object,this.o5.bodyControls).frameLoadSuccess=Ba),ua!==this.o5.dialogButtonsOption&&(this.o5.dialogButtonsOption=null,this.Fd=ua),
this.update(this.o5))}b2j(qa,Ba){const ua=new W.a(G.a.tWj);ua.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:qa,["dialogStyles"]:Ba};this.my.waa(ua,this.sv.contentWindow,this.j0)}j9e(){this.bZa(!0,!1,6)}get Aig(){return this.sv}get AAh(){return this.AIg.then(qa=>{this.qie=!0;return qa})}get BAh(){return this.qie}tfj(){this.j9e()}jrh(){return this.sv}pWj(qa){0===qa&&(this.KSg.reject(Object.assign(new d.a,
{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.xIa(null))}}Object(w.a)(O,"SharedAuthConsentDialog",S.a,[371]);var T=a(908),I=a(105),N=a(145),R=a(42),V=a(178),sa=a(177);class U{constructor(){this.sv=null;this.W0b=0;this.jqb=this.k2a=this.QPc=this.xIa=this.NO=this.nxe=null;this.my=new T.a(null,null);this.V1a="SharedAuthTokenStrategy Unloaded";this.j0=v.OAuthManagerSettings.rWj;this.rve=v.OAuthManagerSettings.qWj;this.hje=v.OAuthManagerSettings.enableConsoleLogging;
this.UIg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.hRg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.YSg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.rva={};this.pLg=new F(1500)}bEb(){return this.V1a}initialize(){var {OAuthManager:qa}=a(902);if("loadFrame"in this.rva)return this.rva.loadFrame.oIe;
if(!this.j0)return I.Health.instance.recordKpiFailure(qa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),b.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);qa=this.mJc("loadFrame");this.W0b=R.a.Kf();var Ba=this.j0+this.rve+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;this.YSg&&(Ba+="&webworker=1");this.sv=document.createElement("iframe");
this.QQa(this.sv);this.sv.style.cssText="height:0;width:0;display:none;";this.sv.id="SharedAuthFrame";this.sv.setAttribute("name","SharedAuthFrame");this.sv.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.sv.setAttribute("title","SharedAuthFrame");this.sv.src=Ba;document.body.appendChild(this.sv);Ba=R.a.Kf()-this.W0b;b.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Ba,this.sv.src);
return qa}Ttc(qa){this.QPc=qa;const Ba=new W.a(G.a.Dig);Ba.Values=this.OHe(qa);qa=this.mJc("initFrame");this.my.waa(Ba,this.sv.contentWindow,this.j0);b.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return qa}rE(qa,Ba,ua,pa,Ka,$a){const ha=new W.a(G.a.uWj),cb=this.ahf();ha.Values=this.ctg(qa,Ba,ua,pa,Ka,$a,cb);qa=this.mJc(cb);pa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.pLg.enqueue(()=>
new Promise(Ia=>{this.Wdk($a,ha,Ia,cb)})):(this.my.waa(ha,this.sv.contentWindow,this.j0),b.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ba));return qa}Wdk(qa,Ba,ua,pa){const Ka=this.rva[pa];Ka&&(this.k2a=Ba,this.xIa=Object.assign(new K,{resolve:ua,correlationId:pa}),this.NO=new O(this.j0,this.rve,qa,this.my,Ka,ua),this.NO.NHc())}ahf(){return V.a.create().toString()}ctg(qa,Ba,ua,pa,Ka,$a,ha){const cb={};cb.appName=qa;cb.appId=Ba;cb.target=
ua;cb.withPopup=pa;cb.claims=Ka;cb.promptMessage=$a;cb.messageCorrelationId=ha;return cb}QQa(qa){$addHandler(qa,"load",Object(z.a)(this,this.laj,"onIFrameLoaded"));$addHandler(qa,"error",Object(z.a)(this,this.Bxc,"onIFrameError"));this.my.pS(this.j0);this.my.Vn(G.a.Gig);this.my.em(G.a.Gig,Object(z.a)(this,this.Iej,"onScriptLoaded"));this.my.Vn(G.a.Fig);this.my.em(G.a.Fig,Object(z.a)(this,this.Hej,"onScriptInitialized"));this.my.Vn(G.a.Big);this.my.em(G.a.Big,Object(z.a)(this,this.M$i,"onGetTokenResponse"));
this.my.Vn(G.a.Hig);this.my.em(G.a.Hig,Object(z.a)(this,this.Fbj,"onLoginResponse"));this.my.Vn(G.a.Eig);this.my.em(G.a.Eig,Object(z.a)(this,this.Haj,"onInteractiveFlowReady"));this.my.Vn(G.a.Cig);this.my.em(G.a.Cig,Object(z.a)(this,this.eaj,"onHideDialog"));this.my.Vn(G.a.zig);this.my.em(G.a.zig,Object(z.a)(this,this.U5i,"onCloseDialog"))}mJc(qa){const Ba=new J;Ba.startTime=R.a.Kf();const ua=new Promise((pa,Ka)=>{Ba.resolve=pa;Ba.reject=Ka});Ba.oIe=ua;this.rva[qa]=Ba;return ua}laj(){const qa=R.a.Kf()-
this.W0b;b.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",qa)}Bxc(qa){const {OAuthManager:Ba}=a(902),ua=R.a.Kf()-this.W0b,pa=Object.assign(new sa.a,{durationMs:ua});I.Health.instance.recordKpiFailure(Ba.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,pa);b.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ua,this.hje?JSON.stringify(qa):"")}Iej(qa){const {OAuthManager:Ba}=a(902),ua=this.rva.loadFrame;var pa=R.a.Kf()-
ua.startTime,Ka=qa.Values.AuthLibrary.toString();qa=qa.Values.Success.toString();b.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",qa,Ka,pa);Ka&&(this.V1a="SharedAuthTokenStrategy "+Ka);Ka=Boolean.parse(qa);Ka||(qa=N.a.Pt(),void 0!==qa&&null!==qa&&(qa.set("AuthLibrary",this.bEb()),pa=Object.assign(new sa.a,{durationMs:pa,extendedProperties:qa}),I.Health.instance.recordKpiFailure(Ba.kpiName,"SharedAuthStrategyInitFailed",!1,!0,pa)));
ua.resolve(Ka?0:1)}Hej(qa){if(qa.Values.interactive&&this.k2a&&this.k2a.Values.messageCorrelationId){const ua=this.k2a.Values.messageCorrelationId.toString();if(qa.Values.interactive&&this.NO){this.NO.AAh.then(pa=>{this.my.waa(this.k2a,this.NO.Aig.contentWindow,this.j0);this.NO.b2j(ua,pa);this.NO.bZa(!0,!0);this.k2a=null});return}}qa=this.rva.initFrame;const Ba=R.a.Kf()-qa.startTime;b.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ba);qa.resolve(0)}M$i(qa){if(qa.Values.messageCorrelationId&&
qa.Values.messageCorrelationId.toString()){var Ba=qa.Values.messageCorrelationId.toString(),ua=this.rva[Ba];if(ua){var pa=R.a.Kf()-ua.startTime;b.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",pa);qa.Values.isSuccess&&qa.Values.isSuccess?ua.resolve(qa.Values.response):ua.reject(qa.Values.response);this.stg(Ba)}else b.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Haj(){if(this.NO.BAh)this.NO.j9e();else if(this.QPc&&this.NO){const qa=new W.a(G.a.Dig);qa.Values=this.OHe(this.QPc,!0);this.my.waa(qa,this.NO.Aig.contentWindow,this.j0)}}eaj(){this.NO&&this.NO.n$a()}U5i(qa){qa.Values.cancelled&&qa.Values.cancelled&&qa.Values.messageCorrelationId&&this.stg(qa.Values.messageCorrelationId.toString());this.NO&&this.NO.hide()}OHe(qa,Ba){Ba=void 0===Ba?!1:Ba;const ua={};ua.appIds=
this.G2h();ua.upn=qa.loginHint;ua.authority=qa.authority;ua.authorityType=Object(c.a)(f,qa.authorityType);ua.tenantId=qa.tenantId;ua.correlationId=u.AFrameworkApplication.userSessionId;ua.enableConsoleLogging=this.hje;ua.enablePopupFlash=this.UIg;ua.skipUpnCheck=this.hRg;ua.interactive=Ba;return ua}G2h(){const qa=[],Ba=v.OAuthManagerSettings.M6c;for(let pa in Ba){var ua=Ba[pa];Array.contains(qa,ua)||Array.add(qa,ua)}return qa}lLc(qa,Ba,ua,pa,Ka,$a){const ha=new W.a(G.a.sWj),cb=this.ahf();ha.Values=
this.ctg(qa,Ba,ua,pa,Ka,$a,cb);this.nxe=ha;qa=this.mJc(cb);b.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ba);this.I_j();return qa}IJc(){return!0}I_j(){this.jqb||(this.jqb=new y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.jqb.id=16,this.jqb.vBd=!1,this.jqb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{b.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.my.waa(this.nxe,this.sv.contentWindow,this.j0)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),b.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Fbj(qa){if(qa.Values.messageCorrelationId&&qa.Values.messageCorrelationId.toString()){var Ba=this.rva[qa.Values.messageCorrelationId.toString()];if(Ba){var ua=R.a.Kf()-Ba.startTime;b.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ua);
qa.Values.isSuccess&&qa.Values.isSuccess?Ba.resolve(qa.Values.response):Ba.reject(qa.Values.response)}else b.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}stg(qa){this.xIa&&this.xIa.correlationId===qa&&(this.xIa.resolve(null),this.xIa=null)}}Object(w.a)(U,"SharedAuthTokenStrategy",null,[359]);class ka{constructor(qa){this.l_c=
qa;this.V1a="UnsupportedAuthTokenStrategy Reason="+e.a[this.l_c]}initialize(){return Promise.resolve(0)}Ttc(){return Promise.resolve(0)}rE(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:e.a[this.l_c],ErrorMessage:"Unable to get a token. Reason: ["+e.a[this.l_c]+"]"}))}lLc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}IJc(){return!1}bEb(){return this.V1a}}
Object(w.a)(ka,"UnsupportedAuthTokenStrategy",null,[359]);var ja=a(755);a.d(D,"OAuthManager",function(){return Da});class Da{constructor(qa){qa=void 0===qa?null:qa;this.qO=0;this.rO=null;this.GPg=0;this.hne=!!window.location.search.match(RegExp("wdpa=1","gi"));const Ba=R.a.Kf();this.eLg=this.Nzh(qa).then(ua=>ua?this.gvi():(b.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-Ba)),ua=N.a.Pt(),
void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.Mx()),ua=Object.assign(new sa.a,{durationMs:Math.floor(R.a.Kf()-Ba),extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"StrategyPickFailed",!1,!0,ua)),Promise.resolve(1))).then(ua=>0!==ua?Promise.resolve(ua):this.RQi())}Ozh(){if(this.hne)this.qO=5,this.rO=new ka(this.qO);else{var qa=v.OAuthManagerSettings.KZi;qa&&0<qa.length?(this.qO=1,this.rO=new h(qa)):u.AFrameworkApplication.fa.qa("IsO365ConsumerHost")||u.AFrameworkApplication.fa.qa("IsO365CommercialHost")?
u.AFrameworkApplication.fa.qa("IsAnonymousUser")?(this.qO=2,this.rO=new ka(this.qO)):(qa=r.a.getAuthContext().loginHint)&&qa.length?v.OAuthManagerSettings.wFb?(this.qO=1,this.rO=new t):(this.qO=1,this.rO=new U):(this.qO=3,this.rO=new ka(this.qO)):(this.qO=4,this.rO=new ka(this.qO))}}Mx(){return this.rO?this.rO.bEb()||"Unknown":"None"}Nzh(qa){qa=void 0===qa?null:qa;b.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ba=R.a.Kf();return u.AFrameworkApplication.fa.uqd().then(ua=>{ua?(this.Ozh(),
qa&&(this.rO=qa),b.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.QCh,this.Mx(),Math.floor(R.a.Kf()-Ba))):b.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(R.a.Kf()-Ba));return Promise.resolve(ua)},
()=>{b.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(R.a.Kf()-Ba));return Promise.resolve(!1)})}gvi(){b.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.Mx());const qa=R.a.Kf();return n.get(this.rO.initialize(),2,v.OAuthManagerSettings.wSd).then(Ba=>{if(0===Ba)b.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.Mx(),Math.floor(R.a.Kf()-qa));
else if(1===Ba){b.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-qa));var ua=N.a.Pt();void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.Mx()),ua=Object.assign(new sa.a,{durationMs:Math.floor(R.a.Kf()-qa),extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitFailed",!1,!0,ua))}else 2===Ba&&(b.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.Mx(),Math.floor(R.a.Kf()-qa)),ua=N.a.Pt(),void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.Mx()),ua=Object.assign(new sa.a,{durationMs:Math.floor(R.a.Kf()-qa),extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"StrategyInitTimedOut",!1,!0,ua)));return Promise.resolve(Ba)},()=>{b.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-qa));return Promise.resolve(1)})}RQi(){b.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.Mx());const qa=R.a.Kf();return n.get(this.rO.Ttc(r.a.getAuthContext()),2,v.OAuthManagerSettings.wSd).then(Ba=>{if(0===Ba)b.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.Mx(),Math.floor(R.a.Kf()-qa));else if(1===Ba){b.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-qa));var ua=N.a.Pt();void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.Mx()),ua=Object.assign(new sa.a,
{durationMs:Math.floor(R.a.Kf()-qa),extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"StrategyLoadFailed",!1,!0,ua))}else 2===Ba&&(b.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-qa)),ua=N.a.Pt(),void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.Mx()),ua=Object.assign(new sa.a,{durationMs:Math.floor(R.a.Kf()-qa),extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,
"StrategyLoadTimedOut",!1,!0,ua)));return Promise.resolve(Ba)},()=>{b.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Mx(),Math.floor(R.a.Kf()-qa));return Promise.resolve(1)})}rE(qa,Ba,ua){return this.jLc(qa,Ba,!1,null,"",void 0===ua?null:ua)}dtg(qa,Ba,ua,pa,Ka){return this.jLc(qa,Ba,!0,ua,pa,void 0===Ka?null:Ka)}jLc(qa,Ba,ua,pa,Ka,$a,ha){ha=void 0===ha?0:ha;ha+=1;b.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
qa,this.vWa(qa,Ba),this.Mx(),ha);var cb=N.a.Pt();void 0!==cb&&null!==cb&&(cb.set("AuthLibrary",this.Mx()),cb.set("AppName",qa),cb.set("Target",this.vWa(qa,Ba)),I.Health.instance.recordKpiUsage(Da.kpiName,0,"WacOAuthFC",cb));if(!v.OAuthManagerSettings.isEnabled||this.hne){var Ia;return this.GGd((Ia=new d.a,Ia.IsSuccess=!1,Ia.Token=null,Ia.ErrorCode="NotEnabled",Ia.ErrorMessage="OAuthManager is disabled.",Ia),qa)}const ob=v.OAuthManagerSettings.M6c[qa];if(void 0===ob||null===ob){b.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",qa);var gb;return this.GGd((gb=new d.a,gb.IsSuccess=!1,gb.Token=null,gb.ErrorCode="DisallowedApp",gb.ErrorMessage="Disallowed appName: "+qa,gb),qa)}const Za=R.a.Kf();let da=Za;const ya=this;cb=this.eLg.then(Ta=>{da=R.a.Kf();return ya.$Ai(qa,ob,Ba,ua,pa,Ka,$a,Ta)});Ia=ua?0:v.OAuthManagerSettings.wSd;let ib;gb=(ib=new d.a,ib.IsSuccess=!1,ib.Token=null,ib.ErrorCode="authTokenStrategy_timeout",
ib.ErrorMessage="Auth Strategy timed out after ["+Ia+"] ms when fetching token",ib);let vb=this,eb=this;return n.get(cb,gb,Ia).then(Ta=>ha<=Da.pYi&&(Ta.ErrorCode===Da.frg||Ta.ErrorCode===Da.N6j)?(b.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ha,Math.floor(R.a.Kf()-Za)),vb.jLc(qa,Ba,ua,pa,Ka,$a,ha)):Ta.ErrorCode===Da.izf&&!ua&&(b.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",
ha,Da.T_e),Da.YFh&&vb.rO.IJc()&&vb.rO.lLc(qa,ob,Ba,ua,pa,Ka).then(La=>Promise.resolve(vb.luc(La,qa,Ba,ob,Za,da))).catch(()=>{let La;const fb=(La=new d.a,La.IsSuccess=!1,La.Token=null,La.ErrorCode="authTokenStrategy_failure",La.ErrorMessage="LoginPopup failed, GetToken could not be called",La);return Promise.resolve(vb.luc(fb,qa,Ba,ob,Za,da))}),Da.T_e)?vb.jLc(qa,Ba,!0,pa,Ka,$a,ha):Promise.resolve(vb.luc(Ta,qa,Ba,ob,Za,da))).catch(()=>{let Ta;const La=(Ta=new d.a,Ta.IsSuccess=!1,Ta.Token=null,Ta.ErrorCode=
"authTokenStrategy_failure",Ta.ErrorMessage="Auth Strategy failed with an unknown error",Ta);return Promise.resolve(eb.luc(La,qa,Ba,ob,Za,da))})}$Ai(qa,Ba,ua,pa,Ka,$a,ha,cb){return 1===cb||2===cb?this.GGd(Object.assign(new d.a,{IsSuccess:!1,Token:null,ErrorCode:1===cb?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),qa):this.rO.rE(qa,Ba,ua,pa,Ka,$a,ha).then(Ia=>Promise.resolve(this.wJf(Ia,!0,qa))).catch(Ia=>Promise.resolve(this.wJf(Ia,!1,qa)))}luc(qa,Ba,ua,pa,Ka,$a){const ha=
{},cb=R.a.Kf()-$a;ha.IsSuccess=qa.IsSuccess;ha.ErrorCode=qa.IsSuccess?"Success":qa.ErrorCode||"";ha.ErrorMessage=qa.IsSuccess?"Success":this.vWa(Ba,qa.ErrorMessage||"");ha.Target=this.vWa(Ba,ua||"");ha.TimeInMS=Math.floor(cb);ha.LoadTimeInMS=Math.floor($a-Ka);ha.AuthLibrary=this.Mx();ha.AppName=Ba;ha.AuthorityType=Object(c.a)(f,r.a.tjc());ha.UserType=this.Lki(r.a.getAuthContext());ha.IsAuthSupportedInSession=e.a[this.qO];ha.RequestCount=++this.GPg;ha.AppId=pa;b.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(ha));
qa.IsSuccess||(ua=N.a.Pt(),void 0!==ua&&null!==ua&&(ua.set("AppName",Ba),ua.set("AuthLibrary",this.Mx()),ua.set("ErrorCode",qa.ErrorCode),ua.set("ErrorMessage",this.vWa(Ba,qa.ErrorMessage)),Ba=Object.assign(new sa.a,{durationMs:cb,extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"TryGetTokenFailure",!1,!0,Ba)));return qa}GGd(qa,Ba){b.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ba,this.vWa(Ba,qa.ErrorMessage));
const ua=N.a.Pt();void 0!==ua&&null!==ua&&(ua.set("AppName",Ba),ua.set("AuthLibrary",this.Mx()),ua.set("ErrorCode",qa.ErrorCode),ua.set("ErrorMessage",this.vWa(Ba,qa.ErrorMessage)),Ba=Object.assign(new sa.a,{extendedProperties:ua}),I.Health.instance.recordKpiFailure(Da.kpiName,"FailureBeforeGetToken",!1,!0,Ba));return Promise.resolve(qa)}nuf(qa){return qa===ja.a.vKc}vWa(qa,Ba){return this.nuf(qa)&&Ba?"REDACTED":Ba}Lki(qa){return u.AFrameworkApplication.fa.qa("IsAnonymousUser")?"anonymous":!qa.loginHint||
1>qa.loginHint.length?"empty":-1<qa.loginHint.indexOf("guest#")?"guest":-1<qa.loginHint.indexOf("ext#")?"external":0>qa.upn.indexOf("@")?"no-at":"supported"}fab(){return 1===this.qO}wJf(qa,Ba,ua){let pa=null,Ka=null,$a=null,ha=null;qa?qa.ErrorCode||qa.ErrorMessage?(Ka=qa.ErrorCode?qa.ErrorCode:Da.D5e,$a=qa.ErrorMessage?qa.ErrorMessage:"No message"):qa.Token?Ba?pa=qa.Token:(Ka=Da.Xyj,$a="A rejected promise returned a token."):(Ka=Da.D5e,$a=JSON.stringify(qa)):(Ka=Da.f1i,$a="No result came from Auth Token Strategy");
qa&&qa.Telemetry&&!this.nuf(ua)&&(ha=qa.Telemetry,b.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ha)));if(Ka===Da.UZi||Ka===Da.Nak)Ka=Da.frg,$a="Auth Library Timed Out";Ka===Da.a7g&&-1<$a.indexOf(Da.CTg)&&(Ka=Da.izf);if(Ka||$a)pa=null;return Object.assign(new d.a,{IsSuccess:!!pa,Token:pa,ErrorCode:Ka,ErrorMessage:$a,Telemetry:ha})}static get T_e(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get YFh(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Da.Nak="token_renewal_error";Da.D5e="Exception";Da.f1i="NoResult";Da.Xyj="RejectToken";Da.UZi="monitor_window_timeout";Da.frg="Timeout";Da.N6j="authTokenStrategy_timeout";Da.a7g="login_required";Da.CTg="AADSTS50058";Da.izf="Cookies Disabled";Da.kpiName="OAuthManager";Da.pYi=2;Object(w.a)(Da,"OAuthManager",null,[270])},993:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);var b;(function(c){c[c.unknown=0]="unknown";c[c.supported=1]="supported";c[c.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
c[c.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";c[c.hostUnsupported=4]="hostUnsupported";c[c.perfAutomation=5]="perfAutomation"})(b||(b={}));Object(w.b)("SupportStatus",b)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/1a134e957eb90892448c0a5b8a9c6b2b/EwaTS.vrs.js.map