/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[30],{1279:function(w,D,a){(function(b){a.d(D,"a",function(){return F});var c=a(0),e=a(15),f=a(178),d=a(139),h=a(1285),r=a(39),n=a(263),u=a(46),v=a(384),x=a(202),k=a(65),m=a(94),t=a(16),z=a(21),y=a(43),C=a(1286),J=a(1);class F extends r.a{constructor(K,L,S){super();this.mui=h.a.getTypeName();this.IFb=this.ZW=this.hf=null;this.imageHeight=this.imageWidth=0;this.JQa=this.errorMessage=this.tableData=null;this.Dwd=0;
this.m3c=!1;this.CVe=W=>{if(W){var G={};if((()=>{let I=y.d(this.wxh(W.data));({zu:G}=I);return I})().returnValue){var O=Object(d.a)(Object,G);if("."===O.DataFromPictureWildcard)if(O.SessionId!==this.JQa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
O.CmdType){case "ACK":this.m3c=!0;this.$pg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.JNj();0<this.errorMessage.length?this.Vdg():0<this.tableData.length&&this.oeg();break;case "insert_html":const I=this.$.pa.ua,N={};var T=z.h(this.$).ha.ra.Ye.clone();N.PasteId=f.a.create().toString();N.DestinationRanges=u.s(u.v(T,this.$));T=O.Parameters.split("|",3);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${T[0]}|${T[1]}|${T[2]}.`);T=O.Parameters.indexOf("|");T=O.Parameters.indexOf("|",T+1);T=O.Parameters.indexOf("|",T+1);N.SourceHtml=O.Parameters.substring(T+1);N.CopyOperationId=null;const R=I.Ra(1,I.Ud());R.pasteHtmlParameters=N;v.a(this.$.userOperationManager,(V,sa,U)=>k.g(I,"pasteHtmlContent",R,V,sa,U,null,64),V=>new x.a(204,0,V,1),null);this.Dwd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Dwd.toString()}`)}}}};
this.lui=(W,G)=>{if(W=G.annotation)if(!G.parentPath||1>=G.parentPath.length||G.parentPath[1]!==this.JQa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=W.errorCode;switch(G){case null:case -1:this.errorMessage=t.a.instance.ia(2273);break;case 1:this.errorMessage=t.a.instance.ia(2274);
break;case 2:this.errorMessage=t.a.instance.ia(2275)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${G?G.toString():"null"}.`);this.QEe.stop();this.tableData=W.html;this.m3c&&(0<this.errorMessage.length?this.Vdg():0<this.tableData.length&&this.oeg())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=K;this.augmentationLoopManager=
L;this.uploaderCreator=S;this.initialize()}dispose(){window.removeEventListener("message",this.CVe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}Yfj(K,L){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let S=new Image;S.onload=()=>{var W=document.createElement("canvas");W.width=S.width;W.height=S.height;const G=W.getContext("2d");try{G.drawImage(S,0,0,S.width,S.height)}catch(I){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${I.message}`);
return}let O;try{O=W.toDataURL("image/jpeg")}catch(I){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${I.message}`);return}W=O.split(",");if(2>W.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{W=W[1];try{var T=window.self.atob(W)}catch(I){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${I.message}`);
return}28E5<T.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.w0j()):(this.OJj(this.hf,this.ZW,W,S.width,S.height),URL.revokeObjectURL(S.src),S=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};S.src=K}Eoj(K,L,S,W){this.hf=K;this.ZW=W;this.uploaderCreator.dxi(this.$,L,S,W,this)}OJj(K,L,S,W,G){this.JQa=f.a.create().toString();this.Dwd=0;this.IFb=S;this.imageWidth=W;this.imageHeight=
G;this.errorMessage=this.tableData="";this.m3c=!1;this.$pg=this.$.Jd.Yh("LoadResource","DataFromPictureTaskpaneLaunch");this.$pg.start();this.Aij(K,L);this.QEe=this.$.Jd.Yh("LoadResource","DataFromPictureAnnotation");this.QEe.start();this.dlk()}dlk(){if(this.IFb.length){var K=window.self.atob(this.IFb);var L=new Uint8Array(K.length);for(let S=0;S<K.length;S++)L[S]=K.charCodeAt(S);this.augmentationLoopManager.clk(L,this.JQa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}Aij(K,
L){L.SessionID=this.JQa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;K=new m.a(-859308420,K.method,K.mode,K.Hg,K.tabName);this.$.Ha.kd(K,L)}Lid(K){try{const L=b.from(K,"utf16le").toString("base64");return C.a.HMa(this.JQa,L)}catch(L){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}wxh(K){try{const L=C.a.HMa(this.JQa,K);return b.from(L,"base64").toString("utf16le")}catch(L){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}JNj(){if(this.IFb.length){var K=n.a(this.$).uea("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.Lid(this.IFb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,"onCustomMessage",L,S=>{S&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}oeg(){if(this.tableData.length){var K=
n.a(this.$).uea("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.Lid(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,"onCustomMessage",L,S=>{S&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}Vdg(){if(this.errorMessage.length){var K=
n.a(this.$).uea("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.Lid(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(K,"onCustomMessage",L,S=>{S&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.CVe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.YX().TZ("DataFromPicture").RZ(()=>{}).activateAnnotation({annotationType:this.mui,Yt:!1,AN:this.lui}).build())}}Object(c.a)(F,"DataFromPictureManager",r.a,[506])}).call(this,a(1280).XAg)},1280:function(w,D,a){(function(b){function c(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,Jrk:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(O){return!1}}
function e(G,O){if((f.NR?2147483647:1073741823)<O)throw new RangeError("Invalid typed array length");f.NR?(G=new Uint8Array(O),G.__proto__=f.prototype):(null===G&&(G=new f(O)),G.length=O);return G}function f(G,O,T){if(!(f.NR||this instanceof f))return new f(G,O,T);if("number"===typeof G){if("string"===typeof O)throw Error("If encoding is specified then the first argument must be a string");return r(this,G)}return d(this,G,O,T)}function d(G,O,T,I){if("number"===typeof O)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&O instanceof ArrayBuffer){O.byteLength;if(0>T||O.byteLength<T)throw new RangeError("'offset' is out of bounds");if(O.byteLength<T+(I||0))throw new RangeError("'length' is out of bounds");O=void 0===T&&void 0===I?new Uint8Array(O):void 0===I?new Uint8Array(O,T):new Uint8Array(O,T,I);f.NR?(G=O,G.__proto__=f.prototype):G=n(G,O);O=G}else if("string"===typeof O){I=G;G=T;if("string"!==typeof G||""===G)G="utf8";if(!f.Ftf(G))throw new TypeError('"encoding" must be a valid string encoding');
T=x(O,G)|0;I=e(I,T);O=I.write(O,G);O!==T&&(I=I.slice(0,O));O=I}else O=u(G,O);return O}function h(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');if(0>G)throw new RangeError('"size" argument must not be negative');}function r(G,O){h(O);G=e(G,0>O?0:v(O)|0);if(!f.NR)for(var T=0;T<O;++T)G[T]=0;return G}function n(G,O){var T=0>O.length?0:v(O.length)|0;G=e(G,T);for(var I=0;I<T;I+=1)G[I]=O[I]&255;return G}function u(G,O){if(f.isBuffer(O)){var T=v(O.length)|0;G=e(G,T);if(0===
G.length)return G;O.copy(G,0,0,T);return G}if(O){if("undefined"!==typeof ArrayBuffer&&O.buffer instanceof ArrayBuffer||"length"in O)return(T="number"!==typeof O.length)||(T=O.length,T=T!==T),T?e(G,0):n(G,O);if("Buffer"===O.type&&L(O.data))return n(G,O.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function v(G){if(G>=(f.NR?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.NR?2147483647:
1073741823).toString(16)+" bytes");return G|0}function x(G,O){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||G instanceof ArrayBuffer))return G.byteLength;"string"!==typeof G&&(G=""+G);var T=G.length;if(0===T)return 0;for(var I=!1;;)switch(O){case "ascii":case "latin1":case "binary":return T;case "utf8":case "utf-8":case void 0:return y(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
T;case "hex":return T>>>1;case "base64":return J(G).length;default:if(I)return y(G).length;O=(""+O).toLowerCase();I=!0}}function k(G,O,T){var I=!1;if(void 0===O||0>O)O=0;if(O>this.length)return"";if(void 0===T||T>this.length)T=this.length;if(0>=T)return"";T>>>=0;O>>>=0;if(T<=O)return"";for(G||(G="utf8");;)switch(G){case "hex":G=O;O=T;T=this.length;if(!G||0>G)G=0;if(!O||0>O||O>T)O=T;I="";for(T=G;T<O;++T)G=I,I=this[T],I=16>I?"0"+I.toString(16):I.toString(16),I=G+I;return I;case "utf8":case "utf-8":return z(this,
O,T);case "ascii":G="";for(T=Math.min(this.length,T);O<T;++O)G+=String.fromCharCode(this[O]&127);return G;case "latin1":case "binary":G="";for(T=Math.min(this.length,T);O<T;++O)G+=String.fromCharCode(this[O]);return G;case "base64":return 0===O&&T===this.length?K.N9e(this):K.N9e(this.slice(O,T));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":O=this.slice(O,T);T="";for(G=0;G<O.length;G+=2)T+=String.fromCharCode(O[G]+256*O[G+1]);return T;default:if(I)throw new TypeError("Unknown encoding: "+
G);G=(G+"").toLowerCase();I=!0}}function m(G,O,T,I,N){if(0===G.length)return-1;"string"===typeof T?(I=T,T=0):2147483647<T?T=2147483647:-2147483648>T&&(T=-2147483648);T=+T;isNaN(T)&&(T=N?0:G.length-1);0>T&&(T=G.length+T);if(T>=G.length){if(N)return-1;T=G.length-1}else if(0>T)if(N)T=0;else return-1;"string"===typeof O&&(O=f.from(O,I));if(f.isBuffer(O))return 0===O.length?-1:t(G,O,T,I,N);if("number"===typeof O)return O&=255,f.NR&&"function"===typeof Uint8Array.prototype.indexOf?N?Uint8Array.prototype.indexOf.call(G,
O,T):Uint8Array.prototype.lastIndexOf.call(G,O,T):t(G,[O],T,I,N);throw new TypeError("val must be string, number or Buffer");}function t(G,O,T,I,N){function R(ka,ja){return 1===V?ka[ja]:ka.$uj(ja*V)}var V=1,sa=G.length,U=O.length;if(void 0!==I&&(I=String(I).toLowerCase(),"ucs2"===I||"ucs-2"===I||"utf16le"===I||"utf-16le"===I)){if(2>G.length||2>O.length)return-1;V=2;sa/=2;U/=2;T/=2}if(N)for(I=-1;T<sa;T++)if(R(G,T)===R(O,-1===I?0:T-I)){if(-1===I&&(I=T),T-I+1===U)return I*V}else-1!==I&&(T-=T-I),I=-1;
else for(T+U>sa&&(T=sa-U);0<=T;T--){sa=!0;for(I=0;I<U;I++)if(R(G,T+I)!==R(O,I)){sa=!1;break}if(sa)return T}return-1}function z(G,O,T){T=Math.min(G.length,T);for(var I=[];O<T;){var N=G[O],R=null,V=239<N?4:223<N?3:191<N?2:1;if(O+V<=T)switch(V){case 1:128>N&&(R=N);break;case 2:var sa=G[O+1];128===(sa&192)&&(N=(N&31)<<6|sa&63,127<N&&(R=N));break;case 3:sa=G[O+1];var U=G[O+2];128===(sa&192)&&128===(U&192)&&(N=(N&15)<<12|(sa&63)<<6|U&63,2047<N&&(55296>N||57343<N)&&(R=N));break;case 4:sa=G[O+1];U=G[O+2];
var ka=G[O+3];128===(sa&192)&&128===(U&192)&&128===(ka&192)&&(N=(N&15)<<18|(sa&63)<<12|(U&63)<<6|ka&63,65535<N&&1114112>N&&(R=N))}null===R?(R=65533,V=1):65535<R&&(R-=65536,I.push(R>>>10&1023|55296),R=56320|R&1023);I.push(R);O+=V}G=I.length;if(G<=S)I=String.fromCharCode.apply(String,I);else{T="";for(O=0;O<G;)T+=String.fromCharCode.apply(String,I.slice(O,O+=S));I=T}return I}function y(G,O){O=O||Infinity;for(var T,I=G.length,N=null,R=[],V=0;V<I;++V){T=G.charCodeAt(V);if(55295<T&&57344>T){if(!N){if(56319<
T){-1<(O-=3)&&R.push(239,191,189);continue}else if(V+1===I){-1<(O-=3)&&R.push(239,191,189);continue}N=T;continue}if(56320>T){-1<(O-=3)&&R.push(239,191,189);N=T;continue}T=(N-55296<<10|T-56320)+65536}else N&&-1<(O-=3)&&R.push(239,191,189);N=null;if(128>T){if(0>--O)break;R.push(T)}else if(2048>T){if(0>(O-=2))break;R.push(T>>6|192,T&63|128)}else if(65536>T){if(0>(O-=3))break;R.push(T>>12|224,T>>6&63|128,T&63|128)}else if(1114112>T){if(0>(O-=4))break;R.push(T>>18|240,T>>12&63|128,T>>6&63|128,T&63|128)}else throw Error("Invalid code point");
}return R}function C(G){for(var O=[],T=0;T<G.length;++T)O.push(G.charCodeAt(T)&255);return O}function J(G){var O=K,T=O.fak;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(W,"");if(2>G.length)G="";else for(;0!==G.length%4;)G+="=";return T.call(O,G)}function F(G,O,T,I){for(var N=0;N<I&&!(N+T>=O.length||N>=G.length);++N)O[N+T]=G[N];return N}var K=a(1282);a(1283);var L=a(1284);D.XAg=f;D.Xqk=function(G){+G!=G&&(G=0);return f.jEe(+G)};D.Cqk=50;f.NR=void 0!==b.NR?b.NR:c();D.Urk=f.NR?2147483647:1073741823;
f.from=function(G,O,T){return d(null,G,O,T)};f.NR&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.jEe=function(G){h(G);return e(null,G)};f.V2g=function(G){return r(null,G)};f.isBuffer=function(G){return!(null==G||!G.ELg)};f.compare=function(G,O){if(!f.isBuffer(G)||!f.isBuffer(O))throw new TypeError("Arguments must be Buffers");if(G===O)return 0;
for(var T=G.length,I=O.length,N=0,R=Math.min(T,I);N<R;++N)if(G[N]!==O[N]){T=G[N];I=O[N];break}return T<I?-1:I<T?1:0};f.Ftf=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(G,O){if(!L(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.jEe(0);var T;if(void 0===O)for(T=O=
0;T<G.length;++T)O+=G[T].length;O=f.V2g(O);var I=0;for(T=0;T<G.length;++T){var N=G[T];if(!f.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(O,I);I+=N.length}return O};f.byteLength=x;f.prototype.ELg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?z(this,0,G):k.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,
G)};f.prototype.compare=function(G,O,T,I,N){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===O&&(O=0);void 0===T&&(T=G?G.length:0);void 0===I&&(I=0);void 0===N&&(N=this.length);if(0>O||T>G.length||0>I||N>this.length)throw new RangeError("out of range index");if(I>=N&&O>=T)return 0;if(I>=N)return-1;if(O>=T)return 1;O>>>=0;T>>>=0;I>>>=0;N>>>=0;if(this===G)return 0;var R=N-I,V=T-O,sa=Math.min(R,V);I=this.slice(I,N);G=G.slice(O,T);for(O=0;O<sa;++O)if(I[O]!==G[O]){R=I[O];V=G[O];
break}return R<V?-1:V<R?1:0};f.prototype.includes=function(G,O,T){return-1!==this.indexOf(G,O,T)};f.prototype.indexOf=function(G,O,T){return m(this,G,O,T,!0)};f.prototype.lastIndexOf=function(G,O,T){return m(this,G,O,T,!1)};f.prototype.write=function(G,O,T,I){if(void 0===O)I="utf8",T=this.length,O=0;else if(void 0===T&&"string"===typeof O)I=O,T=this.length,O=0;else if(isFinite(O))O|=0,isFinite(T)?(T|=0,void 0===I&&(I="utf8")):(I=T,T=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var N=this.length-O;if(void 0===T||T>N)T=N;if(0<G.length&&(0>T||0>O)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");I||(I="utf8");for(N=!1;;)switch(I){case "hex":O=Number(O)||0;I=this.length-O;T?(T=Number(T),T>I&&(T=I)):T=I;I=G.length;if(0!==I%2)throw new TypeError("Invalid hex string");T>I/2&&(T=I/2);for(I=0;I<T;++I){N=parseInt(G.substr(2*I,2),16);if(isNaN(N))break;this[O+I]=N}return I;case "utf8":case "utf-8":return F(y(G,this.length-O),this,O,T);case "ascii":return F(C(G),
this,O,T);case "latin1":case "binary":return F(C(G),this,O,T);case "base64":return F(J(G),this,O,T);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":I=G;N=this.length-O;for(var R=[],V=0;V<I.length&&!(0>(N-=2));++V){var sa=I.charCodeAt(V);G=sa>>8;sa%=256;R.push(sa);R.push(G)}return F(R,this,O,T);default:if(N)throw new TypeError("Unknown encoding: "+I);I=(""+I).toLowerCase();N=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.drk||this,0)}};var S=4096;
f.prototype.slice=function(G,O){var T=this.length;G=~~G;O=void 0===O?T:~~O;0>G?(G+=T,0>G&&(G=0)):G>T&&(G=T);0>O?(O+=T,0>O&&(O=0)):O>T&&(O=T);O<G&&(O=G);if(f.NR)O=this.subarray(G,O),O.__proto__=f.prototype;else{T=O-G;O=new f(T,void 0);for(var I=0;I<T;++I)O[I]=this[I+G]}return O};f.prototype.$uj=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,
O,T,I){T||(T=0);I||0===I||(I=this.length);O>=G.length&&(O=G.length);O||(O=0);0<I&&I<T&&(I=T);if(I===T||0===G.length||0===this.length)return 0;if(0>O)throw new RangeError("targetStart out of bounds");if(0>T||T>=this.length)throw new RangeError("sourceStart out of bounds");if(0>I)throw new RangeError("sourceEnd out of bounds");I>this.length&&(I=this.length);G.length-O<I-T&&(I=G.length-O+T);var N=I-T;if(this===G&&T<O&&O<I)for(I=N-1;0<=I;--I)G[I+O]=this[I+T];else if(1E3>N||!f.NR)for(I=0;I<N;++I)G[I+O]=
this[I+T];else Uint8Array.prototype.set.call(G,this.subarray(T,T+N),O);return N};f.prototype.fill=function(G,O,T,I){if("string"===typeof G){"string"===typeof O?(I=O,O=0,T=this.length):"string"===typeof T&&(I=T,T=this.length);if(1===G.length){var N=G.charCodeAt(0);256>N&&(G=N)}if(void 0!==I&&"string"!==typeof I)throw new TypeError("encoding must be a string");if("string"===typeof I&&!f.Ftf(I))throw new TypeError("Unknown encoding: "+I);}else"number"===typeof G&&(G&=255);if(0>O||this.length<O||this.length<
T)throw new RangeError("Out of range index");if(T<=O)return this;O>>>=0;T=void 0===T?this.length:T>>>0;G||(G=0);if("number"===typeof G)for(I=O;I<T;++I)this[I]=G;else for(G=f.isBuffer(G)?G:y((new f(G,I)).toString()),N=G.length,I=0;I<T-O;++I)this[I+O]=G[I%N];return this};var W=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1281))},1281:function(w){var D=function(){return this}();try{D=D||(new Function("return this"))()}catch(a){"object"===typeof window&&(D=window)}w.exports=D},1282:function(w,D){function a(f){var d=
f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}D.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};D.fak=function(f){var d=a(f);var h=d[0];d=d[1];var r=new e(3*(h+d)/4-d),n=0,u=0<d?h-4:h,v;for(v=0;v<u;v+=4)h=c[f.charCodeAt(v)]<<18|c[f.charCodeAt(v+1)]<<12|c[f.charCodeAt(v+2)]<<6|c[f.charCodeAt(v+3)],r[n++]=h>>16&255,r[n++]=h>>8&255,r[n++]=h&255;2===d&&(h=c[f.charCodeAt(v)]<<2|c[f.charCodeAt(v+1)]>>
4,r[n++]=h&255);1===d&&(h=c[f.charCodeAt(v)]<<10|c[f.charCodeAt(v+1)]<<4|c[f.charCodeAt(v+2)]>>2,r[n++]=h>>8&255,r[n++]=h&255);return r};D.N9e=function(f){for(var d=f.length,h=d%3,r=[],n=0,u=d-h;n<u;n+=16383){for(var v=r,x=v.push,k,m=f,t=n+16383>u?u:n+16383,z=[],y=n;y<t;y+=3)k=(m[y]<<16&16711680)+(m[y+1]<<8&65280)+(m[y+2]&255),z.push(b[k>>18&63]+b[k>>12&63]+b[k>>6&63]+b[k&63]);k=z.join("");x.call(v,k)}1===h?(f=f[d-1],r.push(b[f>>2]+b[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],r.push(b[f>>10]+b[f>>
4&63]+b[f<<2&63]+"="));return r.join("")};var b=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(w=0;64>w;++w)b[w]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[w],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(w)]=w;c[45]=62;c[95]=63},1283:function(w,D){D.read=function(a,b,c,e,f){var d=8*f-e-1;var h=(1<<d)-1,r=h>>1,n=-7;f=c?f-1:0;var u=c?-1:1,v=a[b+f];f+=u;c=v&(1<<-n)-1;v>>=-n;for(n+=d;0<n;c=256*c+a[b+f],f+=u,n-=8);d=c&(1<<-n)-1;
c>>=-n;for(n+=e;0<n;d=256*d+a[b+f],f+=u,n-=8);if(0===c)c=1-r;else{if(c===h)return d?NaN:Infinity*(v?-1:1);d+=Math.pow(2,e);c-=r}return(v?-1:1)*d*Math.pow(2,c-e)};D.write=function(a,b,c,e,f,d){var h,r=8*d-f-1,n=(1<<r)-1,u=n>>1,v=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var x=e?1:-1,k=0>b||0===b&&0>1/b?1:0;b=Math.abs(b);isNaN(b)||Infinity===b?(b=isNaN(b)?1:0,e=n):(e=Math.floor(Math.log(b)/Math.LN2),1>b*(h=Math.pow(2,-e))&&(e--,h*=2),b=1<=e+u?b+v/h:b+v*Math.pow(2,1-u),2<=b*h&&(e++,h/=2),e+
u>=n?(b=0,e=n):1<=e+u?(b=(b*h-1)*Math.pow(2,f),e+=u):(b=b*Math.pow(2,u-1)*Math.pow(2,f),e=0));for(;8<=f;a[c+d]=b&255,d+=x,b/=256,f-=8);e=e<<f|b;for(r+=f;0<r;a[c+d]=e&255,d+=x,e/=256,r-=8);a[c+d-x]|=128*k}},1284:function(w){var D={}.toString;w.exports=Array.isArray||function(a){return"[object Array]"==D.call(a)}},1285:function(w,D,a){a.d(D,"a",function(){return c});w=a(0);D=a(766);var b=a(739);class c extends D.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new b.a,
{T_:c.getTypeName(),B_:c.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(w.a)(c,"DetectedHtmlTableAnnotation",D.a,[])},1286:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{static HMa(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";const f=Array(256),d=Array(256);let h,r=0,n=0;let u,v="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var x=c.charCodeAt(h%c.length);if(256<=
x)return"";r=(r+f[h]+x)%256;x=f[h];f[h]=f[r];f[r]=x}for(h=0;256>h;h++)d[h]=f[256-h-1];r=h=0;for(c=0;c<e.length;c++){h=(h+1)%256;r=(r+f[h])%256;x=f[h];f[h]=f[r];f[r]=x;x=e.charCodeAt(c);if(256<=x)return"";u=x^f[(f[h]+f[r])%256];n=(n+d[h])%256;x=d[h];d[h]=d[n];d[n]=x;v+=String.fromCharCode(u^f[(d[h]+d[n])%256])}return v}}Object(w.a)(b,"RC4A",null,[])},1333:function(w,D,a){a.r(D);var b={};a.r(b);a.d(b,"DataFromPictureCommandHandler",function(){return Ld});var c={};a.r(c);a.d(c,"PictureCommandHandler",
function(){return ff});var e={};a.r(e);a.d(e,"AriaLiveNotifier",function(){return Ua});var f={};a.r(f);a.d(f,"EmbeddedWorkbookReadoutHandler",function(){return og});var d={};a.r(d);a.d(d,"WorkbookReadoutHandler",function(){return Eg});var h={};a.r(h);a.d(h,"GridHighlightBehaviorEventManager",function(){return rg});var r={};a.r(r);a.d(r,"GridHighlightsBehaviorManager",function(){return ji});var n={};a.r(n);a.d(n,"TableManager",function(){return jj});var u={};a.r(u);a.d(u,"SessionReloadActivity",function(){return wi});
var v={};a.r(v);a.d(v,"SparklineManager",function(){return bj});var x=a(0),k=a(15),m=a(713),t=a(565),z=a(80),y=a(139),C;(function(A){A[A.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";A[A.cloudPolicySettings=1]="cloudPolicySettings";A[A.alternateAuthToken=2]="alternateAuthToken"})(C||(C={}));Object(x.b)("ApplicationFeatureHelperRequestType",C);class J{constructor(){this.message=null;this.J8=0}}Object(x.a)(J,"HttpRequstToPromiseRejectData",null,[]);var F=a(105),K=a(63),L=a(219),
S=a(476);class W{constructor(A,ea){this.Pa=A;this.Ei=ea}OMa(A,ea,Ma,Vb,tc,Jc,ld,Zd){Vb=void 0===Vb?null:Vb;tc=void 0===tc?null:tc;Jc=void 0===Jc?null:Jc;ld=void 0===ld?null:ld;Zd=void 0===Zd?null:Zd;const De=C[Ma],Ve=De+"RequestFailure";F.Health.instance.recordKpiUsage(Ve,0,"jpittsdirects",null);return new Promise((Se,sf)=>{k.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",De);const Of=null!=ld?ld:this.Pa.Af("ApplicationFeatureHelperRequestQueueTimeout",
15E3),qg=null!=Zd?Zd:this.Pa.Af("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Ei.r6(A,1,null,this.iDb(Ma,Vb),Jc,!1,1,yg=>{k.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",De);try{if(void 0===yg||null===yg||void 0===yg.data||null===yg.data||void 0===yg.data.Lf||null===yg.data.Lf){F.Health.instance.recordKpiFailure(Ve,"Invalid RequestSucceededEventArgs",!1,!0,null);let Cg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
De);sf(this.pK(Cg,yg))}else if(yg.data.httpStatus!==L.a.zE){F.Health.instance.recordKpiFailure(Ve,"HttpStatusCode_"+yg.data.httpStatus.toString(),!1,!0,null);let Cg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",yg.data.httpStatus,De);sf(this.pK(Cg,yg))}else{void 0!==tc&&null!==tc&&void 0!==yg.data.responseHeaders&&null!==yg.data.responseHeaders&&tc(yg.data.responseHeaders);
var lg=ea(yg.data.Lf);if(lg)k.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",De),Se(lg);else{F.Health.instance.recordKpiFailure(Ve,"Parse Failure",!1,!0,null);let Cg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",De);sf(this.pK(Cg,yg))}}}catch(Cg){F.Health.instance.recordKpiFailure(Ve,"Unexpected Failure",!1,!0,null),lg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Cg,De),sf(this.pK(lg,yg))}},yg=>{if(yg.data){F.Health.instance.recordKpiFailure(Ve,"HttpStatusCode_"+yg.data.httpStatus.toString(),!1,!0,null);var lg=S.a.NPa(yg.data.Lf||"No Data");lg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",yg.data.httpStatus,lg,De)}else F.Health.instance.recordKpiFailure(Ve,"Invalid RequestFailedEventArgs",!1,!0,null),lg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
De);sf(this.pK(lg,yg))},null,void 0,void 0,Of,qg)})}pK(A,ea){const Ma=new J;Ma.message=A;Ma.J8=ea&&ea.data?ea.data.httpStatus:-1;return Ma}iDb(A,ea){const Ma={};Ma["x-UserDataSignature"]=this.Pa.Ta("UserDataSignature");Ma["x-LicensingIsEnabled"]=this.Pa.qa("LicensingIsEnabled").toString();Ma["x-CacheIsEnabled"]=this.Pa.qa("LicensingRedisIsEnabled").toString();Ma["x-OcpsIsEnabled"]=this.Pa.qa("OcpsIsEnabled").toString();Ma["x-LicensingAADIdIsEnabled"]=this.Pa.qa("LicensingAadIdIsEnabled").toString();
0===A&&(Ma["x-LicenseCheckOnTenantEnabled"]="true",Ma["x-SupportUserConsentDependentFeatures"]="true",Ma["x-AFHUserConsentGroupValue"]="0",Ma["x-UseShellServiceForUserConsentGroup"]="true",Ma["x-SMBUserLicensingEnabled"]="true",Ma["x-AFHPIPLComplianceEnabled"]=K.a.Tv(window.location.href,"wd_afhpipl")||"false",Ma["x-ConsumerLicensingSNICertIsEnabled"]=this.Pa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Ma["x-MSGraphInLicensingIsEnabled"]=
this.Pa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(ea)for(let Vb of ea.keys)Ma[Vb]=ea.ma(Vb);return Ma}}Object(x.a)(W,"HttpRequestToPromiseUtility",null,[]);var G=a(6),O;(function(A){A[A.loki=0]="loki";A[A.augloopACLP=1]="augloopACLP"})(O||(O={}));Object(x.b)("AlternateAuthSupportApp",O);var T=a(430),I=a(43);class N{constructor(){this.Token=null;this.ExpirationTime=0}}Object(x.a)(N,"WacAlternateAuthToken",null,[]);class R{constructor(A,ea){this.Mak=
3E5;if(void 0===A||null===A||void 0===ea||null===ea)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Pa=A;this.oZb=new m.a(t.a.Qh());this.apb=new W(A,ea);void 0!==T.OAuthManagerSettings.wHd&&null!==T.OAuthManagerSettings.wHd&&void 0!==T.OAuthManagerSettings.suc&&null!==T.OAuthManagerSettings.suc&&0<T.OAuthManagerSettings.suc&&(A=new N,A.Token=T.OAuthManagerSettings.wHd,A.ExpirationTime=T.OAuthManagerSettings.suc,this.oZb.ga("loki",A))}B2h(){let A=null;this.oZb.Wc(O[0])&&(A=
this.oZb.ma(O[0]));return void 0===A||null===A||this.HDd(A)?this.wUh():Promise.resolve(A.Token)}HDd(A){return A.ExpirationTime-Date.now()<this.Mak}wUh(){const A=new m.a(t.a.Qh());A.ga("X-AlternateAuthApp",O[0]);return this.apb.OMa(this.Hea("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.$jj,"parseAlternateAuthTokenResponse"),2,A).then(ea=>{k.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",O[0]);this.oZb.ga(O[0],
ea);return ea.Token},ea=>{ea=Object(y.a)(J,ea);k.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",ea.message,ea.J8);return null})}$jj(A){let ea=null;({zu:ea}=I.d(A));k.ULS.sendTraceTag(545821457,3004,ea?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",A);return ea}Hea(A){const ea=this.Pa.qa("SuiteOriginForAFHSIsEnabled")?this.Pa.Ta("SuiteOrigin"):this.Pa.Ta("WebServiceBase");return String.format("{0}{1}?{2}",
ea,A,G.AFrameworkApplication.tk)}}Object(x.a)(R,"AlternateAuthHelper",null,[273]);var V=a(468);class sa{constructor(A,ea,Ma){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=A;this.isEnabled=ea;this.tierName=Ma}}Object(x.a)(sa,"FeatureStateChangeArgs",null,[]);var U=a(145),ka=a(264),ja=a(33),Da=a(119),qa=a(178),Ba;(function(A){A[A.Enabled=0]="Enabled";A[A.Disabled=1]="Disabled"})(Ba||(Ba={}));Object(x.b)("FeatureState",Ba);var ua=a(84),pa=a(28),Ka=a(177);class $a{constructor(A,
ea,Ma,Vb,tc){Ma=void 0===Ma?null:Ma;Vb=void 0===Vb?null:Vb;tc=void 0===tc?null:tc;this.Oya=this.W3b=this.Hte=this.Tua=this.Y4b=null;this.apb=new W(A,ea);this.Pa=A;this.PMg=A.Af("LicensingMaxRetryAttempts",0);this.B1b=A.qa("IsO365ConsumerHost");this.bWc=A.qa("IsO365CommercialHost");this.LVc=A.qa("PremiumUpsellIsEnabled");this.v0a=!1;this.iXc=0;this.Lge=Ma;this.Xxe=Vb;this.Oa=tc;this.Sua=A.qa("LicensingIsEnabled");this.cJa=A.qa("OcpsIsEnabled")&&this.bWc;this.G2c=A.qa("ShowPrivacyDialog")&&!!Vb;this.lVc=
A.qa("IsAnonymousUser");this.yhc=new Promise(Jc=>{Jc(!1)});this.aGa=new Promise(Jc=>{Jc(!0)});this.Nya=new m.a(t.a.Qh());this.N5b=!0;this.Toe=this.dbi();this.DBd()&&!this.lVc?(void 0!==G.AFrameworkApplication.sa&&null!==G.AFrameworkApplication.sa&&(this.Y4b=G.AFrameworkApplication.sa.tG,void 0!==this.Y4b&&null!==this.Y4b&&(this.Tua=this.Y4b.Yh("WebServiceCall","ApplicationFeatureHelperService"))),this.Oya=this.G9d()):this.Oya=new Promise(Jc=>{Jc({})});this.Oya.catch(Jc=>{Jc=Object(y.a)(J,Jc);k.ULS.sendTraceTag(42513088,
3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Jc?Jc.J8.toString():"Unknown")});this.N5b&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Jc=>{this.v0a=Jc;return null})}dbi(){const A=this.Pa.Mr("AllLicensedFeatures")?this.Pa.Ox("AllLicensedFeatures"):[],ea=new V.a;for(let Ma=0;Ma<A.length;Ma++)ea.add(A[Ma]);return ea}DBd(){return this.bWc||this.B1b}G9d(A,ea){A=void 0===A?0:A;ea=void 0===ea?!1:ea;k.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",
ea);const Ma=U.a.Pt();Ma&&(Ma.set("retryAttempt",A.toString()),Ma.set("forceRefresh",ea.toString()),Ma.set("isO365ConsumerHost",this.B1b.toString()),Ma.set("isO365CommercialHost",this.bWc.toString()),Ma.set("isFreemiumUpsellSettingEnabled",this.LVc.toString()));F.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ma);F.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",Ma);void 0!==this.Tua&&null!==this.Tua&&this.Tua.start();let Vb=
null;ea&&(Vb=new m.a(t.a.Qh()),Vb.ga("x-LicensingForceRefresh","true"));this.Hte=new Date;return(this.Sua?this.apb.OMa(this.Hea("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.dkj,"parseApplicationFeatureHelperResponse"),0,Vb,Object(z.a)(this,this.Mpj,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(tc=>{const Jc=Object.assign(new Ka.a,{durationMs:this.Zng()});Jc.extendedProperties=Ma;Jc.extendedProperties&&tc&&(Jc.extendedProperties.set("featureCount",
Da.a.count(tc).toString()),Jc.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in tc).toString()),Jc.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in tc).toString()),"FreemiumUpsell"in tc&&Jc.extendedProperties.set("isFreemiumUpsellEnabled",tc.FreemiumUpsell.toString()),this.W3b&&Jc.extendedProperties.set("fromCache",(this.W3b<this.Hte).toString()));F.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Jc);return tc},tc=>{const Jc=Object.assign(new Ka.a,
{durationMs:this.Zng()}),ld=Object(y.a)(J,tc);if(!ld)return k.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),F.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Jc),new Promise((Zd,De)=>{De(tc)});Jc.extendedProperties=Ma;Jc.extendedProperties&&Jc.extendedProperties.set("status",ld.J8.toString());F.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Jc);return 408===ld.J8&&++A<=this.PMg?this.G9d(A):new Promise((Zd,De)=>{De(ld)})})}dkj(A){(A=I.b(A))?(k.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),k.ULS.sendTraceTag(50938594,3004,50,"{0}",A)):k.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return A.Features}Hea(A){var ea=this.Pa.qa("SuiteOriginForAFHSIsEnabled")?this.Pa.Ta("SuiteOrigin"):
this.Pa.Ta("WebServiceBase");ea=String.format("{0}{1}",ea,A);this.Pa.Mr("ApplicationFeatureHelperHttpCachingEnabled")&&this.Pa.qa("ApplicationFeatureHelperHttpCachingEnabled")&&(A=$a.Ikc(this.Pa))&&0<A.length&&(this.N5b&&(A+="ucbf"),ea=new ka.QueryStringBuilder(ea),ea.$i("afhskey",A),ea=ea.toString());return ea}isFeatureEnabled(A,ea){if(!this.cJa&&!this.G2c&&!this.Sua)return this.aGa;k.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
A);if("ConnectedServices"===A){var Ma=this.cJa?this.Lge.P1("ControllerConnectedServicesEnabled"):this.aGa;const Jc=this.G2c?this.Xxe.getSettings().then(ld=>2!==ld.Hw,()=>ea):this.aGa;return Ma.then(ld=>ld?Jc:this.yhc)}if("FreemiumUpsell"===A&&(!this.LVc||!this.B1b||this.lVc))return this.yhc;Ma=null;Ma=this.cJa?this.Lge.isFeatureEnabled(A):this.aGa;let Vb=null;Vb=this.Sua?this.UEi(A,ea):this.aGa;let tc=null;tc=this.G2c?this.Xxe.isFeatureEnabled(A):this.aGa;return Ma.then(Jc=>Jc?tc.then(ld=>ld?Vb:this.yhc):
this.yhc).then(Jc=>{this.dDf(A,Jc,!0);return Jc},()=>{this.dDf(A,ea,!1);return ea})}dDf(A,ea,Ma){k.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",A,ea,Ma)}getFeatureTier(A,ea){if(!this.Sua)return new Promise(Ma=>{Ma(2)});k.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",A);return this.Oya.then(Ma=>this.Elc(A,Ma,ea),()=>ea)}isFreemiumUpsellEnabled(){if(this.LVc&&this.B1b&&!this.lVc){if(this.v0a&&2!==this.iXc||
!this.v0a&&1!==this.iXc)k.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.v0a.toString()),this.iXc=this.v0a?2:1;return this.v0a}return!1}launchUpsellExperience(A,ea){ea=void 0===ea?null:ea;k.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",A));var Ma=U.a.Pt();Ma&&(Ma.set("experienceId",A),ea&&Ma.set("campaignId",ea));F.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Ma);if(Ma=ua.a.instance.ai("Common.IInProductMessagingUIManager")){const Vb=Object(z.a)(this,this.Cni,"handleDimeTaskComplete");Ma.bBf(A,Vb,ea)}else k.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),F.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Oa.Sf(pa.a.Qic,2,{["experience"]:A})}AVa(A,ea){if(!this.Sua)return null;if(!A||!ea)return k.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const Ma=qa.a.create().toString();this.Nya.Wc(A)||this.Nya.ga(A,new m.a(t.a.Qh()));this.Nya.ma(A).add(Ma,ea);k.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ma,A));return Ma}gVd(A,ea){this.Sua&&(A&&this.Nya.Wc(A)?ea&&qa.a.isValid(ea)?this.Nya.ma(A).Wc(ea)?(k.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
ea,A)),this.Nya.ma(A).remove(ea)):k.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",ea,A)):k.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",ea,A)):k.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
A)))}Elc(A,ea,Ma){return this.N5b?A in ea?ea[A].LicenseTier:Ma:A in ea?this.ykj(ea[A],Ma):Ma}ykj(A,ea){switch(A.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return ea}}Cni(){k.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Oya.then(A=>{this.E4f(A)}).catch(()=>{this.E4f({})})}E4f(A){k.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const ea=this.G9d(0,
!0);ea.then(Ma=>{this.Oya=ea;Da.a.count(Ma)>Da.a.count(A)?F.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):F.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let Vb of this.Nya.keys)if(Vb in Ma){const tc=this.Elc(Vb,Ma,0);Vb in A?this.Elc(Vb,A,0)!==tc&&this.kLd(Vb,!0,tc):this.kLd(Vb,!0,tc)}else Vb in A&&this.kLd(Vb,!1,this.Elc(Vb,A,0))}).catch(Ma=>{F.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);k.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ma))})}kLd(A,ea,Ma){k.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",A,ea,Ma);ea=new sa(A,ea,Ma);Ma=this.Nya.ma(A);for(let Vb of Ma)try{Vb.value(ea)}catch(tc){k.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
A,Vb.key,tc.message))}}Gf(A,ea){if(this.Sua){const Ma=this.Toe.contains(A);let Vb=!0,tc="",Jc=!1;return this.Oya.then(ld=>{A in ld?(ld=ld[A],tc=Ba[ld.FeatureState],Vb=1!==ld.FeatureState):Vb=!Ma;this.pDf(A,Ma,tc,Jc,ea,Vb);return Vb},()=>{Jc=!0;Ma&&(Vb=ea);this.pDf(A,Ma,tc,Jc,ea,Vb);return Vb})}return this.aGa}pDf(A,ea,Ma,Vb,tc,Jc){k.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",A,ea,
Vb,Ma,tc,Jc)}UEi(A,ea){if(this.N5b)return this.Gf(A,ea);if(this.Sua){if(this.Toe.contains(A))return this.Oya.then(Ma=>A in Ma,()=>ea);k.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",A)}return this.aGa}Mpj(A){try{A&&"Date"in A&&(this.W3b=new Date(A.Date),k.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.W3b.toString()))}catch(ea){k.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",ea)}}Zng(){if(void 0!==this.Tua&&null!==this.Tua){const A=this.Tua.Ee;this.Tua.stop();return A}return null}static Ikc(A){try{if(ja.a.M7j){const ea=A.Ta("UserDataSignature").split(".");if(1<ea.length){const Ma=window.self.atob(ea[1]),Vb=JSON.parse(Ma).LocalStorageKey;if(void 0!==Vb&&null!==Vb&&0<Vb.length)return Vb}}}catch(ea){k.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",ea.toString())}return null}}
Object(x.a)($a,"ApplicationFeatureHelper",null,[274]);var ha=a(200);class cb{constructor(A,ea){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=A.PolicySettings;A=new Date;A.setMinutes(A.getMinutes()+ea);this.ExpirationTime=A.getTime()}}Object(x.a)(cb,"CloudPolicySettingsCacheData",null,[]);var Ia=a(833),ob=a(470),gb=a(269);class Za{static emg(){return G.AFrameworkApplication.fa.qa("SideCarIsEnabled")?Za.$Ec&&Za.Yzd?new Promise(A=>{A(!0)}):new Promise((A,ea)=>{Za.$Ec=gb.a.create(G.AFrameworkApplication.fa.Ta("SideCarUrl"));
ob.a.Aya(Za.$Ec);Za.$Ec.Eka((Ma,Vb)=>{(Za.Yzd=Vb.succeeded)?A(Vb.succeeded):ea(Vb.succeeded)})}):new Promise(A=>{A(!1)})}}Za.Yzd=!1;Za.$Ec=null;Object(x.a)(Za,"SideCarLoader",null,[]);class da{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(x.a)(da,"CloudPolicySettingsData",null,[]);class ya{constructor(A,ea){this.TQc=0;this.ebc=null;this.apb=new W(A,ea);this.Pa=A;ea=A.Ta("HostAuthType");this.cJa=A.qa("OcpsIsEnabled")&&A.qa("IsO365CommercialHost")&&!(void 0===
ea||null===ea)&&"aad"===ea.toLowerCase();this.bre=I.b(A.Ta("OcpsDefaultSettings")||"{}");this.$pb=this.Ikc();ea=this.Pa.Mr("ServicesControlsMicrosoftControllerServicesList")?this.Pa.Ox("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.p_b=new V.a;for(let Ma=0;Ma<ea.length;Ma++)this.p_b.add(ea[Ma]);this.cJa&&!A.qa("IsAnonymousUser")&&A.qa("SideCarIsEnabled")?this.ebc=this.$dk():this.ebc=this.Wsa(this.cJa,this.Hea("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.ekj,"parseCloudPolicySettingsResponse"));
this.ebc.then(()=>null).catch(Ma=>{Ma=Object(y.a)(J,Ma);k.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ma?Ma.J8.toString():"Unknown")})}P1(A,ea){ea=void 0===ea?!0:ea;if(!this.cJa){const Jc=this;return new Promise(ld=>{ld(Jc.DDb(A))})}let Ma=this,Vb=this;const tc=this.ebc.then(Jc=>{try{let ld=null;Jc.PolicySettings&&"unknown"in Jc.PolicySettings&&(ld=Jc.PolicySettings.unknown);if(ld){if(A in ld&&void 0!==ld[A]&&null!==ld[A])return new Promise(De=>
{De("0"!==ld[A])});const Zd=A.toLowerCase();if(Zd in ld&&void 0!==ld[Zd]&&null!==ld[Zd])return new Promise(De=>{De("0"!==ld[Zd])});k.ULS.sendTraceTag(51512667,3004,50,"Policy"+A+" not found, using default");return new Promise(De=>{De(Ma.DDb(A))})}return new Promise(Zd=>{Zd(Ma.DDb(A))})}catch(ld){return k.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+A+" policy value. Error Message: {0}",ld.message),Ma.handleError(ld.toString(),ea,Ma.DDb(A))}},Jc=>Vb.handleError(Jc,ea,Vb.DDb(A)));tc.then(Jc=>
{k.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",A,Jc);return null});return tc}isFeatureEnabled(A,ea){ea=void 0===ea?!0:ea;if(this.Pa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.WEi(A,ea);let Ma=new Promise(tc=>{tc(!0)}),Vb="";this.p_b.contains(A)&&(Vb="ControllerConnectedServicesEnabled",Ma=this.P1(Vb,ea));Ma.then(tc=>{k.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
A,tc,Vb);return null});return Ma}WEi(A,ea){ea=void 0===ea?!0:ea;let Ma=new Promise(tc=>{tc(!0)}),Vb="";"mso_sendASmile"===A?Vb="Enabled":"Survey"===A||"FloodgateSurvey"===A?Vb="SurveyEnabled":this.p_b.contains(A)&&(Vb="ControllerConnectedServicesEnabled");""!==Vb&&(Ma=this.P1(Vb,ea));Ma.then(tc=>{k.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",A,tc,Vb);return null});return Ma}handleError(A,ea,Ma){return ea?new Promise(Vb=>
{Vb(Ma)}):new Promise((Vb,tc)=>{tc(A)})}Wsa(A,ea,Ma){if(!A)return Promise.resolve(new da);let Vb=!1,tc=null;F.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Jc=this.Gdd("GetCloudPolicySettings");return(new Promise((ld,Zd)=>{if(void 0!==this.$pb&&null!==this.$pb&&0<this.$pb.length){const De=this.Mdk();if(void 0!==De&&null!==De){Vb=!0;ld(De);return}}this.apb.OMa(ea,Ma,1,null,Object(z.a)(this,this.Rpj,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],
this.Pa.Af("CloudPolicySettingsRequestQueueTimeout",15E3),this.Pa.Af("CloudPolicySettingsRequestSentTimeout",3E4)).then(De=>{k.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.zek(De);ld(De);return De},De=>{Zd(De);return null})})).then(ld=>{({stopwatch:Jc,returnValue:tc}=this.cJc(Jc));var Zd=U.a.Pt();Zd&&Zd.set("FromCache",Vb.toString());Zd=Object.assign(new Ka.a,{durationMs:tc,extendedProperties:Zd});F.Health.instance.recordKpiSuccess("GetCloudPolicySettings",
Zd);return ld})}$dk(){return Za.emg().then(()=>{k.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Hea(A){const ea=this.Pa.qa("SuiteOriginForAFHSIsEnabled")?this.Pa.Ta("SuiteOrigin"):this.Pa.Ta("WebServiceBase");return String.format("{0}{1}",ea,A)}ekj(A){let ea=null;({zu:ea}=I.d(A));A=!!ea;k.ULS.sendTraceTag(50622687,3004,A?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
A);return ea}Rpj(A){try{if(void 0!==A&&null!==A&&"CheckIn-Interval"in A){const ea=parseInt(A["CheckIn-Interval"]);void 0!==ea&&null!==ea&&0<ea&&(this.TQc=ea)}}catch(ea){k.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",ea)}}DDb(A){return A in this.bre?"0"!==this.bre[A]:!0}Mdk(){try{const A=Ia.a.instance.getItem(this.$pb);if(void 0===A||null===A)return k.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;k.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",A);const ea=JSON.parse(A);if(void 0===ea||null===ea)return k.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===ea.ExpirationTime||null===ea.ExpirationTime)return k.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),
null;if((new Date(ea.ExpirationTime)).getTime()<Date.now())return k.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const Ma=new da;Ma.PolicySettings=ea.PolicySettings;Ma.ControllerConnectedServicesFeatureNames=new ha.a;this.Pa.Mr("ServicesControlsMicrosoftControllerServicesList")&&this.Pa.Ox("ServicesControlsMicrosoftControllerServicesList");for(let Vb of this.p_b)Ma.ControllerConnectedServicesFeatureNames.add(Vb);k.ULS.sendTraceTag(51662941,3004,
50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ma}catch(A){return k.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",A.toString()),null}}zek(A){try{if(void 0===A||null===A||void 0===A.PolicySettings||null===A.PolicySettings)k.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.TQc)k.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const ea=new cb(A,this.TQc),Ma=JSON.stringify(ea);k.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ma);Ia.a.instance.setItem(this.$pb,Ma);k.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ea){k.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ea.toString())}}Ikc(){const A=$a.Ikc(this.Pa);return A&&0<A.length?"OCPS"+A:null}Gdd(A){const ea=ua.a.instance.ai("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==ea&&null!==ea?ea.Le("WebServiceCall",A):null}cJc(A){if(void 0!==A&&null!==A){const ea=A.Ee;A.stop();return{returnValue:ea,stopwatch:null}}return{returnValue:null,stopwatch:A}}}Object(x.a)(ya,"CloudPolicySettingsHelper",null,[271]);class ib{constructor(){this.iZe=this.Sxg=this.Hw=0;this.jZe=this.Txg=this.GMa="";this.k1c=this.zia=2}clone(){const A=new ib;A.Hw=this.Hw;A.Sxg=this.Sxg;A.iZe=this.iZe;A.GMa=this.GMa;A.Txg=this.Txg;A.jZe=this.jZe;A.zia=this.zia;A.k1c=this.src;return A}get src(){return this.k1c}serialize(A){A=
void 0===A?null:A;const ea={};if(!A||A.contains(ib.ATa))ea[ib.ATa]=this.Hw;if(!A||A.contains(ib.GMb))ea[ib.GMb]=this.GMa;if(!A||A.contains(ib.HMb))ea[ib.HMb]=this.zia;return JSON.stringify(ea)}static create(A,ea){ea=void 0===ea?null:ea;const Ma=new ib;Ma.k1c=A;void 0!==ea&&null!==ea&&(ib.ATa in ea&&(Ma.Hw=ea[ib.ATa]),ib.GMb in ea&&(Ma.GMa=ea[ib.GMb]),ib.HMb in ea&&(Ma.zia=ea[ib.HMb]));return Ma}static deserialize(A,ea){try{const Ma=JSON.parse(A);if(void 0!==Ma&&null!==Ma)return ib.create(ea,Ma);k.ULS.sendTraceTag(50860946,
306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",A);throw Error.argument("settingsData");}catch(Ma){throw k.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ma.toString()),Ma;}}}ib.ATa="CCS";ib.GMb="CCSTime";ib.HMb="OfficePrivacyRoamedNoticeShown";Object(x.a)(ib,"UserPrivacySettings",null,[]);var vb=a(149);class eb{constructor(A,ea){if(void 0===A||null===A||void 0===ea||null===ea)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Pa=A;this.Ei=ea;this.D0c=this.ig=null}Hea(A){var ea=String.format("{0}RoamingServiceHandler.ashx?action=",this.Pa.appSettings.RoamingServiceHandlerWebServiceBase||"");ea=new Sys.StringBuilder(ea);ea.append(A);ea.append("&");ea.append(G.AFrameworkApplication.tk);return ea.toString()}executeRequest(A,ea,Ma,Vb){return this.Ei.uKa(A,ea,void 0===Vb?null:Vb,null,Ma,"33",!1,null,6E4)}saveSettings(A){return new Promise((ea,Ma)=>{try{if(void 0===this.ig||null===this.ig||void 0===A||null===A)k.ULS.sendTraceTag(51258443,
3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ma("Can't determine setting changes to save");else{var Vb=this.ig.Hw!==A.Hw;if(2===this.ig.src&&Vb)this.HKj(A),ea(!0);else{var tc=this.FOj(A);if(void 0===tc||null===tc||!tc.length)k.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ma("No changes to save");else if(1===this.ig.src)ea(this.ttg(tc));else if(0===this.ig.src){k.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",
tc);const Jc=this.executeRequest(this.Hea("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",tc);Jc.continueWith(()=>{if(Jc.jj||Jc.Gh)k.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),ea(!1);else{var ld=Jc.result;void 0!==ld.uh&&null!==ld.uh&&void 0!==ld.uh.data&&null!==ld.uh.data&&ld.uh.data.httpStatus===L.a.zE?(k.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),ea(!0)):(k.ULS.sendTraceTag(51258446,3004,
10,"SaveUserPrivacySettings: Roaming Request Failed"),ea(!1))}})}}}}catch(Jc){k.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Jc.toString()),ea(!1)}})}FOj(A){if(void 0===this.ig||null===this.ig||void 0===A||null===A)throw Error.invalidOperation("User Privacy settings have not been initialized");const ea=new ha.a;0===A.src?(this.ig.Hw!==A.Hw&&(ea.add(ib.ATa),ea.add(ib.GMb)),this.ig.zia!==A.zia&&ea.add(ib.HMb)):1===A.src&&this.ig.Hw!==A.Hw&&ea.add(ib.ATa);return ea.count?
A.serialize(ea):(k.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.D0c){const A=this;this.D0c=new Promise(ea=>{try{A.ig?ea(A.ig.clone()):A.Udk().then(Ma=>{A.ig=Ma;ea(A.ig.clone());return null},()=>{A.Sdk().then(Ma=>{A.ig=Ma;ea(A.ig.clone());return null},()=>{A.Tdk().then(Ma=>{A.ig=Ma;ea(A.ig.clone());return null},()=>{k.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");
A.ig=new ib;ea(A.ig.clone());return null});return null});return null})}catch(Ma){k.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ma.toString()),A.ig=new ib,ea(A.ig.clone())}})}return this.D0c}Udk(){return new Promise((A,ea)=>{try{const Vb=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Pa.qa("PrivacyDialogShouldCheckRoaming")||Vb){var Ma=this.executeRequest(this.Hea("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ma.continueWith(()=>{try{if(Ma.jj||
Ma.Gh)k.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const tc=Ma.result;if(tc&&tc.uh&&tc.uh.data)if(tc.uh.data.httpStatus!==L.a.zE)k.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",tc.uh.data.httpStatus);else{if(tc.uh.data.Lf){A(eb.parse(tc.uh.data.Lf,0));k.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",tc.uh.data.Lf);
return}k.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else k.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");ea("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(tc){k.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",tc.toString()),ea("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else k.ULS.sendTraceTag(50860933,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),ea("Roaming should not be used")}catch(Vb){k.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",Vb.toString()),ea("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Sdk(){return new Promise((A,ea)=>{try{const Ma=vb.a.get("WacUPToggleState");let Vb=null;void 0!==Ma&&null!==Ma&&0<Ma.length&&(Vb=decodeURIComponent(Ma));if(void 0!==Vb&&null!==Vb&&0<Vb.length){const tc=eb.parse(Vb,
1);k.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",tc.toString());A(tc)}else{const tc=ib.create(1),Jc=new ha.a;Jc.add(ib.ATa);const ld=tc.serialize(Jc);this.ttg(ld)?(k.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ld),A(tc)):(k.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ld),ea("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ma){k.ULS.sendTraceTag(50860941,
3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",Ma.toString()),ea("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Tdk(){return new Promise(A=>{try{var ea=-1!==window.location.href.indexOf("&wdccsoff=1");let Ma=ib.create(2);ea?(Ma.Hw=2,G.AFrameworkApplication.OXe(),k.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ma.toString())):(Ma.Hw=1,k.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Ma.toString()));A(Ma)}catch(Ma){k.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ma.toString()),ea=ib.create(2),ea.Hw=1,A(ea)}})}HKj(A){k.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===A.Hw?G.AFrameworkApplication.OXe():G.AFrameworkApplication.UFh();k.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",A)}ttg(A){try{k.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",
A);const ea=this.Pa.Ta("PrivacyCookieDomain")||"";if(!ea||!ea.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");k.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",A);return vb.a.N1d("WacUPToggleState",A,vb.a.VY,"/",ea)}catch(ea){return k.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",ea.toString()),!1}}isFeatureEnabled(A){return this.getSettings().then(ea=>{const Ma=this.Pa.Mr("ServicesControlsMicrosoftControllerServicesList")?
this.Pa.Ox("ServicesControlsMicrosoftControllerServicesList"):[],Vb=new V.a;for(let tc=0;tc<Ma.length;tc++)Vb.add(Ma[tc]);return Vb.contains(A)?2!==ea.Hw:!0},()=>{k.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",A);return!0})}static parse(A,ea){try{return k.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",A,ea),ib.deserialize(A,ea)}catch(Ma){throw k.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ma.toString()),
Ma;}}}Object(x.a)(eb,"UserPrivacySettingsHelper",null,[272]);var Ta=a(261);class La{constructor(){this.Rc=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Oj(A){this.Rc=A;this.Rc.register(271,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").se().Ae(()=>new ya(G.AFrameworkApplication.fa,G.AFrameworkApplication.mf));this.Rc.register(272,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").se().Ae(()=>new eb(G.AFrameworkApplication.fa,
G.AFrameworkApplication.mf));this.Rc.register(273,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").se().Ae(()=>new R(G.AFrameworkApplication.fa,G.AFrameworkApplication.mf));this.Rc.register(274,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").se().Ae(()=>new $a(G.AFrameworkApplication.fa,G.AFrameworkApplication.mf,this.Rc.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Rc.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
G.AFrameworkApplication.jd))}init(){G.AFrameworkApplication.fa.Xw(()=>{const A=this.Rc.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");G.AFrameworkApplication.fa.qa("LicensingIsEnabled")&&(A.isFeatureEnabled("LicensingTestFeature",!1).then(ea=>{k.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ea,G.AFrameworkApplication.fa.Ta("IsAnonymousUser"));return null}),A.getFeatureTier("LicensingTestFeature",
0).then(ea=>{k.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ea,G.AFrameworkApplication.fa.Ta("IsAnonymousUser"));return null}));this.Rc.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.n9j()})}dispose(){}n9j(){try{G.AFrameworkApplication.fa.qa("SideCarIsEnabled")&&Za.emg().then(A=>{k.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
A);return A})}catch(A){}}static main(){Ta.a.instance.Mk(new La)}}Object(x.a)(La,"ApplicationFeatureHelperPackage",null,[3,4]);var fb=a(2),Pb=a(234),Sa=a(32),Wa=a(335),pb=a(334),wa=a(27),hb=a(1),Sb=a(39),Bc=a(9),ab=a(296),qb=a(16);class mc extends ab.a{constructor(A){super(A);this.Cih=()=>{k.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};k.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.Fd=0;this.$d(1,
qb.a.instance.ia(2260));A=qb.a.instance.ia(2258);const ea=this.oK();this.initializeAndShow(A,this.Cih,ea)}get pe(){return"ClipboardReadPermissionAskDialog"}oK(){const A={};A.id=this.pe;const ea=qb.a.instance.ia(2259);A.DialogMessage=ea;return A}}Object(x.a)(mc,"ClipboardReadPermissionAskDialog",ab.a,[]);var yb=a(56);const vc=(A,ea,Ma,Vb,tc)=>{const Jc=A.Stopwatch,ld={};ld.a=tc;ld.e=Jc.id;ld.c="RearrangeRowColumn";ld.b="mouse";ld.d=A.OperationId.toString();ld.f=Ma.toString();ld.g=Vb.toString();ld.h=
ea.toString();ld.i=A.DragDropIsShiftKeyDown;ld.j=!0;ld.o=Jc.Ee;ld.q=!1;ld.r=A.CopyPasteTargetType.toString();ld.s=A.EncounteredDeploymentErrors;return ld};class Db{constructor(A,ea){this.B_h=()=>{const Ma={};Ma.SourceItem=this.toString();return Ma};this.sessionStateId=A;this.sessionId=ea;this.toJSON=this.B_h}Jtf(A){return A?this.sessionStateId===A.sessionStateId&&this.sessionId===A.sessionId:!1}isFromCurrentSession(A){return this.sessionId===A.xa.UserSessionId}}Object(x.a)(Db,"SourceItem",null,[]);
class Ga extends Db{constructor(A,ea,Ma,Vb,tc){super(Ma,Vb);this.activeFloatingObjectControlId=A;this.sheetName=ea;this.type=tc}isEqual(A){return A&&Object.getType(A)===Ga?this.Jtf(A)&&this.activeFloatingObjectControlId===A.activeFloatingObjectControlId&&this.sheetName===A.sheetName:!1}toString(){return this.type.toString()}}Object(x.a)(Ga,"ArtSourceItem",Db,[]);var Eb;(function(A){A[A.valid=0]="valid";A[A.notPairwiseDisjoint=1]="notPairwiseDisjoint";A[A.cutNotSupportedInDiscontinuousSelection=2]=
"cutNotSupportedInDiscontinuousSelection";A[A.notValidForm=3]="notValidForm";A[A.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Eb||(Eb={}));Object(x.b)("CopySourceValidationOptions",Eb);var Zb=a(46);class ic extends Db{constructor(A,ea,Ma,Vb,tc){super(Vb,tc);k.ULS.shipAssertTag(537167645,0,!!ea&&0<ea.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=A;this.ranges=ea;this.sheetName=Ma}isEqual(A){return A&&Object.getType(A)===ic?this.Jtf(A)&&Zb.R(this.ranges,A.ranges)&&
this.sheetName===A.sheetName:!1}toString(){return Zb.i(this.ranges,",",this.$,!1)}}Object(x.a)(ic,"RangeSourceItem",Db,[]);const mb=A=>!!A&&Object.getType(A)===ic;class Hb{}Hb.Glk="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(x.a)(Hb,"ExpectedErrorNames",null,[]);class Wb{}Wb.plainText="text/plain";Wb.html="text/html";Wb.png="image/png";Wb.shadowWorkbook="data/shadow-workbook";Wb.aHi="metadata/is-last-copy-was-external";Wb.aDi="metadata/is-last-copy-was-external-XLO-source";
Wb.bhh="metadata/chrome-extension-id";Wb.Qxb="copyId";Wb.Z1g="metadata/additional-signature-data-attributes";Object(x.a)(Wb,"ClipboardDataFormat",null,[]);const Ob=A=>A.clipboardItems&&(A=A.clipboardItems.getItem(Wb.aHi))&&"1"===A?!0:!1,Gc=A=>Ob(A)&&!(void 0===A.clipboardItems||null===A.clipboardItems)&&!!A.clipboardItems.getItem(Wb.png)&&!A.clipboardItems.getItem(Wb.plainText),Va=A=>A.clipboardItems&&(A=A.clipboardItems.getItem(Wb.aDi))&&"1"===A?!0:!1,Jb=A=>A&&(A=A.getCachedMetadata(),null===A||
void 0===A?0:A.lastCopy)?A.lastCopy:null;var ub=a(53),Qa=a(21),P=a(37);class ta{constructor(A,ea,Ma,Vb){this.$=A;this.originalDestinations=ea;this.ihc=Ma;this.kFg=Vb;this.qPg=this.originalDestinations;this.jJg=this.ihc;this.LMg="PasteRecoveryUI"}get Y1g(){return this.kFg}get oBf(){return this.LMg}get ewj(){return this.qPg}get l6e(){return this.jJg}uza(){return ta.Tkj}u7h(){return this.ihc&&1===this.ihc.length?this.v7h(this.ihc[0]):null}Apd(){return"PasteRecoveryUI-Floatie"}v7h(A){var ea=Qa.h(this.$);
const Ma=ea.Tc.Rj(A);var Vb=ea.Bi(A,Ma);ea=ea.rtl;if(!Vb)return null;A=Qa.h(this.$).Ih(Ma);const tc=A.Qn;if(!tc.Te(Vb))return null;Vb=tc.Xf(Vb);const Jc=Vb.topLeft.y;var ld=Vb.bottomRight.y;const Zd=ea?Vb.bottomRight.x:Vb.topLeft.x;Vb=ea?Vb.topLeft.x:Vb.bottomRight.x;var De=new ub.a(Vb+(ea?-81:81),ld+38+6);if(tc.Qla(De))return this.t9a(A,tc,Ma,Vb,ld,ea?12:-3,66);De=new ub.a(Vb+(ea?-81:81),ld);if(tc.Qla(De))return this.t9a(A,tc,Ma,Vb,ld,ea?20:3,22);De=new ub.a(Vb,ld+38+6);if(tc.Qla(De))return this.t9a(A,
tc,Ma,Vb,ld,-81+(ea?18:0),66);Vb=new ub.a(Zd+(ea?81:-81),ld);if(tc.Qla(Vb))return this.t9a(A,tc,Ma,Zd,ld,-81+(ea?12:-6),22);ld=new ub.a(Zd,Jc-38-6);return tc.Qla(ld)?this.t9a(A,tc,Ma,Zd,Jc,ea?15:0,16):this.t9a(A,tc,Ma,ea?tc.topLeft.x:tc.bottomRight.x,tc.bottomRight.y,-81+(ea?15:-6),22)}t9a(A,ea,Ma,Vb,tc,Jc,ld){var Zd=Qa.h(this.$);const De=Zd.rtl;A=Sys.UI.DomElement.getLocation(A.domElement);Vb=new Sys.UI.Point(Vb+(De?0:A.x)-ea.topLeft.x,tc+A.y-ea.topLeft.y);De&&(Zd=Zd.view.visibleArea,Vb.x=Zd.bottomRight.x-
Zd.topLeft.x-Vb.x,2===Ma||4===Ma)&&(Vb.x+=ea.bottomRight.x);Vb=P.a(this.$).Gna(Vb);return new Sys.UI.Point(Vb.x+Jc,Vb.y+ld)}}ta.Tkj=["PasteRecoveryUI"];Object(x.a)(ta,"PasteRecoveryUI",null,[569]);var Z=a(76),aa=a(281);class Ea{}Ea.tUg="ActiveSelection";Ea.shadowWorkbook="ShadowWorkbook";Ea.kCg="GVML";Ea.plainText="PlainText";Ea.html="Html";Ea.s8g="Bitmap";Object(x.a)(Ea,"PayloadType",null,[]);class za{}za.l3j="Slice6";Object(x.a)(za,"SliceName",null,[]);class bb{}bb.v1i="NotCalled";bb.success="Success";
bb.failed="Failed";Object(x.a)(bb,"SucceededPopulatingSystemClipboardOptions",null,[]);var Mb=a(348);const zb=(A,ea)=>A?ea&&ea.xa?A.sessionId!==ea.xa.UserSessionId:(k.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(k.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),oa=A=>{switch(A){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},Xa=A=>{if(!A)return"null";const ea=[];for(const Ma of A.get())ea.push(`${Ma.clipboardDataFormat}(${Ma.data.length})`);
ea.sort();return ea.join(",")};var bc;(function(A){A[A.valid=0]="valid";A[A.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";A[A.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";A[A.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";A[A.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";A[A.multipleDestinationsAreNotMultiplyOfSourceRange=
5]="multipleDestinationsAreNotMultiplyOfSourceRange";A[A.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";A[A.copySourceNotValid=7]="copySourceNotValid";A[A.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";A[A.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";A[A.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";A[A.unknown=100]="unknown"})(bc||(bc={}));Object(x.b)("PasteValidationOptions",bc);var Ac=
a(54),Xc=a(160),Ed=a(40),Qd=a(172),zd=a(360),fe=a(35),jd=a(328),Xb=a(12),Lc=a(24),Bd=a(140),Nc=a(121),rb=a(577),va=a(108),yc=a(62),Zc=a(92);class cc extends Sys.EventArgs{constructor(A,ea,Ma){super();this.command=A;this.destinationRange=ea;this.sourceRange=Ma}}Object(x.a)(cc,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var Le=a(131),Re=a(86),Ib=a(151),Yc=a(19);class Cb extends ta{constructor(A,ea,Ma,Vb){super(A,ea,Ma,Vb);this.SPi="DragRecoveryUI"}get oBf(){return this.SPi}uza(){return Cb.yDh}Apd(){return"DragRecoveryUI-Floatie"}}
Cb.yDh=["DragRecoveryUI"];Object(x.a)(Cb,"DragFillRecoveryUI",ta,[]);var pc;(function(A){A[A.source=0]="source";A[A.destination=1]="destination"})(pc||(pc={}));Object(x.b)("RangeType",pc);class Mc extends Sb.a{constructor(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){De=void 0===De?null:De;super();this.pasteShortcutManager=this.oya=null;this.Csf=hb.EwaSettings.rd();this.ZAa=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.Iqg=null;this.Ibb=!1;this.zDd=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix3");
this.eYe=()=>{var Ve,Se;let sf=null===(Ve=this.oya)||void 0===Ve?void 0:Ve.Rsc;sf&&(null===(Se=this.oya)||void 0===Se?0:Se.Lwf())&&!Zb.R(Qa.h(this.$).ha.ra.selectedRanges,this.oya.itc)&&(!Zb.R([Qa.h(this.$).ha.ra.activeCell],[sf.activeCell])||Qa.h(this.$).ha.ra.Ye.isSingle)&&(this.oya.mma(),this.oya=null,this.gridView.ha.vr(this.eYe))};this.JNd=Ve=>{this.pXj(Ve)&&(this.Zp.Nvd(),k.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.QUi=(Ve,Se)=>{k.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Ve}]. userPressedExtensionLink=${Se}`);this.gridView.focus()};this.kf=(Ve,Se)=>{Se.fQ||Se.Fh||this.Nt("OnWorkbookOpened",!1).catch(()=>{})};this.cm=(Ve,Se)=>{Ve=Jb(this.SK);const sf=this.Zp.z9a(Ve);sf&&(Se.na&&Se.na.sheetName===sf.sheetName&&sf.isFromCurrentSession(this.$)?this.Zp.Onf(sf.ranges,Ve.commandParameters.commandType):this.Zp.Nvd())};this.Hxc=
(Ve,Se)=>{Ve=Jb(this.SK);(Ve=this.Zp.z9a(Ve))&&Se.item&&Se.item.sheetName===Ve.sheetName&&Ve.isFromCurrentSession(this.$)&&this.Nt("OnItemDeleting",!1).catch(()=>{})};this.hDa=(Ve,Se)=>{this.Csf?this.Iqg(Ve,Se):this.eVf()};this.vU=(Ve,Se)=>{1===Se.kt&&Se.Jh.operation.flags&2&&this.Nt("OnQueueItemChanged/ItemRemoved",!1).catch(()=>{})};this.$=A;this.Tg=Ma;this.gridView=Qa.h(A);this.Zp=tc;this.azi=Jc;this.SK=ea;this.Sxb=Vb;this.getStringifiedError=De||copyPasteInfra.getStringifiedError;this.hkg=1===
Zd;this.al();this.copyPasteShortcutDialogFactory=this.$.ea.Ba(85);k.ULS.shipAssertTag(537167825,0,!!this.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");ld||(k.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),ld=Mc.kyh);this.userHash=Sa.a.zy(ld);this.YYi="CultureTag: "+qb.a.instance.bec+" HASH: ";this.SK.addMetadataChangeListener(Mc.CHf,this.JNd);this.NXi=aa.a.pLb;this.nCa=
this.ZAa?hb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):Bc.a.nCa;A.ea.Zc(478,Ve=>{this.pasteShortcutManager=Ve});this.Csf&&(this.Iqg=jd.b(()=>{this.eVf()},1,this.$.ka,"CopyPasteInfrastructure.OnStartEditInternal",!0))}qfc(){var A=Jb(this.SK);return A?(A=A.sourceItem)&&!A.isFromCurrentSession(this.$)?(k.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return this.$.ea.Ba(373)}m0g(A){this.addHandler(Mc.GOd,A)}QCj(A){this.removeHandler(Mc.GOd,A)}copy(A){A.stopwatch=this.$.Jd.Le("UserAction",yb.b().pl(A.ribbonCommandInfo.command)+"ClientSide");const ea=Ac.GetServiceTaskFactory.Vc(this.$.ea,478,479,0);Ed.TaskExtensions.ya(ea,()=>{this.pasteShortcutManager=ea.result},this.ka,3);const Ma=!!Jb(this.SK);hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&(this.Ibb=
!1);this.Nt("Copy/before/"+Wa.a[A.ribbonCommandInfo.method],!1,void 0,!0,A.copyPasteTargetType).catch(()=>{});var Vb=-1985798686===A.ribbonCommandInfo.command;if(1===this.gridView.ng&&(Vb=this.Zp.Tsf(this.gridView.ha.ra.selectedRanges,Vb),0!==Vb)){const ld=Mc.jnh(Vb);this.ADa(ld,Eb[Vb],!1);return Promise.reject(!1)}A.userHash=this.userHash;A.id=qa.a.create().toString();let tc=this,Jc=this;return this.Sxb.onCopy(A).then(ld=>{ld.isAsyncCopy||A.stopwatch.stop();tc.pasteIndicationManager.nZe();const Zd=
Mb.d(A);k.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Zd}`);tc.ISi(ld,Ma);ld=1===A.copyPasteTargetType;!A.isFormatPainter&&ld&&(tc.pasteShortcutManager?tc.pasteShortcutManager.$Fh():k.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},ld=>{let Zd=!1,De="none",Ve=Mc.czb,Se=!0,sf=-1,Of=Mc.copyErrorName+Mc.TNa,qg=!1,yg=null;if(ld){yg=ld.copyContext;sf=ld.reason;Of+=Mc.pPa(ld);ld.message&&(Ve=
ld.message);var lg=Mc.inh(ld);if(lg)if(3===lg.copyErrorName)Zd=!0,Ve=De="Async Copy canceled by the user.",Se=!1;else if(fe.a.Jr(lg.ewaErrors))if(Ve=Jc.jkc(lg.ewaErrors),fe.a.aj(lg.ewaErrors,Mc.operationSucceededWithAlert))qg=Zd=!0;else if(fe.a.aj(lg.ewaErrors,Mc.pasteDataLimitHit)||fe.a.aj(lg.ewaErrors,Mc.copyThrottlingError))Zd=!0;13===ld.reason?(Zd=!0,Se=!1):11===ld.reason&&(Se=!1)}lg=ld?Jc.getStringifiedError(ld):"null";Zd?(lg=Mb.d(A),k.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${Se}, Friendly message: ${De}, Error Message: ${Ve}, CommandParameters: ${lg}`)):
k.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${Se}, Error Message: ${lg}, CommandParameters: ${Mb.d(A)}`);Se&&Jc.Nt("Copy/fail/"+Wa.a[A.ribbonCommandInfo.method],!0,void 0,void 0,A.copyPasteTargetType).catch(()=>{});Jc.HSi(A,Zd,Ve,Of,sf,qg,yg);return Promise.reject(ld)})}jlj(A){if(this.qfc())return Zc.a(this.voc(A.commandType,A.ribbonCommandInfo));let ea;ea=Zb.d(this.gridView.ha.ra.selectedRanges);A.originalDestinations=
ea;A.expandDestinations=this.A$b(A.originalDestinations,A.commandType);if(this.M$b(A.commandType,A.expandDestinations)||this.oLe())A.userHash=this.userHash,A.id=qa.a.create().toString(),this.Sxb.onPaste(A).then(()=>Promise.resolve(!0),Ma=>Promise.reject(Ma));return Promise.resolve(!0)}n8i(A){if(A.method){var ea={};ea.activeCell=this.gridView.ha.ra.activeCell;var Ma=new Cb(this.$,Zb.d(this.gridView.ha.ra.selectedRanges),Zb.d(this.gridView.ha.ra.selectedRanges),ea);ea=tc=>{const Jc=Ac.GetServiceTaskFactory.Vc(this.$.ea,
406,405,0);Ed.TaskExtensions.ya(Jc,()=>{A.method&&tc(Jc.result)},this.ka,8)};var Vb=tc=>{tc.FIe(Ma);tc.Glg(A.method);this.oya=tc};this.oya?Vb(this.oya):ea(Vb);k.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.gridView.ha.cr(this.eYe)}}paste(A){A.stopwatch=this.$.Jd.Le("UserAction",yb.b().pl(A.ribbonCommandInfo.command)+"ClientSide");hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&(k.ULS.sendTraceTag(537167822,
0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.Ibb=!1,A.clipboardPicklingApiDataFormatsToRead=[Wb.shadowWorkbook]);Qa.h(this.$).Ri&&Qa.h(this.$).Ri.w4(this.Ard(A.ribbonCommandInfo.command),A.stopwatch.id);if(A.isPasteCommandFromRecoveryUI){var ea=this.$.ea.Ba(406);var Ma=Zb.d(ea.itc);if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8063983_ResolveWhenRecoveryRangeEmpty")&&!Ma)return k.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),
Promise.resolve(!0);ea=ea.Rsc;A.pasteRecoveryCachedClipboardItems=ea?ea[Mc.$Xf]:null}else Ma=Zb.d(this.gridView.ha.ra.selectedRanges);A.originalDestinations=Ma;A.expandDestinations=this.A$b(A.originalDestinations,A.commandType);if(this.M$b(A.commandType,A.expandDestinations)||this.oLe())return A.userHash=this.userHash,A.id=qa.a.create().toString(),hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!ja.a.GD&&(A.clipboardReadPermissionPromptShown=!1,A.clipboardAsyncApiDataFormatsToRead=
[Wb.plainText+"Async"],this.Sxb.shouldShowClipboardReadPermissionDialog().then(Vb=>{Vb&&(A.clipboardReadPermissionPromptShown=!0,new mc(this.$));return Promise.resolve(!0)},()=>Promise.resolve(!0))),this.Sxb.onPaste(A).then(Vb=>this.hyc(Vb,A),Vb=>this.LNb(A,Vb));this.$.Fe(927125067,Z.a.ld,30,null);Ma=Zb.i(A.expandDestinations,",",this.$,!1);k.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Ma}, CommandType: ${A.commandType}, copyPasteTargetType="${A.copyPasteTargetType}"`);
return Promise.resolve(!0)}Ard(A){switch(A){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}oLe(){return!!Qa.h(this.$).ha.Va.activeFloatingObjectControlId&&this.$.wu(null,!1,470)}xcb(){const A=Jb(this.SK);return A&&A.commandParameters?A.commandParameters.copyPasteTargetType:0}$Gi(){return!!Jb(this.SK)&&zb(Jb(this.SK),this.$)}Nt(A,ea,Ma,Vb,tc){Ma=void 0===Ma?!1:Ma;Vb=void 0===Vb?!1:Vb;tc=void 0===tc?0:tc;try{this.pasteShortcutManager&&
this.pasteShortcutManager.Kec();let Jc=tc;const ld=this.MOi();if(!Vb&&2===ld)return k.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ea}', isExplicit = '${Ma}', isForce = '${Vb}', Current CCP operation copyPasteTargetType = '${tc}', LastCopyPasteTargetType = '${ld}'`),Promise.reject(null);0===Jc&&(Jc=ld);const Zd=this.$.Jd.Le("UserAction","ClearCopyState"),De=Zd.id;k.ULS.sendTraceTag(537167820,
0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ea}', isExplicit = '${Ma}', isForce = '${Vb}', Current CCP operation copyPasteTargetType = '${tc}', LastCopyPasteTargetType = '${ld}'`);this.Zp.Nvd();this.ltj();return this.Sxb.onCancelCopy(ea).then(()=>{ea&&hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&(this.Ibb=!1);Zd.stop();this.UCf(A,De,!0,Ma,ea,"","",Zd.Ee,Jc);return Promise.resolve(!0)},Ve=>{var Se=
Ve?this.getStringifiedError(Ve):"null";k.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Se}`);Zd.stop();Se=Mc.oeh+Mc.TNa;let sf=Mc.czb;Ve&&(Se+=Mc.pPa(Ve),Ve.message&&(sf=Ve.message));this.UCf(A,De,!1,Ma,ea,sf,Se,Zd.Ee,Jc);return Promise.reject(Ve)})}catch(Jc){return Promise.reject(null)}}Sad(A,ea,Ma,Vb){var tc=void 0;tc=void 0===tc?!1:tc;Ma=void 0===Ma?!1:Ma;Vb=void 0===Vb?0:Vb;return Ma||this.qfc()?this.Nt(A,ea,tc,
Ma,Vb):(k.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}ADa(A,ea,Ma){k.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ea}`);const Vb=new va.a;Vb.ga("reason",ea);rb.a(Bd.a.discontinuousSelectionBlocking,[Ma?Nc.a.Kkj:Nc.a.foh],
!0,!0,!1,!1,Vb);A=fe.a.Ze(1,1,751,A,0,371863010,"DiscontinuousSelectionBlocking");hb.EwaSettings.EA()?new zd.a(this.$,A):(A=new Qd.ErrorDialog(this.$,A),A.initialize(),A.hi())}MOi(){const A=Jb(this.SK);return A&&A.sourceItem?Object.getType(A.sourceItem)===Ga?2:1:0}dragDropCells(A,ea,Ma,Vb,tc){tc=void 0===tc?!1:tc;A.stopwatch=this.$.Jd.Le("UserAction","DragDropClientSide");A.isDragDrop=!0;this.Nt("DragDrop/before/"+Wa.a[A.ribbonCommandInfo.method],!1,void 0,void 0,A.copyPasteTargetType).catch(()=>
{});const Jc=tc?2:1;let ld=0;ld=tc?4:Vb?256:128;const Zd={encounteredDeploymentErrors:!1};Zd.commandParameters=A;A.userHash=this.userHash;A.id=qa.a.create().toString();return this.zDd?this.Zp.pasteRange(A.ribbonCommandInfo,Zb.q(ea,this.$),Zb.q(Ma,this.$),Jc,ld,[A.stopwatch],Zd,!1,()=>{k.ULS.sendTraceTag(537167818,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.Vcb(A,Jc,ea,Ma,Zd)},De=>{this.qeb(De,A,Jc,ea,Ma,Zd)}).then(()=>{this.gridView.ha.selectionType=
-1;return Promise.resolve(!0)},De=>Promise.reject(De)):this.Zp.pasteRange(A.ribbonCommandInfo,Zb.q(ea,this.$),Zb.q(Ma,this.$),Jc,ld,[A.stopwatch],Zd,!1,null,null).then(()=>{k.ULS.sendTraceTag(521410075,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.gridView.ha.selectionType=-1;this.Vcb(A,Jc,ea,Ma,Zd);return Promise.resolve(!0)},De=>{this.qeb(De,A,Jc,ea,Ma,Zd);return Promise.reject(De)})}xDh(A,ea,Ma,Vb,tc){tc=void 0===tc?!1:tc;A.stopwatch=
this.$.Jd.Le("UserAction","DragDropReplaceClientSide");A.isDragDrop=!0;this.Sad("DragDropReplace/before/"+Wa.a[A.ribbonCommandInfo.method],!1,void 0,A.copyPasteTargetType).catch(()=>{});const Jc=tc?2:1;let ld=0;ld=tc?4:Vb?256:128;const Zd={encounteredDeploymentErrors:!1};Zd.commandParameters=A;hb.EwaSettings.getBooleanFeatureGate(aa.a.ufc,!1)&&(A.isDragInsert=!1);A.userHash=this.userHash;A.id=qa.a.create().toString();return this.zDd?this.Zp.pasteRange(A.ribbonCommandInfo,Zb.q(ea,this.$),Zb.q(Ma,this.$),
Jc,ld,[A.stopwatch],Zd,!1,()=>{k.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.Vcb(A,Jc,ea,Ma,Zd)},De=>this.qeb(De,A,Jc,ea,Ma,Zd)).then(()=>{this.gridView.ha.selectionType=-1;return Promise.resolve(!0)},De=>Promise.reject(De)):this.Zp.pasteRange(A.ribbonCommandInfo,Zb.q(ea,this.$),Zb.q(Ma,this.$),Jc,ld,[A.stopwatch],Zd,!1,null,null).then(()=>{k.ULS.sendTraceTag(521410073,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);
this.gridView.ha.selectionType=-1;this.Vcb(A,Jc,ea,Ma,Zd);return Promise.resolve(!0)},De=>{this.qeb(De,A,Jc,ea,Ma,Zd);return Promise.reject(De)})}wDh(A,ea,Ma,Vb,tc){tc=void 0===tc?!1:tc;A.stopwatch=this.$.Jd.Le("UserAction","DragDropInsertClientSide");this.Sad("DragDropInsert/before/"+Wa.a[A.ribbonCommandInfo.method],!1,void 0,A.copyPasteTargetType).catch(()=>{});const Jc=tc?2:1,ld=Zb.L(this.A$b([Ma],Jc));var Zd=this.$.da.na.sheetName;const De=this.$.da.na.sheetName,Ve=Zb.v(ea,this.$);Ve.SheetName=
Zd;Zd=Zb.v(ld,this.$);Zd.SheetName=De;Vb=ld.isRow||ea.isRow||Vb?1:0;const Se={encounteredDeploymentErrors:!1};A.isDragInsert=!0;Se.commandParameters=A;A.userHash=this.userHash;A.id=qa.a.create().toString();if(this.zDd)return tc=this.Zp.vZe(Se,Ve,Zd,tc,Vb,A.ribbonCommandInfo,()=>{k.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.Vcb(A,Jc,ea,Ma,Se)},Of=>{this.qeb(Of,A,Jc,ea,Ma,Se)}),Zc.d(tc.then(()=>{this.gridView.ha.selectionType=
-1;return Promise.resolve(!0)},Of=>Promise.reject(Of))).Nr(()=>!0);tc=this.Zp.vZe(Se,Ve,Zd,tc,Vb,A.ribbonCommandInfo,null,null);let sf=this;return Zc.d(tc.then(()=>{k.ULS.sendTraceTag(521410071,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.gridView.ha.selectionType=-1;this.Vcb(A,Jc,ea,Ma,Se);return Promise.resolve(!0)},Of=>{sf.qeb(Of,A,Jc,ea,Ma,Se);return Promise.reject(Of)})).Nr(()=>!0)}voc(A,ea,Ma,Vb,tc,Jc){var ld=Jb(this.SK);if(!ld)return k.ULS.sendTraceTag(537167812,
0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),yc.Task.Wa(!1);if(!mb(ld.sourceItem))return k.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),yc.Task.Wa(!1);var Zd=ld.sourceItem;if(!Zd)return k.ULS.shipAssertTag(537167810,0,!!Zd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),yc.Task.Wa(!1);if(!Zd.isFromCurrentSession(this.$)&&!aa.a.zRa)return k.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),
yc.Task.Wa(!1);if(1<Zd.ranges.length)return k.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.ADa(2192,"InsertCopiedCutCells",!0),yc.Task.Wa(!1);ld=Zb.L(Zd.ranges);var De=this.gridView.ha.ra.Ye.clone();A=Zb.L(this.A$b([De],A));const Ve=this.BAf();Zd=Zd.sheetName;De=this.$.da.na.sheetName;const Se=Zb.v(ld,this.$);Se.SheetName=Zd;const sf=Zb.v(A,this.$);sf.SheetName=De;Zd=this.gridView.ha.ra.activeRange;const Of=()=>{k.ULS.sendTraceTag(508929747,
0,50,"InsertCopiedCutCellsCrossSession Succeeded")},qg=()=>{k.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(A.Ci||ld.Ci||this.Zp.hZj(this.$,ld,Zd)?yc.Task.Wa(0):A.isRow||ld.isRow||this.Zp.iZj(this.$,ld,Zd)?yc.Task.Wa(1):this.azi.ycc(this.$,Qa.h(this.$).rtl)).Nr(yg=>!this.qfc()&&aa.a.zRa?this.Zp.executeInsertCopiedCutCellsAcrossSession(Se,sf,Ve,yg.result,ea,Of,qg,Ma,Vb,tc,Jc):this.Zp.executeInsertCopiedCutCellsOperation(Se,sf,Ve,yg.result,ea,null,null)).continueWith(()=>
{this.Nt("InsertCopiedCutCells/success/"+Wa.a[ea.method],!0)})}SHb(){const A=Jb(this.SK),ea=this.gridView.ha.ra.yj;return!!A&&mb(A.sourceItem)&&ea&&1===A.sourceItem.ranges.length}BAf(){return this.CAf(-911352779)}XCd(){var A,ea;const Ma=Jb(this.SK);return Ma?(null===(A=Ma.asyncClipboardItemsKeys)||void 0===A?void 0:A.includes(Wb.shadowWorkbook))||(null===(ea=Ma.syncClipboardItemsKeys)||void 0===ea?void 0:ea.includes(Wb.shadowWorkbook))||3!==Ma.copyStatus:!1}htc(){return this.CAf(-1985798686)}M$b(A,
ea){var Ma=new Xc.a(this.$.va),Vb=36===A;const tc=Ma.Gf(4);A=2===this.xcb()&&Ma.Gf(1);Vb=Vb&&tc;Ma=!Ma.Ej||!this.htc()||!Xc.a.gfc(ea,Qa.h(this.$));return Vb||A||this.$.wu(ea,!0)&&Ma}FHb(A,ea){return this.Zp.FHb(A,ea)}dispose(){super.dispose();this.zk();this.SK.removeMetadataChangeListener(Mc.CHf)}thd(A,ea,Ma,Vb,tc,Jc){if(!this.kih(A.commandParameters.ribbonCommandInfo.command))return A.cseStatus=2,!1;if(Jc&&ea.Te(Vb))return A.cseStatus=4,!1;if(Ma!==tc)return A.cseStatus=6,!1;if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(Vb.width%ea.width||Vb.height%ea.height))return A.cseStatus=16,!1;if(hb.EwaSettings.getBooleanFeatureGate(aa.a.XUe,!1)){if(Ma=ea,Vb=Vb.Xf(this.gridView.Yk),ea=null===ea.Xf(this.gridView.Yk),tc=A.commandParameters.ribbonCommandInfo.command,ea&&1804571062!==tc&&-185374993!==tc||!Vb)return A.cseStatus=7,!1}else if(Ma=ea.Xf(this.gridView.Yk),Vb=Vb.Xf(this.gridView.Yk),!Ma||!Vb)return A.cseStatus=7,!1;if(aa.a.NIe){ea=this.MIe(this.gridView,A.commandParameters.ribbonCommandInfo.command,Ma,pc.source);if(0!==
ea)return A.cseStatus=ea,!1;ea=this.MIe(this.gridView,A.commandParameters.ribbonCommandInfo.command,Vb,pc.destination);if(0!==ea)return A.cseStatus=ea,!1}ea=Zb.v(Ma,this.$);ea=this.Tg.Qkj(this.gridView,ea,Zb.v(Vb,this.$),A.commandParameters.ribbonCommandInfo.command,A.commandParameters.stopwatch);1===ea&&(Jc&&(this.Tg.Jad(Ma,!1),this.Tg.Jad(Ma,!0)),Jc=new cc(A.commandParameters.ribbonCommandInfo.command,Vb,Ma),Qa.h(this.$).$1f(Jc),this.pasteIndicationManager.hnc(A.commandParameters.id,!0),this.PSb(A.commandParameters.expandDestinations,
A.commandParameters.isPasteCommandFromRecoveryUI),this.Rad("DoPasteClientEstimation/"+Wa.a[A.commandParameters.ribbonCommandInfo.method],A));A.cseStatus=ea;return 1===ea}MIe(A,ea,Ma,Vb){const tc=new Le.a("CopyPasteInfrastructure.blockCseForPaste",A,Ma);try{for(;tc.moveNext();){let Jc=tc.get_current().cell;if(Jc.Wy)return 8;if(237279923===ea||-185374993===ea){if(Jc.MR&&hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste"))return 18;if(Jc.eN&&hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste"))return 19}if(Vb===
pc.source){if(Jc.Cfa)return 23;if(Jc.mDd)return 24;if(Jc.hasIgnorableError)return 25;if((237279923===ea||1804571062===ea)&&this.oJi(A,Ma))return 20;if(237279923===ea){if(Jc.Tea)return 22;if(Jc.hasHyperlink||Jc.Loa)return 21}}}}finally{tc&&tc.dispose()}return 0}oZf(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.QUi)}uUi(A,ea,Ma,Vb){A=vc(A,ea,Ma,Vb,this.$.xa.UserSessionId);A.k=!0;yb.b().Wg(45,A,!0)}Idj(A,ea,Ma,Vb,tc){var Jc=!1,ld=!1,Zd=Mc.czb,De=Mc.pZe+Mc.TNa;A&&(De+=
Mc.pPa(A),fe.a.Jr(A.ewaErrors)?(Zd=this.jkc(A.ewaErrors),fe.a.aj(A.ewaErrors,[-103190598])&&(Jc=!0)):A.message&&(Zd=A.message));ld||(ld=this.nAd(A));ea=vc(ea,Ma,Vb,tc,this.$.xa.UserSessionId);ea.k=!1;ea.l=ld;ea.n=Zd;ea.p=De;ea.q=Jc;yb.b().Wg(45,ea,!0);return Promise.reject(A)}oJi(A,ea){const Ma=A.xj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new wa.Range(ea.top,ea.right,ea.bottom,ea.right,!0,!0));for(;Ma.$$mn();){let Vb=Ma.$$cu();if(Vb&&Vb.iAa())return k.ULS.sendTraceTag(509436432,0,
50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0}for(A=A.xj("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new wa.Range(ea.bottom,ea.left,ea.bottom,ea.right,!0,!0));A.$$mn();)if((ea=A.$$cu())&&ea.eAa())return k.ULS.sendTraceTag(509436431,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0;return!1}R6g(A,ea,Ma){A.cseStatus=0;A.cseStatus=this.REi(A.commandParameters.ribbonCommandInfo.command,Ma,this.gridView,ea);
if(0!==A.cseStatus)return!1;A.cseStatus=this.Tg.Rkj(this.gridView,ea,Ma,A.commandParameters.stopwatch);ea=new cc(A.commandParameters.ribbonCommandInfo.command,Ma,null);1===A.cseStatus&&(Qa.h(this.$).$1f(ea),this.pasteIndicationManager.hnc(A.commandParameters.id,!0),this.PSb(A.commandParameters.expandDestinations,A.commandParameters.isPasteCommandFromRecoveryUI),this.Rad("AttemptExternalPlainTextPasteClientEstimation/"+Wa.a[A.commandParameters.ribbonCommandInfo.method],A));return 1===A.cseStatus}REi(A,
ea,Ma,Vb){if(-875588320!==A&&-185374993!==A&&237279923!==A)return 2;if(Ma.ed.BRa(ea))return 8;if(Ma.ed.nEd(ea))return 18;if(Ma.ed.N2(ea))return 11;if(this.Tg.YYe(ea))return 12;A=this.Och(ea,Vb);return Qa.j(this.gridView,A)?0:7}Och(A,ea){var Ma=ea.indexOf("\r");Ma=-1!==Ma?"\n"===ea[Ma+1]?ea.split("\r\n"):ea.split("\r"):ea.split("\n");ea=Ma.length;Ma=Ma[0].split("\t").length;return new wa.Range(A.top,A.left,A.top+ea-1,A.left+Ma-1,!0,!0)}kih(A){switch(A){case 237279923:case 808159687:return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7317055_PasteCse");
case -185374993:return!0;case 1804571062:return!0;default:return!1}}CAf(A){const ea=Jb(this.SK);if(!ea)return!1;const Ma=ea.sourceItem;return aa.a.zRa||!Ma||Ma.isFromCurrentSession(this.$)?ea.commandParameters.ribbonCommandInfo.command===A:(k.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1)}pXj(A){return A&&A.lastCopy?zb(A.lastCopy,this.$):!0}Ccf(A,ea,Ma,Vb,tc){const Jc={};Jc.a=this.$.xa.UserSessionId;Jc.e=A.stopwatch.id;
Jc.c=yb.b().pl(A.ribbonCommandInfo.command);Jc.b=Wa.a[A.ribbonCommandInfo.method];Jc.d=A.id;Jc.f=Ma.toString();Jc.g=Vb.toString();Jc.h=ea.toString();Jc.o=A.stopwatch.Ee;Jc.q=!1;Jc.r=A.copyPasteTargetType.toString();Jc.s=tc.encounteredDeploymentErrors;hb.EwaSettings.getBooleanFeatureGate(aa.a.ufc,!1)&&(Jc.i=tc.commandParameters.dragDropIsShiftKeyDown,Jc.j=tc.commandParameters.isDragInsert);return Jc}Vcb(A,ea,Ma,Vb,tc){A=this.Ccf(A,ea,Ma,Vb,tc);A.k=!0;yb.b().Wg(45,A,!0)}QSi(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){A=
this.Ccf(A,ea,Ma,Vb,De);A.k=!1;A.l=tc;A.n=Jc;A.p=ld;A.q=Zd;yb.b().Wg(45,A,!0)}UCf(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){const Ve={};Ve.a=this.$.xa.UserSessionId;Ve.b=ea;Ve.c=A;Ve.f=Ma;Ve.e=Vb;Ve.d=tc;Ve.g=Jc;Ve.h=ld;Ve.i=Zd;Ve.j=De.toString();yb.b().Wg(46,Ve,!0)}ISi(A,ea){A=this.Xbf(A.commandParameters,A);A.l=!0;A.j=ea;yb.b().Wg(43,A,!0)}HSi(A,ea,Ma,Vb,tc,Jc,ld){A=this.Xbf(A,ld);A.l=!1;A.m=ea;A.o=Ma;A.y=Vb;A.x=tc;A.z=Jc;yb.b().Wg(43,A,!0);k.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${A.y},ErrorReason=${A.x},IsExpectedError=${A.m},IsSucceededWithAlert=${A.z},ErrorMessage=${A.o}`)}Xbf(A,
ea){const Ma={};Ma.a=this.$.xa.UserSessionId;Ma.f=A.stopwatch.id;Ma.g=A.id;Ma.c=yb.b().pl(A.ribbonCommandInfo.command);Ma.b=Wa.a[A.ribbonCommandInfo.method];Ma.q=A.stopwatch.Ee;Ma.bd=Mc.wjc();Ma.bg=A.copyPasteHandlerName;Ma.bj=void 0===A.ribbonCommandInfo.Hg||null===A.ribbonCommandInfo.Hg?null:pb.a[A.ribbonCommandInfo.Hg];Ma.bq=A.uploadToClipService;Ma.br=A.floatingObjectType;Ma.s=A.copyPasteTargetType.toString();Ma.bc=oa(A.copyPasteTargetType);Ma.z=!1;if(ea){Ma.bk=ea.id;Ma.bl=ea.serverRequestTimeInMs;
ea.requestTelemetryData&&(Ma.bm=ea.requestTelemetryData.EcsOperationDuration,Ma.bn=ea.requestTelemetryData.EcsRequestDuration,Ma.bo=ea.requestTelemetryData.WfeRequestDuration);Ma.d=ea.sourceItem?ea.sourceItem.toString():null;Ma.e=-1;if(mb(ea.sourceItem)){Ma.e=0;A=ea.sourceItem.ranges;for(const Vb of A)Ma.e+=Vb.Ew}Ma.h=ea.isAsyncCopy;Ma.i=ea.isFromCache;Ma.k=ea.isSelectionAllowed;Ma.r=ea.plainTextPayloadSize;Ma.u=ea.htmlPayloadSize;Ma.v=ea.htmlSizeExceedsLimit;Ma.w=ea.copyTotalSizeExceedsLimit;Ma.t=
ea.shadowWorkbookPayloadSize;Ma.p=ea.clientSideCopyTime;Ma.ba=ea.encounteredDeploymentErrors;Ma.bb=ea.shadowWorkbookSizeExceedsLimit;Ma.be=ea.syncClipboardItemsKeys;Ma.bf=ea.asyncClipboardItemsKeys;Ma.bh=this.GRe(ea.succeededPopulatingSystemClipboardSync);Ma.bi=this.GRe(ea.succeededPopulatingSystemClipboardAsync)}return Ma}PSb(A,ea){ea=void 0===ea?!1:ea;if(!this.gridView.Xc&&!this.gridView.Jk){var Ma=this.gridView.ha.ra,Vb=!ea&&1===A.length&&Zb.R(A,Ma.selectedRanges),tc=Vb?Ma.activeCell:A[0].topLeft;
A[0].contains(tc)||(k.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Ma.selectedRanges}, IndexOfActiveRange ${Ma.Ys}, ActiveCell ${Ma.activeCell}, calculatedDestinationRanges ${A}, keepThePreviousActiveCell ${Vb}, newActiveCell ${tc}, isPasteCommandFromRecoveryUI ${ea}`),tc=A[0].topLeft);this.gridView.ha.FI(A,0,tc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}igf(A,ea){const Ma={};Ma.a=this.$.xa.UserSessionId;Ma.g=A.stopwatch.id;Ma.t=A.stopwatch.Ee;
Ma.bz=!1;ea&&(Ma.bv=ea.id,Ma.bw=ea.serverRequestTimeInMs,Ma.n=ea.commandParameters.clipboardFormatReadTimes,Ma.o=ea.commandParameters.clipboardFormatReadStatus,Ma.p=ea.commandParameters.clipboardReadPermissionPromptShown,Ma.q=ea.commandParameters.asyncApiReadTimedOut,ea.requestTelemetryData&&(Ma.cb=ea.requestTelemetryData.EcsOperationDuration,Ma.cc=ea.requestTelemetryData.EcsRequestDuration,Ma.cd=ea.requestTelemetryData.WfeRequestDuration));Ma.x=A.copyPasteTargetType.toString();Ma.bl=oa(A.copyPasteTargetType);
Ma.br=A.copyPasteHandlerName;Ma.i=Zb.i(A.expandDestinations,",",this.$,!1);Ma.h=Zb.i(A.originalDestinations,",",this.$,!1);Ma.e=A.id;Ma.d=A.commandType;Ma.c=yb.b().pl(A.ribbonCommandInfo.command);Ma.b=Wa.a[A.ribbonCommandInfo.method];Ma.bf=!1;Ma.bg=!1;Ma.bp=Mc.wjc();Ma.bt=void 0===A.ribbonCommandInfo.Hg||null===A.ribbonCommandInfo.Hg?null:pb.a[A.ribbonCommandInfo.Hg];Ma.cj=A.isPasteCommandFromEnterShortcut;if(Ma.ca=A.isPasteCommandFromRecoveryUI)Ma.cf=A.pasteRecoveryUndoStopwatch.id,Ma.cg=A.pasteRecoveryUndoStopwatch.Ee;
if(ea){if((A=ea.copyContextSnapshot)&&!ea.wasLastCopyExternal){Ma.f=A.commandParameters.id;Ma.j=A.sourceItem.toString();Ma.k=-1;if(mb(A.sourceItem)){Ma.k=0;const Vb=A.sourceItem.ranges;for(const tc of Vb)Ma.k+=tc.Ew}Ma.bg=1===A.commandParameters.commandType}else ea.clipboardItems?Ma.f=ea.clipboardItems.getItem(Wb.Qxb):k.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Ma.bz=ea.pasteRecoveryUIDisplayed;Ma.ci=ea.cseStatus}else k.ULS.sendTraceTag(537167773,
0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Ma}bUi(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){A=this.igf(A,Zd);A.l=!1;A.m=ea;A.s=Ma;A.bc=Vb;A.be=tc;A.bd=Jc;A.bf=ld;Zd?(A.y=Ob(Zd)||!Zd.copyContextSnapshot,A.bi=!A.y&&zb(Zd.copyContextSnapshot,this.$),A.bj=Zd.shadowWorkbookSizeExceedsLimit,A.v=Zd.shadowWorkbookPayloadSize,A.w=Zd.htmlPayloadSize,A.bq=Xa(Zd.clipboardItems),A.bb=Zd.activeSelectionType,A.bs=Zd.isSameSession,A.bn=Zd.payloadOrigin,A.bo=Zd.payloadType,A.bu=Zd.externalAppSource,
A.bx=Zd.indicationDisplayScheduled,A.by=Zd.pasteIndicationDisplayStatus,A.ck=Zd.pasteDestinationHasMergedCells):A.bi=zb(De,this.$);yb.b().Wg(44,A,!0);k.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${A.be},ErrorReason=${A.bd},IsExpectedError=${A.m},IsSucceededWithAlert=${A.bf},ErrorMessage=${A.s}`)}cUi(A){const ea=this.igf(A.commandParameters,A);ea.y=A.wasLastCopyExternal;ea.l=!0;ea.u=A.plainTextPayloadSize;ea.v=A.shadowWorkbookPayloadSize;ea.w=A.htmlPayloadSize;
ea.z=A.isClipboardDataContainShadowWorkbook;ea.ba=A.isShadowWorkbookParsedSuccessfully;ea.bb=A.activeSelectionType;ea.bc=A.pasteResult;ea.bh=A.encounteredDeploymentErrors;ea.bj=A.shadowWorkbookSizeExceedsLimit;ea.bk=Va(A);ea.bq=Xa(A.clipboardItems);ea.bs=A.isSameSession;ea.bn=A.payloadOrigin;ea.bo=A.payloadType;ea.bu=A.externalAppSource;ea.bx=A.indicationDisplayScheduled;ea.by=A.pasteIndicationDisplayStatus;ea.ck=A.pasteDestinationHasMergedCells;ea.bm=A.clipboardItems?A.clipboardItems.getItem(Wb.bhh):
null;ea.bi=!A.isSameSession&&!A.wasLastCopyExternal;ea.ci=A.cseStatus;yb.b().Wg(44,ea,!0)}al(){this.$.va.Fi(this.cm);this.$.va.r_g(this.Hxc);this.$.userOperationManager.Gt(this.vU);this.$.Pm(this.kf);Qa.h(this.$).Vd.yp(this.hDa)}zk(){this.$&&this.$.va&&(this.$.va.hj(this.cm),this.$.va.gCj(this.Hxc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.mq(this.vU);this.gridView&&this.gridView.Vd&&this.gridView.Vd.lp(this.hDa)}LNb(A,ea){var Ma=null;let Vb=!1;var tc=null;let Jc="UnknownFailure",
ld=-1,Zd=Mc.czb,De=Mc.pasteErrorName+Mc.TNa,Ve=!1;this.pasteIndicationManager.hnc(A.id,!1);this.pasteDestinationHasMergedCells(A.expandDestinations)&&(ea.pasteContext.pasteDestinationHasMergedCells=!0);const Se=Jb(this.SK);(A.clearStateOnFinish||A.clearSystemClipboard)&&this.Nt("Paste/fail/"+Wa.a[A.ribbonCommandInfo.method],!0,void 0,void 0,A.copyPasteTargetType).catch(()=>{});if(ea){ld=ea.reason;De+=Mc.pPa(ea);ea.message&&(Zd=ea.message);if(Ma=Mc.vnh(ea))if(1===Ma.pasteErrorName)Vb=!0,Jc="CopyPasteLengthTooLongPopup",
Zd=tc="The pasted content is too long. Popup a dialog to the user.",k.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}"`),Ma=fe.a.Ze(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),hb.EwaSettings.EA()?new zd.a(this.$,Ma):(Ma=new Qd.ErrorDialog(this.$,Ma),Ma.initialize(),Ma.hi());else if(7===Ma.pasteErrorName)Vb=!0,Jc="No-Op",Zd=tc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
k.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}"`);else if(8===Ma.pasteErrorName)Vb=!0,Jc="UseShortcutsPopup",Zd=tc="Unable to paste content from the system clipboard. Popup dialog to the user.",k.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}"`),this.oZf();else if(18===Ma.pasteErrorName){Vb=!0;Jc="PasteExternalNotSupportMultipleSelectionPopup";
Zd="Paste external not support multiple selection.";tc="Unknown";var sf=2192;100!==Ma.validationFailureReason&&(tc=bc[Ma.validationFailureReason],sf=Mc.zRe(Ma.validationFailureReason));this.ADa(sf,tc,!0)}else 20===Ma.pasteErrorName||19===Ma.pasteErrorName?(Vb=!0,20===Ma.pasteErrorName?(Jc="PasteAcrossSessionNotSupportMultipleSelectionPopup",Zd="Paste across session does not support multiple selection."):(Jc="PasteInSameSessionNotSupportMultipleSelectionPopup",Zd="This kind of multiple selection is not supported for same session paste."),
tc="Unknown",sf=2192,100!==Ma.validationFailureReason&&(tc=bc[Ma.validationFailureReason],sf=Mc.zRe(Ma.validationFailureReason)),Ma=6===Ma.validationFailureReason,this.M$b(A.commandType,A.expandDestinations)&&Ma&&this.PSb(A.expandDestinations),this.ADa(sf,tc,!0)):6===Ma.pasteErrorName?(Vb=!0,Jc="No-Op",Zd=tc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",k.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}"`)):
17===Ma.pasteErrorName?(Vb=!0,Jc="No-Op",Zd=tc="Paste text on Art is not yet a supported operation",k.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}"`)):16===Ma.pasteErrorName?(Vb=!0,Jc="No-Op",Zd=tc="Paste has failed because the previous copy has failed",Ma=this.getStringifiedError(Ma),k.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${tc}, copyPasteTargetType="${A.copyPasteTargetType}", error=${Ma}`)):
fe.a.Jr(Ma.ewaErrors)?(fe.a.bda(Ma.ewaErrors)||fe.a.aj(Ma.ewaErrors,fe.a.Vlc())?(Vb=!0,Jc="CommunicationError",tc=fe.a.me(Ma.ewaErrors),k.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Zd} copyPasteTargetType="${A.copyPasteTargetType}"`)):fe.a.aj(Ma.ewaErrors,Mc.UKj)?(Vb=!0,Jc="SavingWorkbookError",tc=fe.a.me(Ma.ewaErrors),k.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Zd} copyPasteTargetType="${A.copyPasteTargetType}"`)):fe.a.aj(Ma.ewaErrors,
Mc.operationSucceededWithAlert)&&(Ve=Vb=!0,Jc="OperationSucceededWithAlert",tc=fe.a.me(Ma.ewaErrors),k.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Zd} copyPasteTargetType="${A.copyPasteTargetType}"`)),Vb||(Zd=this.jkc(Ma.ewaErrors),Vb=this.nAd(ea))):11===Ma.pasteErrorName&&(Vb=!0,Jc="No-Op",Zd="Paste has failed because user try copy cross-session oart object");15===ea.reason&&(Vb=!0,Jc="No-Op",Zd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Lc.a.equals(De,Hb.Glk,!1)&&(Vb=!0,Jc="No-Op",Zd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Vb||(Ma=ea?this.getStringifiedError(ea):"null",k.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Ma}, copyPasteTargetType="${A.copyPasteTargetType}"`));this.bUi(A,Vb,Zd,Jc,De,ld,Ve,ea.pasteContext,Se);return Promise.reject(ea)}hyc(A,ea){var Ma;k.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ea.copyPasteTargetType}"`);
this.pasteIndicationManager.hnc(ea.id,!0);if(this.Wkj(ea.copyPasteTargetType,A)){hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&A.wasLastCopyExternal&&A.payloadType===Ea.shadowWorkbook&&(this.Ibb=!0);let Vb=null;(null===(Ma=A.pastedRange)||void 0===Ma?0:Ma.Ranges)&&0<A.pastedRange.Ranges.length?Vb=Zb.g(A.pastedRange.Ranges):A.wasLastCopyExternal||(Vb=ea.expandDestinations);this.JMj(A,Vb);if(this.EZj(A,Vb)){let tc;Ma=Zb.d(ea.originalDestinations);
tc=1028===ea.commandType?Zb.d(ea.expandDestinations):Zb.d(Vb);let Jc=null;A.wasLastCopyExternal&&(ea.isKeyboardEvent||ea.isPasteCommandFromRecoveryUI)&&(Jc={[Mc.$Xf]:A.clipboardItems});this.pasteDestinationHasMergedCells(ea.expandDestinations)&&(A.pasteDestinationHasMergedCells=!0);A.pasteRecoveryUIDisplayed=!0;const ld=new ta(this.$,Ma,tc,Jc),Zd=Ac.GetServiceTaskFactory.Vc(this.$.ea,406,405,0);Ed.TaskExtensions.ya(Zd,()=>{const De=Zd.result;De.FIe(ld);De.Glg(ea.ribbonCommandInfo.method)},this.ka,
8)}this.Y6i(A,Vb)}this.Rad("Paste/success/"+Wa.a[ea.ribbonCommandInfo.method],A);this.cUi(A);this.hkg&&(!ea.isKeyboardEvent||Va(A))&&this.$.da.Ii.get(66)&&(k.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.hkg=!1,this.cph());return Promise.resolve(!0)}Y6i(A,ea){Ed.TaskExtensions.ya(Ac.GetServiceTaskFactory.Vc(this.$.ea,534,535,1),Ma=>{Ma.result.Wck(A,ea)},this.$.ka,3)}EZj(A,ea){return!ea||1!==ea.length||A.commandParameters.clearSystemClipboard||
A.commandParameters.clearStateOnFinish||A.commandParameters.skipClipboardAccess?!1:Ob(A)&&(ea=A.clipboardItems.getItem(Wb.plainText),A=A.clipboardItems.getItem(Wb.html),void 0===ea||null===ea||ea.length>this.NXi||void 0===A||null===A||A.length>this.nCa)?(k.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}Wkj(A,ea){return 1===A||ea.payloadType===Ea.plainText||hb.EwaSettings.Da(151)&&ea.payloadType===Ea.html||
hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&ea.payloadType===Ea.shadowWorkbook}pasteDestinationHasMergedCells(A){const ea=Qa.h(this.$).za.Ky();if(!ea||!ea.length)return!1;for(const Ma of ea)if(Ma.Sv(A[0]))return!0;return!1}Rad(A,ea){let Ma;(()=>{let Vb=this.ZCi(ea);({eMa:Ma}=Vb);return Vb})().returnValue&&this.Nt(A,Ma,void 0,void 0,ea.commandParameters.copyPasteTargetType).catch(()=>{})}qeb(A,ea,Ma,Vb,tc,Jc){const ld=A?this.getStringifiedError(A):
"null";let Zd=!1,De=!1,Ve=!1,Se=Mc.czb,sf=Mc.pZe+Mc.TNa;A&&(sf+=Mc.pPa(A),fe.a.Jr(A.ewaErrors)?(Se=this.jkc(A.ewaErrors),fe.a.aj(A.ewaErrors,Mc.operationSucceededWithAlert)&&(Zd=!0),fe.a.aj(A.ewaErrors,Mc.dragDropNonEmptyRange)&&(De=Ve=!0)):A.message&&(Se=A.message));Ve||(Ve=this.nAd(A));De?this.gridView.ha.selectionType=-1:this.Zp.iwj(tc);Ve||k.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${ld}, copyPasteTargetType="${ea.copyPasteTargetType}`);this.QSi(ea,Ma,
Vb,tc,Ve,Se,sf,Zd,Jc)}A$b(A,ea){let Ma=A;const Vb=this.Rai();if(null===Vb||void 0===Vb?0:Vb.ranges)Ma=this.Zp.fdh(ea,Vb.ranges,A);return Ma}Rai(){const A=Jb(this.SK);return A&&mb(A.sourceItem)?A.sourceItem:null}ltj(){this.raiseEvent(Mc.GOd,null)}JMj(A,ea){const Ma=A.commandParameters.originalDestinations;ea&&(Zb.R(this.gridView.ha.ra.selectedRanges,Ma)?(this.PSb(ea),A=Xb.HelperMethods.cvb(ea),k.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${A}`)):
A.commandParameters.isPasteCommandFromRecoveryUI?(this.PSb(ea,!0),k.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ea}, active cell: ${ea[0].topLeft}`)):(A=Xb.HelperMethods.cvb(Ma),k.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${A}`)))}ZCi(A){if(A.isPlainTextPaste||
A.isHtmlPaste||Gc(A)||A.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,eMa:!1};var ea=A.copyContextSnapshot;if(A.commandParameters.clearStateOnFinish)return{returnValue:!0,eMa:!0};if(ea&&mb(ea.sourceItem)){var Ma=ea.sourceItem;if(!Ma.isFromCurrentSession(this.$))return{returnValue:!1,eMa:!0};ea=-1985798686===ea.commandParameters.ribbonCommandInfo.command;if(!(1<Ma.ranges.length||1<A.commandParameters.expandDestinations.length)){const Vb=Zb.L(Ma.ranges);A=Zb.L(A.commandParameters.expandDestinations);
const tc=this.$.da.na.sheetName;Ma=Ma.sheetName;if(Ma===tc&&A.equals(Vb))return{returnValue:!1,eMa:!0};if(Ma===tc&&A.Xf(Vb))return{returnValue:!0,eMa:!1}}return{returnValue:ea,eMa:!0}}return{returnValue:!1,eMa:!0}}eVf(){var A=Jb(this.SK);(A=this.Zp.z9a(A))&&A.isFromCurrentSession(this.$)&&this.Nt("OnStartEdit",!1).catch(()=>{})}jkc(A){A=fe.a.j8h(A,Mc.TNa);return this.YYi+Sa.a.zy(A).toString()}nAd(A){A=Mc.pPa(A);return!!A&&Lc.a.oAb(A,Mc.XYi)}cph(){const A=fe.a.Ze(1,2,327,328,ja.a.Eo?329:ja.a.QF?330:
331,530046625,"ActivateLocalStorage"),ea=Object(Re.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Zc.d)(Ib.a.resolve(Yc.l,{Qa:0})):Ac.GetServiceTaskFactory.Vc(this.$.ea,5,4,0);Ed.TaskExtensions.ya(ea,()=>{ea.result.ki(43,A)},this.ka,3)}GRe(A){return void 0===A||null===A?bb.v1i:A?bb.success:bb.failed}static vnh(A){const ea=A.innerError;return ea&&0!==ea.pasteErrorName?A.innerError:null}static inh(A){const ea=A.innerError;return ea&&0!==ea.copyErrorName?A.innerError:null}static pPa(A){let ea=
"";if(!A)return Mc.eWe;A.errorName&&(ea=A.errorName,A.innerError&&(ea+=Mc.TNa+Mc.pPa(A.innerError)));ea||(ea=A&&A.name?A.name:Mc.eWe);return ea}static wjc(){Mc.$b||(Mc.$b=za.l3j);return Mc.$b}static zRe(A){switch(A){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return k.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${A}`),2199}}static jnh(A){switch(A){case 3:return 2193;
case 1:return 2194;case 2:case 4:return 2192;default:return k.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${A}`),2199}}}Mc.CHf="EwaJsMetadataChangeListenerId";Mc.GOd="cpiOSC";Mc.kyh="cpiDID";Mc.czb="Unknown";Mc.eWe="UnknownError";Mc.TNa="_";Mc.pZe="DragAndDropError";Mc.pasteErrorName="PasteError";Mc.oeh="CancelError";Mc.copyErrorName="CopyError";Mc.XYi="MergedCellOverlap";Mc.$Xf="PasteRecoveryCachedClipboardItems";
Mc.UKj=[1352631530,1679665408];Mc.operationSucceededWithAlert=[-103190598];Mc.pasteDataLimitHit=[1306609195];Mc.copyThrottlingError=[-386183710];Mc.dragDropNonEmptyRange=[563945982];Mc.$b=null;Object(x.a)(Mc,"CopyPasteInfrastructure",Sb.a,[549,550,5]);class xd{constructor(){this.p5a=this.uOe=null}}Object(x.a)(xd,"ClipboardPlatformInitializationResult",null,[]);var Nd=a(662),te=a(238),tb=a(124),Gb=a(7),fd=a(65);const lc=(A,ea,Ma,Vb,tc,Jc,ld,Zd)=>{Zd=void 0===Zd?null:Zd;ld=A.Ra(1,ld);ld.pasteHtmlParameters=
ea;return fd.g(A,"PasteHtmlContent",ld,Ma,Vb,tc,Jc,64,Zd)},$c=(A,ea,Ma,Vb,tc,Jc,ld,Zd,De)=>{De=void 0===De?null:De;Zd=A.Ra(9,Zd);Zd.destinationRange=ea;Zd.source=Ma;return fd.g(A,"PasteString",Zd,Vb,tc,Jc,ld,64,De)},Md=(A,ea,Ma,Vb,tc,Jc,ld,Zd)=>{Zd=void 0===Zd?null:Zd;ld=A.Ra(1,void 0===ld?null:ld);ld.copyParameters=ea;return fd.g(A,"Copy",ld,Ma,Vb,tc,Jc,0,Zd)},dd=(A,ea,Ma,Vb,tc,Jc,ld,Zd)=>{Zd=void 0===Zd?null:Zd;ld=A.Ra(1,void 0===ld?null:ld);ld.pasteParameters=ea;return fd.g(A,"Paste",ld,Ma,Vb,
tc,Jc,64,Zd)};class ee{constructor(A,ea,Ma){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=A;this.destinationRange=ea;this.pasteFlags=Ma}}Object(x.a)(ee,"MacroRecorderPasteRangePayload",null,[134]);class Tc{constructor(A,ea){this.content=this.destinationRange=null;this.destinationRange=A;this.content=ea}getContent(){return this.content}}Object(x.a)(Tc,"MacroRecorderPasteStringPayload",null,[134]);var wd=a(74);class Kb{constructor(A){this.pasteParameters=null;this.pasteParameters=
A}}Object(x.a)(Kb,"MacroRecorderPastePayload",null,[134]);var Vc=a(602),Hd;(function(A){A[A.none=0]="none";A[A.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";A[A.applyLinkFailed=2]="applyLinkFailed";A[A.pasteHtmlFailed=3]="pasteHtmlFailed";A[A.pasteStringFailed=4]="pasteStringFailed";A[A.pasteRangeFailed=5]="pasteRangeFailed";A[A.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";A[A.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";
A[A.clipboardIsInaccessible=8]="clipboardIsInaccessible";A[A.pasteArtFailed=9]="pasteArtFailed";A[A.noArtSourceItem=10]="noArtSourceItem";A[A.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";A[A.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";A[A.invalidShadowWorkbook=13]="invalidShadowWorkbook";A[A.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";A[A.failedToPasteExternalImage=15]="failedToPasteExternalImage";A[A.lastAsyncSerializeFailed=16]=
"lastAsyncSerializeFailed";A[A.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";A[A.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";A[A.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";A[A.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";A[A.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";
A[A.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(Hd||(Hd={}));Object(x.b)("PasteErrorType",Hd);class Xd{constructor(A,ea){this.errorName=this.innerError=null;this.errorName=A;this.innerError=void 0===ea?null:ea}}Object(x.a)(Xd,"CCPError",null,[]);class qe extends Xd{constructor(A,ea){ea=void 0===ea?null:ea;super(fe.a.me(void 0===A?null:A,"_"),ea)}}Object(x.a)(qe,"EwaCCPError",Xd,[]);class $d extends Xd{constructor(A,ea,Ma,Vb,tc){ea=void 0===ea?null:ea;Ma=void 0===Ma?null:Ma;Vb=void 0===
Vb?"":Vb;tc=void 0===tc?100:tc;super(Hd[A]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=A;this.ewaErrors=ea;this.validationFailureReason=tc;this.innerError=ea?new qe(ea,Ma):Ma;this.message=Vb}}Object(x.a)($d,"PasteInnerError",Xd,[]);var de=a(202),le=a(31),$b=a(220),wc=a(126),gd=a(295),Ud=a(358);class ne{constructor(A){this.parameters=null;this.parameters=A}getParameters(){return this.parameters}}Object(x.a)(ne,"MacroRecorderRangeCopyCutCellsInsertedPayload",
null,[134]);var rc=a(384);class kd{constructor(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){this.destinationRange=A;this.Qxb=Ma;this.Nkj=Vb;this.hf=tc;this.RXb=Jc;this.pasteContext=ld;this.Bac=Zd;this.Qrg=De}}Object(x.a)(kd,"PasteHtmlRequestParams",null,[]);class qd{constructor(A,ea){this.Vsc=this.tSa=null;this.xUa=aa.a.xUa;this.VPd=aa.a.VPd;this.pLb=aa.a.pLb;this.vpc=hb.EwaSettings.getBooleanFeatureGate(aa.a.zyb,!1);this.Hyd=!1;this.ZAa=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");
this.DGi=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8000555_CopyPasteWFEIncreasedLimitsForPasteString2");this.mC=(Ma,Vb)=>{if(2===Vb.kt)this.Xx.clear(),this.tSa=null;else if(1===Vb.kt&&this.Xx&&this.Xx.contains(Vb.Jh)){Ma=tb.a(Vb.Jh.operation.operationName);const tc=Vb.Jh.dequeueUtcTime.getTime()-Vb.Jh.enqueueUtcTime.getTime();k.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Ma} returned, it took ${tc} milliseconds to complete.`);this.Xx.remove(Vb.Jh);this.tSa=null}};
this.$=A;this.gridView=ea;this.Hyd&&(this.$.userOperationManager.Gt(this.mC),this.Xx=new ha.a)}get nCa(){return this.ZAa?hb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):Bc.a.nCa}copy(A,ea,Ma,Vb,tc){Vb=void 0===Vb?null:Vb;tc=void 0===tc?null:tc;const Jc=this.$.pa.ua.Ud();this.Hyd&&this.p0();this.Vsc=Jc.ClientRequestId;var ld=new de.a(505,0,(Zd,De,Ve)=>{const Se={CopyPasteTargetType:1};Se.SourceRanges=A;Se.CopyOperationId=ea.id;
k.ULS.sendTraceTag(537167756,0,50,`CopyPasteInfrastructure.Copy served from CopyPasteProxy : ${this.ZAa}, CopyOperationId : ${Se.CopyOperationId}`);return this.tSa=this.ZAa?Md(this.$.pa.Dx,Se,gd.b(Zd,Ma),Vb?gd.a(De,Vb):De,Ve,ea.ribbonCommandInfo,Jc,tc):Md(this.$.pa.ua,Se,gd.b(Zd,Ma),Vb?gd.a(De,Vb):De,Ve,ea.ribbonCommandInfo,Jc,tc)},80);ld=this.$.userOperationManager.enqueueOperation(ld,ea.ribbonCommandInfo);this.Hyd&&this.Xx.add(ld)}ZXf(A,ea,Ma,Vb,tc,Jc){return new Promise((ld,Zd)=>{var De;const Ve=
Jc.commandParameters.stopwatch.Ee;let Se=2;20===Jc.commandParameters.commandType&&(Se=16);36===Jc.commandParameters.commandType&&(Se=32);68===Jc.commandParameters.commandType&&(Se=64);le.a.iEd(this.$)&&1028===Jc.commandParameters.commandType&&(Se=1024);hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteWithColumnWidthsEnabled",!1)&&4100===Jc.commandParameters.commandType&&(Se=4096);let sf=null;if(null===(De=Jc.copyContextSnapshot)||void 0===De?0:De.commandParameters)sf=Jc.copyContextSnapshot.commandParameters.id;
qd.I_d(this.$,A,Vb,ea,Ma,null,Of=>{qd.umc(Of,Jc,ld,Zd,Ve,this.$,null,!0,null,null)},Of=>{Jc.serverRequestTimeInMs=Jc.commandParameters.stopwatch.Ee-Ve;Of=wc.a.Bg(Of.data);Zd(new $d(5,Of))},tc,Se,sf,Jc.commandParameters.id)})}pasteRange(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve){return new Promise((Se,sf)=>{const Of=ld.commandParameters.stopwatch.Ee;qd.TNj(this.$,A,ea,Ma,Vb|-5&tc,qg=>{qd.umc(qg,ld,Se,sf,Of,this.$,null,!0,De,Ve)},qg=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Ee-Of;qg=wc.a.Bg(qg.data);
qg=new $d(5,qg);null===Ve||void 0===Ve?void 0:Ve(qg);sf(qg)},Jc,Zd)})}jqj(A,ea,Ma,Vb,tc,Jc,ld){return(new Promise((Zd,De)=>{if(ea)if(ea.length>this.nCa){var Ve=ld.clipboardItems.getItem(Wb.plainText);let Se=-1;void 0!==Ve&&null!==Ve&&(Se=Ve.length);aa.a.Vtf&&ea.length<this.VPd&&ea.length>this.xUa&&(this.hZf(ea),this.fZ=new kd(A,ea,Ma,Vb,tc,Jc,ld,0,this.Hzc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.kQd()));k.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ea.length}, MaxHtmlImportLength: ${this.nCa}, PlainTextLength: ${Se}`);
De(new $d(1))}else Ve=new de.a(204,0,(Se,sf,Of)=>{this.$.VA();const qg=ld.commandParameters.stopwatch.Ee;Se=gd.b(Se,ri=>{qd.umc(ri,ld,Zd,De,qg,this.$,ea,!1,null,null)});sf=gd.a(sf,ri=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Ee-qg;ri=wc.a.Bg(ri.data);De(new $d(3,ri))});const yg=this.$.pa.ua.Ud(),lg=Zb.v(A,this.$),Cg={};Cg.SourceHtml=ea;Cg.DestinationRanges=lg?Zb.s(lg):null;Cg.CopyOperationId=Ma;Cg.PasteId=Vb;k.ULS.sendTraceTag(537167755,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.ZAa}. PasteId : ${Cg.PasteId}`);
return this.ZAa?lc(this.$.pa.Dx,Cg,Se,sf,Of,null,yg,Jc):lc(this.$.pa.ua,Cg,Se,sf,Of,null,yg,Jc)},65),this.$.userOperationManager.enqueueOperation(Ve,tc);else Zd("")})).then(()=>{aa.a.Vtf&&ea.length>this.xUa&&(this.hZf(ea),this.fZ=new kd(A,ea,Ma,Vb,tc,Jc,ld,0,this.Hzc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.kQd()))})}hZf(A){const ea=this.$.Jd.Le("Task","pasteHtmlChunkOperation"),Ma=Math.floor(A.length/this.xUa)+1;this.Hzc=Array(Ma);let Vb=0;for(;Vb<Ma;)this.Hzc[Vb]=
A.substring(Vb*this.xUa,(Vb+1)*this.xUa),Vb++;k.ULS.sendTraceTag(523257954,0,50,`CopyPasteUtils.populatePasteChunks Time taken for chunking: ${ea.Ee}`)}kQd(){this.Mkj(this.fZ.destinationRange,this.Hzc[this.fZ.Bac],this.fZ.Qxb,this.fZ.Nkj,this.fZ.hf,this.fZ.RXb,this.fZ.pasteContext,this.fZ.Bac,this.fZ.Qrg);this.fZ.Bac++;this.fZ.Bac<this.fZ.Qrg&&window.requestIdleCallback(()=>this.kQd())}Mkj(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){const Ve=new de.a(204,0,(Se,sf,Of)=>{const qg=ld.commandParameters.stopwatch.Ee;Se=
gd.b(Se,()=>{k.ULS.sendTraceTag(512313415,0,15,`CopyPasteUtils.pasteHtmlServerCall succeeded serverRequestTimeInMs:${ld.commandParameters.stopwatch.Ee-qg},
             pasteid:${Vb},
             chunkIndex:${Zd},
             totalChunks:${De}`)});sf=gd.a(sf,()=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Ee-qg;k.ULS.sendTraceTag(512313414,0,15,`CopyPasteUtils.pasteHtmlServerCall failed serverRequestTimeInMs:${ld.serverRequestTimeInMs},
               pasteid:${Vb},
               chunkIndex:${Zd},
               totalChunks:${De}`)});const yg=this.$.pa.ua.Ud(),lg=Zb.v(A,this.$),Cg={};Cg.SourceHtml=ea;Cg.DestinationRanges=lg?Zb.s(lg):null;Cg.CopyOperationId=Ma;Cg.PasteId=`${Vb}_chunk_${Zd}`;Cg.ChunkIndex=Zd;Cg.TotalChunks=De;k.ULS.sendTraceTag(523257952,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.ZAa}. PasteId : ${Cg.PasteId}`);return lc(this.$.pa.Dx,Cg,Se,sf,Of,null,yg,Jc)},65);this.$.userOperationManager.enqueueOperation(Ve,tc)}kqj(A,ea,Ma,Vb,tc){return new Promise((Jc,
ld)=>{k.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${tc.id}`);ea&&(ea=Lc.a.trimEnd(ea,"\n","\r"));k.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${tc.id}`);if(ea)if(ea.length>this.pLb)k.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
ea.length,this.pLb),ld(new $d(1));else{let De,Ve;const Se=Zb.v(A,this.$);k.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${tc.id}`);var Zd=!this.$.da.isNamedObjectViewMode&&!ea.includes("\n")&&!ea.includes("\t");k.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${tc.id}. treatAsLink=${Zd}`);Zd=Zd&&Lc.a.pvf(ea);k.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${tc.id}. treatAsLink=${Zd}`);const sf=this.$.pa.ua.Ud();if(Zd){Ve=526;k.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${tc.id}`);const Of=$b.a.vmd(ea);k.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${tc.id}`);const qg=Zb.s(Se);Zd=(yg,
lg,Cg)=>{const ri=tc.commandParameters.stopwatch.Ee;yg=gd.b(yg,xi=>{k.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${tc.id}`);tc.requestTelemetryData=xi.RequestTelemetryData;tc.serverRequestTimeInMs=tc.commandParameters.stopwatch.Ee-ri;xi.Errors&&0<xi.Errors.length?ld(new $d(2,xi.Errors)):Jc(ea)});lg=gd.a(lg,xi=>{tc.serverRequestTimeInMs=tc.commandParameters.stopwatch.Ee-ri;xi=wc.a.Bg(xi.data);ld(new $d(2,
xi))});this.$.VA();k.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${tc.id}`);return fd.b(this.$.pa.ua,qg,ea,Of,!1,!1,63,yg,lg,Cg,A,sf,Vb)};De=()=>new Vc.a(qg,ea,Of)}else Ve=180,Zd=(Of,qg,yg)=>{this.$.VA();const lg=tc.commandParameters.stopwatch.Ee;Of=gd.b(Of,Cg=>{k.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${tc.id}`);
qd.umc(Cg,tc,Jc,ld,lg,this.$,ea,!1,null,null)});qg=gd.a(qg,Cg=>{tc.serverRequestTimeInMs=tc.commandParameters.stopwatch.Ee-lg;Cg=wc.a.Bg(Cg.data);ld(new $d(4,Cg))});k.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${tc.id}`);return $c(this.DGi?this.$.pa.Dx:this.$.pa.ua,Se,ea,Of,qg,yg,null,sf,Vb)},De=()=>new Tc(Se,ea);k.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${tc.id}`);
Zd=new de.a(Ve,0,Zd,65,De);k.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${tc.id}`);this.$.userOperationManager.enqueueOperation(Zd,Ma)}else Jc("")})}Onf(A,ea){ea=[1===ea?4:5];this.gridView.zd.AC(Ud.a.PFa(wd.d(this.$.na),A),ea,!0);this.gridView.zd.tt(ea);this.gridView.zd.update(!0)}Nvd(){const A=[4,5];this.gridView.zd.Sl(A,!1,!1);this.gridView.zd.sm(null,A,!1);1===this.gridView.ha.ng&&this.gridView.tt(!1,!1);this.gridView.zd.update(!1,
!1)}fdh(A,ea,Ma){const Vb=[];for(const tc of Ma)Vb.push(this.mdh(A,ea,tc));return Vb}p0(){if(this.Xx)for(let A of this.Xx)if(this.$&&this.$.userOperationManager){if(A.operation){const ea=tb.a(A.operation.operationName);k.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ea}.`)}this.meh();this.$.userOperationManager.cya(A)}}meh(){if(this.tSa){const A=this.tSa.Bw;k.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${A}`);
wc.a.nx(A);!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.Vsc&&fd.h(this.$.pa.ua,this.Vsc,null,null,null);this.Vsc=this.tSa=null}}mdh(A,ea,Ma){k.ULS.shipAssertTag(537167713,0,!!ea,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");k.ULS.shipAssertTag(537167712,0,0<ea.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let Vb=0,tc=0;var Jc=new Set;const ld=new Set;for(const Zd of ea){ea=`${Zd.left}_${Zd.right}`;
const De=`${Zd.top}_${Zd.bottom}`;ld.has(ea)||(ld.add(ea),tc+=Zd.width);Jc.has(De)||(Jc.add(De),Vb+=Zd.height)}if(36===A)return Ma.isSingle?qd.i6e(tc,Vb,Ma):Ma.clone();516===A&&(A=Vb,Vb=tc,tc=A);A=!(Ma.width%tc)&&!(Ma.height%Vb);Jc=Ma.eQ&&!(Ma.height%Vb);Ma.u9&&!(Ma.width%tc)||Jc?Ma=qd.i6e(tc,Vb,Ma):A?Ma=Ma.clone():(Ma=Ma.clone(),Ma.bottom=Math.min(Bc.a.qh,Ma.top+Vb-1),Ma.right=Math.min(Bc.a.ph,Ma.left+tc-1));return Ma}p5g(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve,Se){if(!Vb||!Vb.length)return 1;if(1<Vb.length){if(!this.vpc&&
Jc)return 3;if(Ve)return 0;if(Zd)return 9;if(De)return 8;if(Se)return 2;if(1<ea.length)return 4;const sf=ea[0];if(!ld&&!te.a.all(Vb,Of=>Of.isSingle||!(Of.width%sf.width)&&!(Of.height%sf.height)))return 5;if((!this.vpc||!Jc)&&Lc.a.equals(A,Ma,!0))for(const Of of tc)if(Of.Te(sf)&&!Of.equals(sf))return 6}else if(ea&&0<ea.length){if(0!==this.Tsf(ea,De))return 7;if(1<ea.length){if(!this.vpc&&Jc)return 3;if((!this.vpc||!Jc)&&Lc.a.equals(A,Ma,!0))for(const sf of ea)if(A=tc[0],sf.Te(A)&&!sf.equals(A))return 6}}return 0}Tsf(A,
ea){if(!A||1>=A.length)return 0;if(ea)return 2;if(!Zb.T(A))return 1;ea=new Nd.a(t.a.Qh());for(const Ma of A)for(const Vb of A){const tc=Ma.top===Vb.top&&Ma.bottom===Vb.bottom,Jc=Ma.left===Vb.left&&Ma.right===Vb.right,ld=Math.max(Ma.left,Vb.left)<Math.min(Ma.right,Vb.right);if(Math.max(Ma.top,Vb.top)<Math.min(Ma.bottom,Vb.bottom)&&!tc||ld&&!Jc)return 3;ea.add(`${Ma.top}-${Ma.bottom}-${Vb.left}-${Vb.right}`);ea.add(`${Vb.top}-${Vb.bottom}-${Ma.left}-${Ma.right}`)}for(const Ma of A)ea.remove(`${Ma.top}-${Ma.bottom}-${Ma.left}-${Ma.right}`);
return 0<ea.count?3:0}iwj(A){const ea=this.gridView.ha;ea.updateSelection(A,A.topLeft,0);ea.selectionType=-1}z9a(A){if(null===A||void 0===A?0:A.sourceItem){if(!mb(A.sourceItem))return null;if((A=A.sourceItem)&&Zb.db(A.ranges,!0))return A}return null}FHb(A,ea){k.ULS.shipAssertTag(537167711,0,!!A,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return ea&&Gb.a.qG in ea||A.tabName?!1:1===A.method}static TNj(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){const Ve=A.pa.ua.Ud(De?{Cpa:!0,ooa:1}:{Cpa:!1,
ooa:0});De=new de.a(506,0,(Se,sf,Of)=>{A.VA();var qg=A.pa.ua;Se=gd.b(Se,Jc);sf=gd.a(sf,ld);var yg=Zd;yg=void 0===yg?null:yg;const lg=qg.Ra(9,Ve);lg.sourceRanges=Ma;lg.destinationRanges=Vb;lg.flags=tc;return fd.g(qg,"PasteRange",lg,Se,sf,Of,null,64,yg)},65,()=>new ee(Ma,Vb,tc));A.userOperationManager.enqueueOperation(De,ea)}static umc(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve){ld=void 0===ld?null:ld;k.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ea.id}`);
ea.requestTelemetryData=A.RequestTelemetryData;ea.serverRequestTimeInMs=ea.commandParameters.stopwatch.Ee-tc;fe.a.Bh(A.Errors)?fe.a.Qka(A.Errors)?(ea&&(ea.encounteredDeploymentErrors=!0),A=fe.a.me(A.Errors),k.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${A}`)):(A=new $d(5,A.Errors),null===Ve||void 0===Ve?void 0:Ve(A),Vb(A)):A.Result?(Vb=!!A&&!!A.RequestTelemetryData,Qa.h(Jc).Ri.Dpa(ea.commandParameters.stopwatch.id,
A.StateId,Vb?A.RequestTelemetryData.EcsOperationDuration:0,Vb?A.RequestTelemetryData.EcsRequestDuration:0,Vb?A.RequestTelemetryData.WfeRequestDuration:0),ea.pastedRange=A.Result.SheetMultiRange,k.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ea.id}`),null===De||void 0===De?void 0:De(),Ma(!0),hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&Zd&&!ea.commandParameters.isDragDrop&&(ea=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?Ib.a.Ph(Yc.Sb):Jc.ea.Ba(465))&&ea.Yaa(6,A)):(k.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ea.id}`),Ma(ld||!0))}static I_d(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve,Se,sf){const Of=A.pa.ua.Ud(),qg=qd.aUe(Ma,Vb,tc,Ve,Se,sf);Ma=new de.a(503,0,(yg,lg,Cg)=>{A.VA();
return dd(A.pa.ua,qg,gd.b(yg,ld),gd.a(lg,Zd),Cg,Jc,Of,De)},65,()=>new Kb(qg));A.userOperationManager.enqueueOperation(Ma,ea)}static aUe(A,ea,Ma,Vb,tc,Jc){const ld={};ld.ShadowWorkbookBase64=A.shadowWorkbookBase64;ld.SourceRanges={};ld.SourceRanges.Ranges=Array(1);ld.SourceRanges.Ranges[0]={};ld.SourceRanges.Ranges[0].FirstRow=A.rangeRowStart;ld.SourceRanges.Ranges[0].LastRow=A.rangeRowEnd;ld.SourceRanges.Ranges[0].FirstColumn=A.rangeColumnStart;ld.SourceRanges.Ranges[0].LastColumn=A.rangeColumnEnd;
hb.EwaSettings.getBooleanFeatureGate(aa.a.zyb,!1)?Ma?ld.DestinationRanges=Zb.u(Ma.SheetName,Ma.NamedObjectName,Zb.g(Ma.Ranges)):(k.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),ld.DestinationRanges=null):ld.DestinationRanges=ea?Zb.s(ea):null;ld.CopyPasteTargetType=1;ld.PasteType=Vb;ld.CopyOperationId=tc;ld.PasteId=Jc;ld.SourceClientPath=A.sourceClientPath;ld.SourceSheetName=A.sourceSheetName;ld.SourceWorkbookName=A.sourceWorkbookName;
if(!A.originalSourceRangesCountExceedsLimit&&A.originalSourceRanges&&0<A.originalSourceRanges.length&&1024===Vb){ld.OriginalSourceMultiRange={};ea=Array(A.originalSourceRanges.length);for(Ma=0;Ma<ea.length;++Ma)ea[Ma]={},ea[Ma].FirstRow=A.originalSourceRanges[Ma][0],ea[Ma].FirstColumn=A.originalSourceRanges[Ma][1],ea[Ma].LastRow=A.originalSourceRanges[Ma][2],ea[Ma].LastColumn=A.originalSourceRanges[Ma][3];ld.OriginalSourceMultiRange.Ranges=ea}return ld}static i6e(A,ea,Ma){Ma=Ma.clone();Ma.height<
ea&&(Ma.bottom=Math.min(Bc.a.qh,Ma.top+ea-1));Ma.width<A&&(Ma.right=Math.min(Bc.a.ph,Ma.left+A-1));return Ma}iZj(A,ea,Ma){return(A=Qa.h(A).ed.Dh(Ma))?ea.width===A.usedRange.width&&Ma.left===A.usedRange.left||Ma.left===A.usedRange.left&&Ma.right===A.usedRange.right&&0===Ma.width%ea.width:!1}hZj(A,ea,Ma){return(A=Qa.h(A).ed.Dh(Ma))?ea.height===A.usedRange.height&&Ma.top===A.usedRange.top||Ma.top===A.usedRange.top&&Ma.bottom===A.usedRange.bottom&&0===Ma.height%ea.height:!1}executeInsertCopiedCutCellsOperation(A,
ea,Ma,Vb,tc,Jc,ld){Jc=void 0===Jc?null:Jc;ld=void 0===ld?null:ld;const Zd={};Zd.InsertDirection=Vb;Zd.SourceRange=A;Zd.DestRange=ea;Zd.CopyCutOperation=Ma?0:1;const De=this.$.pa.ua,Ve=this.$.pa.ua.Ud(),Se=()=>new ne(Zd);return rc.a(this.$.userOperationManager,(sf,Of,qg)=>{sf=Jc?gd.b(sf,Jc):sf;Of=ld?gd.a(Of,ld):Of;const yg=De.Ra(41,null);yg.insertCopiedCutCellsParameters=Zd;return fd.g(De,"InsertCopiedCutCellsV2",yg,sf,Of,qg,Ve,0)},sf=>new de.a(104,0,sf,void 0,Se),tc)}vZe(A,ea,Ma,Vb,tc,Jc,ld,Zd){return new Promise((De,
Ve)=>{this.executeInsertCopiedCutCellsOperation(ea,Ma,Vb,tc,Jc,Se=>{A.requestTelemetryData=Se.RequestTelemetryData;if(Se.Errors&&0<Se.Errors.length){const sf=new $d(21,Se.Errors);null===Zd||void 0===Zd?void 0:Zd(sf);Ve(new $d(21,Se.Errors))}else null===ld||void 0===ld?void 0:ld(),De(!0)},Se=>{Se=wc.a.Bg(Se.data);Se=new $d(21,Se);null===Zd||void 0===Zd?void 0:Zd(Se);Ve(Se)})})}executeInsertCopiedCutCellsAcrossSession(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve,Se){Jc=void 0===Jc?null:Jc;ld=void 0===ld?null:ld;let sf=
{};sf.PasteParameters=qd.aUe(Ve,Zd,De,2,Se.copyContextSnapshot.commandParameters.id,Se.commandParameters.id);sf.InsertDirection=Vb;sf.SourceRange=A;sf.DestRange=ea;sf.CopyCutOperation=Ma?0:1;const Of=this.$.pa.ua,qg=this.$.pa.ua.Ud(),yg=()=>new ne(sf);return rc.a(this.$.userOperationManager,(lg,Cg,ri)=>{lg=Jc?gd.b(lg,Jc):lg;Cg=ld?gd.a(Cg,ld):Cg;const xi=Of.Ra(41,null);xi.insertCopiedCutCellsParameters=sf;return fd.g(Of,"InsertCopiedCutCellsCrossSession",xi,lg,Cg,ri,qg,0)},lg=>new de.a(106,0,lg,void 0,
yg),tc)}}Object(x.a)(qd,"CopyPasteUtils",null,[546]);var oe=a(441),Yd;(function(A){A[A.range=0]="range";A[A.art=1]="art"})(Yd||(Yd={}));Object(x.b)("SourceItemType",Yd);var We=a(94);class He{constructor(A){this.Aog={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1};this.uVb={};this.wog={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,
["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.D7c={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",
["100"]:"FloatingObjectType.Unsupported"};this.zog={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686};this.LYd={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut"};this.yog={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.loa={};this.xog={["FrameMode.None"]:0,["FrameMode.Reading"]:1,
["FrameMode.Edit"]:2};this.s8a={};this.Bog={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,
["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.lu={};this.$=A;this.loa.notDefined="InputManager.InputMethod.NotDefined";this.loa.unknown="InputManager.InputMethod.Unknown";this.loa.keyboard="InputManager.InputMethod.Keyboard";this.loa.mouse="InputManager.InputMethod.Mouse";this.loa.touch=
"InputManager.InputMethod.Touch";this.loa.crossSlide="InputManager.InputMethod.CrossSlide";this.s8a.none="FrameMode.None";this.s8a.reading="FrameMode.Reading";this.s8a.edit="FrameMode.Edit";this.lu.unknown="UILocation.Unknown";this.lu.upperRibbon="UILocation.UpperRibbon";this.lu.ribbon="UILocation.Ribbon";this.lu.QAT="UILocation.QAT";this.lu.jewel="UILocation.Jewel";this.lu.navigationPane="UILocation.NavigationPane";this.lu.keyboardShortcut="UILocation.KeyboardShortcut";this.lu.statusBar="UILocation.StatusBar";
this.lu.dialog="UILocation.Dialog";this.lu.floatie="UILocation.Floatie";this.lu.notificationBar="UILocation.NotificationBar";this.lu.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.lu.taskPane="UILocation.TaskPane";this.lu.heroDock="UILocation.HeroDock";this.lu.singleLineRibbon="UILocation.SingleLineRibbon";this.lu.multilineRibbon="UILocation.MultilineRibbon";this.lu.overflow="UILocation.Overflow";this.lu.tellMe="UILocation.TellMe";this.lu.farPeripheralControls="UILocation.FarPeripheralControls";
this.lu.header="UILocation.Header";this.lu.fileMenu="UILocation.FileMenu";this.lu.contextMenu="UILocation.ContextMenu";this.lu.dialogMenu="UILocation.DialogMenu";this.lu.toolbar="UILocation.Toolbar";this.lu.canvas="UILocation.Canvas";this.uVb.range="SourceItemType.Range";this.uVb.art="SourceItemType.Art"}serializeSourceItem(A){const ea={};if(A&&Object.getType(A)===ic)ea.sheetName=A.sheetName,ea.topArray=te.a.map(A.ranges,Ma=>Ma.top),ea.leftArray=te.a.map(A.ranges,Ma=>Ma.left),ea.bottomArray=te.a.map(A.ranges,
Ma=>Ma.bottom),ea.rightArray=te.a.map(A.ranges,Ma=>Ma.right),ea.sessionStateId=A.sessionStateId,ea.sessionId=A.sessionId,ea.sourceItemType=this.seg(0);else if(A&&Object.getType(A)===Ga)ea.activeFloatingObjectControlId=A.activeFloatingObjectControlId,ea.sheetName=A.sheetName,ea.sessionStateId=A.sessionStateId,ea.sessionId=A.sessionId,ea.floatingObjectType=this.uOj(A.type),ea.sourceItemType=this.seg(1);else return k.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),
null;return JSON.stringify(ea)}serializeCommandParameters(A){if(!A)return k.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const ea={};ea.id=A.id;ea.commandType=A.commandType;ea.copyPasteTargetType=A.copyPasteTargetType;A.ribbonCommandInfo&&(ea.ribbonCommandName=this.EOj(A.ribbonCommandInfo.command),ea.inputMethodName=this.yOj(A.ribbonCommandInfo.method),ea.frameModeName=this.wOj(A.ribbonCommandInfo.mode),ea.uiLocationName=this.HOj(A.ribbonCommandInfo.Hg),
ea.tabName=A.ribbonCommandInfo.tabName);return JSON.stringify(ea)}deserializeSourceItem(A){if(!A)return null;try{const ea=JSON.parse(A);if(!ea)return k.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let Ma=null;switch(this.pzh(ea.sourceItemType)){case 0:Ma=new ic(this.$,this.mzh(ea),ea.sheetName,ea.sessionStateId,ea.sessionId);break;case 1:Ma=new Ga(ea.activeFloatingObjectControlId,ea.sheetName,ea.sessionStateId,ea.sessionId,this.jzh(ea.floatingObjectType))}return Ma}catch(ea){return k.ULS.sendTraceTag(537167702,
0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${A?A.length:0}, errror: ${ea}`),null}}deserializeCommandParameters(A){if(!A)return null;try{const ea=JSON.parse(A);if(!ea)return k.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const Ma=Mb.a();Ma.id=ea.id;Ma.ribbonCommandInfo=this.ozh(ea);Ma.commandType=ea.commandType;Ma.copyPasteTargetType=ea.copyPasteTargetType;
return Ma}catch(ea){return k.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${A?A.length:0}, errror: ${ea}`),null}}mzh(A){const ea=[];k.ULS.shipAssertTag(537167699,0,!!A.topArray&&0<A.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${A.topArray?"empty":"null"}.`);k.ULS.shipAssertTag(537167698,0,!!A.leftArray&&0<A.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${A.leftArray?
"empty":"null"}.`);k.ULS.shipAssertTag(537167697,0,!!A.bottomArray&&0<A.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${A.bottomArray?"empty":"null"}.`);k.ULS.shipAssertTag(537167696,0,!!A.rightArray&&0<A.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${A.rightArray?"empty":"null"}.`);if(!(A.topArray&&A.leftArray&&A.bottomArray&&A.rightArray))return ea;k.ULS.shipAssertTag(537167695,0,A.topArray.length===
A.bottomArray.length&&A.topArray.length===A.leftArray.length&&A.topArray.length===A.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${A.topArray.length}), BottomArray(${A.bottomArray.length}), LeftArray(${A.leftArray.length}), RightArray(${A.rightArray.length}) should be the same.`);const Ma=Math.min(A.topArray.length,A.bottomArray.length,A.leftArray.length,A.rightArray.length);for(let Vb=0;Vb<Ma;Vb++)ea.push(new wa.Range(A.topArray[Vb],A.leftArray[Vb],
A.bottomArray[Vb],A.rightArray[Vb],!1,!1));return ea}ozh(A){return new We.a(this.nzh(A.ribbonCommandName),this.lzh(A.inputMethodName),this.kzh(A.frameModeName),this.rzh(A.uiLocationName),A.tabName)}EOj(A){return void 0!==A&&null!==A&&A.toString()in this.LYd?this.LYd[A.toString()]:(k.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${A}`),this.LYd["-911352779"])}nzh(A){return A&&
A in this.zog?this.zog[A]:(k.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${A}`),-911352779)}yOj(A){return void 0!==A&&null!==A&&Wa.a[A]in this.loa?this.loa[Wa.a[A]]:(k.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${A}`),this.loa.unknown)}lzh(A){return A&&A in this.yog?this.yog[A]:(k.ULS.shipAssertTag(537167691,
0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${A}`),0)}wOj(A){return void 0!==A&&null!==A&&oe.a[A]in this.s8a?this.s8a[oe.a[A]]:(k.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${A}`),this.s8a.edit)}kzh(A){return A&&A in this.xog?this.xog[A]:(k.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${A}`),2)}seg(A){return void 0!==A&&null!==A&&Yd[A]in
this.uVb?this.uVb[Yd[A]]:(k.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${A}`),this.uVb.range)}pzh(A){return A&&A in this.Aog?this.Aog[A]:(k.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${A}`),0)}uOj(A){return void 0!==A&&null!==A&&A.toString()in this.D7c?this.D7c[A.toString()]:(k.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${A}`),
this.D7c["99"])}jzh(A){return A&&A in this.wog?this.wog[A]:(k.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${A}`),99)}HOj(A){return void 0!==A&&null!==A&&pb.a[A]in this.lu?this.lu[pb.a[A]]:(k.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${A}`),this.lu.ribbon)}rzh(A){return A&&A in this.Bog?this.Bog[A]:(k.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${A}`),
2)}}Object(x.a)(He,"EnvironmentSerializationHelper",null,[]);class bf{}bf.Pbg="SameSession";bf.dfd="CrossSession";bf.qBf="LegacyCrossSession";bf.external="External";Object(x.a)(bf,"PayloadOrigin",null,[]);const ef=A=>A?A.shadowWorkbookSizeExceedsLimit&&void 0!==A.shadowWorkbookBlockedSize&&null!==A.shadowWorkbookBlockedSize?A.shadowWorkbookBlockedSize:A.shadowWorkbookBase64?A.shadowWorkbookBase64.length:0:0,nc=A=>A.shadowWorkbookSizeExceedsLimit?!0:ef(A)>Bc.a.evc;var id=a(68),Dd=a(166),fc=a(112);
class Oa{constructor(A,ea,Ma){Ma=void 0===Ma?null:Ma;this.JKa=!1;this._name=ea;this.$=A;this.ro=qb.a.instance;this.Zp=new qd(A,Qa.h(A));this.icc=Ma}get name(){return this._name}get H7c(){return this.ro.Ia(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}iek(A){let ea;ea=null;try{const Ma=A.getItem(Wb.shadowWorkbook);if(!Ma)return{returnValue:!1,WZ:ea};ea=JSON.parse(Ma);return{returnValue:this.VMi(ea),WZ:ea}}catch(Ma){return k.ULS.sendTraceTag(537167835,
0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Ma),{returnValue:!1,WZ:ea}}}VMi(A){return!!A&&(!!A.shadowWorkbookBase64||A.shadowWorkbookSizeExceedsLimit)&&void 0!==A.rangeRowStart&&void 0!==A.rangeRowEnd&&void 0!==A.rangeColumnStart&&void 0!==A.rangeColumnEnd}Fzc(A){A.wasLastCopyExternal=!0;hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&A.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(A.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.Zdc?20:4);if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ja.a.GD&&516!==A.commandParameters.commandType&&1028!==A.commandParameters.commandType){let ea=null;if((()=>{let Ma=this.iek(A.clipboardItems);({WZ:ea}=Ma);return Ma})().returnValue)return A.isShadowWorkbookParsedSuccessfully=!0,this.Lkj(A,ea)}if(516!==A.commandParameters.commandType&&36!==A.commandParameters.commandType&&4100!==A.commandParameters.commandType){if(hb.EwaSettings.Da(151)&&
20!==A.commandParameters.commandType){const ea=A.clipboardItems.getItem(Wb.html),Ma=!(void 0===ea||null===ea)&&!!ea&&ea.trim()!==this.H7c&&(ea.startsWith("<")||ja.a.hh&&ea.startsWith("\n<")),Vb=A.clipboardItems.getItem(Wb.Qxb),tc=Dd.f(A.clipboardItems.getItem(Wb.plainText));return!Ma||!Vb&&tc?(tc&&k.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.UPd(A)):this.Jkj(A,ea,void 0===Vb?null:Vb)}return this.UPd(A)}return Promise.reject(new $d(6))}Lkj(A,
ea){k.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");A.pasteResult="SystemClipboardShadowWorkbookPaste";A.payloadType=Ea.shadowWorkbook;A.payloadOrigin=bf.external;A.shadowWorkbookPayloadSize=ef(ea);A.shadowWorkbookSizeExceedsLimit=nc(ea);let Ma=null,Vb=null;const tc=A.commandParameters.originalDestinations;hb.EwaSettings.getBooleanFeatureGate(aa.a.zyb,!1)?Ma=Zb.r(tc,this.$):Vb=Zb.v(Zb.L(tc),this.$);ea.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&
(A.originalSourceRangesCountExceedsLimit=ea.originalSourceRangesCountExceedsLimit);if(A.shadowWorkbookSizeExceedsLimit)return k.ULS.sendTraceTag(537167833,0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${A.shadowWorkbookPayloadSize}) is over the limit(${Bc.a.evc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ea.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new $d(1));k.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${A.commandParameters.id}`);
return this.Zp.ZXf(A.commandParameters.ribbonCommandInfo,Vb,Ma,ea,[A.commandParameters.stopwatch],A)}UPd(A){var ea=A.clipboardItems.getItem(Wb.plainText);if(void 0!==ea&&null!==ea&&ea.trim()===this.H7c)return Promise.reject(new $d(7));void 0!==ea&&null!==ea&&(A.plainTextPayloadSize=ea.length);let Ma=!1;aa.a.ITh&&null!==this.icc&&(Ma=this.icc.R6g(A,Lc.a.trimEnd(ea,"\n","\r"),Zb.L(A.commandParameters.originalDestinations)));Ma&&Qa.h(this.$).Ri.oR(A.commandParameters.stopwatch.id,id.BasicTelemetryCalculator.VP);
this.JKa||(this.JKa=!0,fc.b("AutoAdjustedColumnWidth"));A.isPlainTextPaste=!0;A.pasteResult="SystemClipboardPaste";A.payloadOrigin=Va(A)?bf.qBf:bf.external;A.payloadType=Ea.plainText;k.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${A.id}, PasteOperationId=${A.commandParameters.id}`);ea=this.Zp.kqj(Zb.L(A.commandParameters.originalDestinations),ea,A.commandParameters.ribbonCommandInfo,[A.commandParameters.stopwatch],
A);k.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${A.id}`);return ea}Jkj(A,ea,Ma){this.JKa||(this.JKa=!0,fc.b("AutoAdjustedColumnWidth"));A.htmlPayloadSize=ea.length;A.isHtmlPaste=!0;A.pasteResult="SystemClipboardHtmlPaste";A.payloadType=Ea.html;A.payloadOrigin=Va(A)?bf.qBf:bf.external;k.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${A.commandParameters.id}`);
return this.Zp.jqj(Zb.L(A.commandParameters.originalDestinations),ea,Ma,A.commandParameters.id,A.commandParameters.ribbonCommandInfo,[A.commandParameters.stopwatch],A)}uUe(A){const ea={};A&&(ea.shadowWorkbookBase64=A.ShadowWorkbookBase64,ea.shadowWorkbookSizeExceedsLimit=A.ShadowWorkbookSizeExceedsLimit,ea.originalSourceRangesCountExceedsLimit=A.OriginalSourceRangesCountExceedsLimit,ea.originalSourceRangesCount=A.OriginalSourceRangesCount,ea.shadowWorkbookBlockedSize=A.ShadowWorkbookBlockedSize);
return ea}wyg(A,ea){const Ma=Ob(A),Vb=32===(A.commandParameters.commandType&32),tc=1024===(A.commandParameters.commandType&1024);let Jc=!1,ld=null,Zd=null,De=!1;if(!Ma){Jc=-1985798686===A.commandParameters.ribbonCommandInfo.command;var Ve=A.copyContextSnapshot;if(ea)De=!Ve.sourceItem.isFromCurrentSession(this.$);else if(Ve=this.Zp.z9a(Ve))ld=Ve.ranges,Zd=Ve.sheetName,De=!A.isSameSession}return this.Zp.p5g(Zd,ld,this.$.na.sheetName,A.commandParameters.originalDestinations,A.commandParameters.expandDestinations,
De,Vb,tc,Jc,ea,Ma)}}Object(x.a)(Oa,"BaseCopyPasteHandler",null,[596,597,598]);class Lb{constructor(A){this.clipboardItems=this.key=null;this.Bda=A}Vza(A){return this.key&&this.key.isEqual(A)?this.createClipboardItems(this.clipboardItems):null}setValue(A,ea){this.key=A;this.clipboardItems=this.createClipboardItems(ea)}createClipboardItems(A){const ea=this.Bda.create();var Ma=A.getItem(Wb.plainText);Ma&&ea.setItem(Wb.plainText,Ma);(Ma=A.getItem(Wb.shadowWorkbook))&&ea.setItem(Wb.shadowWorkbook,Ma);
(A=A.getItem(Wb.html))&&ea.setItem(Wb.html,A);return ea}}Object(x.a)(Lb,"CopyCache",null,[]);class Fc extends Oa{constructor(A,ea,Ma,Vb,tc){tc=void 0===tc?null:tc;super(A,Vb,ea);this.icc=ea;this.Bda=Ma;this.mdd=tc||new Lb(this.Bda);this.gridView=Qa.h(A);this.ha=this.gridView.ha;this.clipboardRangeFactory=A.ea.Ba(169)}getSourceItem(){const A=Zb.d(this.gridView.ha.ra.selectedRanges);return new ic(this.$,A,this.$.da.na.sheetName,this.$.da.mg,this.$.xa.UserSessionId)}beforeSerialize(A){A.isSelectionAllowed=
!1;A.isAsyncCopy=!1;A.isFromCache=!1;A.encounteredDeploymentErrors=!1;A.plainTextPayloadSize=0;A.shadowWorkbookPayloadSize=0;A.htmlPayloadSize=0;A.clientSideCopyTime=0;const ea=new Xc.a(this.$.va),Ma=A.sourceItem;A.isSelectionAllowed=te.a.all(Ma.ranges,Vb=>this.isSelectionAllowed(ea,Vb));A.isSelectionAllowed&&this.Zp.Onf(Ma.ranges,A.commandParameters.commandType)}LRa(A){return this.gridView.za.S8()&&Qa.j(this.gridView,A)}mlj(A,ea,Ma,Vb){let tc=!1,Jc=1===ea.commandParameters.commandType,ld=Vb[0].Ew;
1===Ma.ranges.length&&1===Vb.length?hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Jc&&1!==ld&&ld!==Ma.ranges[0].Ew?A.cseStatus=17:tc=this.icc.thd(A,Zb.L(Ma.ranges),Ma.sheetName,Zb.L(A.commandParameters.expandDestinations),this.$.da.na.sheetName,Jc):A.cseStatus=5;tc&&Qa.h(this.$).Ri.oR(A.commandParameters.stopwatch.id,id.BasicTelemetryCalculator.VP);return this.Ukj(A,Ma,Zb.u(this.$.na.sheetName,null,Vb),ea.commandParameters.commandType,tc)}isSelectionAllowed(A,ea){return A.RIb(ea,
this.gridView)}Ukj(A,ea,Ma,Vb,tc){ea=Zb.u(ea.sheetName,null,ea.ranges);A.pasteResult="SameSessionPaste";A.payloadOrigin=bf.Pbg;A.payloadType=Ea.tUg;k.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${A.commandParameters.id}`);return this.Zp.pasteRange(A.commandParameters.ribbonCommandInfo,ea,Ma,Vb,A.commandParameters.commandType,[A.commandParameters.stopwatch],A,tc,null,null)}}Object(x.a)(Fc,"BaseRangeCopyPasteHandler",Oa,[]);
var Wc=a(41);class td{constructor(A){this.rX=new Wc.a(!0);this.$=A}onDeferredPasteStarted(A){this.rX.Wc(A.id)||this.rX.add(A.id,!0);if(0<this.rX.count){const ea=Object(Re.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Zc.d)(Ib.a.resolve(Yc.l,{Qa:0})):Ac.GetServiceTaskFactory.Vc(this.$.ea,5,4,0);Ed.TaskExtensions.ya(ea,()=>{ea.result.ki(28,null)},this.$.ka,3)}}onDeferredPasteCompleted(A){const ea=0<this.rX.count;this.rX.Wc(A.id)&&this.rX.remove(A.id);if(ea&&!this.rX.count){const Ma=
Object(Re.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Zc.d)(Ib.a.resolve(Yc.l,{Qa:0})):Ac.GetServiceTaskFactory.Vc(this.$.ea,5,4,0);Ed.TaskExtensions.ya(Ma,()=>{Ma.result.removeEntry(28)},this.$.ka,3)}}}Object(x.a)(td,"DeferredPasteTracker",null,[]);var na;(function(A){A[A.none=0]="none";A[A.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";A[A.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";A[A.asyncCopyCanceled=3]="asyncCopyCanceled";A[A.loadCopiedArtDataFromServerFailed=
4]="loadCopiedArtDataFromServerFailed"})(na||(na={}));Object(x.b)("CopyErrorType",na);class Pa extends Xd{constructor(A,ea){ea=void 0===ea?null:ea;super(na[A]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=A;this.ewaErrors=ea;if(null===ea||void 0===ea?0:ea.length)this.innerError=new qe(ea,null)}}Object(x.a)(Pa,"CopyInnerError",Xd,[]);var lb=a(133);class Nb extends Fc{constructor(A,ea,Ma,Vb){super(A,ea,Ma,"AcrossSessionRangeCopyPasteHandler",void 0===Vb?null:Vb);this.rX=new td(A)}serialize(A){const ea=
A.sourceItem,Ma={};let Vb=this.mdd.Vza(ea);if(Vb)Ma.synchronousResult=Vb,A.isFromCache=!0,A.clientSideCopyTime=A.commandParameters.stopwatch.Ee;else{let Jc=null;var tc=Zb.G(ea.ranges);if(!le.a.Kuf()&&this.LRa(tc)){k.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");tc=this.clipboardRangeFactory.create(tc);try{Jc=tc.toString(),Vb=this.Bda.create(),Vb.setItem(Wb.plainText,Jc),this.mdd.setValue(ea,Vb),Ma.synchronousResult=
Vb,A.clientSideCopyTime=A.commandParameters.stopwatch.Ee}finally{tc&&tc.dispose()}}else A.isAsyncCopy=!0,Ma.synchronousResult=this.Bda.create(),Ma.synchronousResult.setItem(Wb.plainText,this.H7c);Ma.asynchronousResult=this.mpd(A,ea,Jc)}A.syncClipboardItemsKeys=Xa(Ma.synchronousResult);return Ma}shouldWaitForCopyToComplete(A){if(!A||!A.copyContextSnapshot)return k.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;k.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(A.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return k.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;k.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(A){this.rX.onDeferredPasteStarted(A)}onDeferredPasteCompleted(A){this.rX.onDeferredPasteCompleted(A)}deserialize(A){A.isClipboardDataContainShadowWorkbook=
!(void 0===A.clipboardItems.getItem(Wb.shadowWorkbook)||null===A.clipboardItems.getItem(Wb.shadowWorkbook));if(Qa.h(this.$).ha.ng&326)return Ob(A)&&(A.wasLastCopyExternal=!0),Promise.reject(new $d(17));var ea=this.wyg(A,!1);if(0!==ea)return Promise.reject(new $d(Ob(A)?18:A.isSameSession?19:20,void 0,void 0,void 0,ea));var Ma=A.copyContextSnapshot,Vb=this.Zp.z9a(Ma);if(Ob(A))return this.Fzc(A);ea=A.commandParameters.originalDestinations;if(Vb&&A.isSameSession)return this.mlj(A,Ma,Vb,ea);if(516!==A.commandParameters.commandType){let tc=
null;if((()=>{let Jc=this.otg(A.clipboardItems);({WZ:tc}=Jc);return Jc})().returnValue)return A.isShadowWorkbookParsedSuccessfully=!0,Vb=Ma=null,hb.EwaSettings.getBooleanFeatureGate(aa.a.zyb,!1)?Ma=Zb.r(ea,this.$):Vb=Zb.v(Zb.L(ea),this.$),this.Hkj(A,Vb,Ma,tc);if(A.isClipboardInaccessible)return Promise.reject(new $d(8));if(36!==A.commandParameters.commandType)return this.UPd(A)}return Promise.reject(new $d(6))}beforePaste(A){this.$.ea.Ba(373).oLj(A);A.indicationDisplayScheduled=!0}Ddk(A){let ea;if(!(A&&
A.SourceRanges&&A.SourceRanges.Ranges&&A.SourceRanges.Ranges.length&&(A.OriginalSourceRangesCountExceedsLimit||A.OriginalSourceMultiRange&&A.OriginalSourceMultiRange.Ranges&&A.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,WZ:null};var Ma=A.SourceRanges.Ranges[0];if(!A.ShadowWorkbookBase64&&!A.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,WZ:null};ea=this.uUe(A);ea.rangeRowStart=Ma.FirstRow;ea.rangeRowEnd=Ma.LastRow;ea.rangeColumnStart=Ma.FirstColumn;ea.rangeColumnEnd=Ma.LastColumn;
ea.sourceClientPath=A.SourceClientPath;ea.sourceSheetName=A.SourceSheetName;ea.sourceWorkbookName=A.SourceWorkbookName;if(!A.OriginalSourceRangesCountExceedsLimit)for(A=A.OriginalSourceMultiRange.Ranges,ea.originalSourceRanges=Array(A.length),Ma=0;Ma<A.length;++Ma)ea.originalSourceRanges[Ma]=[A[Ma].FirstRow,A[Ma].FirstColumn,A[Ma].LastRow,A[Ma].LastColumn];return{returnValue:!0,WZ:ea}}otg(A){let ea;ea=null;A=A.getItem(Wb.shadowWorkbook);if(!A)return{returnValue:!1,WZ:ea};ea=JSON.parse(A);return{returnValue:this.UMi(ea),
WZ:ea}}UMi(A){return!!A&&(!!A.shadowWorkbookBase64||A.shadowWorkbookSizeExceedsLimit)&&void 0!==A.rangeRowStart&&void 0!==A.rangeRowEnd&&void 0!==A.rangeColumnStart&&void 0!==A.rangeColumnEnd}Hkj(A,ea,Ma,Vb){k.ULS.shipAssertTag(537167903,0,!!Vb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");A.pasteResult="CrossSessionPaste";A.payloadOrigin=bf.dfd;A.payloadType=Ea.shadowWorkbook;A.shadowWorkbookPayloadSize=ef(Vb);A.shadowWorkbookSizeExceedsLimit=
nc(Vb);Vb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(A.originalSourceRangesCountExceedsLimit=Vb.originalSourceRangesCountExceedsLimit);if(A.shadowWorkbookSizeExceedsLimit)return k.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${A.shadowWorkbookPayloadSize}) is over the limit(${Bc.a.evc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Vb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new $d(1));if(1028===
A.commandParameters.commandType&&A.originalSourceRangesCountExceedsLimit)return k.ULS.sendTraceTag(572617859,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${Vb.originalSourceRangesCount}) is over the limit(${Bc.a.OXi}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${Vb.originalSourceRangesCountExceedsLimit}`),Promise.reject(new $d(1));k.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${A.commandParameters.id}`);
return this.Zp.ZXf(A.commandParameters.ribbonCommandInfo,ea,Ma,Vb,[A.commandParameters.stopwatch],A)}mpd(A,ea,Ma){k.ULS.shipAssertTag(537167901,0,!!A,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Vb=A.commandParameters.stopwatch.Ee,tc=Zb.u(ea.sheetName,null,ea.ranges);return new Promise((Jc,ld)=>{k.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${A.id}`);
this.Zp.copy(tc,A.commandParameters,Zd=>{A.requestTelemetryData=Zd.RequestTelemetryData;A.serverRequestTimeInMs=A.commandParameters.stopwatch.Ee-Vb;if(fe.a.Bh(Zd.Errors))if(fe.a.Qka(Zd.Errors))A.encounteredDeploymentErrors=!0,Zd=fe.a.me(Zd.Errors),k.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Zd}. copy Id: ${A.id}`);else{var De=fe.a.me(Zd.Errors),Ve=[-591377245];
if(aa.a.ioh&&fe.a.aj(Zd.Errors,Ve)&&(Ve=this.sA(tc))){Ve=String.format(this.ro.gd(218),Ve.toLocaleUpperCase());var Se=lb.d(Zd.Errors,qg=>-591377245===qg.MessageId);Zd.Errors[Se].Description=Ve;k.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${A.id}`)}k.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${A.id}`);
ld(new Pa(2,Zd.Errors))}else if(k.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${A.id}`),A.markForCancellation)ld(new Pa(3,Zd.Errors));else{var sf=Zd.Result;Ve=sf.PlainTextResult;void 0!==Ma&&null!==Ma&&(Ve=Ma);void 0!==Ve&&null!==Ve&&(A.plainTextPayloadSize=Ve.length);De=this.Bda.create();var Of;(()=>{let qg=this.Ddk(sf);({WZ:Of}=qg);return qg})().returnValue&&(A.shadowWorkbookPayloadSize=ef(Of),A.shadowWorkbookSizeExceedsLimit=
nc(Of),A.originalSourceRangesCountExceedsLimit=sf.OriginalSourceRangesCountExceedsLimit,Se=JSON.stringify(Of),De.setItem(Wb.shadowWorkbook,Se));De.setItem(Wb.plainText,Ve);le.a.Kuf()&&(Ve=sf.HtmlResult,A.htmlSizeExceedsLimit=sf.HtmlSizeExceedsLimit,void 0!==Ve&&null!==Ve&&(A.htmlPayloadSize=Ve.length),De.setItem(Wb.html,Ve));A.copyTotalSizeExceedsLimit=sf.CopyTotalSizeExceedsLimit;De.setItem(Wb.Qxb,A.commandParameters.id);this.mdd.setValue(ea,De);A.asyncClipboardItemsKeys=Xa(De);Jc(De);hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(De=1===A.commandParameters.commandType?8:7,(Ve=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?Ib.a.Ph(Yc.Sb):this.$.ea.Ba(465))&&Ve.Yaa(De,Zd))}},Zd=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.Ee-Vb;Zd=wc.a.Bg(Zd.data);const De=fe.a.me(Zd);k.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${A.id}`);ld(new Pa(2,Zd))},[A.commandParameters.stopwatch])})}sA(A){return null==
A||null==A.Ranges||0===A.Ranges.length?(k.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===A.Ranges.length?Zb.C(A.Ranges[0]):Zb.G(Zb.g(A.Ranges))).toString()}}Object(x.a)(Nb,"AcrossSessionRangeCopyPasteHandler",Fc,[]);class xc{constructor(A,ea,Ma,Vb,tc,Jc,ld){this.floatingObjectId=A;this.commandParameters=ea;this.MI=Ma;this.vwh=Vb;this.Jma=void 0===Jc?null:Jc;this.RXb=void 0===ld?null:ld;this.Xnh=tc}}Object(x.a)(xc,"CopyArtRequest",
null,[]);class Oc{constructor(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){this.promise=null;this.ribbonCommandInfo=A;this.destination=ea;this.ZWe=Ma;this.RXb=tc;this.WZ=Jc;this.item=ld;this.pasteContext=Zd;this.VSa=Ma||ea.FirstRow+"_"+ea.FirstColumn;this.hvf=!0;this.rOe=De}}Object(x.a)(Oc,"PasteArtRequest",null,[]);class yd{constructor(A,ea){this.FRb=new va.a;this.N3a=A;this.$=ea;this.Nqj=Ma=>Promise.resolve(Ma);this.LNb=Ma=>Promise.reject(Ma)}Api(A){if(this.yIi(A.VSa)){k.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${A.VSa}`);
const ea=this.FRb.ma(A.VSa);this.FRb.ga(A.VSa,A);const Ma=ea.promise;ea.hvf=!1;return this.BGh(A,Ma)}this.FRb.ga(A.VSa,A);return this.LPi(A)}yIi(A){return this.FRb.Wc(A)}LPi(A){return new Promise((ea,Ma)=>{A.promise=this.N3a.VXf(A).then(Vb=>{ea(null);return this.hyc(A,Vb)},Vb=>{Ma(null);return this.LNb(Vb)})})}BGh(A,ea){return new Promise((Ma,Vb)=>{A.promise=ea.then(tc=>{this.Bjk(A,tc);return this.N3a.VXf(A).then(Jc=>{Ma(null);return this.hyc(A,Jc)},Jc=>{Vb(null);return this.LNb(Jc)})},tc=>this.LNb(tc))})}hyc(A,
ea){A.hvf&&(this.Jhh(A.VSa),this.k_d(A,ea));return this.Nqj(ea)}Jhh(A){this.FRb.remove(A)}k_d(A,ea){const Ma=this.bhi();A.VSa===Ma&&this.N3a.k_d(A.destination,ea,A.item.type)}bhi(){var A=Qa.h(this.$).ha.Va.activeFloatingObjectControlId;A||(A=Zb.v(Qa.h(this.$).ha.ra.activeCell,this.$),A=A.FirstRow+"_"+A.FirstColumn);return A}Bjk(A,ea){A.destination=null;A.ZWe=ea}}Object(x.a)(yd,"PasteArtRequestManager",null,[]);var Sd=a(213),ve=a(134),Ee=a(113);class Ue extends Oa{constructor(A,ea,Ma,Vb,tc){tc=void 0===
tc?null:tc;super(A,"ArtCopyPasteHandler");this.Dih="XLO";this.Eih="3";this.rX=new td(A);this.Bda=ea;this.N3a=Ma;this.ha=Qa.h(A).ha;this.ldd=tc||new Lb(this.Bda);this.Ikj=new yd(Ma,A);this.dvb=Vb}getSourceItem(){k.ULS.shipAssertTag(537167896,0,!!this.ha.Va.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");k.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.Va.activeFloatingObjectControlId}]`);
return new Ga(this.ha.Va.activeFloatingObjectControlId,this.$.da.na.sheetName,this.$.da.mg,this.$.xa.UserSessionId,this.ha.Va.Yd.floatingObject.type)}beforeSerialize(A){A&&A.commandParameters?(A?(A.isAsyncCopy=!1,A.isSelectionAllowed=!1,A.isFromCache=!1,A.plainTextPayloadSize=0,A.shadowWorkbookPayloadSize=0,A.htmlPayloadSize=0,A.htmlSizeExceedsLimit=!1,A.clientSideCopyTime=0,A.encounteredDeploymentErrors=!1,A.shadowWorkbookSizeExceedsLimit=!1,A.originalSourceRangesCountExceedsLimit=!1,A.copyTotalSizeExceedsLimit=
!1):k.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),A.commandParameters.copyPasteTargetType=2):k.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(A){const ea=A.sourceItem,Ma={};if(!ea)return k.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ma;if(!this.FLi())return k.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
Ma;k.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ea.activeFloatingObjectControlId}]`);this.lRd();let Vb=this.ldd.Vza(ea);if(Vb)Ma.synchronousResult=Vb,A.isFromCache=!0,A.isAsyncCopy=!1,A.clientSideCopyTime=A.commandParameters.stopwatch.Ee,1===A.commandParameters.commandType&&this.$.Fe(2045211913,A.commandParameters.ribbonCommandInfo.method,A.commandParameters.ribbonCommandInfo.Hg,null);else{A.isFromCache=!1;A.isAsyncCopy=!0;Vb=
this.Bda.create();if(A.commandParameters.uploadToClipService){const tc={};tc["data-clipservice-ccpid"]=A.commandParameters.id;tc["data-pkey"]=A.commandParameters.pKey;tc["data-clipservice-type"]=A.commandParameters.clipServiceDataType;tc["data-clipservice-count"]=A.commandParameters.objectCount.toString();tc["data-clipservice-dc"]=A.commandParameters.clipServiceDataCenter;tc["data-clipservice-client"]=this.Dih;tc["data-TimeStamp"]=(new Date).toUTCString();tc["data-clipservice-version"]=this.Eih;Vb.setItem(Wb.Z1g,
JSON.stringify(tc))}Ma.synchronousResult=this.fWg(Vb);Ma.asynchronousResult=this.mpd(A,ea,Vb)}A.syncClipboardItemsKeys=Xa(Ma.synchronousResult);return Ma}fWg(A){k.ULS.shipAssertTag(537167891,0,!!this.ha.Va.Yd,"Expecting a floating object to be currently selected for copy");A||(A=this.Bda.create());const ea=this.ha.Va.Yd.eCb();ea&&A.setItem(Wb.html,`<img src='${ea}'>`);return A}lRd(){const A=this.ha.Va.Yd;this.dvb.lRd(ve.a.gxb(A.floatingObject),ve.a.Gih(A.Ss))}shouldWaitForCopyToComplete(){k.ULS.sendTraceTag(537167890,
0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(A){this.rX.onDeferredPasteStarted(A)}onDeferredPasteCompleted(A){this.rX.onDeferredPasteCompleted(A)}deserialize(A){var ea=Ob(A),Ma=null;let Vb=null;var tc=!1;if(!ea){Ma=A.copyContextSnapshot;Vb=Ma.sourceItem;if(!Vb)return Promise.reject(new $d(10));tc=Vb.isFromCurrentSession(this.$)}var Jc=this.wyg(A,!0);if(0!==Jc)return Promise.reject(new $d(ea?18:tc?19:20,void 0,void 0,void 0,Jc));if(ea)return this.Fzc(A);
if(!tc&&!Ue.FDi(Vb))return A=`User attempted to paste art of type [${Vb.type}] between sessions.`,k.ULS.sendTraceTag(537167889,0,50,A),Promise.reject(new $d(11,void 0,void 0,A));if(Ma.isAsyncSerializeFailed)return Promise.reject(new $d(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let ld;try{const Zd=A.clipboardItems.getItem(Wb.shadowWorkbook);ld=JSON.parse(Zd)}catch(Zd){return A=copyPasteInfra.getStringifiedError(Zd),k.ULS.sendTraceTag(537167888,
0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${A}`),Promise.reject(new $d(12,void 0,Zd))}ld.floatingObjectId!==Vb.activeFloatingObjectControlId?k.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Vb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ld.floatingObjectId}]`):k.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Vb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ld.floatingObjectId}]`);
if(!ld||!ld.shadowWorkbookBase64)return Promise.reject(new $d(13,void 0,void 0,`shadowWorkbookPayload is null = ${!ld}`));A.isShadowWorkbookParsedSuccessfully=!0;A.shadowWorkbookPayloadSize=ef(ld);A.shadowWorkbookSizeExceedsLimit=nc(ld);A.payloadOrigin=tc?bf.Pbg:bf.dfd;A.payloadType=Ea.kCg;if(nc(ld))return A=`Shadow workbook size [${A.shadowWorkbookPayloadSize}] is over the limit [${Bc.a.evc}]. ShadowWorkbookSizeExceedsLimit: ${ld.shadowWorkbookSizeExceedsLimit}`,k.ULS.sendTraceTag(36304156,0,15,
`ArtCopyPasteHandler.Deserialize: ${A}`),Promise.reject(new $d(1,void 0,void 0,A));Ma=ea=null;Qa.h(this.$).ha.ng&326?Ma=Qa.h(this.$).ha.Va.activeFloatingObjectControlId:ea=this.$.na&&this.$.na.activeCell?Zb.v(this.$.na.activeCell,this.$):Zb.v(Zb.L(A.commandParameters.originalDestinations),this.$);tc=null;if(this.dvb.Fjg(Vb))try{tc=this.dvb.thd()}catch(Zd){Jc=copyPasteInfra.getStringifiedError(Zd),k.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${Jc}`)}return this.Ikj.Api(new Oc(A.commandParameters.ribbonCommandInfo,
ea,Ma,A.commandParameters.commandType,[A.commandParameters.stopwatch],ld,Vb,A,tc))}Fzc(A){A.wasLastCopyExternal=!0;if(A.clipboardItems.getItem("image/png")){const ea=A.commandParameters.stopwatch.Ee;A.payloadType=Ea.s8g;return Zc.c(this.$.Fe(1403967063,A.commandParameters.ribbonCommandInfo.method,A.commandParameters.ribbonCommandInfo.Hg,{["dataUrl"]:A.clipboardItems.getItem("image/png")})).then(Ma=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.Ee-ea;return Ma?Promise.resolve(null):Promise.reject(new $d(15))},
()=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.Ee-ea;return Promise.reject(new $d(15))})}k.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.Fzc(A)}FLi(){const A=Qa.h(this.$).ha;return A.Va.activeFloatingObjectControlId&&A.Va.Yd&&A.Va.Yd.floatingObject?A.Va.Yd.floatingObject.S6d():!1}mpd(A,ea,Ma){return new Promise((Vb,tc)=>{const Jc=A.commandParameters.stopwatch.Ee;k.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");
this.N3a.boh(new xc(ea.activeFloatingObjectControlId,A.commandParameters,ld=>{A.requestTelemetryData=ld.RequestTelemetryData;A.serverRequestTimeInMs=A.commandParameters.stopwatch.Ee-Jc;if(fe.a.Bh(ld.Errors))if(fe.a.Qka(ld.Errors))A.encounteredDeploymentErrors=!0,ld=fe.a.me(ld.Errors),k.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${ld}`);else{var Zd=fe.a.me(ld.Errors);k.ULS.sendTraceTag(36229122,
0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Zd}`);tc(new Pa(4,ld.Errors))}else if(k.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ea.activeFloatingObjectControlId}].`),A.markForCancellation)tc(new Pa(3,ld.Errors));else{if(fe.a.Jr(ld.Errors)){var De=fe.a.me(ld.Errors);k.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${De}`)}if(De=
ld.Result){De=this.uUe(De);De.floatingObjectId=ea.activeFloatingObjectControlId;A.shadowWorkbookPayloadSize=ef(De);A.shadowWorkbookSizeExceedsLimit=nc(De);try{Zd=JSON.stringify(De)}catch(Ve){tc(new $d(14,void 0,Ve,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${A.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${De.floatingObjectId}]`));return}k.ULS.shipAssertTag(537167881,0,!!Ma,"Expecting syncClipboardItems to be defined");Ma.setItem(Wb.shadowWorkbook,
Zd);1===A.commandParameters.commandType&&(this.xoj(ea.type,ea.activeFloatingObjectControlId,ld.StateId),this.deleteFloatingObject(ea.activeFloatingObjectControlId,ea.type));this.ldd.setValue(ea,Ma);A.asyncClipboardItemsKeys=Xa(Ma);Vb(Ma)}else k.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ea.activeFloatingObjectControlId}`),Vb(this.ldd.Vza(ea))}},A.commandParameters.commandType,ea.type,ld=>{A.serverRequestTimeInMs=
A.commandParameters.stopwatch.Ee-Jc;ld=wc.a.Bg(ld.data);1===A.commandParameters.commandType&&this.N3a.ifk(ea.type,ea.activeFloatingObjectControlId);const Zd=fe.a.me(ld);k.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Zd}`);tc(new Pa(4,ld))},[A.commandParameters.stopwatch]))})}deleteFloatingObject(A,ea){A=Sd.a.EB(ea,A);if(A=Ee.a(this.$).Ws(A))Ee.a(this.$).deleteFloatingObject(A,14,!0),Qa.h(this.$).ha.Va.FB=null}xoj(A,ea,Ma){const Vb=
hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)?Ib.a.Ph(Yc.Mc):this.$.ea.Ba(277);if(Vb){let Jc=null;A=Sd.a.EB(A,ea);A=Ee.a(this.$).Ws(A);if(null===A||void 0===A?0:A.Tk)Jc=A.Tk.block;if(Jc){var tc=A.floatingObject.Ji();Vb.W6b(()=>!Jc.ak.Wc(tc),Ma,"CutArt")}}}static FDi(A){return 1===A.type||5===A.type||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartAndInkPasteEnabled",!1)&&(0===A.type||8===A.type)}}Object(x.a)(Ue,"ArtCopyPasteHandler",
Oa,[]);var hf=a(61);class Rb extends Kb{constructor(A,ea,Ma,Vb){super(A);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ea;this.top=Ma;this.left=Vb}}Object(x.a)(Rb,"MacroRecorderPasteArtPayload",Kb,[]);class ed{constructor(A,ea){this.$=A;this.dvb=ea}mvi(A,ea,Ma,Vb,tc,Jc,ld){Jc=void 0===Jc?null:Jc;ld=void 0===ld?null:ld;const Zd=this.$.pa.ua.Ud();let De=null;const Ve={CopyPasteTargetType:2};Ve.FloatingObjectId=A;Ve.CopyOperationId=Ma.id;Ma.floatingObjectType=ea;Ve.UploadToClipService=
Ma.uploadToClipService;Ve.PKey=Ma.pKey;Ve.ClipServiceDataCenter=Ma.clipServiceDataCenter;let Se=0;2===tc?(tc=505,Se=16,De=(sf,Of,qg)=>Md(this.$.pa.ua,Ve,gd.b(sf,Vb),Jc?gd.a(Of,Jc):Of,qg,Ma.ribbonCommandInfo,Zd,ld)):(tc=179,De=(sf,Of,qg)=>{this.vCh(ea,A);this.$.VA();var yg=this.$.pa.ua;sf=gd.b(sf,Vb);Of=Jc?gd.a(Of,Jc):Of;var lg=Ma.ribbonCommandInfo,Cg=ld;Cg=void 0===Cg?null:Cg;const ri=yg.Ra(1,void 0===Zd?null:Zd);ri.copyParameters=Ve;return fd.g(yg,"Cut",ri,sf,Of,qg,lg,0,Cg)});this.$.userOperationManager.enqueueOperation(new de.a(tc,
0,De,Se|64),Ma.ribbonCommandInfo)}vCh(A,ea){var Ma=Sd.a.EB(A,ea);(Ma=Ee.a(this.$).Ws(Ma))?(Qa.h(this.$).ha.Va.ZJ(Ma),Ma.isVisible=!1):k.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${A}, FloatingObjectId: ${ea}`)}ifk(A,ea){A=Sd.a.EB(A,ea);if(A=Ee.a(this.$).Ws(A))A.isVisible=!0}boh(A){this.mvi(A.floatingObjectId,A.Xnh,A.commandParameters,A.MI,A.vwh,A.Jma,A.RXb)}Qvi(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){Zd=void 0===Zd?null:Zd;De=
void 0===De?!0:De;return new Promise((Ve,Se)=>{const sf=Jc.commandParameters.stopwatch.Ee;this.I_d(A,tc,ea,Ma,Of=>{Jc.requestTelemetryData=Of.RequestTelemetryData;Jc.serverRequestTimeInMs=Jc.commandParameters.stopwatch.Ee-sf;if(fe.a.Qka(Of.Errors))Jc&&(Jc.encounteredDeploymentErrors=!0),Of=fe.a.me(Of.Errors),k.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Of}`);else if(fe.a.Bh(Of.Errors)){var qg=
fe.a.me(Of.Errors);k.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${qg}`);Se(new $d(9,Of.Errors))}else Of.Result?(qg=Of.Result,k.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.Joj(ld,qg.FloatingObjectId,Of.StateId),Ve(ed.Ywd(qg.FloatingObjectId))):(k.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Se(new $d(9,Of.Errors)))},Of=>{Jc.serverRequestTimeInMs=
Jc.commandParameters.stopwatch.Ee-sf;Of=wc.a.Bg(Of.data);k.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${fe.a.me(Of)}`);Se(new $d(9,Of))},Vb,Zd,De)})}Joj(A,ea,Ma){const Vb=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)?Ib.a.Ph(Yc.Mc):this.$.ea.Ba(277);if(Vb){const tc=Sd.a.EB(A,ed.Ywd(ea));Vb.W6b(()=>!!Ee.a(this.$).Ws(tc),Ma,"PasteArt")}}W9d(A,ea){ea&&this.dvb.W9d(A,Sd.a.EB(A.type,ea))}VXf(A){return this.Qvi(A.ribbonCommandInfo,
A.destination,A.ZWe,A.RXb,A.WZ,A.pasteContext,A.item.type,A.rOe,A.item.isFromCurrentSession(this.$)).then(ea=>ea,ea=>{this.W9d(A.item,A.rOe);return Promise.reject(ea)})}k_d(A,ea,Ma){A||(A=Zb.v(Qa.h(this.$).ha.ra.activeCell,this.$));Qa.h(this.$).trc(Zb.E(A),1)?Ee.a(this.$).paa(Ma,ea,!0):Qa.h(this.$).ha.Va.bMa(A,ea,Ma).continueWith(Vb=>{Vb.result?k.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ea}]`):k.ULS.sendTraceTag(537167842,
5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ea}]`)})}I_d(A,ea,Ma,Vb,tc,Jc,ld,Zd,De){De=void 0===De?!0:De;const Ve=this.$.pa.ua.Ud(),Se={};Se.ShadowWorkbookBase64=ea.shadowWorkbookBase64;Se.FloatingObjectId=Vb;Se.DestinationRanges=Ma?Zb.s(Ma):null;Se.CopyPasteTargetType=2;Se.ClientEstimationFloatingObjectId=Zd;Ma=new de.a(503,0,(sf,Of,qg)=>{Zd||this.$.VA();return dd(this.$.pa.ua,Se,gd.b(sf,tc),gd.a(Of,Jc),qg,null,Ve,ld)},void 0,()=>{if(De){let sf;sf=
hf.a.nk(hf.a.ye(Se));sf.FloatingObjectId=ea.floatingObjectId;Se.DestinationRanges||(sf.DestinationRanges=Zb.p(this.$.va.na.sheetName,"",0,0,0,0));return new Rb(sf,De,0,0)}return new Rb(Se,De,0,0)});Ma.flags=65;this.$.userOperationManager.enqueueOperation(Ma,A)}static Ywd(A){return`${A.length+2}.{${A.toUpperCase()}}`}}Object(x.a)(ed,"ArtCopyPasteUtils",null,[587]);var pd=a(205);class ie{constructor(A){this.jdd=this.zxa=null;this.zfb=15;this.$=A}lRd(A,ea){this.zxa=A;this.jdd=ea}thd(){if(!this.zxa||
!this.jdd)return k.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const A=ve.a.gxb(new Sd.a(this.zxa));A.Id=ed.Ywd(qa.a.create().toString());A.Version=-1;A.Name="";A.IsClientEstimation=!0;var ea=this.gxi(A);if(!ea)return null;const Ma=new Sd.a(A);ea.block.ak.add(Ma);Ma.KRb();const Vb=Ee.a(this.$);Vb.wcc(Ma,ea);ea=Vb.Ws(Sd.a.l$h(A));!ea||ea.floatingObject.tRa||
ea.floatingObject.SRa||ea.WWa(this.jdd);Vb.paa(A.Type,A.Id,!0);return A.Id}Fjg(A){return hb.EwaSettings.Da(205)&&A.isFromCurrentSession(this.$)&&!Qa.h(this.$).rtl&&!Qa.h(this.$).Tc.kk}W9d(A,ea){this.Fjg(A)&&(A=Ee.a(this.$).Ws(ea))&&(k.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ea}] of type [${A.floatingObject.type}]`),Ee.a(this.$).deleteFloatingObject(A,15,!0),A.Tk&&A.jhb(A.Tk,!1))}gxi(A){if(!A)return k.ULS.sendTraceTag(537167839,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(Qa.h(this.$).ha.Va.activeFloatingObjectControlId){var ea=Qa.h(this.$).ha.Va.FB.floatingObject;A.OriginDeltaX=ea.offsetX+this.zfb;A.OriginDeltaY=ea.offsetY+this.zfb;A.AbsoluteLeft+=this.zfb;A.AbsoluteTop+=this.zfb;A.AbsoluteRight+=this.zfb;A.AbsoluteBottom+=this.zfb;A.ZOrder=ea.yE+1;return Qa.h(this.$).ha.Va.FB.Tk}if(!this.$.na||!this.$.na.activeCell)return k.ULS.sendTraceTag(537167838,0,
15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Ma=this.$.na.activeCell;ea=Qa.h(this.$).q_(Ma);if(!ea)return k.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Ma.toString()} is null.`),null;const Vb=Xb.HelperMethods.EDb(ea.domElement,ea.fl.domElement);Ma=ea.gridView.Bi(Ma,2);if(!Vb||!Ma)return k.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!Vb}. cellPositionRelativeToGridOrigin is null: ${!Ma} .`),
null;A.OriginDeltaX=Ma.topLeft.x-Vb.x;A.OriginDeltaY=Ma.topLeft.y-Vb.y;A.AbsoluteLeft=Ma.topLeft.x;A.AbsoluteTop=Ma.topLeft.y;A.AbsoluteRight=A.AbsoluteLeft+Math.abs(this.zxa.AbsoluteRight-this.zxa.AbsoluteLeft);A.AbsoluteBottom=A.AbsoluteTop+Math.abs(this.zxa.AbsoluteBottom-this.zxa.AbsoluteTop);A.ZOrder=this.zxa.ZOrder+100;return new pd.a(ea.gridView.za.Qj(ea.hashCode),ea.hashCode)}}Object(x.a)(ie,"ArtPasteClientEstimation",null,[586]);class Ce{create(){const A=window.clipboardPlatform;return A?
A.createClipboardItems():null}}Object(x.a)(Ce,"ClipboardItemsFactory",null,[585]);class Pe{}Pe.undefined="Undefined";Object(x.a)(Pe,"CCPTelemetryConsts",null,[]);class lf{}lf.cells="Cells";lf.floatingObject="FloatingObject";lf.unknown="Unknown";Object(x.a)(lf,"ActiveSelection",null,[]);class nf{}nf.FBh="DisplayNotInvoked";nf.mhd="Displayed";nf.Soj="PrerequisitesNotReady";Object(x.a)(nf,"PasteIndicationDisplayStatus",null,[]);class If extends Nb{constructor(A,ea,Ma,Vb){super(A,ea,Ma,void 0===Vb?null:
Vb);this.jcc=null}beforePaste(){k.ULS.sendTraceTag(509162378,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(A){A.isClipboardDataContainShadowWorkbook=!(void 0===A.clipboardItems.getItem(Wb.shadowWorkbook)||null===A.clipboardItems.getItem(Wb.shadowWorkbook));this.Zp.z9a(A.copyContextSnapshot);const ea=A.commandParameters.originalDestinations;if(!A.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let Ma=null;if((()=>{let Vb=this.otg(A.clipboardItems);({WZ:Ma}=
Vb);return Vb})().returnValue){A.isShadowWorkbookParsedSuccessfully=!0;let Vb=null,tc=null;hb.EwaSettings.getBooleanFeatureGate(aa.a.zyb,!1)?Vb=Zb.r(ea,this.$):tc=Zb.v(Zb.L(ea),this.$);return this.hlj(A,tc,Vb,Ma)}return A.isClipboardInaccessible?Promise.reject(new $d(8)):Promise.reject(new $d(6))}get copyPasteInfrastructure(){var A;null!==(A=this.jcc)&&void 0!==A?A:this.jcc=this.$.ea.Ba(254,!0);return this.jcc}$yi(A,ea,Ma,Vb){return this.copyPasteInfrastructure?Zc.a(this.copyPasteInfrastructure.voc(null,
Vb.commandParameters.ribbonCommandInfo,A,ea,Ma,Vb)):Promise.reject(new $d(0))}hlj(A,ea,Ma,Vb){A.pasteResult="CrossSessionPaste";A.payloadOrigin=bf.dfd;A.payloadType=Ea.shadowWorkbook;A.shadowWorkbookPayloadSize=ef(Vb);A.shadowWorkbookSizeExceedsLimit=nc(Vb);Vb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(A.originalSourceRangesCountExceedsLimit=Vb.originalSourceRangesCountExceedsLimit);return A.shadowWorkbookSizeExceedsLimit?Promise.reject(new $d(1)):1028===A.commandParameters.commandType&&
A.originalSourceRangesCountExceedsLimit?Promise.reject(new $d(1)):this.$yi(ea,Ma,Vb,A)}}Object(x.a)(If,"AcrossSessionInsertCopiedCutCellsHandler",Nb,[]);class Ff{constructor(A){this.fVc=this.OPc=this.c_c=null;this.$=A}get kTd(){if(!this.c_c){const A=this.$.ea.Ba(254,!0);A&&(this.c_c=new Nb(this.$,A,new Ce))}return this.c_c}get czi(){if(!this.fVc){const A=this.$.ea.Ba(254,!0);A&&(this.fVc=new If(this.$,A,new Ce))}return this.fVc}get C7c(){if(!this.OPc&&this.$.ea.Ba(254,!0)){const A=new ie(this.$);
this.OPc=new Ue(this.$,new Ce,new ed(this.$,A),A)}return this.OPc}getCopyFlowHandler(A){const ea=this.b6h(Qa.h(this.$).ng);A.commandParameters.copyPasteHandlerName=ea.name;return ea}getPasteFlowHandler(A){var ea=A.copyContextSnapshot;switch(A.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return A=this.czi;default:return ea=Gc(A)?this.C7c:Ob(A)?this.kTd:(null===ea||void 0===ea?0:ea.sourceItem)&&Object.getType(ea.sourceItem)===Ga?this.C7c:this.kTd,A.commandParameters.copyPasteHandlerName=
ea.name,ea}}initializePasteContext(A){if(A&&(A.isSameSession=!1,A.isShadowWorkbookParsedSuccessfully=!1,A.pasteResult=Pe.undefined,A.payloadOrigin=Pe.undefined,A.payloadType=Pe.undefined,A.encounteredDeploymentErrors=!1,A.shadowWorkbookSizeExceedsLimit=!1,A.originalSourceRangesCountExceedsLimit=!1,A.activeSelectionType=this.S1h(),A.indicationDisplayScheduled=!1,A.pasteDestinationHasMergedCells=!1,A.cseStatus=0,A.pasteIndicationDisplayStatus=nf.FBh,A.copyContextSnapshot)){var ea=A.copyContextSnapshot;
const ld=mb(ea.sourceItem);var Ma=ea.sourceItem;var Vb=!!Ma&&Object.getType(Ma)===Ga;Ma=0;var tc=!1;ld?(tc=ea.sourceItem,A.isSameSession=tc.isFromCurrentSession(this.$),Ma=1,tc=this.AIi(tc,A)):Vb&&(A.isSameSession=ea.sourceItem.isFromCurrentSession(this.$),Ma=2);if(A.copyContextSnapshot.commandParameters){const Zd=-1985798686===ea.commandParameters.ribbonCommandInfo.command;Vb=A.commandParameters;var Jc=this.$;ea?Jc&&Jc.xa?ea=ea.sessionId===Jc.xa.UserSessionId:(k.ULS.shipAssertTag(537166211,0,!1,
"ewaControl shouldn't be null"),ea=!1):(k.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ea=!1);Vb.clearSystemClipboard=ea&&Zd&&ld&&!tc;A.commandParameters.copyPasteTargetType=Ma}}}getSessionId(){return this.$.xa.UserSessionId}AIi(A,ea){const Ma=lb.b(A.ranges,Vb=>Vb.Ci)&&lb.b(ea.commandParameters.originalDestinations,Vb=>1!==Vb.top);return lb.b(A.ranges,Vb=>Vb.isRow)&&lb.b(ea.commandParameters.originalDestinations,Vb=>1!==Vb.left)||Ma}b6h(A){switch(A){case 1:return this.kTd;case 64:case 4:case 2:case 256:return this.C7c;
default:throw Error.invalidOperation("Unsupported selection");}}S1h(){return Qa.h(this.$).ha.ng&470?lf.floatingObject:1===Qa.h(this.$).ha.ng?lf.cells:lf.unknown}getDialogResponse(){}}Object(x.a)(Ff,"ExcelCopyPasteApplicationHost",null,[545]);var Mf=a(181);class dc extends ab.a{constructor(A,ea){super(A);this.Nv=null;this.bzi=(Ma,Vb)=>{1===Ma?(Ma=dc.OAh[Vb[dc.NAh]],k.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===
Ma?"Horizontal":"Vertical"}`),this.Nv.setResult(Ma)):(k.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.Nv.iw())};this.ni(ea)}get pe(){return"InsertCopiedCutCellsDialog"}ni(A){this.Nv=new Mf.a;const ea=qb.a.instance.ia(16);A=this.oK(A);this.initializeAndShow(ea,this.bzi,A)}oK(A){return{[dc.Mv]:this.pe,[dc.iKi]:A}}}dc.NAh="direction";dc.iKi="isRtl";dc.OAh={["Vertical"]:1,["Horizontal"]:0};Object(x.a)(dc,"InsertCopiedCutCellsDialog",
ab.a,[]);class B{ycc(A,ea){return(new dc(A,ea)).Nv.task}}Object(x.a)(B,"InsertCopiedCutCellsDialogFactory",null,[543]);var fa=a(96),Na=a(52),nb=a(48),gc=a(431),bd=a(34),Ra=a(282);class Tb{constructor(A){this.udc="";this.sU=this.Cv=null;this.yfb=new Map;this.j6=null;this.wAc=!1;this.snf=(ea,Ma)=>{this.hide(void 0===ea?null:ea,void 0===Ma?null:Ma)};this.$=A;this.gridView=Qa.h(A);this.gridView.ha.cr(this.snf)}nZe(){this.wAc||(k.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),
this.gridView.$.QB(A=>{A.j8(0).then(()=>{this.wAc=!0})}))}oLj(A){const ea=A.commandParameters.id;k.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ea}, cancelCtx is null = ${!this.Cv}, PrerequisitesDownloaded = ${this.wAc}`);this.nZe();this.udc=ea;const Ma=!this.fJf();if(!this.Cv||Ma)this.GLe(),this.Cv=Na.a.instance.create(()=>{this.EBh(A)},void 0===A.timeoutToShowSpinnerInMs||null===A.timeoutToShowSpinnerInMs?100:A.timeoutToShowSpinnerInMs,nb.a.Okj);this.j6=
A.commandParameters.originalDestinations;aa.a.bYf&&this.vLj(ea)}EBh(A){this.wAc?(this.display(A.commandParameters.originalDestinations),A.pasteIndicationDisplayStatus=nf.mhd):(k.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),A.pasteIndicationDisplayStatus=nf.Soj)}vLj(A){this.yfb.set(A,bd.a.$a.eg);Na.a.instance.create(()=>{this.NBh(A)},this.$.xa.PasteToastNotificationDelayTime,nb.a.Pkj)}NBh(A){this.yfb.has(A)&&
(this.sU?this.sU.displayTimeoutSeconds+=this.$.xa.PasteToastNotificationDefaultDisplayDuration:(A=qb.a.instance.ia(2341),this.sU=gc.a.rB.notificationBar.e1(A,!1),this.sU.image=3,this.sU.displayTimeoutSeconds=this.$.xa.PasteToastNotificationDefaultDisplayDuration,gc.a.rB.notificationBar.gD(this.sU)))}G8(A){A&&this.sU&&(A=qb.a.instance.ia(2342),this.sU.oMc(A));setTimeout(()=>{this.wAj()},3E3)}wAj(){this.sU&&(gc.a.rB.notificationBar.removeEntry(this.sU),this.sU=null)}display(A){k.ULS.sendTraceTag(537167649,
0,50,"PasteIndicationManager.Display: started");this.gridView.zd.AC(Ud.a.PFa(wd.d(this.gridView.$.na),A),Tb.Gzc,!0);this.gridView.zd.tt(Tb.Gzc)}hnc(A,ea){ea=void 0===ea?!0:ea;k.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${A}, currentPasteCommandId = ${this.udc}`);A&&Lc.a.equals(A,this.udc,!1)&&this.hide();if(aa.a.bYf&&A&&this.yfb.has(A)){const Ma=Ra.a(bd.a.$a.eg,this.yfb.get(A));6E4<Ma&&k.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${A}), scheduleDisplayToHideDurationInMs (${Ma}))`);
this.yfb.delete(A);null!=this.sU&&0===this.yfb.size&&this.G8(ea)}}hide(A){this.j6&&(void 0===A?0:A)&&this.fJf()&&k.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.udc="";this.GLe();this.j6=null;0!==this.gridView.zd.tod([30]).length&&(this.gridView.zd.Sl(Tb.Gzc),this.gridView.zd.sm(null,Tb.Gzc))}fJf(){return Zb.R(this.gridView.ha.ra.selectedRanges,this.j6)}GLe(){this.Cv&&
(fa.a.Ma(this.Cv),this.Cv=null)}dispose(){this.hide();this.sU&&this.G8(!1);this.gridView.ha.vr(this.snf)}}Tb.Gzc=[30];Object(x.a)(Tb,"PasteIndicationManager",null,[542,5]);var qc=a(1130),hd=a(57),Vd=a(737);class Be extends Pb.a{constructor(A){super();this.iZi=79;this.hZi=86;this.qZi=14;this.$=A;this.ro=qb.a.instance;this.Syd=aa.a.Syd&&!this.$.isMobileMode;this.Tyd=aa.a.Tyd&&this.$.isMobileMode&&this.$.isEditMode;this.Md()}create(){const A=hd.a.OY([73,74],4,this.Na,void 0,void 0,void 0,Be.Dra);let ea;
ea=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7896261_FormatCellsActionNewService")?Object(Zc.d)(Ib.a.resolve(Yc.bb,{Qa:this.Na})):Ac.GetServiceTaskFactory.create(this.$.ea,18,this.$.ka,this.Na);Ed.TaskExtensions.ya(Ed.TaskExtensions.Bf([ea,A],this.ka),()=>{const Ma=new qc.a;let Vb=null;this.wlh(Ma).then(tc=>{Vb=tc.uOe;const Jc=copyPasteInfra.createCopyPasteInfra(Vb,new Ff(this.$),Ma,{isChangeGateEnabled:hb.EwaSettings.isChangeGateEnabled});k.ULS.shipAssertTag(537167762,0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");
k.ULS.shipAssertTag(537167761,0,!!this.$.xa&&!!this.$.xa.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const ld=Vb.getMetadataManager();var Zd=Object(Vd.a)(this.$.ea,254,()=>new Mc(this.$,ld,ea.result,Jc,new qd(this.$,Qa.h(this.$)),new B,this.$.xa.DocumentHostInfo.UserId,Vb.getInitializationError()));this.qd(Zd);if(tc.p5a){Zd=Mc.wjc();const De=JSON.stringify(tc.p5a.dataClipboardCapabilities),Ve=tc.p5a.clipboardStrategiesToInitialize[0].clipboardStrategyType===
tc.p5a.dataClipboardStrategyType,Se=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();k.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Zd}, StrategyType=${tc.p5a.dataClipboardStrategyType}, StrategyCapabilities=${De}, IsBestStrategyTypeInitialized=${Ve}, InfraLoadTimeMS=${Se}`)}else k.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},
tc=>{const Jc=Mc.wjc();tc=tc?copyPasteInfra.getStringifiedError(tc):"null";k.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${Jc} error: ${tc}`)})},this.ka,3)}dispose(){super.dispose()}wlh(A){let ea=null;var Ma=window.clipboardPlatform;Ma&&(ea=Ma.getClipboardPlatformEnvironment());if(!ea)return k.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);Ma=this.$.xa;const Vb=[Ma.OfficeOnlineChromeExtensionId,Ma.ChromeClipboardAccessExtensionId],tc=this.ro.Ia(5);var Jc=this.$.ag.get(57);let ld=!Jc&&this.$.ag.get(5);var Zd=this.$.da.ae;Zd&&(Zd.inWebPart||Zd.inViewerFromWebPart||Zd.isDivSyndicated)&&(ld=!1);const De=()=>ja.a.QF&&""!==ja.a.BNa&&parseInt(ja.a.BNa.split(".")[0],10)>=this.iZi;(Zd=(this.Syd||this.Tyd)&&!Jc&&(()=>!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&(ja.a.Eo&&ja.a.KAa(this.hZi)||
De()||ja.a.rBa&&ja.a.bpa(this.qZi))))())&&k.ULS.sendTraceTag(508703874,0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");Jc=this.c5h(ld,!Jc,Zd);k.ULS.shipAssertTag(537167758,0,!!Ma.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return ea.init({isChangeGateEnabled:hb.EwaSettings.isChangeGateEnabled},A,Vb,Ma.SharedClipboardHostingApp,Ma.SharedClipboardHostingApps,
Ma.SharedClipboardHostingEnvironments,Ma.SharedClipboardOverrideOrigin,Ma.SharedClipboardSchemaVersion,Ma.SharedClipboardExpirationInMinutes,Ma.ClipboardPromiseTimeoutInMinutes,tc,Ma.MachineCluster,new He(this.$),Jc,Ma.DocumentHostInfo.UserId,Ma.ClipboardTtlInMS,hb.EwaSettings.Da(273),Ma.UserSessionId,Ma.BulsEndpointUrl).then(Ve=>Object(fb.a)(new xd,{uOe:ea,p5a:Ve}),Ve=>Promise.reject(Ve))}c5h(A,ea,Ma){const Vb=[];A&&Ma&&Vb.push(this.EUe(9));A&&ea&&Vb.push(this.EUe(6));ea&&(Vb.push(this.Ved(7)),Vb.push(this.Ved(0)));
A&&Vb.push(this.BTe());Vb.push({clipboardStrategyType:4});Ma=Vb?Vb.map(tc=>JSON.stringify(tc)).join(","):"[]";k.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${A}, isSystemClipboardAllowed=${ea}, result = ${Ma}`);return Vb}BTe(){const A=this.$.xa,ea={clipboardStrategyType:5};ea.sessionId=A.UserSessionId;ea.useSharedClipboardIframe=!0;ea.sharedClipboardHostingApp=A.SharedClipboardHostingApp;
ea.sharedClipboardHostingApps=A.SharedClipboardHostingApps;ea.sharedClipboardHostingEnvironments=A.SharedClipboardHostingEnvironments;ea.sharedClipboardOverrideOrigin=A.SharedClipboardOverrideOrigin;ea.sharedClipboardSchemaVersion=A.SharedClipboardSchemaVersion;ea.sharedClipboardExpirationInMinutes=A.SharedClipboardExpirationInMinutes;ea.wacCluster=A.MachineCluster;return ea}EUe(A){const ea={};ea.clipboardStrategyType=A;ea.localStorageStrategyParameters=this.BTe();ea.systemClipboardStrategyParameters=
this.Ved(0);return ea}Ved(A){const ea={};ea.clipboardStrategyType=A;ea.skipFilesIfPlainTextExists=!0;return ea}static la(A){A.ea.Ja(373,new Tb(A));A.ea.Ja(Be.Dra,new Be(A))}}Be.Dra=255;Object(x.a)(Be,"CopyPasteInfrastructureFactory",Pb.a,[]);var Qe=a(10),cf=a(117),wb=a(14);class zc extends Sb.a{constructor(A,ea,Ma){super();this.statusBarManager=null;this.VXe=()=>{this.Kec()};this.WAh=()=>{this.Kec()};this.UXe=Vb=>{10===Vb&&this.Kec()};this.onKeyDown=Vb=>13===Vb.Ca.keyCode?(Vb=new We.a(237279923,1,
2,6,null),this.$.Ha.kd(Vb,{[Gb.a.skipClipboardAccess]:!0,[Gb.a.V0e]:!0}),!0):!1;this.$=A;this.Hq=ea;this.No=Ma;this.pjd=!1;this.$.ea.Zc(29,Vb=>{this.statusBarManager=Vb;Vb.gM(this)})}dispose(){this.zk();this.No=this.Hq=this.$=null;this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null)}Jp(){return!0}Du(A,ea){if("QueryPasteShortcutEnabledLabel"!==A&&!zc.i6j.includes(A))return!1;const Ma=this.dI();"QueryPasteShortcutEnabledLabel"===A?(ea.Visible=Ma,k.ULS.sendTraceTag(537167636,
0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${Ma} for commandId ${A}`)):(ea.Visible=!Ma,k.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!Ma} for commandId ${A}`));return!0}$Fh(){this.al();this.raiseEvent("pasteShortcutStatusChanged")}Kec(){this.zk();this.raiseEvent("pasteShortcutStatusChanged")}dI(){return this.pjd}Ks(A){this.addHandler("pasteShortcutStatusChanged",A)}ot(A){this.removeHandler("pasteShortcutStatusChanged",A)}al(){if(!this.dI()){this.pjd=
!0;Qa.h(this.$).Fk.yp(this.VXe);this.No.la("blur",this.WAh);const A=this.$.ea.Ba(65);A&&A.Y6&&A.Y6.registerForCommentEvents(this.UXe);this.Hq.fw(wb.a.Rd,this.$.Gw,this.onKeyDown,!0)}}zk(){if(this.dI()){this.pjd=!1;Qa.h(this.$).Fk.lp(this.VXe);this.No.detach("blur");const A=this.$.ea.Ba(65);A&&A.Y6&&A.Y6.unregisterForCommentEvents(this.UXe);this.Hq.kw(wb.a.Rd,this.$.Gw,this.onKeyDown,!0)}}}zc.i6j=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(x.a)(zc,"PasteShortcutManager",Sb.a,
[538,187,188,5]);var rd=a(148);class ce extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){const A=this.$;this.qd(A.ea.Ba(478)||this.$.ea.Ja(478,new zc(A,cf.KeyInputManager.instance,rd.a.instance.XJ())))}static la(A){A.ea.Ja(479,new ce(A))}}Object(x.a)(ce,"PasteShortcutManagerFactory",Pb.a,[]);var Me=a(734),ra=a(733),sb=a(110),uc=a(1279),od=a(201);let Ld=class{constructor(A,ea,Ma){this.Uyb=null;this.$=A;ea?(k.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),
this.Uyb=new uc.a(A,ea,Ma)):k.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Ce(){return!1}executeCommand(A,ea,Ma){A=!1;switch(ea.command){case 73979048:this.Uyb&&this.Uyb.Eoj(ea,sb.a.instance,G.AFrameworkApplication.fa,Ma),A=!0}return A?yc.Task.Wa(!0):od.a(ea.command)}qe(A,ea){return 73979048===ea.command&&hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Ge(){return!1}dispose(){this.Uyb&&
this.Uyb.dispose()}};Ld=Object(ra.a)([Object(Ib.d)(Yc.G),Object(ra.b)(0,Object(Yc.R)()),Object(ra.b)(1,Object(Yc.i)()),Object(ra.b)(2,Object(Yc.Lc)())],Ld);Object(x.a)(Ld,"DataFromPictureCommandHandler",null,[190,5]);class ue extends Me.a{constructor(A){super(A)}yf(){const A=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?Object(Zc.d)(Ib.a.resolve(Yc.i,{Qa:1})):Ac.GetServiceTaskFactory.Vc(this.$.ea,328,327,1),ea=Object(Re.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?
Object(Zc.d)(Ib.a.resolve(Yc.Lc,{Qa:this.Na})):Ac.GetServiceTaskFactory.Vc(this.$.ea,484,485,1);Ed.TaskExtensions.ya(Ed.TaskExtensions.Bf([A,ea],this.$.ka),()=>{this.gf([new Ld(this.$,A.result,ea.result)])},this.$.ka,3)}static la(A){Me.a.Nf(452,new ue(A))}}Object(x.a)(ue,"DataFromPictureCommandHandlerFactory",Me.a,[]);var Xe=a(523),re=a(114);class Gf{constructor(A,ea,Ma){this.Gl=this.MOd=null;this.yJa=this.qca=0;this.s0b=null;this.BV=A;this.Uf=ea;this.Pa=Ma;this.J6a=!1;this.Iae=!0;this.VGj();this.Hdb=
this.fa.qa("NativeFileOpenDialogIsEnabled")}get context(){return this.BV}get fa(){return this.Pa}get retryCount(){return this.qca}get bEc(){return this.yJa}kOb(A){this.Gl=A;if(!this.J6a){if(this.Iae){if(this.Hdb&&ja.a.ND){this.s0b=A.efc(Object(z.a)(this,this.YMd,"onFileChosen"));return}this.s0b=A.efc(null);if(!this.wGa(this.s0b,A))return}this.finalizeUpload(A,null)}}YMd(A){if(this.wGa(A,this.Gl)){if(ja.a.ND||ja.a.hh)this.s0b=A;this.finalizeUpload(this.Gl,null)}}Qyc(){this.MOd&&this.MOd()}VGj(){this.qca=
0;this.yJa=this.fa.Af("Box4UploadRetryDelayStart",200);this.Gl&&(this.Gl.dispose(),this.Gl=null)}}Object(x.a)(Gf,"FileUploader",null,[]);var Vf=a(332),pf=a(830),tf=a(154);class ag extends Gf{constructor(A,ea,Ma){super(A,ea,Ma);this.k3b=this.Tva=null}get rR(){return G.AFrameworkApplication.sa.tG}Rcf(A){switch(A){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}uyg(A){return ag.wGa(A,this.Pki())}Pki(){return ag.$xe}wGa(A,
ea){ea=void 0===ea?null:ea;A=this.uyg(A);return 0!==A?(ea&&ea.oAe(),2===A&&this.El(0,this.Rcf(A)),!1):!0}finalizeUpload(A,ea){k.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.MOd=ea;this.d1j();Vf.a.mark(5576);this.k3b=this.rR.Le("LoadResource","PictureUploadTime")}El(A,ea){const Ma=new tf.StandardDialog;Ma.Fd=0;Ma.FC(A,CommonUIStrings.l_ImageUploadFailedTitle,ea,null)}Qyc(){k.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.Qyc();this.k3b&&(this.k3b.stop(),
this.k3b=null);this.Oih()}d1j(){this.Tva=(new pf.a).create();this.Tva.message=CommonUIStrings.l_ImageUploadWait;this.Tva.Fd=5;this.Tva.Uv=!1;this.Tva.kFa(null,null,null)}Oih(){this.Tva&&(this.Tva.close(),this.Tva=null)}static Bri(A,ea){A=Sa.a.Im(A);for(let Ma=0;Ma<ea.length;++Ma)if(A.endsWith(ea[Ma]))return!0;return!1}static wGa(A,ea){ea=void 0===ea?null:ea;ea||(ea=ag.$xe);return A?ag.Bri(A,ea)?0:2:1}}ag.$xe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(x.a)(ag,"PictureUploader",Gf,[]);
var Wf=a(569),vg=a(324),Nf=a(248),Rg=a(153),Tf=a(179),yh=a(97),l=a(104),ba=a(183),Fa=a(196),db;(function(A){A[A.unknown=0]="unknown";A[A.bing=1]="bing";A[A.M365=2]="M365"})(db||(db={}));Object(x.b)("InsertMediaProviders",db);var Yb=a(98),Cc=a(908);class ad extends Cc.a{constructor(A,ea){super(A,K.a.ZM(ea))}rQb(A,ea){this.isEnabled()&&this.pS(this.targetOrigin)&&(this.Vn(A),this.em(A,ea))}}Object(x.a)(ad,"InsertMediaCrossDocumentMessenger",Cc.a,[615,387,5]);class cd{}Object(x.a)(cd,"OnlineMediaSearchResult",
null,[]);var ae=a(326),se=a(871),ze=a(359),of;(function(A){A[A.OK=0]="OK";A[A.cancel=1]="cancel";A[A.error=2]="error";A[A.open=3]="open"})(of||(of={}));Object(x.b)("HubbleAction",of);var mf=a(73);class Uf extends Rg.a{constructor(A,ea,Ma,Vb,tc,Jc){super();this.qqc=!1;this.correlationId=this.PFd=this.cE=this.zAa=null;this.$4i=()=>{this.Mya(this.v4a);this.CFc(1)};this.GEd=ld=>{ld.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==ld.target.id||ld.shiftKey?"KeepFocusStartDiv"===ld.target.id&&ld.shiftKey&&(ld.preventDefault(),
document.getElementById("KeepFocusDiv").focus()):(ld.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.obj=()=>{this.Gub&&(this.Gub.launchUpsellExperience("stockimages"),k.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.Mcj=ld=>{ld&&ld.Values&&(ld=ld.Values,delete ld.m_Origin,delete ld.m_Source,delete ld.m_ReceivedTime,k.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+ld.eventName||!1),Tf.a.sendOtelEvent(Object.assign(new se.a,
{otelEvent:ld})))};this.nm=Jc;this.$=A;this.zqf=ea;this.Gub=Ma;this.raa=[];this.udb=Vb;this.sAh=tc;this.uEe=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.Oh=this.Nrh()}W0j(A){this.qqc=!1;this.showDialog(this.nm,null);this.zAa=document.getElementById(this.Gj("InsertMediaFrame"));if(!this.zAa)throw this.Mya(this.v4a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var ea=document.getElementById(this.Gj("WACDialogPanel"));ea&&ea.setAttribute(yh.a.wf,yh.a.avb);ea=document.createElement("div");
ea.id="KeepFocusStartDiv";ea.tabIndex=0;ea.className="keep-focus-start";this.zAa.parentNode.insertBefore(ea,this.zAa.parentNode.firstChild);ea=document.createElement("div");ea.id="KeepFocusDiv";ea.tabIndex=0;ea.className="keep-focus";this.correlationId=qa.a.create();this.zAa.parentNode.appendChild(ea);$addHandler(this.pNa,"keydown",this.GEd);this.zAa.src=this.zqf;this.zAa.frameBorder="0";ea=document.getElementById(this.Gj("WACDialogButtonPanel"));if(!ea)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");
ea.className="display-none";ea=document.getElementById(this.Gj("WACDialogTitleText"));if(!ea)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");ea.className="display-none";2===this.udb&&(document.getElementById(this.Gj("WACDialogTitlePanel")).className="display-none",document.getElementById(this.Gj("WACDialogBodyPanel")).className="padding-zero");l.FocusManager.instance().uT().scope.jQ=!0;this.cE=new ad(this.zAa.contentWindow,this.zqf);this.cE.pS("https://osiziwuspersimmon002.blob.core.windows.net");
this.cE.pS("https://osizewuspersimmon001.blob.core.windows.net");this.cE.pS("https://osizpscuspersimmon000.blob.core.windows.net");this.cE.pS("https://cdn.hubblecontent.msit.osi.office.net");this.cE.pS("https://cdn.hubblecontent.osi.office.net");this.cE.rQb(ba.a.lWg,Ma=>{this.P3i(Ma,A.jta)});this.cE.rQb(ba.a.insert,()=>{this.Baj(A.jta)});this.cE.rQb(ba.a.c$c,this.$4i);this.cE.rQb(ba.a.NWg,Ma=>{this.Mcj(Ma)});2===this.udb&&0===this.sAh&&(this.cE.rQb(ba.a.CPi,this.obj),this.PFd=this.Gub.AVa("MsoPremiumStockImages",
Ma=>{k.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");Ma.isEnabled?this.cE.sendMessage(ba.a.$kk,{["LicenseTier"]:Ma.toString()}):k.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.CFc(3)}dispose(){this.raa=null;this.Gub&&this.PFd&&this.Gub.gVd("MsoPremiumStockImages",this.PFd);this.cE&&(this.cE.dispose(),this.cE=null);super.dispose()}hide(){super.hide();Yb.a.oGc(this.$)}get h8(){return Fa.a.tec+
"/InsertMediaDialog"}get S0(){return!1}P3i(A,ea){A=A&&A.Values?(A=A.Values)?Object(fb.a)(new cd,{Action:A.action||"",Caption:A.caption||"",ContentType:A.contentType||"",FileExtension:A.extension||"",PageUrl:A.pageUrl||"",SourceUrl:A.sourceUrl||"",ThumbnailUrl:A.thumbnailUrl||"",LicenseUrl:A.licenseUrl||"",LicenseDisplayName:A.licenseDisplayName||"",Height:A.height||0,Width:A.width||0}):null:null;A&&(this.raa.push(A),this.qqc&&(k.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),
ea(this.raa),this.qqc=!1,this.Mya(this.v4a)))}Baj(A){this.raa&&0<this.raa.length?this.raa.length<=this.uEe?(A(this.raa),this.CFc(0),this.Mya(this.v4a)):(this.FC(),k.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.raa.length=0,this.CFc(2)):this.qqc=!0}Nrh(){const A=document.createElement("div");A.id="InsertMediaDialog";A.className=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":
"insert-media-dialog-old";const ea=document.createElement("div");ea.id="InsertMediaPanel";ea.className=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";const Ma=document.createElement("iframe");Ma.id="InsertMediaFrame";Ma.className="insert-media-frame";A.appendChild(ea);ea.appendChild(Ma);return ae.b(A)}FC(){const A=fe.a.Ze(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");A.Description=
String.format(qb.a.instance.gd(206),this.uEe.toLocaleString());hb.EwaSettings.EA()?new zd.a(this.$,A):(new Qd.ErrorDialog(this.$,A)).hi()}Ebi(){return 2===this.udb?"M365":"bing"}CFc(A){var ea,Ma;if(2===this.udb||1===this.udb){const tc=G.AFrameworkApplication.fa.Ta("InsertMediaDialogAriaTenantNameSpace");if(tc&&""!==tc){var Vb=[];Array.add(Vb,Object.assign(new mf.a,{name:"DialogMode",string:this.Ebi()}));Array.add(Vb,Object.assign(new mf.a,{name:"Provider",string:db[this.udb]}));Array.add(Vb,Object.assign(new mf.a,
{name:"InsertedFiles",int64:null===(ea=this.raa)||void 0===ea?void 0:ea.length}));Vb.push(Object.assign(new mf.a,{name:"MediaDetails",string:this.raa?JSON.stringify(this.raa.map(Jc=>Jc.SourceUrl)):null}));Array.add(Vb,Object.assign(new mf.a,{name:"DialogResult",string:of[A]}));Array.add(Vb,Object.assign(new mf.a,{name:"CorrelationId",string:null===(Ma=this.correlationId)||void 0===Ma?void 0:Ma.toString()}));Tf.a.sendTelemetryEvent(Object.assign(new ze.a,{name:String.format("{0}.{1}",tc,"InsertOnlineImages"),
dataFields:Vb}))}}}}Object(x.a)(Uf,"InsertMediaDialog",Rg.a,[]);var Jf=a(390),Pf=a(302);class Qf extends ag{constructor(A,ea,Ma,Vb,tc,Jc){super(null,Ma,Vb);this.DEf=0;this.jta=ld=>{if(ld){var Zd=Array(ld.length);for(var De=0;De<ld.length;De++){const sf=ld[De];Zd[De]={};Zd[De].SourceUrl=sf.SourceUrl;Sa.a.Moa(sf.LicenseUrl)&&Sa.a.Moa(sf.PageUrl)&&(Zd[De].LicenseUrl=sf.LicenseUrl,Zd[De].LicenseDisplayName=sf.LicenseDisplayName,Zd[De].PageUrl=sf.PageUrl);Zd[De].AltText=-2053056795===this.hf.command?sf.Caption:
"";Zd[De].IsCellPicture=15735758===this.hf.command||570484235===this.hf.command}var Ve=-2009825598===this.hf.command?"bing":"M365";De=Qa.h(this.$);var Se=Zb.o(De.ha.ra.activeCell,this.$);rc.a(this.$.userOperationManager,(sf,Of,qg)=>vg.u(this.$.pa.ua,Se,Zd,Ve,gd.b(sf,this.bdj),gd.a(Of,this.adj),qg,null),sf=>new de.a(595,0,sf),this.hf);Xb.HelperMethods.I2?(De=new Map,De.set("MediaProvider",Ve),De.set("ImagesCount",ld.length.toString()),De.set("TimeTakenToOpenDialog",this.DEf.toString()),F.Health.instance.recordKpiUsage(Pf.a.izi,
1,Jf.a.hqg,De)):k.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Qyc()}else k.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.bdj=ld=>{if(Nf.a(ld))k.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${fe.a.me(ld.Errors)}`);else{k.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");
const Zd=this.hf.command;15735758!==Zd&&570484235!==Zd&&(ld.Result?Ee.a(this.$).paa(1,ld.Result):k.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};this.adj=()=>{k.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=A;this.hf=ea;this.AL=Jc;this.cFe=ua.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let A=
null;A=this.$.Jd.Le("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.hf.command){case -2009825598:case 15735758:this.g0j();break;case -2053056795:case 570484235:this.cFe.execute(ea=>{ea.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Ma=>k.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${Ma}`)).then(Ma=>{this.h0j(Ma);return null})})}A.stop();this.DEf=A.Ee}g0j(){let A=this.$.xa.BingPictureEndpoint;
const ea=Wf.a.XM(G.AFrameworkApplication.lcid),Ma=qa.a.create();A?(A=0<A.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(A,1,1):String.format(A,1,G.AFrameworkApplication.lcid,ea?ea.name:"en-us",G.AFrameworkApplication.buildVersion,Ma.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.ycc(A,1,-1,qb.a.instance.ia(1764))):(k.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.AL.setException(Error.create("Failed to access the Bing service endpoint")))}h0j(A){var ea=
this.$.xa.M365PictureEndpoint,Ma=qa.a.create();if(ea){var Vb=this.$.xa.DocumentHostInfo.UserId;Vb=Vb?Sa.a.zy(Vb).toString():"0";var tc=this.cFe.instance.isFreemiumUpsellEnabled();A=A?1:tc?0:-1;Ma=Ma.toString();tc=Wf.a.XM(G.AFrameworkApplication.lcid).name;ea=String.format(ea,G.AFrameworkApplication.lcid,tc,G.AFrameworkApplication.buildVersion,Ma,1,Vb,A,1);this.ycc(ea,2,A,qb.a.instance.ia(1763))}else k.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),
this.AL.setException(Error.create("Failed to access the M365 service endpoint"))}ycc(A,ea,Ma,Vb){try{(new Uf(this.$,A,ua.a.instance.ai("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ea,Ma,Vb)).W0j(this),this.AL.setResult(!0)}catch(tc){k.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${tc}] [MediaProvider : ${ea}] [DialogLicenseTier : ${Ma}]`),this.AL.setException(tc)}}}Object(x.a)(Qf,"OnlinePictureUploaderWrapper",ag,[5]);let ff=
class{constructor(A,ea){this.$=A;this.uploaderCreator=ea}executeCommand(A,ea,Ma){A=ea.command;switch(A){case 1403967063:case -2060689045:if(Ma&&"dataUrl"in Ma)return ea=new Mf.a,this.uploaderCreator&&this.uploaderCreator.Twi(this.$,sb.a.instance,G.AFrameworkApplication.fa,Ma,Ma.dataUrl,ea),ea.task;this.uploaderCreator&&this.uploaderCreator.Txi(this.$,ea,sb.a.instance,G.AFrameworkApplication.fa,Ma);return yc.Task.Wa(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return A=new Mf.a,
new Qf(this.$,ea,sb.a.instance,G.AFrameworkApplication.fa,Ma,A),A.task;default:return od.a(A)}}qe(A,ea){let Ma=this.$.isEditMode;if(Ma)switch(ea.command){case 1403967063:Ma=!0;break;case -2053056795:Ma=!0;break;case -2009825598:Ma=!0;break;case -2060689045:case 15735758:case 570484235:Ma=le.a.THb()&&1===A;break;default:Ma=!1}return Ma}Ge(){return!1}Ce(){return!1}};ff=Object(ra.a)([Object(Ib.d)(Yc.wb),Object(ra.b)(0,Object(Yc.R)()),Object(ra.b)(1,Object(Yc.Lc)())],ff);Object(x.a)(ff,"PictureCommandHandler",
null,[190]);class Ug extends Me.a{constructor(A){super(A)}yf(){Ed.TaskExtensions.ya(Object(Re.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?Object(Zc.d)(Ib.a.resolve(Yc.Lc,{Qa:this.Na})):Ac.GetServiceTaskFactory.Vc(this.$.ea,484,485,1),A=>{this.gf([new ff(this.$,A.result)])},this.$.ka,3)}static la(A){Me.a.Nf(90,new Ug(A))}}Object(x.a)(Ug,"PictureCommandHandlerFactory",Me.a,[]);var Zh=a(655),Nh=a(561),Tg=a(49),dh=a(1169);class Zg extends Rg.a{constructor(A,ea){ea=void 0===ea?!0:ea;super(!1,
!1,Zg.px);this.r1a=null;this.Lje=!1;this.xp=[];this.Gl=null;this.H5b=A;this.uQg=ea;this.Gz=this.Gwe=!1;this.jka=null;this.bTc=!1;this.Oh=this.rAh;this.kg="InsertFileDialog";this.$d(1,this.g6b);Zg.px?(this.r1a={["id"]:this.kg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.dhj,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.Q8i,"onFrameReady")},this.initializeAndShow(this.titleText,
Object(z.a)(this,this.woc,"insertDialogHandler"),this.r1a),this.R_b=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.woc,"insertDialogHandler")),ea&&this.Ohg(),(A=this.TM(1))&&this.xp.push(A),(A=this.TM(0))&&this.xp.push(A),this.swg(),this.R_b=!1)}get glk(){return this.H5b}validate(){this.Gl.EH||k.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Gl.EH.value?!0:(Zg.FC(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Q8i(A){this.uQg&&(this.Gl=this.Nhg(A,
this.H5b))}dhj(){this.Gl&&this.Gl.EH&&(this.Lje||(this.Gl.Xxj(Object(z.a)(this,this.YMd,"onFileChosen")),this.Lje=!0),this.Gl.X6e())}YMd(A){this.r1a.uploadStatusLabel=A;this.fGa(this.titleText,Object(z.a)(this,this.woc,"insertDialogHandler"),this.r1a)}woc(A){1===A&&this.isEnabled()?Zg.px&&this.Gl.EH&&!this.Gl.EH.value?(this.r1a.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.fGa(this.titleText,Object(z.a)(this,this.woc,"insertDialogHandler"),this.r1a)):(this.n$a(),this.H5b.finalizeUpload(this.Gl,
Object(z.a)(this,this.dispose,"dispose"))):0===A&&this.hide()}Ohg(){this.bTc=!1;this.Gl=this.Nhg(document.getElementById("uploadFrameContainer"),this.H5b);G.AFrameworkApplication.fa.qa("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.jka=Object(z.a)(this,this.NOd,"onUploadFrameLoad"),Tg.a.addHandler(this.Gl.iFrame,"load",this.jka));this.Gl.EH||k.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.s0f()}NOd(){this.s0f()}s0f(){if(this.Gl&&!this.bTc){var A=this.Gl.EH;A&&(Tg.a.addHandler(A,
wb.a.Rd,Object(z.a)(this,this.onKeyDown,"onKeyDown")),A=[A],this.xp=A.concat.apply(A,this.xp),this.swg(),this.bTc=!0)}}dispose(){if(this.Gl&&!Zg.px){const A=this.Gl.EH;A&&Tg.a.removeHandler(A,wb.a.Rd,Object(z.a)(this,this.onKeyDown,"onKeyDown"));this.jka&&Tg.a.removeHandler(this.Gl.iFrame,"load",this.jka)}this.Gl=null;super.dispose()}swg(){if(0<this.xp.length){const A=new dh.a(this.xp),ea=l.FocusManager.instance().uT();ea&&(this.xp[0].focus(),ea.ah=A,ea.e3=!0)}}onKeyDown(A){4!==l.FocusManager.instance().v0f(A)&&
A.preventDefault()}static get px(){return G.AFrameworkApplication.sa.Sa.Tx&&G.AFrameworkApplication.sa.Sa.Gwf}static FC(A){const ea=document.getElementById("errorText");ea.innerText=A;ea.style.display="inline-block"}}Object(x.a)(Zg,"InsertFileDialog",Rg.a,[]);class $g{static get Oh(){return Rg.a.fq($g.hn,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}$g.hn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(x.a)($g,"InsertImageDialogHtml",null,[]);class Gh extends Zg{constructor(A,ea){super(A,void 0===ea?!0:ea)}get g6b(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get rAh(){return $g.Oh}validate(){this.Gl.EH||k.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const A=Object(y.a)(ag,this.glk),ea=A.uyg(this.Gl.EH.value);return 0!==ea?(Zg.FC(A.Rcf(ea)),!1):!0}}Object(x.a)(Gh,"InsertImageDialog",Zg,[]);var Eh=
a(566);const Sh=(A,ea,Ma)=>{if(A){var Vb=0;do{try{A();break}catch(tc){if(k.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Vb,Ma,tc.message,tc.stack),Vb>=ea)break}Vb++}while(1)}};var rh=a(127),Lh=a(474);class Oh{constructor(A,ea,Ma,Vb,tc,Jc,ld,Zd,De,Ve,Se,sf){De=void 0===De?!0:De;Se=void 0===Se?!1:Se;this.d7e="FileUpload.ashx";this.tq=null;this._initialized=!1;this.Pi=this.xob=this.aTc=this.jka=this.q0b=this.Cr=this.ov=null;this.So=
!1;this.EG=this.r0b=this.C2c=null;this._parent=A;this.hLg=ea;this.NPg=Ma;this.qke=tc;this.A0c=ld;this.hee=Zd;this.oqe=void 0===sf?null:sf;this.nge=void 0===Ve?null:Ve;this.B2c=!1;this.GLg=Vb.qa("CanaryRenewalForFileUploadIsEnabled");this.Ixg=!1;(this.gva=Se)||this.Woh(Jc);De&&this.lqf()}get S$f(){return this.NPg}get sessionId(){return this.A0c}get iFrame(){return this.tq}get EH(){return this.Cr}get Hdb(){return G.AFrameworkApplication.fa?G.AFrameworkApplication.fa.qa("NativeFileOpenDialogIsEnabled"):
!1}get Y6e(){return G.AFrameworkApplication.fa?G.AFrameworkApplication.fa.qa("FileInputDescriptionAccessibilityIsEnabled"):!1}get blk(){return G.AFrameworkApplication.fa?G.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.UploadDocumentFromPCIsEnabled",!1):!1}get hHi(){return this.gva?!1:rh.b(this.tq.contentWindow.location.pathname,this.d7e,0)}get c3g(){return!ja.a.bBa&&G.AFrameworkApplication.fa.qa("AllowMultipleImageInsertFromLocalDevice")}lqf(){this.EG=qa.a.create().toString();
this.gva?this.cjd():this.j4g()}Woh(A){this.tq=document.createElement("iframe");this.tq.className=A;this.tq.id=A;this.qke&&(this.tq.style.visibility="visible",this.tq.style.height="30px",this.tq.setAttribute("frameborder","0"));this.jka=Object(z.a)(this,this.NOd,"onUploadFrameLoad");Tg.a.addHandler(this.tq,"load",this.jka)}efc(A){A=void 0===A?null:A;G.AFrameworkApplication.sa.uAc();if(!this.Cr)return k.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Tg.a.addHandler(this.Cr,"change",()=>{this.MUh(A)});
Sh(Object(z.a)(this,this.X6e,"fileInputClick"),1,"DoFileOpenDialog");return this.Cr.value}MUh(A){A&&A(this.Cr.value)}NUh(){this.q0b&&(this.q0b.innerText=this.mef())}Xxj(A){Tg.a.addHandler(this.Cr,"change",()=>{A(this.mef())})}mef(){let A=null;if(this.Cr.value){const ea=this.Cr.value,Ma=ea.lastIndexOf("\\");0<Ma&&(A=ea.substring(Ma+1,ea.length))}return A?A:""}X6e(){try{k.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Cr.click()}catch(A){throw k.ULS.sendTraceTag(36783331,
322,10,"UploadFrame.FileInputClick Exception: {0}",A.message),A;}}a7j(){this.HKi()?this.Nog():(this.Bae(),this.ov.submit())}HKi(){return(this.GLg||this.gva)&&!(void 0===window.self.FormData||null===window.self.FormData)}heg(A){if(A){const ea=this.gSe();this.Pi=new XMLHttpRequest;this.Pi.open("POST",ea);this.Pi.setRequestHeader("X-CorrelationId",this.EG);this.hTi(A);this.Pi.onreadystatechange=Object(z.a)(this,this.jta,"uploadResponseReceived");this.Pi.send(A)}}hTi(A){if(!ja.a.bBa&&A.get){var ea=A.get("ImageId");
A=window.self.navigator;ea={["CorrelationId"]:this.EG,["Canary"]:G.AFrameworkApplication.canary,["ImageNodeId"]:ea};A&&(A=A.connection?A.connection:A.mozConnection?A.mozConnection:A.webkitConnection?A.webkitConnection:null)&&(ea.effectiveType=A.effectiveType,ea.downlink=A.downlink,ea.type=A.type,ea.rtt=A.rtt);k.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",ea)}}Nog(){try{this.Bae();k.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");
const A=new (Type.parse("FormData"))(this.ov);this.heg(A)}catch(A){k.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+A.message),this.Veb(null)}}Mog(A){try{if(this.Bae(),k.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.Ymk(A)){this.r0b=A;this.ov.contains(this.Cr)&&this.ov.removeChild(this.Cr);var ea=new (Type.parse("FormData"))(this.ov);ea.append("applicationfileInput",A.blob,A.filename);this.heg(ea)}else this.Veb(null)}catch(Ma){k.ULS.sendTraceTag(591267743,
322,10,"SubmitFormWithBlob failed to send the request with exception "+Ma.message),this.Veb(null)}}Ymk(A){return A&&void 0!==A.blob&&null!==A.blob&&void 0!==A.filename&&null!==A.filename&&""!==A.filename?void 0===window.self.FormData||null===window.self.FormData?(k.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(A=A?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===A.blob||null===A.blob,void 0===A.filename||null===A.filename||""===
A.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",k.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",A)),!1)}jta(){if(4===this.Pi.readyState)if(200===this.Pi.status){k.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.EG);const A=this.Pi.getResponseHeader("X-NewKey"),ea=this.ECi(this.Pi);let Ma=!1;if(void 0!==A&&null!==A&&ea&&(Ma=this.Nmk(A),!this.B2c&&Ma)){k.ULS.sendTraceTag(594888404,
322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.EG);this.B2c=!0;void 0!==this.r0b&&null!==this.r0b?this.Mog(this.r0b):this.Nog();return}k.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.B2c,ea,!(void 0===A||null===A),Ma,this.EG);this.Veb(this.Pi.responseText)}else k.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",
this.Pi.status,this.Pi.responseText?!1:!0,this.EG),this.Veb(null)}ECi(A){try{const ea=I.a(A.responseText).Responses;if(void 0!==ea&&null!==ea&&1===ea.length){const Ma=ea[0];if(void 0!==Ma&&null!==Ma&&2===Ma.length&&28===Ma[1].StatusCode)return!0}}catch(ea){}return!1}Nmk(A){Lh.a.jvg(A);return G.AFrameworkApplication.canary!==A?!1:!0}Bae(){this.C2c||(this.C2c=new Date)}dispose(){this.So||(this.gva?this._parent.removeChild(this.ov):(this._parent.removeChild(this.tq),Tg.a.removeHandler(this.tq,"load",
this.jka),this.jka=null),this.aTc&&(Tg.a.removeHandler(this.Cr,"change",this.aTc),this.aTc=null),this.Y6e&&(this.xob&&(Tg.a.removeHandler(this.Cr,"change",this.xob),this.xob=null),this.q0b=null),this.Cr=this.ov=this._parent=this.tq=null,this.So=!0,this.C2c=null,k.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}Arh(A){if(this.ov){var ea;(ea=this.ov.querySelector("input[name=__REQUESTDIGEST]"))?ea.value=A:(ea=this.med(),ea.type="hidden",ea.id="__REQUESTDIGEST",
ea.name="__REQUESTDIGEST",ea.value=A,this.ov.appendChild(ea))}}med(){return this.gva?document.createElement("input"):this.tq.contentWindow.document.createElement("input")}NOd(){try{if(!this.tq.contentWindow.document.body)return}catch(ea){this.pqi();return}if(!(this._initialized||this.Hdb&&ja.a.ND))this.cjd();else if(!this.Hdb||!ja.a.ND||this.hHi){let ea;ea=ja.a.Sx?this.tq.contentWindow.document.body.innerText:this.Ixg?this.tq.contentWindow.document.body.firstChild.innerText:this.tq.contentWindow.document.body.firstChild.innerHTML;
var A=this.tq.contentWindow.document.body.innerText.toLowerCase();const Ma=0<=A.indexOf("responses")||0<=A.indexOf("wopisrc");A=0<=A.indexOf("http error");!Ma&&A&&k.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.tq.contentWindow.document.body.innerText);this.Veb(ea)}}cjd(){if(!this._initialized){var A=this.ia("uploadForm");const ea=this.ia("fileInput"),Ma=this.gSe();this.hrh();this.ov.id=A;this.ov.method="post";this.ov.encoding="multipart/form-data";
this.ov.action=Ma;this.Cr.type="file";this.hee&&(this.Cr.accept=this.hee,this.nge&&(this.Cr.capture=this.nge));this.Cr.id=ea;this.Cr.name=ea;this.c3g&&(this.Cr.multiple=!0);this.blk&&("true"===this.oqe?this.Cr.multiple=!0:"false"===this.oqe&&(this.Cr.multiple=!1));!this.Y6e||ja.a.Sx||ja.a.QF||(this.xob=Object(z.a)(this,this.NUh,"fileInputChangedHandleAccessibility"),Tg.a.addHandler(this.Cr,"change",this.xob),this.q0b=yh.a.yFe(this.ov,this.Cr,"InputFileDescription"));this.qke&&(this.gva||(A=this.tq.contentWindow.document.body,
A.style.margin="0",A.style.overflow="hidden"),A=G.AFrameworkApplication.sa,this.Cr.style.fontFamily=A.N4,this.Cr.style.fontSize=A.sLc,this.Cr.style.margin="0");(A=document.getElementById("__REQUESTDIGEST"))&&this.Arh(A.value);this.ov.appendChild(this.Cr);this._initialized=!0;this.hLg(this)}}hrh(){if(this.gva)this.ov=document.createElement("form"),this._parent.appendChild(this.ov),this.Cr=document.createElement("input");else{this.ov=this.tq.contentWindow.document.createElement("form");const A=this.tq.contentWindow.document;
A.body.appendChild(this.ov);this.Cr=A.createElement("input")}}j4g(){this._parent.appendChild(this.tq);this.Hdb&&ja.a.ND&&this.cjd()}gSe(){var A=new ka.QueryStringBuilder(this.d7e);G.AFrameworkApplication.I2a(A);this.uPj(A);A=A.toString();if(ja.a.hh||ja.a.ND||ja.a.QF)A=K.a.ejc(A);return A}oAe(){const A=new re.a(2,1,0,Object(z.a)(this,this.delayedDispose,"delayedDispose"),4);G.AFrameworkApplication.Lj.Ah(A)}}Object(x.a)(Oh,"UploadFrame",null,[5]);class pg extends Oh{constructor(A,ea,Ma,Vb,tc,Jc,ld,
Zd){Zd=void 0===Zd?!1:Zd;super(A,ea,Ma,Vb,tc,"UploadFrame",Jc.da.sessionId,"image/*",!1,null,void 0===ld?!1:ld);this.$=Jc;this.Ixg=!0;this.LCi=Zd;this.lqf()}ia(A){return A}uPj(A){k.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");wc.a.S6c(A,this.$.xa);A.q6(Bc.a.sessionId,this.sessionId);var ea=Qa.h(this.$).ha;ea=Zb.o(ea.ra.g8,this.$);A.q6(Bc.a.erj,this.$.va.na.name);A.q6(Bc.a.drj,ea.FirstRow.toString());A.q6(Bc.a.crj,ea.FirstColumn.toString());A.q6(Bc.a.mzi,this.LCi.toString())}pqi(){this.S$f("ServerUploadError")}Veb(A){this.S$f(A)}static SEi(A){return!A||
Lc.a.equals(A,"ServerUploadError",!1)}}Object(x.a)(pg,"UploadFrameWrapper",Oh,[]);class Zf extends Gh{constructor(A,ea,Ma,Vb){super(A,!1);this.HX=null;this.wFa=!1;this.Od=null;this.exc=()=>{this.H$d("");this.HLc();return!1};this.$=ea;this.QMc=A;this.JT=Eh.a.instance;this.fa=Ma;this.Od=Vb;this.Ohg();this.Lxd();this.$.hd.FA=!0}Nhg(A,ea){return new pg(A,Object(z.a)(ea,ea.kOb,"onUploadFrameInitialized"),Object(z.a)(ea,ea.jta,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.HLc();this.JT=this.QMc=
null;super.dispose()}hide(){super.hide();this.$.hd.FA=!1}validate(){var A=this.QMc.kbe(this.Gl.EH.value,this.QMc.Xsg(this.Gl));return 0!==A?(A=this.QMc.Ppd(A).Description,this.H$d(A),this.F6d(),!1):!0}isEnabled(){return!0}H$d(A){var ea;null===(ea=this.Od)||void 0===ea?void 0:ea.Pfg(this.HX,A)}Lxd(){this.HX=document.getElementById("errorText");this.HX.style.display="inline-block";this.wFa=!1;this.H$d("");this.pNa.style.maxWidth=this.pNa.currentStyle.minWidth}F6d(){this.JT.ta(wb.a.click,this.Gl.EH,
this.exc);this.JT.ta(wb.a.Rd,this.Gl.EH,this.exc);this.wFa=!0}HLc(){this.wFa&&(this.JT.Aa(wb.a.click,this.Gl.EH,this.exc),this.JT.Aa(wb.a.Rd,this.Gl.EH,this.exc),this.wFa=!1)}}Object(x.a)(Zf,"InsertImageDialogWrapper",Gh,[]);class Og extends ag{constructor(A,ea,Ma,Vb,tc){tc=void 0===tc?!0:tc;super(null,ea,Ma);this.Ima=this.MI=null;this.rzd=this.Ubb=!1;this.rQd=null;this.jta=Jc=>{this.mce.stop();this.l9b.cancel();if(pg.SEi(Jc))this.EKc?this.Nkf(4):(Jc=new Zh.a(0,2,null,null,!1,null,null,null),Jc.status=
8,this.i9d(new Nh.a(Jc),null,"InsertPictureWebMethod")),k.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.EKc}`);else{const ld=Og.knk(Jc);0!==ld?(k.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${Jc}`),this.Nkf(ld)):this.bqi(Jc)}this.Qyc();this.dispose()};this.j8i=Jc=>{this.wGa(Jc,this.Gl)&&this.finalizeUpload(this.Gl,null)};this.kOb=Jc=>{k.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.Gl=Jc;if(!this.J6a){if(this.Iae){if(this.nLe()||
this.Hdb&&ja.a.ND){Jc.efc(this.j8i);return}const ld=Jc.efc(null);if(!this.wGa(ld,Jc))return}this.finalizeUpload(Jc,null)}};this.Bgj=()=>{this.EKc=!0};this.dd=A;this.mce=A.Jd.Yh("WebServiceCall","InsertPictureOperation");this.l9b=Na.a.instance.create(this.Bgj,1E5,nb.a.T7g,!1);this.EKc=!1;this.avc=this.$.xa.InsertPictureMaxFileSizeBytes;Vb&&(this.Ubb="TestOnly"in Vb);Vb&&(this.rzd="IsCellPicture"in Vb);tc&&this.showDialog()}get $(){return this.dd}get DXi(){return this.avc/1024/1024}dispose(){fa.a.Ma(this.l9b);
this.Gl&&this.Gl.oAe();this.Gl=this.l9b=this.dd=null}Vuj(A){if(!this.$)return k.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),yc.Task.Wa(!0);if(!this.$.h9)return yc.Task.Wa(!0);const ea=new Mf.a,Ma=new FileReader;A=A.EH.files[0];const Vb=()=>{ea.iy(!0)};Ma.onload=()=>{this.rQd=Ma.result;ea.iy(!0)};Ma.onerror=Vb;Ma.onabort=Vb;Ma.readAsDataURL(A);return ea.task}Xsg(A){let ea=-1;A=A.EH;(null===A||void 0===A?0:A.files)&&0<A.files.length&&(ea=A.files[0].size);return ea}kbe(A,
ea){let Ma=Og.Qnh(ag.wGa(A));0===Ma?-1!==ea&&(k.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ea}, maxAllowedSize: ${this.avc}, remainingWorkbookSize: ${this.$.da.HAf}`),ea>this.avc?Ma=3:ea>this.$.da.HAf&&(Ma=7)):6===Ma&&this.lVi(A);k.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Ma}`);return Ma}wGa(A,ea){A=this.kbe(A,this.Xsg(ea));return 0!==A?(this.J6a||1===A||this.m4d(A),!1):!0}rsg(A){A.a7j()}Ppd(A){let ea=0,Ma=1,Vb=-1100324317,tc="InsertPictureUnknownError",
Jc=null;switch(A){case 1:ea=1758;Ma=0;Vb=940870981;tc="InsertPictureNoFileSelected";break;case 3:Ma=0;Vb=1250467391;tc="InsertPicturePictureTooBig";Jc=String.format(qb.a.instance.gd(181),this.DXi.toLocaleString());break;case 6:ea=1762;Ma=0;Vb=1380041209;tc="InsertPictureUnsupportedFormat";break;case 7:ea=1759;Ma=0;Vb=-903115058;tc="InsertPictureExceedWorkbookSize";break;case 4:ea=1760;Ma=0;Vb=1218352119;tc="InsertPictureUploadTimeout";break;case 5:ea=1761,Ma=0,Vb=1979899005,tc="InsertPictureServiceNonDeterministicError"}A=
Og.Ze(ea,Ma,Vb,tc);Jc&&(A.Description=Jc);return A}showDialog(){if(this.nLe())this.J6a=!1,this.Gl=new pg(this.$.domElement,this.kOb,this.jta,this.fa,!1,this.$,!0,this.rzd);else if(k.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Ubb&&(ja.a.WB||ja.a.ND&&72>ja.a.xNe))this.J6a=!1,this.Gl=new pg(this.$.domElement,this.kOb,this.jta,this.fa,!1,this.$);else{this.J6a=!0;const A=Object(Zc.d)(Ib.a.resolve(Yc.tb,{Qa:0}));Ed.TaskExtensions.ya(A,()=>{this.Gl=(new Zf(this,this.$,this.fa,
A.result)).Gl},this.$.ka,3)}}bqi(A){let ea={};try{if(ea=hf.a.nk(A),yb.b().hD(this.mce.id,ea.ServerCorrelationId,"actions","ServerActions"),!fe.a.Bh(ea.Errors)&&ea.Result&&(this.$.da.m_(ea.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.rzd)){const Ma=ea.Result;Ee.a(this.$).paa(1,Ma);const Vb=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)?Ib.a.Ph(Yc.Mc):this.$.ea.Ba(277);Vb&&Vb.u4c(this.$,1,ea.Result,ea,"InsertPicture");k.ULS.sendTraceTag(526399114,
0,50,"Insert picture completed successfully :)")}}catch(Ma){k.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${A?A.length:-1}, errror: ${Ma}`)}this.gLc(ea,null,"InsertPictureWebMethod")}Nkf(A){A=this.Ppd(A);const ea={};ea.Errors=[A];this.gLc(ea,null,"InsertPictureWebMethod")}gLc(A,ea,Ma){this.MI(A,ea,Ma)}i9d(A,ea,Ma){this.Ima(A,ea,Ma)}m4d(A){A=this.Ppd(A);hb.EwaSettings.EA()?new zd.a(this.$,A):(new Qd.ErrorDialog(this.$,
A)).hi()}lVi(A){const ea=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;A=Sa.a.Im(A);for(let Ma=0;Ma<ea.length;++Ma)if(A.endsWith(ea[Ma])){k.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ea[Ma]}`);break}}static knk(A){return!A||Lc.a.equals(A,Bc.a.insertPictureUnknownError,!0)?2:Lc.a.equals(A,Bc.a.insertPictureNoFileSelectedError,!0)?1:Lc.a.equals(A,Bc.a.lzi,!0)?3:Lc.a.equals(A,Bc.a.ozi,!0)?5:0}static Ze(A,ea,Ma,Vb){return fe.a.Ze(1,0,0,A,ea,Ma,Vb)}static Qnh(A){switch(A){case 1:return 1;
case 2:return 6}return 0}nLe(){return this.Ubb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(x.a)(Og,"BasePictureUploaderWrapper",ag,[5]);class ig extends Og{constructor(A,ea,Ma,Vb,tc,Jc){Jc=void 0===Jc?!0:Jc;super(A,ea,Ma,Vb,!1);this.SUh=tc;this.Phc=A.Jd.Yh("LoadResource","FileReaderUploaderLoadResource");Jc&&this.showDialog()}w0j(){this.avc=28E5;this.m4d(3)}Rld(A){k.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const ea=
new FileReader;A=A.EH.files;if(0==A.length)k.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Ma=A[0];ea.onload=()=>{this.Phc.stop();this.SUh.Yfj(ea.result,this);k.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Ma.type}, Size:${Ma.size.toString()}`)};ea.onerror=()=>{this.Phc.stop();k.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Ma.type}, Size:${Ma.size.toString()}`)};
ea.onabort=()=>{this.Phc.stop();k.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Ma.type}, Size:${Ma.size.toString()}`)};this.Phc.start();ea.readAsDataURL(Ma)}}finalizeUpload(A,ea){this.Rld(A,ea)}}Object(x.a)(ig,"FileReaderUploaderWrapper",Og,[563]);class zg{constructor(A,ea){this.dataUri=this.sheetName=null;this.sheetName=A;this.dataUri=ea}getSheetName(){return this.sheetName}}Object(x.a)(zg,"MacroRecorderPictureInsertedPayload",null,[134]);
class Xg extends Og{constructor(A,ea,Ma,Vb,tc,Jc){Jc=void 0===Jc?!0:Jc;super(A,Ma,Vb,tc,!1);this.hf=ea;Jc&&this.showDialog()}Rld(A,ea){super.finalizeUpload(A,ea);rc.a(this.$.userOperationManager,(Ma,Vb)=>{this.MI=Ma;this.Ima=Vb;this.mce.start();this.l9b.ps();this.EKc=!1;this.rsg(A);return this.Vuj(A)},Ma=>{const Vb={};this.$.wl(Vb);const tc=Vb.SheetName;Ma=new de.a(510,0,Ma,72,()=>new zg(tc,this.rQd?this.rQd:""));Ma.WEa(()=>!0);Ma.hf=this.hf;return Ma},this.hf)}finalizeUpload(A,ea){this.Rld(A,ea)}}
Object(x.a)(Xg,"PictureUploaderWrapper",Og,[]);class Fg{constructor(A,ea){this.filename=A;this.blob=ea}}Object(x.a)(Fg,"UploadBlobParameters",null,[]);class Ph extends Xg{constructor(A,ea,Ma,Vb,tc,Jc,ld){super(A,ea,Ma,Vb,tc,!1);this.Iae=!1;this.AL=ld;this.Nnc=Ph.O_h(Jc);A=this.kbe(this.Nnc.name,this.Nnc.size);0!==A?(this.m4d(A),this.AL.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.Gl=new pg(this.$.domElement,this.kOb,this.jta,Vb,!1,this.$)}i9d(A,ea,Ma){super.i9d(A,
ea,Ma);this.AL.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}gLc(A,ea,Ma){super.gLc(A,ea,Ma);fe.a.Bh(A.Errors)?this.AL.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${fe.a.me(A.Errors)}`)):this.AL.setResult(!0)}rsg(A){const ea=new Fg(this.Nnc.name,this.Nnc);A.Mog(ea)}static O_h(A){var ea=A.split(",");A=ea[0].includes("base64")?window.self.atob(ea[1]):window.self.decodeURI(ea[1]);
ea=ea[0].split(":")[1].split(";")[0];const Ma=new Uint8Array(A.length);for(let Vb=0;Vb<A.length;Vb++)Ma[Vb]=A.charCodeAt(Vb);A=new Blob([Ma],{type:ea});A.name="Image.png";return A}}Object(x.a)(Ph,"DataUrlUploaderWrapper",Xg,[]);let bg=class{constructor(){}Txi(A,ea,Ma,Vb,tc){-2060689045===ea.command&&(tc.IsCellPicture=!0);new Xg(A,ea,Ma,Vb,tc,!0)}Twi(A,ea,Ma,Vb,tc,Jc){new Ph(A,null,ea,Ma,Vb,tc,Jc)}dxi(A,ea,Ma,Vb,tc){new ig(A,ea,Ma,Vb,tc,!0)}};bg=Object(ra.a)([Object(Ib.d)(Yc.Lc)],bg);Object(x.a)(bg,
"UploaderCreator",null,[533]);class xa extends Pb.a{constructor(A){super();this.$=A;this.Md()}static la(A){A.ea.Ja(485,new xa(A))}create(){var A;this.qd(null!==(A=this.$.ea.Ba(484))&&void 0!==A?A:this.$.ea.Ja(484,new bg))}}Object(x.a)(xa,"UploaderCreatorFactory",Pb.a,[]);var Ab=a(395);class sc{constructor(){this.eha=this.R$e=null}}Object(x.a)(sc,"GestureAdapterInfo",null,[]);class X{constructor(){this.iSc=null}$Qi(){if(!this.iSc){var A="hammer.min.js";G.AFrameworkApplication.fa.Mr("IsServerFlavorDebug")&&
(A=G.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");A=G.AFrameworkApplication.SU(String.format("{0}",A),5);A=gb.a.create(A,null,null);ob.a.Aya(A);this.iSc=A.Scb}return this.iSc}static get instance(){X.La||(X.La=new X);return X.La}}X.La=null;Object(x.a)(X,"HammerJsDependencyLoader",null,[564]);var ca;(function(A){A[A.none=-1]="none";A[A.pinch=0]="pinch";A[A.pan=1]="pan";A[A.swipe=2]="swipe"})(ca||(ca={}));Object(x.b)("GestureEvent",ca);var Qb=a(83);class Uc extends Qb.a{constructor(A,
ea,Ma,Vb,tc,Jc,ld,Zd){super(A,Ma,Vb,Jc);this.fnb=ea;this.Xja=ld;this.G_=Zd;this.WJg=tc}get shiftKey(){return this.Xja}get ctrlKey(){return this.G_}get clientPoint(){return this.fnb}get hza(){return this.WJg}static create(A,ea,Ma,Vb,tc,Jc){if(Ma.rawEvent)if(Jc){var ld=Ma.rawEvent;ld=new Sys.UI.Point(ld.clientX,ld.clientY)}else ld=Qb.a.DCb(Ma);else ld=new Sys.UI.Point(Ma.clientX,Ma.clientY);return new Uc(A,ld,ea,Ma,Vb,tc,Ma.shiftKey,Ma.ctrlKey,Jc)}}Object(x.a)(Uc,"GestureEventArgs",Qb.a,[]);class Od{constructor(){this.srcEvent=
this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(x.a)(Od,"GestureManagerData",null,[]);class me{}me.uDg=2;me.vDg=4;me.wDg=8;me.xDg=8;Object(x.a)(me,"HammerConstants",null,[]);
var Oe=a(102),jf=a(207),kf=a(85);class Kf extends Tg.a{constructor(A,ea){super();this.Gua=Ab.a.z1h;this.MZc=!!window.PointerEvent;this.lxe=window.hasOwnProperty("ontouchstart");this.f0a=this.Iqb=null;this.Uba=!1;this.VV=new va.a;this.brb=new va.a;this.XJg=new ha.a;this.dua=null;this.i_a=this.WTc=this.vge=this.SQc=this.EXc=this.Jte=this.Cge=this.Gsb=!1;this.mqb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.u1c=null;this.If=Oe.EventHandlerManager.instance;this.MZc?(k.ULS.sendTraceTag(593893141,
310,50,"Using pointer events"),this.Iqb=Object(z.a)(this,this.TTa,"onPointerEvent"),this.f0a=wb.a.B1h):this.lxe?(k.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Iqb=Object(z.a)(this,this.iDa,"onTouchEvent"),this.f0a=wb.a.touchEvents):(k.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Iqb=Object(z.a)(this,this.Xxc,"onMouseEvent"),this.f0a=wb.a.A1h);this.wj=ea;this.Wia=A;G.AFrameworkApplication.fa&&(this.Gsb=G.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.Cge=
G.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.Jte=G.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.EXc=G.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.SQc=G.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.vge=G.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.WTc=G.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.i_a=this.Gsb&&G.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&
G.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}U9h(){return this.MZc?0:this.lxe?1:2}Fp(A){super.Fp(A);this.If.joa(this.f0a,A,0,this.Iqb)}Ao(A){super.Ao(A);this.If.jNa(A,this.f0a)}qxj(A,ea,Ma){Ma=void 0===Ma?null:Ma;var Vb=void 0===Vb?null:Vb;G.AFrameworkApplication.Iqc()?X.instance.$Qi().continueWith(tc=>{this.K5j();if(tc.Gh||tc.jj)k.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",tc.status);else{k.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",
tc.status);if(this.vge){tc=window.Hammer;if("undefined"===typeof tc){k.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.jJc();return}if("undefined"===typeof tc.inputHandler){k.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.jJc();return}}if(!A)throw this.jJc(),Error.argumentNull("source element can not be null");tc=jf.a.Jza(A,this.Gua);if(void 0===tc||null===tc)tc=new va.a,jf.a.Vib(A,this.Gua,tc),this.rxj(A);var Jc=null;if(!tc.Wc(ca[0])){Jc=Object;var ld=
Jc.assign,Zd=new sc,De=ca[0],Ve=Vb;Ve=void 0===Ve?null:Ve;if(void 0===this||null===this)throw k.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Se=null;switch(De){case wb.a.pinch:Se=new Hammer.Pinch(Ve);break;case wb.a.pan:Se=new Hammer.Pan(Ve)}Se&&(Se.manager=this);Jc=ld.call(Jc,Zd,{eha:Se,R$e:ea});tc.add(ca[0],Jc)}if(void 0!==Ma&&null!==Ma)for(ld=0;ld<Ma.length;ld++)tc.Wc(ca[Ma[ld]])&&(Zd=tc.ma(ca[Ma[ld]]),Jc.eha.recognizeWith(Zd.eha))}this.jJc()}):
k.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}K5j(){this.WTc&&(this.wj?this.u1c=this.wj.Le("Task","RegisterGestureAdapterAfterLoad"):k.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}jJc(){this.WTc&&(this.u1c?this.u1c.stop():k.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}rxj(A){this.XJg.add(A);this.If.joa(this.f0a,A,0,this.Iqb)}recognize(A){var ea=Array(A.pointers.length);for(var Ma=
0;Ma<A.pointers.length;Ma++)ea[Ma]=A.pointers[Ma].target;Ma=null;for(this.dua=this.ubi(ea);void 0!==this.dua&&null!==this.dua&&(Ma=jf.a.Jza(this.dua,this.Gua),void 0===Ma||null===Ma);this.dua=this.dua.parentNode);if(void 0!==Ma&&null!==Ma){this.curRecognizer&&this.curRecognizer.state===me.xDg&&(this.curRecognizer=null);ea=Ma.keys;for(let Vb of ea){ea=Ma.ma(Vb);void 0!==ea&&null!==ea&&void 0!==ea.eha&&null!==ea.eha&&(void 0===this.curRecognizer||null===this.curRecognizer||ea.eha===this.curRecognizer||
ea.eha.canRecognizeWith(this.curRecognizer))&&ea.eha.recognize(A);const tc=ea.eha.state;this.curRecognizer||me.uDg!==tc&&me.vDg!==tc&&me.wDg!==tc||(this.curRecognizer=ea.eha)}}}emit(A,ea){if("hammer.input"!==A){this.Uba=!1;ea=Uc.create(A,this.dua,ea.srcEvent,ea,3,this.MZc);var Ma=jf.a.Jza(this.dua,this.Gua);if(this.GIi(A))var Vb=0;else if(this.vIi(A))Vb=1;else if(this.KLi(A))Vb=2;else{k.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Ma}=Ma.Ve(ca[Vb]));
void 0!==Ma&&null!==Ma&&((Ma=Ma.R$e,Ma.PFi())?A.endsWith("start")?this.Uba=Ma.Z8i(ea):A.endsWith("end")?(Ma.X8i(ea),this.Uba=!0):A.endsWith("cancel")?(Ma.W8i(ea),this.Uba=!0):A.endsWith("move")&&(this.Uba=Ma.Y8i(ea)):k.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",A))}}get(A){return Object(y.a)(Hammer.Recognizer,A)}ubi(A){if(1>A.length)return null;if(1===A.length)return A[0];var ea=A[0],Ma=!0;for(let Vb=1;Vb<A.length;Vb++){if(!A[Vb])return null;if(ea!==A[Vb]){Ma=!1;
break}}if(Ma)return ea;ea=this.laf(A[0]);Ma=0;for(const Vb of A){A=this.laf(Vb);if(ea.ma(ea.count-1)!==A.ma(A.count-1))return null;for(let tc=ea.count-2,Jc=A.count-2;tc>=Ma&&0<=Jc;tc--,Jc--)if(ea.ma(tc)!==A.ma(Jc)){Ma=tc+1;break}}return ea.ma(Ma)}laf(A){const ea=new ha.a;for(;void 0!==A&&null!==A;A=A.parentNode)ea.add(A);return ea}nef(A){switch(A){case wb.a.lh:case wb.a.jda:return 1;case wb.a.xi:case wb.a.ila:return 2;case wb.a.hg:case wb.a.yLa:return 4;case wb.a.XKc:case wb.a.$8c:return 8}return 0}iDa(A,
ea,Ma){A=this.nef(A);ea=this.Y$h(Ma);Hammer.inputHandler(this,A,ea);this.Uba&&Ma.preventDefault();return this.Uba}Vlf(){return 1<this.VV.count}S$b(){k.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Gsb)for(let A of this.VV)this.E6f(A.key);else this.VV=new va.a;this.session=null}JWg(A,ea,Ma){k.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",A);if(!this.brb.Wc(A)){try{ea.setPointerCapture(A)}catch(Vb){k.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",
Vb)}this.brb.add(A,ea)}this.VV.ga(A,Ma);this.i_a&&1<this.VV.count&&this.Wia&&!this.Wia.wwb&&(this.Wia.wwb=!0)}E6f(A){k.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",A);if(this.brb.Wc(A)){try{this.brb.ma(A).releasePointerCapture(A)}catch(ea){k.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ea)}this.brb.remove(A)}else k.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",A);this.VV.remove(A);this.i_a&&1>=this.VV.count&&this.Wia&&
this.Wia.wwb&&(this.Wia.wwb=!1)}TTa(A,ea,Ma){var Vb=Ma.rawEvent.pointerType.toString();const tc=Ma.rawEvent.pointerId.toString();if("touch"!==Vb)return!1;A=this.nef(A);if(1!==A&&!this.VV.Wc(tc))return!1;this.Cge&&1===A&&Ma.rawEvent.isPrimary&&this.VV.count&&(k.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.S$b());this.Gsb?this.JWg(tc,ea,Ma):this.VV.ga(tc,Ma);this.EXc&&2===A&&(!this.SQc||this.SQc&&"function"===typeof Ma.rawEvent.getCoalescedEvents)&&(ea=Ma.rawEvent.getCoalescedEvents())&&
this.Vlf()&&(this.mqb=Math.max(this.mqb,ea.length));this.Jte&&(this.Uba=!1);Vb=this.X$h(this.VV,Ma,Vb);Hammer.inputHandler(this,A,Vb);if(4===A||8===A)this.Gsb?this.E6f(tc):this.VV.remove(tc),this.VV.count||(this.session=null,this.EXc&&-1!==this.mqb&&(k.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.mqb),this.mqb=-1));this.Uba&&Ma.preventDefault();return this.Uba}Xxc(){return!1}Y$h(A){const ea=new Od;var Ma=A.rawEvent;const Vb=Ma.touches;Ma=Ma.changedTouches;ea.pointers=
Array.clone(Vb);ea.pointers=Array.clone(0<Vb.length?Vb:Ma);ea.changedPointers=Array.clone(Ma);ea.srcEvent=A;ea.pointerType="touch";return ea}X$h(A,ea,Ma){const Vb=new Od;Vb.pointers=kf.toArray(A.values);Vb.changedPointers=[ea];Vb.pointerType=Ma;Vb.srcEvent=ea;return Vb}GIi(A){return Sa.a.startsWith(A,wb.a.pinch)}vIi(A){return Sa.a.startsWith(A,wb.a.pan)}KLi(A){return Sa.a.startsWith(A,wb.a.swipe)}}Object(x.a)(Kf,"GestureInputManager",Tg.a,[536,537]);var cg=a(292);class jg{constructor(){this.Rc=null;
this.Hz=!1}get name(){return"Common.App.GestureInputManager"}Oj(A){A.register(Kf,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").se().Ae(()=>new Kf(cg.a.instance,G.AFrameworkApplication.sa.tG));this.Rc=A}init(){this.Hz||(this.Rc.resolve("Common.App.GestureManager.GestureInputManager"),this.Hz=!0)}dispose(){}static main(){Ta.a.instance.Mk(new jg)}}Object(x.a)(jg,"GestureInputManagerPackage",null,[3,4]);var $f=a(107);class Jg extends $f.a{constructor(){super()}static instance(){return Jg.La||
(Jg.La=new Jg)}}Jg.rgj="OnTextSelectionHighlightChangeEvent";Jg.La=null;Object(x.a)(Jg,"TextSelectionHighlightChangeEvent",$f.a,[]);class Aa extends Rg.a{constructor(A,ea){super(!1,!1,!0);this.XGa=A;this.iSg=ea}start(){var A={["tooltipPersistenceEnabled"]:this.XGa.Bwd};G.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(A.textSelectionChangeEnabled=this.XGa.rWb);A={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:A};this.initializeAndShow("",
Object(z.a)(this,this.gIj,"resultHandler"),A)}gIj(A,ea){1===A&&(this.XGa.Bwd=ea.tooltipPersistenceEnabled,G.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(A=ea.textSelectionChangeEnabled,this.XGa.rWb!==A&&this.iSg.raiseEvent(Jg.rgj),this.XGa.rWb=A))}}Object(x.a)(Aa,"AccessibilitySettingsDialog",Rg.a,[]);var Fb=a(116);class kc{constructor(A,ea){this.Oa=A;this.XGa=ea}Mi(){this.Oa.Pd(pa.a.u_j,Fb.a.frame,Object(z.a)(this,this.v_j,"showAccessibilitySettingsDialogHandler"))}v_j(){(new Aa(this.XGa,
Jg.instance())).start();return 32}}Object(x.a)(kc,"AccessibilitySettingsDialogActor",null,[535]);const Dc=A=>{const ea=new Mf.a;G.AFrameworkApplication.mf.Vo(be(A),1,null,null,!0,2,Ma=>{200===Ma.data.httpStatus?ea.setResult("true"===Ma.data.Lf.toLowerCase()):ea.setResult(!1)},()=>{ea.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ea.task},Fd=(A,ea)=>{G.AFrameworkApplication.mf.Vo(be(A),2,ea.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},be=A=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
G.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",A,G.AFrameworkApplication.tk);var Wd=a(147);class Je{constructor(){this.d2a=this.m0a=null}get Bwd(){return!!this.m0a}set Bwd(A){A!==this.m0a&&(this.m0a=A,Wd.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A),this.Jrc()&&Fd("saveHoverableRibbonTooltipIsEnabled",A))}get rWb(){return!!this.d2a}set rWb(A){A!==this.d2a&&(this.d2a=A,this.Jrc()&&Fd("saveTextSelectionHighlightChangeIsEnabled",
A))}fRi(){const A=new Mf.a;if(this.m0a)A.setResult(this.m0a);else if(this.Jrc()){const ea=Dc("getHoverableRibbonTooltipIsEnabled");ea.continueWith(()=>{this.m0a=ea.result;Wd.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ea.result);A.setResult(ea.result)},8)}else A.setResult(!1)}BRi(){const A=new Mf.a;if(this.d2a)A.setResult(this.d2a);else if(this.Jrc()){const ea=Dc("getTextSelectionHighlightChangeIsEnabled");ea.continueWith(()=>{this.d2a=ea.result;A.setResult(ea.result)},
8)}else A.setResult(!1)}Jrc(){const A=G.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),ea=G.AFrameworkApplication.fa.qa("IsAnonymousUser");return A&&!ea}}Object(x.a)(Je,"AccessibilitySettingsInfo",null,[534]);var Ne=a(123);class Lf{constructor(){this.Rc=null}get name(){return"Common.App.AccessibilitySettings"}Oj(A){this.Rc=A;this.Rc.register(Je,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ae(()=>new Je).se();
this.Rc.register(kc,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ae(()=>new kc(G.AFrameworkApplication.jd,this.Rc.ai("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).se()}init(){const A=this.Rc.ai("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ea=this.Rc.ai("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");A&&ea?(ea.Mi(),A.fRi(),A.BRi(),Ne.a(508827098,
200,50,"Text Selection Highlight Change Setting value on boot: {0}",A.rWb)):Ne.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){Ta.a.instance.Mk(new Lf)}}Object(x.a)(Lf,"AccessibilitySettingsPackage",null,[3,4]);var Ef=a(36),ia=a(13),jb=a(252);class oc{constructor(A){this.EEc=A||""}static get N_e(){return oc.gje||(oc.gje=new oc(""))}static get xHd(){return oc.tpe||(oc.tpe=oc.XX(2).EEc)}static KOa(A){A=
Sa.a.am(A||"");return new oc(A)}static fna(A){return oc.KOa(qb.a.instance.ia(A))}static XX(A){return new oc(qb.a.instance.Ia(A))}static Dnd(A,...ea){return oc.IZh(qb.a.instance.gd(A),...ea)}static IZh(A,...ea){const Ma=ea.length,Vb=Array(Ma);for(let tc=0;tc<Ma;tc++)Vb[tc]=(ea[tc]||oc.N_e).EEc;return new oc(String.format(A,Vb))}}oc.gje=null;oc.tpe=null;Object(x.a)(oc,"SafeHtml",null,[578]);const Ec=(A,ea)=>{ea&&(A.append(ea),A.append(oc.xHd))};var ge=a(118),Ae=a(781),Ze=a(226);class Y{constructor(A,
ea){this.S3=this.HU=this.MN=null;this.ana=ea;this.Uth(A);this.yoj();hb.EwaSettings.rd()&&A.ea.Ja(244,this)}get isActive(){return!!this.ana&&document.activeElement===this.ana}readText(A){A=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?A:String.format(qb.a.instance.gd(30),A);this.MN.setAttribute(Gb.a.Aw,A);this.HU.setAttribute(Gb.a.Aw,A);this.c8j()}dispose(){this.S3&&this.S3.parentNode&&this.S3.parentNode.removeChild(this.S3);this.HU=this.MN=this.S3=
this.ana=null}Uth(A){var ea=A.Ad+"readoutElementWrapper";const Ma=A.Ad+"readoutElement1",Vb=A.Ad+"readoutElement2";this.S3=document.getElementById(ea);this.S3||(this.S3=document.createElement(Ze.a.div),this.S3.id=ea,this.MN=document.createElement(Ze.a.label),this.MN.id=Ma,this.MN.setAttribute(Gb.a.wf,Gb.a.L3a),this.MN.setAttribute("aria-roledescription",""),this.MN.setAttribute("aria-multiline",!1),this.HU=document.createElement(Ze.a.label),this.HU.id=Vb,this.HU.setAttribute(Gb.a.wf,Gb.a.L3a),this.HU.setAttribute("aria-roledescription",
""),this.HU.setAttribute("aria-multiline",!1),this.MN.style.width="0px",this.MN.style.height="0px",this.HU.style.width="0px",this.HU.style.height="0px",this.MN.tabIndex=-1,this.HU.tabIndex=-1,this.S3.appendChild(this.MN),this.S3.appendChild(this.HU),A=A.Ad+Gb.a.Ubc,ea=document.getElementById(A),k.ULS.shipAssertTag(537153942,3,!!ea,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${A}`),ea&&ea.appendChild(this.S3))}yoj(){this.ana&&this.MN&&this.HU&&(this.ana.setAttribute(Gb.a.v6,
this.MN.id),this.ana.setAttribute(Gb.a.b9b,`${this.MN.id} ${this.HU.id}`))}c8j(){if(this.isActive){let A="";ia.DOMElementExtensions.hasAttribute(this.ana,Gb.a.v6)&&(A=this.ana.getAttribute(Gb.a.v6).toString());this.ana.setAttribute(Gb.a.v6,A===this.MN.id?this.HU.id:this.MN.id)}else k.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static XAa(){if(null==Y.MBb)if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!ja.a.rBa)Y.MBb=!0,k.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Y.MBb=!1,ja.a.QF||ja.a.hh)Y.MBb=!0,k.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Y.MBb}static la(A){Y.XAa()&&A.ea.Ja(244,new Y(A,Qa.h(A).cellTextEditBox.textBox.Ag))}}Y.MBb=null;Object(x.a)(Y,"FocusBasedReadout",null,[486,5]);let Ua=class{constructor(A,ea,
Ma,Vb){Ma=void 0===Ma?A.Gw:Ma;Vb=void 0===Vb?A.oh:Vb;this.XMf=(tc,Jc)=>{this.FTd(Jc.hf.command)};this.Rdg=()=>{if(!this.$.da.Zd){var tc={["AriaLiveOffCount"]:this.hfe,["AriaLivePoliteCount"]:this.ife,["AriaLiveAssertiveCount"]:this.gfe,["AriaLiveRudeCount"]:this.jfe,["ScreenReaderDivCount"]:this.Gue,["AlertScreenReaderDivCount"]:this.Mee,["AuxScreenReaderDivCount"]:this.rfe,["AriaAlertCount"]:this.efe,["ReadCommandOnCompletionCount"]:this.ote,["TotalAriaLiveRegionUpdates"]:this.kxe};Tf.a.sendTelemetryEvent(Object(fb.a)(new ze.a,
{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:ge.a.Ek(tc)}))}};this.$=A;this.Od=void 0===ea?null:ea;this.qba=document.createElement("div");this.qba.setAttribute(Gb.a.w6,Gb.a.jm);this.qba.className=Ef.a.Vjd;Ma.insertBefore(this.qba,Vb);this.rca=document.createElement("div");this.rca.setAttribute(Gb.a.w6,Gb.a.jm);this.rca.className=Ef.a.Vjd;Ma.insertBefore(this.rca,this.qba);this.dNg=qb.a.instance.Ia(2);this.y6=document.createElement("div");this.y6.setAttribute(Gb.a.wf,Gb.a.Tka);
this.y6.setAttribute(Gb.a.Uka,Gb.a.fLa);this.y6.className=Ef.a.Vjd;Ma.insertBefore(this.y6,this.rca);this.kxe=this.ote=this.efe=this.rfe=this.Mee=this.Gue=this.jfe=this.gfe=this.ife=this.hfe=0;this.register();hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)||this.$.ea.Ja(211,this)}get USa(){return this.dNg}get isActive(){return!0}get K2g(){return this.qba}get BLj(){return this.rca}get activeCell(){return Qa.h(this.$).yd(null)}get RGb(){return hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",
!1)}dispose(){this.$&&this.unregister();ia.DOMElementExtensions.xh(this.y6);ia.DOMElementExtensions.xh(this.qba);ia.DOMElementExtensions.xh(this.rca);this.rca=this.qba=this.y6=this.$=null}setEnabled(A){this.Lfg(this.rca,A)}QQj(){this.Lfg(this.qba,!0)}readText(A){this.Mgb(oc.KOa(A),!0)}bha(A){this.Mgb(oc.KOa(A),!1)}g3f(A,ea){if(1>ea||!A)k.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ma=new Sys.StringBuilder;A=String.format(qb.a.instance.gd(34),ea,A);Ec(Ma,A);Ec(Ma,
qb.a.instance.ia(857));this.Mgb(oc.KOa(Ma.toString()),!1)}}Ouj(A,ea,Ma){if(1>Ma||1>ea||ea>Ma||!A)k.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Vb=new Sys.StringBuilder;Ec(Vb,A);Vb.append(String.format(qb.a.instance.gd(55),ea,Ma));this.Mgb(oc.KOa(Vb.toString()),!1)}}FTd(A){this.RGb||(A=this.tgi(A),this.Mgb(A,!1))}Muj(A){this.RGb&&(A=this.sgi(A),this.Mgb(A,!1,!0))}Mgb(A,ea,Ma){Ma=void 0===Ma?!1:Ma;if(A=A?A.EEc:null)ea=ea?this.rca:this.qba,Lc.a.equals(ea.innerHTML,A,!1)&&
(A+=oc.xHd),this.dsg(ea,Ma),this.Od.Ij(ea,A)}kVa(A,ea){this.y6.getAttribute(Gb.a.Uka)!==ea&&this.y6.setAttribute(Gb.a.Uka,ea);A=A?oc.KOa(A).EEc:"";this.dsg(this.y6);this.Od.Ij(this.y6,A)}Puj(A,ea,Ma,Vb){var tc=!0;tc=void 0===tc?!1:tc;const Jc=qb.a.instance.gd(54);k.ULS.shipAssertTag(537153949,0,!(void 0===A||null===A));k.ULS.shipAssertTag(537153948,0,!(void 0===ea||null===ea));k.ULS.shipAssertTag(537153947,0,!(void 0===Ma||null===Ma));k.ULS.shipAssertTag(537153946,0,!(void 0===Vb||null===Vb));k.ULS.shipAssertTag(537153945,
0,!(void 0===Jc||null===Jc));A=String.format(Jc,A||"",ea||"",Ma||"",Vb||"");tc?this.kVa(A,Gb.a.Iwa):this.readText(A)}Vgk(A){var ea=this.rca.style;A?(A=jb.a.g$b(A.cell,ea),ea=A.bB,ea.top=ea.left=ea.bottom=ea.right=null,A.GW()):ea.cssText=""}tgi(A){if(this.RGb)return null;switch(A){case -1985798686:return oc.fna(12);case -911352779:return oc.fna(11);case 237279923:return oc.fna(13);case -1502853784:return oc.XX(81);case -111689794:return oc.XX(78);case -287251124:return this.jsd(1333,ea=>ea.bold);case -1925065947:return this.jsd(1334,
ea=>ea.italic);case 1764140053:return this.jsd(1335,ea=>ea.underline)}return null}sgi(A){if(!this.RGb||6!==A.Hg)return null;const ea=this.activeCell;if(!ea)return null;switch(A.command){case -1985798686:return oc.fna(12);case -911352779:return oc.fna(11);case 237279923:return oc.fna(13);case -1502853784:return oc.XX(81);case -111689794:return oc.XX(78);case 368460465:A=Qa.h(this.$).ed.Dh(ea.range,!0);if(null!==A)return this.JPa(2291,!A.hasAutoFilter,!1);A=this.$.va.getItemByName(this.$.da.na.sheetName);
return this.JPa(2291,null===A.$U,!1);case -1522760979:return this.JPa(1150,Qa.h(this.$).isFormulaView,!1);case 1941920197:return oc.fna(836);case 1051390410:return oc.XX(589);case 1542466017:return oc.XX(591);case -706918724:return oc.XX(590);case 369708605:return oc.XX(592);case -1215659745:return oc.XX(523);case 1783960667:return oc.XX(521);case -1355155015:return oc.XX(554);case -1158102843:return oc.XX(522);case -287251124:return A=this.Ypc(A.command,ea),null===A?null:this.JPa(1333,A);case -1925065947:return A=
this.Ypc(A.command,ea),null===A?null:this.JPa(1334,A);case 1764140053:return A=this.Ypc(A.command,ea),null===A?null:this.JPa(1335,A);case -1590502662:return A=this.Ypc(A.command,ea),null===A?null:this.JPa(1336,A);case 862890474:case 963349338:if(A=this.Aza(ea),null!==A)return A=oc.KOa(String(A)),oc.Dnd(214,A)}return null}register(){k.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(k.ULS.shipAssertTag(537153943,0,!!this.$.Ha,"Can't register to CommandHandlerManager's event"),
this.$.Ha&&this.$.Ha.Cka(this.XMf),this.$.da&&this.$.da.YE(this.Rdg))}unregister(){this.$&&(this.$.Ha.mha(this.XMf),this.$.da.kG(this.Rdg))}Lfg(A,ea){const Ma=A===this.qba;ea?(Ma&&Y.XAa()||A.setAttribute(Gb.a.Uka,Gb.a.Iwa),Ma&&A.setAttribute(Gb.a.wf,Gb.a.Tka),A.setAttribute(Gb.a.w6,Gb.a.Jt),A.removeAttribute(Gb.a.w6),this.Od.Ij(A,A.innerHTML+" ")):(A.removeAttribute(Gb.a.Uka),Ma&&A.removeAttribute(Gb.a.wf),A.setAttribute(Gb.a.w6,Gb.a.jm))}jsd(A,ea){const Ma=this.activeCell;if(!Ma)return null;const Vb=
hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),tc=[7,8];ea=ea(Ma)?!0:!1;return oc.Dnd(Vb?tc[+ea]:tc[+!ea],oc.fna(A))}dsg(A,ea){ea=void 0===ea?!1:ea;switch(A.getAttribute(Gb.a.Uka)){case Gb.a.RGe:++this.hfe;break;case Gb.a.Iwa:++this.ife;break;case Gb.a.fLa:++this.gfe;break;case Gb.a.H5g:++this.jfe}switch(A){case this.BLj:++this.Gue;break;case this.K2g:++this.Mee;break;case this.y6:++this.rfe}A.getAttribute(Gb.a.wf)===Gb.a.Tka&&++this.efe;ea&&++this.ote;
this.kxe++}JPa(A,ea,Ma){Ma=void 0===Ma?!0:Ma;return this.RGb?oc.Dnd(ea?Ma?7:216:Ma?8:217,oc.fna(A)):null}Ypc(A,ea){return Qa.h(this.$).ha.Va.TT?this.tFi(A):this.uFi(A,ea)}tFi(A){const ea={};switch(A){case -287251124:A="QueryBold";break;case -1925065947:A="QueryItalics";break;case 1764140053:A="QueryUnderline";break;case -1590502662:A="QueryStrikethrough";break;default:return!1}const Ma=Ee.a(this.$);return Ma?(Ma.iQa(A,ea),ea[Ae.a.On]):!1}uFi(A,ea){if(!ea)return null;var Ma=Qa.h(this.$);ea=Dd.a(ea);
hb.EwaSettings.rd()&&Ma.Xc&&(ea.Font=Ma.Fk.Bza(ea.Font));Ma=ea.Font;switch(A){case -287251124:return Ma.Bold;case -1925065947:return Ma.Italic;case 1764140053:return Ma.Underline;case -1590502662:return Ma.Strikethrough}return!1}Aza(A){if(!A)return null;let ea=Qa.h(this.$);if(ea.ha.Va.TT)return null;A=Dd.a(A);hb.EwaSettings.rd()&&ea.Xc&&(A.Font=ea.Fk.Bza(A.Font));return A.Font.FontSize}};Ua=Object(ra.a)([Object(Ib.d)(Yc.f),Object(ra.b)(0,Object(Yc.R)()),Object(ra.b)(1,Object(Yc.tb)())],Ua);Object(x.a)(Ua,
"AriaLiveNotifier",null,[485,486,5]);class ac extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){const A=Object(Zc.d)(Ib.a.resolve(Yc.tb,{Qa:this.Na}));Ed.TaskExtensions.ya(Ed.TaskExtensions.Bf([A],this.$.ka),()=>{this.qd(this.$.ea.Ba(211)||new Ua(this.$,A.result,this.$.Gw,this.$.oh))},this.ka,3)}static la(A){A.ea.Ja(212,new ac(A))}}Object(x.a)(ac,"AriaLiveNotifierFactory",Pb.a,[]);class Kc extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){Y.XAa()?Qa.h(this.$).cellTextEditBox.textBox.GS(()=>
{const A=this.$.ea.Ba(244)||new Y(this.$,Qa.h(this.$).cellTextEditBox.textBox.Ag);this.qd(A)}):this.qd(null)}static la(A){A.ea.Ja(315,new Kc(A))}}Object(x.a)(Kc,"FocusBasedReadoutFactory",Pb.a,[]);const Td=A=>{switch(A){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;
case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var Ie=a(223);class df{static get ztj(){return df.gte||(df.gte=RegExp("([A-Z]+)","g"))}static get ytj(){return df.fte||(df.fte=RegExp("([A-Z])","g"))}static get Bgh(){return df.wge||(df.wge=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Zrd(A){return df.Kgf(A.toString())}static Kgf(A){return df.Bgh.test(A)?
A.replace(df.ztj,"$1 ").replace(df.ytj,' "$1"').trim():A}static HEj(A){const ea=A.lastIndexOf("!");return A.substring(0,-1<ea?ea+1:0)+df.Kgf(A.substring(-1<ea?ea+1:0,A.length))}}df.gte=null;df.fte=null;df.wge=null;Object(x.a)(df,"RangeAriaExtensions",null,[]);class gf{constructor(){this.activeItemName=null;this.uxf=!1;this.tableName=null;this.w5a=0;this.RJc=!1}}Object(x.a)(gf,"SelectionReadoutState",null,[]);class uf{constructor(A,ea,Ma,Vb,tc){this.gridReadoutNotifier=null;this.Ggb=!1;this.axa=this.fvb=
null;this.aha=()=>{hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?k.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):(!Qa.h(this.$).Xc||hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8009961_ReadoutRangePicker")&&Qa.h(this.$).inRangePicker)&&this.h9b.ps()};this.L3i=()=>{if(!Qa.h(this.$).ha.Va.MBd){var Jc,ld=(()=>{let Zd=this.P1h();({activeCell:Jc}=Zd);return Zd})().returnValue;this.readText(ld,Jc)}};this.UD=
()=>{const Jc=this.activeCell;this.readText("Editing",Jc);hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Jc&&Jc.Nmc&&!Qa.h(this.$).emf||this.h9b.cancel()};this.df=()=>{hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?k.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.aha(),this.Ggb&&Qa.h(this.$).inRangePicker&&1===Z.a.ld&&(null===this.fvb?this.fvb=Na.a.instance.create(this.KTd,
uf.s6b,"readSelectedRanges"):this.fvb.ps()))};this.$=ea;this.ariaLiveNotifier=A;this.vVb=Vb;this.tableManager=Ma;this.jG=new gf;this.XAa=Y.XAa();this.Ggb=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.XAa&&(hb.EwaSettings.rd()?this.gridReadoutNotifier=tc:this.gridReadoutNotifier=ea.ea.Ba(244),k.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?
uf.s6b=0:uf.s6b=700);this.h9b=Na.a.instance.create(this.L3i,uf.s6b,nb.a.fNj,!1);this.al()}get activeCell(){return Qa.h(this.$).yd(null)}dispose(){this.$&&this.zk();fa.a.Ma(this.h9b);this.vVb=this.$=this.h9b=null}Nod(A,ea,Ma){Ma=void 0===Ma?!0:Ma;if(null!==this.$.hd.uj&&"FindAndReplaceDialog"===this.$.hd.uj.pe||!A)return"";var Vb=this.$.ea;const tc=new Sys.StringBuilder;this.s4g(tc,A,ea);if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Jc=this.tableManager.Ena(A.range);
(null===Jc||void 0===Jc?0:Jc.Y3d)&&this.tFe(tc,Jc);Jc=this.tableManager.Vt(A.range);(null===Jc||void 0===Jc?0:Jc.$na)&&this.tFe(tc,Jc)}Jc=A.B8?this.cef(A):A.text;Ec(tc,Jc);Jc=this.$.activeItemName;this.jG.activeItemName!==Jc&&(Ec(tc,Jc),this.jG.activeItemName=Jc);Jc=1===ea.length?Zb.L(ea).isSingle?"":qb.a.instance.ia(853):String.format(qb.a.instance.gd(31),ea.length);Ec(tc,Jc);for(var ld of ea)Jc=this.XAa?ld.toString():df.Zrd(ld),Ec(tc,Jc),1===ea.length&&uf.pMi(ld)&&(Jc=Qa.h(this.$).za.Tt(ld.bottomRight),
void 0!==Jc&&null!==Jc&&Jc.text&&(Jc=Jc.B8?this.bef(Jc,Jc.text):Jc.text,Ec(tc,Jc)));ld=A.cell;ld=this.Edi(ld.sJj,ld.Djh);Ec(tc,ld);this.c4g(tc,A);Ma&&(A.obb?Ec(tc,qb.a.instance.ia(841)):A.hBa&&Ec(tc,qb.a.instance.ia(842)));if(A.hasAutoFilter||A.l2)this.t4g(tc,A.hasAutoFilter?A.cell.autoFilterType:A.cell.Olj),Ma&&Ec(tc,qb.a.instance.ia(844));Ie.c(this.$,A.range)&&Ec(tc,qb.a.instance.ia(848));this.$3g(tc,A);Ma=(Ma=Vb.Ba(14))?Ma.P2h():"";Ec(tc,Ma);A.Qy&&(Ma=Qa.h(this.$).za.Tt(A.range),Ma=!!Ma&&Ma.hasIgnorableError,
uf.$Wj(A)?uf.a4g(tc,A):hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Ma?Ec(tc,qb.a.instance.ia(846)):Ec(tc,qb.a.instance.ia(845)));A.eN&&(Ec(tc,qb.a.instance.ia(847)),A.LEb&&Ec(tc,String.format(qb.a.instance.gd(16),A.Swh)),Ec(tc,A.iconName));A.hasRichValueIcon&&(ld=this.$.ea.Ba(271),Ma="",ld&&A.cell.GBf&&(ld=ld.wX(A.cell.GBf))&&ld.DomainId.Id!==uf.Yok&&(Ma=ld.Name),A.cell.NBi?(Ec(tc,String.format(qb.a.instance.gd(187),Ma)),Ec(tc,qb.a.instance.ia(1812))):(Ec(tc,
String.format(qb.a.instance.gd(185),Ma)),Ec(tc,qb.a.instance.ia(1811))));this.Tqi(A)&&Ec(tc,uf.H9h(A));(Vb=Vb.Ba(231))&&Ec(tc,Vb.sef(ea,!0));1===ea.length&&ea[0].isSingle&&uf.ZWj(A,ea[0],this.$)&&(ea=this.$.ea.Ba(271))&&Ec(tc,ea.b3h());A.IWb&&A.JWb&&Ec(tc,A.JWb);(ea=A.cell.J$c)&&Ec(tc,ea);this.Z3g(tc,A);A.HRa&&A.YOb&&(A=A.pQd)&&(Ec(tc,qb.a.instance.ia(1985)),Ec(tc,A));return tc.toString()}zKe(A){this.axa=this.jG;this.jG=Object(fb.a)(new gf,{activeItemName:this.axa.activeItemName,RJc:A?this.axa.RJc:
!1,tableName:A?this.axa.tableName:"",w5a:A?this.axa.w5a:-1})}Y$f(){this.axa&&(this.jG=this.axa,this.axa=null)}Edi(A,ea){return 2===A||2===ea?qb.a.instance.ia(875):1===A||1===ea?qb.a.instance.ia(876):""}cef(A){return this.bef(A.cell,A.text)}s4g(A,ea,Ma){if(Ma&&1===Ma.length&&Ma[0].isSingle){Ma="";var Vb=this.tableManager.Ena(ea.range);if(Vb){Ma=Vb.pivotTableName;this.Q6c(A,Ma);var tc=Vb.Lpc?qb.a.instance.ia(835):"";hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&
(tc+=(Vb.altText?Vb.altText+" . ":"")+(Vb.altTextSummary?Vb.altTextSummary:""));this.vFe(A,!0,Ma,tc);Ec(A,this.tableManager.cKi(Vb,ea.range)?qb.a.instance.ia(838):"");Ec(A,this.tableManager.jDi(Vb,ea.range)?qb.a.instance.ia(837):"")}else if(Vb=this.tableManager.Vt(ea.range)){Ma=(tc=Qa.h(this.$).ed.Dh(ea.range))?tc.name:"";this.Q6c(A,Ma);let Jc="";tc&&(Jc=(tc.pYa?tc.pYa+" . ":"")+(tc.qYa?tc.qYa:""));this.vFe(A,!1,Ma,Jc);Ec(A,this.tableManager.zuf(Vb,ea.range)?qb.a.instance.ia(837):"")}else this.Q6c(A,
Ma),this.jG.tableName="",this.jG.w5a=-1}}Q6c(A,ea){ea!==this.jG.tableName&&this.jG.tableName&&(A.append(qb.a.instance.ia(this.jG.RJc?834:833)),Ec(A," "+this.jG.tableName))}vFe(A,ea,Ma,Vb){Ma!==this.jG.tableName&&(A.append(qb.a.instance.ia(ea?832:831)),Ec(A," "+Ma),Ec(A,Vb),this.jG.tableName=Ma,this.jG.RJc=ea,this.jG.w5a=-1)}tFe(A,ea){const Ma=Qa.h(this.$).ha.ra.activeCell;if(Ma.top!==ea.top&&Ma.left!==this.jG.w5a){A.append(qb.a.instance.ia(837));ea=new wa.Range(ea.top,Ma.left,ea.top,Ma.left,!0,!0);
Ec(A,df.Zrd(ea));if(ea=Qa.h(this.$).yd(ea))ea=ea.B8?this.cef(ea):ea.text,Ec(A,ea);this.jG.w5a=Ma.left}}bef(A,ea){const Ma=A.z$a;return A.fAa?String.format(qb.a.instance.gd(14),ea,Ma):String.format(qb.a.instance.gd(13),ea,df.HEj(Ma))}al(){k.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var A=Qa.h(this.$);k.ULS.shipAssertTag(537153929,0,!!A,"Can't register to grid's events");A&&(A.Vd.yp(this.UD),A.za.su(this.aha),A.XG(this.aha),this.Ggb&&A.Vd.yq(this.kj.bind(this)),
A=A.ha,k.ULS.shipAssertTag(537153928,0,!!A,"Can't register to selectionManager's events"),A&&(A.cr(this.df),A.add_activeCellChanged(this.aha),A.Va.wW(this.aha),this.Ggb&&(this.KTd=this.KTd.bind(this))))}}zk(){if(this.$){var A=Qa.h(this.$);A&&(A.Vd.lp(this.UD),A.za.eu(this.aha),A.zI(this.aha),this.Ggb&&A.Vd.Pp(this.kj),A=A.ha)&&(A.vr(this.aha),A.remove_activeCellChanged(this.aha),A.Va.caa(this.aha))}}readText(A,ea){this.XAa&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(A):
(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(A),this.Ggb&&!ea||this.ariaLiveNotifier.Vgk(ea))}kj(){this.fvb&&this.fvb.cancel()}KTd(){this.readText(this.ehi())}ehi(){let A="";Qa.h(this.$).ha.rangePicker.HN.forEach(()=>{A+=void 0});return A+=" selected"}P1h(){let A;A=null;var ea=Qa.h(this.$).ha;if(1!==ea.ng&&!ea.Va.Yd)return k.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ea.ng} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",
activeCell:A};switch(ea.ng){case 2:return{returnValue:this.O4h(ea),activeCell:A};case 64:var Ma=ea.Va.Yd.floatingObject;let Vb="";if(ea=ea.Va.Yd.ev||ea.Va.Yd.Cf)Vb=(ea=ea.firstChild)?ia.DOMElementExtensions.getTextContent(ea):"";return{returnValue:String.format(qb.a.instance.gd(53),uf.fjc(Ma.altText,Ma.altTextDescription,Ma.name),Vb,Ma.altTextDescription),activeCell:A};case 4:return{returnValue:uf.i3g(ea.Va.Yd.floatingObject),activeCell:A};case 512:return{returnValue:ve.a.Hcf(ea.Va.Yd.floatingObject.aid),
activeCell:A};case 8:return Ma=ea.Va.Yd.floatingObject,{returnValue:String.format(qb.a.instance.gd(51),Ma?Ma.name:""),activeCell:A};case 1:return A=this.activeCell,Ma=ea.ra.selectedRanges,hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8009961_ReadoutRangePicker")&&Qa.h(this.$).inRangePicker?this.tfi(ea,A):{returnValue:this.Nod(A,Ma),activeCell:A}}return{returnValue:"",activeCell:A}}tfi(A,ea){A=A.rangePicker.HN.map(Vb=>Vb.range);const Ma=Qa.h(this.$).yd(A[0]);return{returnValue:this.Nod(Ma,A),activeCell:ea}}O4h(A){const ea=
new Sys.StringBuilder;ea.append(uf.Ufh(A));const Ma=this.$.ea.Ba(231);Ma&&Ec(ea,Ma.sef(A.Va.Yd.floatingObject,!1));return ea.toString()}Tqi(A){A=A.ssf();let ea=!1;this.jG.uxf!==A&&(this.jG.uxf=A,ea=!0);return ea}c4g(A,ea){if(ea.h$a)if(ea=this.vVb.gii(ea)){var Ma=qb.a.instance,Vb=Ma.ia;a:switch(ea.type){case 0:var tc=828;break a;case 1:tc=829;break a;default:tc=830}Ma=Vb.call(Ma,tc);Ec(A,String.format(qb.a.instance.gd(25),Ma));ea=String.format(qb.a.instance.gd(24),df.Zrd(ea.r4j));Ec(A,ea)}else k.ULS.sendTraceTag(537153925,
0,15,"No sparkline range was found on a cell with sparkline."),Ec(A,String.format(qb.a.instance.gd(25),""))}t4g(A,ea){switch(ea){case 1:case 11:Ec(A,qb.a.instance.ia(849));break;case 6:Ec(A,qb.a.instance.ia(849));Ec(A,qb.a.instance.ia(851));break;case 7:Ec(A,qb.a.instance.ia(849));Ec(A,qb.a.instance.ia(852));break;case 2:Ec(A,qb.a.instance.ia(850));Ec(A,qb.a.instance.ia(851));break;case 3:Ec(A,qb.a.instance.ia(850));Ec(A,qb.a.instance.ia(852));break;default:Ec(A,qb.a.instance.ia(850))}}$3g(A,ea){var Ma;
const Vb=this.$.ea.Ba(65);ea=Vb?Vb.dPa(ea.range):null;let tc="";const Jc=Object(y.a)(530,ea);if(ea)tc=!ea.Vab&&Jc&&Jc.OLi?String.format(qb.a.instance.gd(29),Jc.W8j):String.format(qb.a.instance.gd(23),ea.author);else if(null===(Ma=null===Vb||void 0===Vb?void 0:Vb.hp)||void 0===Ma?0:Ma.MH)tc=String.format(qb.a.instance.gd(28),Vb.hp.sQ.author);Ec(A,tc)}Z3g(A,ea){const Ma=this.$.ea.Ba(286);Ma&&(ea=Ma.R2h(wd.d(this.$.na),ea.range))&&0<ea.length&&(ea=String.format(qb.a.instance.gd(1===ea.length?220:221),
ea[0]),Ec(A,ea))}static i3g(A){return String.format(qb.a.instance.gd(52),uf.fjc(A.altText,A.altTextDescription,A.name),A.altTextDescription)}static H9h(A){return qb.a.instance.ia(A.ssf()?839:840)}static fjc(A,ea,Ma){return A||ea?A:Ma}static Ufh(A){var ea=A.Va.Yd;A=ea.floatingObject;const Ma=A.Oe,Vb=Ma.ChartTitle,tc=A.altText,Jc=A.altTextDescription,ld=!!(Ma.Attributes&4);return(ea=ea.getSelectionDescription())?ea:Ma.DataRangeForDisplay?String.format(qb.a.instance.gd(ld?49:47),uf.fjc(tc,Jc,A.name),
Jc,Vb,qb.a.instance.ia(Td(Ma.ChartCategory)),Ma.DataRangeForDisplay):String.format(qb.a.instance.gd(ld?50:48),uf.fjc(tc,Jc,A.name),Jc,Vb,qb.a.instance.ia(Td(Ma.ChartCategory)))}static $Wj(A){return hb.EwaSettings.Da(101)&&(A.fHb||A.Jpc)}static a4g(A,ea){ea.psa?ea.fHb?Ec(A,String.format(qb.a.instance.gd(26),ea.psa.topLeft.toString())):ea.Jpc&&(ea=ea.psa.CR(),Ec(A,String.format(qb.a.instance.gd(27),(ea.LastColumn-ea.FirstColumn+1).toString(),(ea.LastRow-ea.FirstRow+1).toString()))):k.ULS.shipAssertTag(537153924,
0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static ZWj(A,ea,Ma){return A.Qy||!hb.EwaSettings.Da(131)?!1:(A=Ma.ea.Ba(271))?A.npc(ea):!1}static pMi(A){return A.top===A.bottom&&A.left+1===A.right||A.top+1===A.bottom&&A.left===A.right}}uf.Yok=268435712;uf.s6b=500;Object(x.a)(uf,"SelectionReadoutHandler",null,[531,5]);class fg extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){const A=this.$.ea,
ea=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?Object(Zc.d)(Ib.a.resolve(Yc.f,{Qa:this.Na})):Ac.GetServiceTaskFactory.Vc(A,211,212,this.Na),Ma=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(Zc.d)(Ib.a.resolve(Yc.Gc,{Qa:this.Na})):Ac.GetServiceTaskFactory.Vc(A,66,134,this.Na),Vb=Object(Zc.d)(Ib.a.resolve(Yc.Ec,{Qa:this.Na}));let tc=yc.Task.Wa(null);hb.EwaSettings.rd()&&(tc=Ac.GetServiceTaskFactory.Vc(A,244,
315,this.Na));Ed.TaskExtensions.ya(Ed.TaskExtensions.Bf([ea,Ma,Vb,tc],this.ka),()=>{const Jc=Object(Vd.a)(this.$.ea,226,()=>new uf(ea.result,this.$,Ma.result,Vb.result,tc.result));this.qd(Jc)},this.$.ka,3)}static la(A){A.ea.Ja(227,new fg(A))}}Object(x.a)(fg,"SelectionReadoutHandlerFactory",Pb.a,[]);class Ag{constructor(A,ea){this.$=ea;this.ariaLiveNotifier=A}o3f(){const A=this.S2h();this.ariaLiveNotifier.kVa(A,Gb.a.fLa)}S2h(){const A=new Sys.StringBuilder;this.$.workbookContext&&Ec(A,this.$.workbookContext.WorkbookFileName);
Ec(A,qb.a.instance.ia(855));Ec(A,this.U2h());Ec(A,this.T2h());Ec(A,qb.a.instance.ia(856));return A.toString()}U2h(){return this.$.isEditMode?qb.a.instance.ia(860):qb.a.instance.ia(861)}T2h(){var A=this.kok();const ea=this.$.va.na;A=1!==A?String.format(qb.a.instance.gd(32),A):qb.a.instance.ia(854);A=new Sys.StringBuilder(A);ea&&ea.sheetName&&(A.append(oc.xHd),A.append(String.format(qb.a.instance.gd(33),ea.sheetName)));return A.toString()}kok(){let A=0;for(const ea of this.$.va.items)ea.visible&&A++;
return A}}Object(x.a)(Ag,"WorkbookReadout",null,[]);let og=class{constructor(A,ea,Ma){this.IQf=()=>{this.Bce.o3f();this.ariaLiveNotifier.setEnabled(!0)};this.$=ea;this.ariaLiveNotifier=A;this.Bce=new Ag(A,ea);this.yic=Ma.Drd(this.$);this.yic.y_g(this.IQf)}dispose(){this.yic&&this.yic.nCj(this.IQf);this.yic=this.ariaLiveNotifier=this.$=null}};og=Object(ra.a)([Object(Ib.d)(Yc.Q),Object(ra.b)(0,Object(Yc.f)()),Object(ra.b)(1,Object(Yc.R)()),Object(ra.b)(2,Object(Yc.tc)())],og);Object(x.a)(og,"EmbeddedWorkbookReadoutHandler",
null,[5]);let Eg=class{constructor(A,ea){this.bZ=()=>{this.Ef||this.SEe()};this.Ef=!1;this.k1=ea.hX;this.ariaLiveNotifier=A;this.Bce=new Ag(A,ea);this.k1&&this.k1.PT?this.SEe():this.al()}dispose(){this.zk();this.ariaLiveNotifier=this.k1=null;this.Ef=!0}al(){if(this.k1){this.k1.tu(this.bZ);this.k1.za.su(this.bZ);this.k1.XG(this.bZ);var A=Object(y.a)(255,this.k1);A&&(A.Vd.yp(this.bZ),A.ha.cr(this.bZ),A.ha.add_activeCellChanged(this.bZ),A.ha.Va.wW(this.bZ))}else k.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}zk(){if(this.k1){this.k1.za.eu(this.bZ);
this.k1.zI(this.bZ);const A=Object(y.a)(255,this.k1);A&&(A.Vd.lp(this.bZ),A.ha.vr(this.bZ),A.ha.remove_activeCellChanged(this.bZ),A.ha.Va.caa(this.bZ))}}SEe(){this.Bce.o3f();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.QQj();this.dispose()}};Eg=Object(ra.a)([Object(Ib.d)(Yc.Oc),Object(ra.b)(0,Object(Yc.f)()),Object(ra.b)(1,Object(Yc.R)())],Eg);Object(x.a)(Eg,"WorkbookReadoutHandler",null,[5]);class eh extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){const A=this.$.ea,
ea=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?Object(Zc.d)(Ib.a.resolve(Yc.f,{Qa:this.Na})):Ac.GetServiceTaskFactory.Vc(A,211,212,this.Na);if(this.$.eI){const Ma=Object(Zc.d)(Ib.a.resolve(Yc.tc,{Qa:this.Na}));Ed.TaskExtensions.ya(Ed.TaskExtensions.Bf([ea,Ma],this.$.ka),()=>{const Vb=Object(Vd.a)(this.$.ea,228,()=>new og(ea.result,this.$,Ma.result));this.qd(Vb)},this.$.ka,3)}else Ed.TaskExtensions.ya(ea,Ma=>{const Vb=Object(Vd.a)(this.$.ea,228,()=>new Eg(Ma.result,
this.$));this.qd(Vb)},this.$.ka,3)}static la(A){A.ea.Ja(229,new eh(A))}}Object(x.a)(eh,"WorkbookReadoutHandlerFactory",Pb.a,[]);String(d);String(f);window.___1688279143750_closurehack=d;window.___1688279143750_closurehack=f;let rg=class extends Sb.a{constructor(A){super();hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)||A.ea.Ja(376,this)}m1g(A){this.addHandler("TAF",A)}KDj(A){this.removeHandler("TAF",A)}usj(){this.raiseEvent("TAF")}};rg=
Object(ra.a)([Object(Ib.d)(Yc.ob),Object(ra.b)(0,Object(Yc.R)())],rg);Object(x.a)(rg,"GridHighlightBehaviorEventManager",Sb.a,[487,5]);class ah extends Pb.a{constructor(A){super();this.$=A;this.Md()}create(){this.qd(this.$.ea.Ba(376)||new rg(this.$))}static la(A){A.ea.Ja(377,new ah(A))}}Object(x.a)(ah,"GridHighlightBehaviorEventManagerFactory",Pb.a,[]);var gh=a(87),Bg=a(250),wh=a(175),ti=a(129);class tg extends Sys.EventArgs{constructor(A,ea){super();this.start=A;this.M$a=ea}}Object(x.a)(tg,"MarqueeResizeStartedOrEndedEventArgs",
Sys.EventArgs,[]);class Yh extends Sb.a{constructor(A){super();this.$uc=[3];this.Aua=void 0;this.gridView=A;this.Btg=le.a.PF();this.$P=le.a.PF()}get coloredReferencesManager(){const A=this.gridView.$.ea.Ba(281);A||k.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return A}get AD(){if(this.Aua)return this.Aua;
const A=this.gridView.$.ea.Ba(464);A||k.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");A.AD||k.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Aua=A.AD}M_g(A){this.addHandler("mrek",A)}VQ(A,ea,Ma){for(const Vb of this.gridView.Mp)Bg.a.instance.ta(wb.a.vn,
Vb.domElement,A);Bg.a.instance.ta(wb.a.ri,document.documentElement,ea);this.gridView.cellTextEditBox.Tfc(!0);Ma&&Bg.a.instance.ta(wb.a.aE,this.gridView.fn,ea)}g$d(A,ea,Ma){for(const Vb of this.gridView.Mp)Bg.a.instance.Aa(wb.a.vn,Vb.domElement,A);Bg.a.instance.Aa(wb.a.ri,document.documentElement,ea);this.gridView.cellTextEditBox.Tfc(!1);Ma&&Bg.a.instance.Aa(wb.a.aE,this.gridView.fn,ea)}wxj(A,ea){for(const Ma of this.gridView.Mp)wh.a.instance.ta(wb.a.xi,Ma.domElement,A);wh.a.instance.ta(wb.a.hg,document.documentElement,
ea)}Sfk(A,ea){for(const Ma of this.gridView.Mp)wh.a.instance.Aa(wb.a.xi,Ma.domElement,A);wh.a.instance.Aa(wb.a.hg,document.documentElement,ea)}Rdd(A,ea,Ma,Vb){const tc=document.createElement("div");tc.className=ea;for(const Jc of Ma)tc.classList.add(Jc);A.appendChild(tc);Bg.a.instance.ta(wb.a.pointerDown,tc,Vb);return tc}Ghf(A){A=A.Nd.parentNode;if(!A)return k.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;A=parseInt(A.getAttribute(Gb.a.M$a),
10);return isNaN(A)?(k.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.zd.DF(3,1,A)}RTb(A,ea,Ma){A=(void 0===Ma?!0:Ma)&&(this.$P?!!this.AD&&this.AD.sHi(A):!!this.coloredReferencesManager&&this.coloredReferencesManager.rHi(A));for(const Vb of ea)ia.DOMElementExtensions.setVisible(Vb,A)}hjc(){return this.gridView.pr?ti.a(this.gridView.$):this.gridView.Vd}L3f(){if(this.$P){var A=this.hjc();
A&&this.AD?this.Btg?A.uG(null):this.AD.ilb(A,null):(k.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.zd.Sl(this.$uc),this.gridView.zd.sm(null,this.$uc))}else this.hvj()}hvj(){const A=this.hjc();A&&this.coloredReferencesManager?this.Btg?A.uG(null):this.coloredReferencesManager.uG(A,null):(k.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),
this.gridView.zd.Sl(this.$uc),this.gridView.zd.sm(null,this.$uc))}R1f(A,ea){this.raiseEvent("mrek",new tg(A,ea))}}Object(x.a)(Yh,"BehaviorHelperMethods",Sb.a,[]);var Vi=a(42),ki=a(103);class zh extends ki.a{constructor(A,ea){super(A,void 0===ea?null:ea)}m3a(){}}Object(x.a)(zh,"HighlightFlyweightBehavior",ki.a,[]);var zi=a(18),Sg=a(434),Ni=a(128),ui=a(235),Wi=a(249),xh=a(75);class Th extends Wi.a{constructor(A,ea,Ma){super(document.createElement("div"));this.vdc=null;this.sYb=!1;this.onPointerDown=
Vb=>{Vb=P.a(this.$)?P.a(this.$).jg(Vb):Vb;this.sYb=!1;if(3===(Z.a.ld=Vb.ud)){const tc=Vb.Ca.rawEvent,Jc=tc.srcElement||tc.target;ia.DOMElementExtensions.Eh(this.domElement,Jc)&&ia.DOMElementExtensions.Eh(tc.currentTarget,Jc)&&(this.sYb=!0,this.vdc=Vb.clientPoint)}return!1};this.Li=Vb=>{Vb=P.a(this.$)?P.a(this.$).jg(Vb):Vb;this.raiseEvent("GrPointerUp",Vb);return this.sYb=!1};this.Zk=Vb=>{Vb=P.a(this.$)?P.a(this.$).jg(Vb):Vb;3===Vb.ud&&this.sYb&&this.eri(Vb.clientPoint)&&(this.raiseEvent("GrDrag"),
this.sYb=!1);return!1};this.We=Vb=>{P.a(this.$)&&P.a(this.$).jg(Vb);return!0};this.$=Ma;Ma=!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(Ma?xh.a.a5e:xh.a.$4e);this.domElement.classList.add(xh.a.Ygc);A.appendChild(this.domElement);ia.DOMElementExtensions.setVisible(this.domElement,!1);this.fQa=document.createElement("div");this.fQa.classList.add(xh.a.Xgc);this.fQa.style.borderColor=ea;this.domElement.appendChild(this.fQa);Bg.a.instance.ta(wb.a.pointerDown,
this.domElement,this.onPointerDown);Bg.a.instance.ta(wb.a.ri,this.domElement,this.Li);wh.a.instance.ta(wb.a.hg,this.domElement,this.Li);Bg.a.instance.ta(wb.a.vn,this.domElement,this.Zk);wh.a.instance.ta(wb.a.xi,this.domElement,this.Zk);ui.a.instance.ta(wb.a.click,this.domElement,this.We)}pCe(A){this.addHandler("GrDrag",A)}B7f(A){this.removeHandler("GrDrag",A)}oCe(A){this.addHandler("GrContxt",A)}A7f(A){this.removeHandler("GrContxt",A)}qCe(A){this.addHandler("GrPointerUp",A)}C7f(A){this.removeHandler("GrPointerUp",
A)}dispose(){Tg.a.Xqa(this.domElement);super.dispose()}Veg(){this.domElement.classList.remove(xh.a.Ygc);this.fQa.classList.remove(xh.a.Xgc);this.fQa.classList.add(xh.a.b5e)}Lug(){this.fQa.classList.remove(xh.a.b5e);this.fQa.classList.add(xh.a.Xgc);this.domElement.classList.add(xh.a.Ygc)}eri(A){return!!this.vdc&&(3<Math.abs(A.x-this.vdc.x)||3<Math.abs(A.y-this.vdc.y))}static CCb(A){return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(A=P.a(A.$)?P.a(A.$).zoom:Bc.a.n3,Math.round(9/
Math.max(A,1))):9}}Th.BId=0;Object(x.a)(Th,"TouchGrippie",Wi.a,[]);class Ch extends zh{constructor(A,ea,Ma,Vb){super(ea);this.MDd=this.Sub=!1;this.s$b=null;this.ufa=this.IDd=!1;this.jz=()=>{this.Sub&&this.IDd?this.dsa():this.E8()};this.TPf=Jc=>{3===Jc.ud&&(this.IDd=!0,this.dsa());return!1};this.UPf=Jc=>{if(3===Jc.ud){if(!Jc.Nd||this.LEi(Jc))return!1;this.IDd=!1;this.E8()}return!1};this.dh=()=>{this.ufa&&this.k$d();this.dsa();this.MDd=!1};this.Ou=()=>{this.E8();this.MDd=!0};this.dDa=(Jc,ld)=>{ld.I8===
this.I8&&(ld.visible?this.MDd||this.dsa():this.E8())};this.FVf=()=>{this.VPf(this.jV.domElement,!1)};this.aMf=()=>{this.VPf(this.BS.domElement,!0)};this.zxc=(Jc,ld)=>{this.ha.Oqa(ld)};this.Axc=(Jc,ld)=>{this.ha.Oqa(Sg.b(ld))};this.vNb=()=>{3===Z.a.ld?this.dsa():this.E8();this.ufa&&1===Z.a.ld&&this.k$d()};this.GVf=()=>{this.APj()};this.VZe=()=>{this.E8()};this.Lp=()=>{this.ha.Va.Yd&&this.E8()};this.NLf=()=>{this.E8()};this.NPf=(Jc,ld)=>{this.k$d();3===ld.ud?this.dsa():this.E8()};this.qBc=()=>{this.Sub&&
(this.E8(),this.dsa())};const tc=Ma.$;this.pv=Ma;this.ha=Ma.ha;this.afa=A;this.WMj=ea;this.paneType=Vb;A=this.domElement.currentStyle;ea="#000000";A&&(ea=A.borderTopColor);this.jV=new Th(this.K7e(),ea,tc);this.BS=new Th(this.K7e(),ea,tc);this.jV.pCe(this.FVf);this.jV.oCe(this.zxc);this.jV.qCe(this.Axc);this.BS.pCe(this.aMf);this.BS.oCe(this.zxc);this.BS.qCe(this.Axc);for(const Jc of this.gridView.Mp)wh.a.instance.ta(wb.a.lh,Jc.domElement,this.UPf),wh.a.instance.ta(wb.a.hg,Jc.domElement,this.TPf);
Ma.view.uu(this.jz);Ma.Vd.yp(this.VZe);Ma.zd.cub(this.dDa);Ma.Y4c(this.NLf);tc.tB(this.qBc);Ma.tu(this.qBc);this.ha.Gka(this.dh);this.ha.Hka(this.Ou);Ma.XG(this.Lp);this.ha.p7b(this.NPf);Z.a.xCe(this.vNb);Ed.TaskExtensions.ya(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)?Object(Zc.d)(Ib.a.resolve(Yc.ob,{Qa:0})):Ac.GetServiceTaskFactory.Vc(tc.ea,376,377,0),Jc=>{Jc.result.m1g(this.GVf)},tc.ka,3)}get gridView(){return this.pv}dispose(){fa.a.te([this.jV,
this.BS]);this.jV.B7f(this.FVf);this.jV.A7f(this.zxc);this.jV.C7f(this.Axc);this.BS.B7f(this.aMf);this.BS.A7f(this.zxc);this.BS.C7f(this.Axc);for(var A of this.gridView.Mp)wh.a.instance.Aa(wb.a.lh,A.domElement,this.UPf),wh.a.instance.Aa(wb.a.hg,A.domElement,this.TPf);this.gridView.view.pt(this.jz);this.gridView.Vd.lp(this.VZe);this.gridView.zd.gRb(this.dDa);this.gridView.KVd(this.NLf);this.gridView.$.iE(this.qBc);this.gridView.hx(this.qBc);this.ha.eaa(this.dh);this.ha.pha(this.Ou);this.gridView.zI(this.Lp);
this.ha.JCc(this.NPf);Z.a.I7f(this.vNb);this.ufa&&k.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(A=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)?Ib.a.Ph(Yc.ob):this.gridView.$.ea.Ba(376))&&A.KDj(this.GVf);super.dispose()}wXa(){if(!this.afa.range||!this.afa.range.equals(this.wib))return!1;const A=!this.gridView.IRa();return this.gridView.Xc&&A&&(this.wib.isRow||this.wib.Ci)?!1:this.ufa?
!0:3===Z.a.ld}E8(){this.Sub&&(this.jV.set_visible(!1),this.BS.set_visible(!1),this.Sub=!1)}dsa(){if(this.wXa()){var A=ia.DOMElementExtensions.getBoundingClientRect(this.s$b);A||k.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.gridView.fn,this.gridView.Tc.kk);var ea=ia.DOMElementExtensions.getBoundingClientRect(this.WMj),Ma=new Sys.UI.Bounds(ea.x-A.x,ea.y-A.y,ea.width,ea.height),Vb=this.wib,tc=Vb.topLeft,Jc=Vb.bottomRight,ld=Vb.isRow||
Vb.Ci;if(Vb.Ci){var Zd=this.hWh();Vb=Ma.x-2*Th.CCb(this.gridView);var De=Zd;var Ve=Ma.x+ea.width}else Vb.isRow?(Vb=Ve=this.gWh(),De=Ma.y-2*Th.CCb(this.gridView),Zd=Ma.y+ea.height):(De=Ma.y,Zd=Ma.y+ea.height,this.gridView.rtl?(Vb=Ma.x+ea.width,Ve=Ma.x):(Vb=Ma.x,Ve=Ma.x+ea.width));ea=Th.BId+(ld?0:Th.CCb(this.gridView));this.jV.style.left=Xb.HelperMethods.De(Vb-ea);this.jV.style.top=Xb.HelperMethods.De(De-ea);this.BS.style.left=Xb.HelperMethods.De(Ve-ea);this.BS.style.top=Xb.HelperMethods.De(Zd-ea);
this.jV.set_visible(this.yuf(De,Vb,tc,ld,A));this.BS.set_visible(this.yuf(Zd,Ve,Jc,ld,A));this.Sub=!0}}yuf(A,ea,Ma,Vb,tc){const Jc=ia.DOMElementExtensions.getBoundingClientRect(this.gridView.Ih(this.paneType).domElement);tc=new Sys.UI.Bounds(Jc.x-tc.x-3,Jc.y-tc.y-3,Jc.width+6,Jc.height+6);return(this.gridView.Tc.Rj(Ma)===this.paneType||Vb)&&Vi.a.UT(tc,new Sys.UI.Point(ea,A))}hWh(){return(this.gridView.view.visibleArea.height+this.gridView.Tc.height+Th.BId-Th.CCb(this.gridView))/2}gWh(){return(this.gridView.view.visibleArea.width+
this.gridView.Tc.width+Th.BId-Th.CCb(this.gridView))/2}STf(){this.dsa()}LEi(A){return ia.DOMElementExtensions.sra(A.Nd,zi.a.Hy)&&(this.YFi(A)||this.ZFi(A))}ZFi(A){if(this.gridView.rtl)A=A.clientPoint.x;else{const ea=ia.DOMElementExtensions.getBoundingClientRect(A.Nd);A=A.clientPoint.x-(ea.x+ea.width-Ni.a.$x)}return 0<A&&A<=Ni.a.$x}YFi(A){const ea=ia.DOMElementExtensions.getBoundingClientRect(A.Nd);A=A.clientPoint.y-(ea.y+ea.height-Ni.a.$x);return 0<A&&A<=Ni.a.$x}VPf(A,ea){this.ufa&&k.ULS.sendTraceTag(537159312,
0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.n$c(A,ea,this.ufa);this.E8()}APj(){this.ufa||(k.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.ufa=!0,this.jV.Veg(),this.BS.Veg(),this.gridView.ha.sourceRange=this.gridView.ha.ra.Ye,this.dsa())}k$d(){this.ufa&&(k.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.ufa=!1,this.jV.Lug(),this.BS.Lug())}K7e(){this.s$b||(this.s$b=this.gridView.fn);
return this.s$b}}Object(x.a)(Ch,"SelectionTouchGrippiesBehaviorBase",zh,[]);class $h extends Ch{constructor(A,ea,Ma,Vb){super(A,ea,Ma,Vb)}get I8(){return 19}get wib(){return this.gridView.ha.ra.activeRange}wXa(){const A=this.gridView.Jk||this.gridView.Xc;return!this.gridView.ha.ra.yj&&!A&&super.wXa()}}Object(x.a)($h,"DiscontinuousSelectionTouchGrippiesBehavior",Ch,[]);class Ai extends zh{constructor(A){super(A);const ea=document.createElement("div");ea.className=xh.a.mRh;A.appendChild(ea)}}Object(x.a)(Ai,
"SelectionBorderBehavior",zh,[]);class Xf{}Xf.Nkd="ewr-selection-draghandle";Xf.Okd="ewr-selection-draghandle-grab";Xf.fRh="ewr-selection-draghandle-top-ie";Xf.gRh="ewr-selection-draghandle-top-ie-enhanced";Xf.dRh="ewr-selection-draghandle-top";Xf.eRh="ewr-selection-draghandle-top-enhanced";Xf.UQh="ewr-selection-draghandle-bottom-ie";Xf.VQh="ewr-selection-draghandle-bottom-ie-enhanced";Xf.SQh="ewr-selection-draghandle-bottom";Xf.TQh="ewr-selection-draghandle-bottom-enhanced";Xf.YQh="ewr-selection-draghandle-left-ie";
Xf.ZQh="ewr-selection-draghandle-left-ie-enhanced";Xf.WQh="ewr-selection-draghandle-left";Xf.XQh="ewr-selection-draghandle-left-enhanced";Xf.bRh="ewr-selection-draghandle-right-ie";Xf.cRh="ewr-selection-draghandle-right-ie-enhanced";Xf.$Qh="ewr-selection-draghandle-right";Xf.aRh="ewr-selection-draghandle-right-enhanced";Xf.hRh="ewr-selection-dragtooltip";Xf.iRh="ewr-selection-dragtooltip-updated";Xf.tRh="ewr_selection_rearrangeleft";Xf.uRh="ewr_selection_rearrangeright";Xf.vRh="ewr_selection_rearrangetop";
Xf.sRh="ewr_selection_rearrangebottom";Xf.selecting="selecting";Xf.wRh="ewr-selection-resizemarqueehandle";Xf.zRh="ewr-selection-resizemarqueehandle-topleft";Xf.ARh="ewr-selection-resizemarqueehandle-topright";Xf.xRh="ewr-selection-resizemarqueehandle-bottomleft";Xf.yRh="ewr-selection-resizemarqueehandle-bottomright";Xf.IQh="ewr-marquee-thick";Xf.MQh="ewr-resizemarqueehandle-thick";Object(x.a)(Xf,"CssClassNames",null,[]);var Hg=a(263);class Te extends Ai{constructor(A,ea,Ma,Vb){super(A);this.dYa=
!1;this.oze=this.pze=null;this.Dca=0;this.Zr=hb.EwaSettings.getBooleanFeatureGate(aa.a.ufc,!1);this.hEi=hb.EwaSettings.getBooleanFeatureGate(aa.a.uDh,!1);this.Gbe=this.iwd=this.Z0=0;this.kZ=this.Bd=this.sourceRange=this.Kqa=null;this.Li=tc=>{tc=P.a(this.$).jg(tc);return this.ASf(tc)};this.onPointerDown=tc=>{tc=P.a(this.$).jg(tc);if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")&&!this.Ajb())return!1;if(2===tc.ud&&tc.kq===Sys.UI.MouseButton.leftButton&&!this.dYa){var Jc=
this.tsd(tc);if(!Jc)return k.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Bd=Jc.clone();this.sourceRange=this.Bd.clone();this.Kqa=this.Bd;if(Jc=this.aci(tc))if(this.Yo=5,this.Gbe=Jc.top-this.sourceRange.top,this.iwd=Jc.left-this.sourceRange.left,Qa.h(this.$).Ti.Ar(this.Zr?Te.Szb:Te.qZe),this.cOd(tc),this.dYa=!0,Hg.b(this.$,!0),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix"))return!0}return!1};this.Zk=
tc=>{tc=P.a(this.$).jg(tc);if(this.Zr&&this.dOd(tc))return!0;if(tc=this.ha.ms(tc.clientPoint,tc.Nd,5,void 0,void 0,!0)){tc=this.pwb(tc);if(this.Bd.equals(tc))return!0;this.Bd=tc;if(!this.lV())return k.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.vhc(!0),!1}return!0};this.kf=(tc,Jc)=>{Jc.fQ||(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")?this.Rib(this.$.isEditMode):this.Rib(this.$.isEditMode&&this.Ajb()))};
this.GB=[];this.$=ea;this.ha=Qa.h(this.$).ha;this.paneType=Ma;this.Aq=Vb;ea=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.u_d=this.hEi?ea?[Xf.eRh,Xf.TQh,Xf.XQh,Xf.aRh]:[Xf.gRh,Xf.VQh,Xf.ZQh,Xf.cRh]:ea?[Xf.dRh,Xf.SQh,Xf.WQh,Xf.$Qh]:[Xf.fRh,Xf.UQh,Xf.YQh,Xf.bRh];if(!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix"))for(const tc of this.u_d)ea=this.Aq.Rdd(A,tc,this.Zr?[Xf.Okd]:[Xf.Nkd],this.onPointerDown),this.GB.push(ea);this.$.Pm(this.kf)}get zd(){return Qa.h(this.$).zd}get Yo(){return this.ha.selectionType}set Yo(A){this.ha.selectionType=
A}dispose(){this.GB.forEach(A=>{Bg.a.instance.Aa(wb.a.pointerDown,A,this.onPointerDown)});this.GB.length=0;this.Kqa=this.sourceRange=this.Bd=null;k.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Dca}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Rn(this.kf),1===this.Dca&&(k.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.rM(this.oze,this.pze,!1)));super.dispose()}ASf(A){if(5!==
this.Yo)return!1;(A=this.VTa(A))||this.vhc(!1);Hg.b(this.$,!1);return A}VQ(A,ea){k.ULS.shipAssertTag(537159377,0,!this.Dca,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.Dca}`);this.Dca+=1;this.oze=A;this.pze=ea;this.Aq.VQ(A,ea,this.e9d())}pwb(A){if(!A||!this.Bd)return k.ULS.shipAssertTag(537159376,0,!!A,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),k.ULS.shipAssertTag(537159375,0,!!this.Bd,
"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ea=this.Bd.clone();1!==this.Z0&&(ea.left=Math.max(A.left-this.iwd,1),ea.right=ea.left+this.sourceRange.width-1);2!==this.Z0&&(ea.top=Math.max(A.top-this.Gbe,1),ea.bottom=ea.top+this.sourceRange.height-1);return this.pub(ea)}rM(A,ea,Ma,Vb){Ma=void 0===Ma?!0:Ma;Vb=void 0===Vb?!0:Vb;k.ULS.shipAssertTag(537159374,0,1===this.Dca,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.Dca}`);
--this.Dca;this.Zr||Qa.h(this.$).Ti.Ar(Gb.a.jY);this.Aq.g$d(A,ea,this.e9d());Ma&&this.FNe(Vb);this.Z0=0;this.dYa=!1}pub(A){var ea=Qa.h(this.$);let Ma=A;if(ea.Tc.qY){if(!ea.yd(A.topLeft)){ea=ea.xj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ea.pT,this.Kqa.top!==A.top?1:2);try{ea.Bm=this.Kqa.top<A.top||this.Kqa.left<A.left,ea.Vx(A.topLeft),Ma=ea.$$cu().range}finally{ea&&ea.dispose()}}hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")?(Ma.right=Math.min(Ma.left+
A.width-1,Bc.a.ph),Ma.bottom=Math.min(Ma.top+A.height-1,Bc.a.qh)):(Ma.right=Ma.left+A.width-1,Ma.bottom=Ma.top+A.height-1)}return this.Kqa=Ma}Rib(A){this.GB.forEach(ea=>{ia.DOMElementExtensions.setVisible(ea,A)})}aci(A){const ea=A.Nd;A=A.clientPoint;if(!ea||!A)return k.ULS.shipAssertTag(537159373,0,!!ea,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),k.ULS.shipAssertTag(537159372,0,!!A,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;A.y+=ea===
this.GB[Te.xfc]?2:ea===this.GB[Te.tZe]?-2:0;A.x+=ea===this.GB[Te.uZe]?2:ea===this.GB[Te.wfc]?-2:0;return this.ha.ms(A,ea,5,void 0,void 0,!0)}}Te.qZe="move";Te.ndd="copy";Te.Szb="grabbing";Te.xfc=0;Te.tZe=1;Te.uZe=2;Te.wfc=3;Object(x.a)(Te,"DragSelectionClickBehaviorBase",Ai,[]);class H extends Te{constructor(A,ea,Ma,Vb,tc,Jc){super(A,ea,Ma,tc);this.we=this.CI=null;this.klf=()=>{this.vhc(!0)};if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix"))for(const ld of this.u_d)ea=
this.Aq.Rdd(A,ld,this.Zr?[Xf.Okd]:[Xf.Nkd],this.onPointerDown),this.GB.push(ea);this.Rib(this.$.isEditMode);this.gridView=Qa.h(this.$);this.iI=Vb;this.coloredReferencesManager=this.$.ea.Ba(281);k.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.$P=le.a.PF())A=this.$.ea.Ba(464),k.ULS.shipAssertTag(512312961,0,!!A,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),
this.AD=A.AD;for(const ld of this.GB)Bg.a.instance.ta(wb.a.lZ,ld,this.iI.sof),Bg.a.instance.ta(wb.a.aE,ld,this.iI.tof);this.m3a(Jc)}m3a(A){this.Aq.RTb(A,this.GB);this.iI.b4()}cOd(A){k.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.KQa=!0;this.we.dH(!1);this.Yo=5;this.iI.xZe(A.Nd);this.we.textBox.removeSelection();this.we.z7b(this.klf);this.VQ(this.Zk,this.Li);this.Z0=this.sourceRange.isRow?1:this.sourceRange.Ci?2:0}VTa(){const A=
this.UZ();this.Yo=-1;this.rM(this.Zk,this.Li);return A}FNe(){this.gridView.KQa=!1;this.iI.yZe(this.GB[0]);this.we.textBox.setCaretPositionToEnd();this.we.TCc(this.klf);this.Aq.L3f()}vhc(A){k.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");A&&this.rM(this.Zk,this.Li)}tsd(A){this.we=this.Aq.hjc();this.CI=this.Aq.Ghf(A);return this.we&&this.CI&&this.CI.range?this.CI.range:(k.ULS.shipAssertTag(537159388,
0,!!this.we,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),k.ULS.shipAssertTag(537159387,0,!!this.CI,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),k.ULS.shipAssertTag(537159386,0,!!this.CI.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}UZ(){return this.CI?this.$P?this.AD.NLb(this.we,this.CI,this.Bd):this.coloredReferencesManager.NLb(this.we,this.CI,this.Bd):(k.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}lV(){return this.UZ()}e9d(){return!0}dOd(){return!1}Ajb(){return!0}}Object(x.a)(H,"DragMarqueeClickBehavior",Te,[]);var la=a(93),Ha=a(357),Bb=a(751),jc=a(236),Rc=a(47);class Sc extends Te{constructor(A,ea,Ma,Vb,tc){super(A,ea,Ma,tc);this.ij=null;this.Ci=this.isRow=!1;this.dh=()=>{this.domElement.classList.remove(Xf.selecting)};this.Ou=()=>{this.domElement.classList.add(Xf.selecting)};this.df=()=>{if(this.$.isEditMode){const Jc=this.Ajb();this.Rib(Jc)}};this.tableManager=Vb;if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")){if(0===
Sc.$ec[Ma].length)for(const Jc of this.u_d)ea=document.createElement("div"),ea.className=Jc,ea.classList.add(this.Zr?Xf.Okd:Xf.Nkd),Sc.$ec[Ma].push(ea);for(const Jc of Sc.$ec[Ma])A.appendChild(Jc),Bg.a.instance.ta(wb.a.pointerDown,Jc,this.onPointerDown),this.GB.push(Jc)}hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")?this.Rib(this.$.isEditMode):this.Rib(this.Ajb()&&this.$.isEditMode);this.Up={};this.TB=!1;this.ha.Hka(this.Ou);this.ha.Gka(this.dh);hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")||
this.ha.zW(this.df)}dispose(){this.ha&&(this.ha.pha(this.Ou),this.ha.eaa(this.dh),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")||this.ha.zZ(this.df),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.eDc(this.Qeb));if(this.Up)for(var A=1;4>=A;A++)ia.DOMElementExtensions.xh(this.Up[A.toString()]);if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix"))for(A=1;4>=A;A++)Sc.$ec[A].length=0;this.Up=
this.ij=null;super.dispose()}FNe(A){A&&(this.Zr&&Qa.h(this.$).Ti.Ar(Gb.a.jY),cf.KeyInputManager.instance.Aa(wb.a.Rd,this.domElement.ownerDocument.body,this.onKeyDown),this.TB=!1);for(A=1;4>=A;A++){const ea=this.Up[A.toString()];ea&&ea.parentNode.removeChild(ea);this.Up[A.toString()]=null}this.ij=null}tsd(){return this.ha.ra.Ye}UZ(){this.ha.updateSelection(this.Bd,this.Bd.topLeft,0);return!0}lV(A){A=void 0===A?!1:A;this.zd.sm(this.Bd,this.pn());this.zd.tt(this.pn());this.HI(A);return!0}cta(A){A=void 0===
A?!1:A;this.zd.sm(this.Bd,this.ij);this.zd.tt(this.ij);this.HI(A)}vhc(){k.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}e9d(){return!1}Daa(A,ea,Ma,Vb,tc){tc=void 0===tc?!1:tc;var Jc=ia.DOMElementExtensions.getBoundingClientRect(ea);let ld=ea===this.GB[Te.xfc]||ea===this.GB[Te.tZe];if(this.Zr){var Zd=ea===this.GB[Te.uZe]||ea===this.GB[Te.wfc];this.isRow&&Zd||this.Ci&&ld?Zd="100px":(ld=this.isRow||ld,Zd=(ld?tc?
Sc.Yak:Sc.cbk:tc?Sc.Xak:Sc.$ak)+"px");ea=ld?ea===this.GB[Te.xfc]?"top":"bottom":ea===this.GB[Te.wfc]?"right":"left";A=100*(ld?A.x-Jc.x:A.y-Jc.y)/(ld?Jc.width:Jc.height);for(Jc=1;4>=Jc;Jc++){Vb=document.createElement("div");var De=document.createElement("div");const Ve=document.createElement("div");Vb.appendChild(De);Vb.appendChild(Ve);tc&&(De=document.createElement("div"),Vb.appendChild(De),Ve.style.fontWeight="bold");Vb.className=Xf.iRh;this.Up[Jc.toString()]=Vb;this.zd.DF(Ma,Jc).Ng.appendChild(Vb);
if(Vb=this.Up[Jc.toString()])Vb.style[ea]=Zd,Vb.style[ld?"left":"top"]=A+"%"}}else for(tc=(ld?-Sc.bbk:-Sc.Zak)+"px",Zd=ld?ea===this.GB[Te.xfc]?"top":"bottom":ea===this.GB[Te.wfc]||Vb?"right":"left",ea=100*(ld?Vb?0:A.x-Jc.x:A.y-Jc.y)/(ld?Jc.width:Jc.height),A=1;4>=A;A++)if(Jc=document.createElement("div"),Jc.className=Xf.hRh,this.Up[A.toString()]=Jc,this.zd.DF(Ma,A).Ng.appendChild(Jc),Jc=this.Up[A.toString()])Jc.style[Zd]=tc,Jc.style[ld?"left":"top"]=ea+"%"}xwg(A,ea,Ma){const Vb=Qa.h(this.$),tc=Vb.Bi(A);
var Jc=Vb.Ih(this.paneType);Ma=Bb.a.hy(Jc.view.pk,this.domElement.parentNode,Ma,Vb.rtl);Jc=!1;let ld=2;ea&&Ma.y-tc.topLeft.y>tc.height/2?(Jc=!0,ld=1):!ea&&Ma.x-tc.topLeft.x>tc.width/2&&(Jc=!0);if(Jc){ea=Vb.xj("DragSelectionClickBehavior.updateMouseSelectionRange",Vb.pT,ld);try{ea.Vx(A),ea.$$mn(),ea.$$cu()}finally{ea&&ea.dispose()}}}Qwb(A){this.zd.Sl(this.ij);this.rM(this.lqa,this.mqa,void 0,A)}XW(A){this.zd.Sl(this.pn());this.rM(this.Zk,this.Li,void 0,A)}QCb(){return this.Zr?48:6}pn(){return this.Zr?
Sc.vDh:Sc.zDh}rab(A){return A.Ca.keyCode===la.a.mta||ja.a.isMac&&A.Ca.keyCode===la.a.rZa}tGb(A){A=Qa.h(this.$).getRangeInformation(A);for(let ea=0,Ma=A.length;ea<Ma;++ea)if(Object(Ha.a)(jc.PivotTableRange,A[ea]))return A=fe.a.Ze(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Rc.a(this.$).Xu([A]),!0;return!1}}Sc.Zak=50;Sc.bbk=25;Sc.$ak=-85;Sc.cbk=-40;Sc.Xak=-120;Sc.Yak=-50;Sc.zDh=[6];Sc.vDh=[48];Sc.$ec=[[],[],[],[],[],[]];Object(x.a)(Sc,"DragSelectionClickBehavior",Te,[]);class Cd{constructor(A,
ea){this.destinationRange=this.sourceRange=null;this.sourceRange=A;this.destinationRange=ea}}Object(x.a)(Cd,"MacroRecorderTableRowColumnRearrangedPayload",null,[134]);class vd extends Sc{constructor(A,ea,Ma,Vb,tc){super(A,ea,Ma,Vb,tc);this.Wha=null;this.cU=this.dU=!1;this.Wzf=0;this.sXa=this.yNa=null;this.DM=0;this.yfc=qb.a.instance.ia(2269);this.zZe=qb.a.instance.ia(2270);this.fHc=qb.a.instance.ia(2271);this.Sig=qb.a.instance.ia(2272);this.onKeyDown=Jc=>{if(this.Zr){if(this.rab(Jc)||Jc.Ca.keyCode===
la.a.sZa)return this.ARa||(cf.KeyInputManager.instance.ta(wb.a.Hf,this.domElement.ownerDocument.body,this.onKeyUp),this.ARa=!0),!this.C2&&this.rab(Jc)&&(Qa.h(this.$).Ti.Ar(Te.ndd),this.C2=!0),this.D2||Jc.Ca.keyCode!==la.a.sZa||(Qa.h(this.$).Ti.Ar(Te.Szb),this.D2=!0,2===this.DM?(k.ULS.shipAssertTag(509159443,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.XW(!1),this.Z0=0,this.ij=this.cU?[11]:[12],this.dU=this.cU,this.EUd(),k.ULS.shipAssertTag(509159442,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta()):3===this.DM?(k.ULS.shipAssertTag(509159441,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Pwb(!1),this.Z0=this.isRow?1:2,this.Uqa(),k.ULS.shipAssertTag(509159440,
0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV()):1===this.DM&&(k.ULS.shipAssertTag(509159439,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Qwb(!1),this.Uqa(),k.ULS.shipAssertTag(509159438,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV())),!0}else if(!this.C2&&
(Jc.Ca.keyCode===la.a.mta||ja.a.isMac&&Jc.Ca.keyCode===la.a.rZa))return cf.KeyInputManager.instance.ta(wb.a.Hf,this.domElement.ownerDocument.body,this.onKeyUp),Qa.h(this.$).Ti.Ar(Te.ndd),this.C2=!0;return!1};this.onKeyUp=Jc=>{if(this.Zr){if(this.rab(Jc)||Jc.Ca.keyCode===la.a.sZa)return this.Wzf=this.rab(Jc)?0:1,this.TB&&Qa.h(this.$).Ti.Ar(Te.Szb),Jc.Ca.keyCode===la.a.sZa&&(2===this.DM?(k.ULS.shipAssertTag(509159437,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
k.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Pwb(!1),this.Z0=0,this.Uqa(!0),k.ULS.shipAssertTag(509159436,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV(!0)):3===this.DM?(k.ULS.shipAssertTag(509159435,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.XW(!1),this.Z0=this.isRow?1:2,this.ij=this.isRow?[11]:[12],this.EUd(!0),k.ULS.shipAssertTag(509159434,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(!0)):1===this.DM&&(k.ULS.shipAssertTag(509159433,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!1),this.ij=this.cU?[11]:[12],this.sQb(!0),k.ULS.shipAssertTag(509159432,
0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(!0))),this.ELc(this.Wzf),!0}else if(Jc.Ca.keyCode===la.a.mta||ja.a.isMac&&Jc.Ca.keyCode===la.a.rZa)return this.ELc(),this.TB&&Qa.h(this.$).Ti.Ar(Te.qZe),!0;return!1};this.mqa=Jc=>{Jc=P.a(this.$).jg(Jc);5===this.Yo?this.ASf(Jc):(this.TB=!1,k.ULS.shipAssertTag(509159430,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zd.Sl(this.ij),!this.$.wu([this.Bd],!1)||this.evj()||
this.Pvf()||(this.ha.sourceRange=this.sourceRange.clone(),this.Zr?this.mqj():this.W5e(),this.Dfa()?this.Bd.top>this.sourceRange.top&&(Jc=this.Bd.height,this.Bd.top-=Jc,this.Bd.bottom-=Jc):this.Bd.left>this.sourceRange.left&&(Jc=this.Bd.width,this.Bd.left-=Jc,this.Bd.right-=Jc),this.UZ()),this.CGd());k.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.rM(this.lqa,this.mqa);this.tableRange=null;this.Yo=-1;this.Zr&&(this.Wha=null,this.DM=0);
return!0};this.NNb=()=>{this.TB=!1;this.DM=0;k.ULS.shipAssertTag(509159429,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.zd.Sl(this.ij);if(!this.$.wu([this.Bd],!1))return k.ULS.sendTraceTag(509150291,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rM(this.MNb,this.NNb),this.Yo=-1,!0;if(!(this.ha.ra.Ye.equals(this.Bd)||this.tGb(this.Bd)||this.tGb(this.sourceRange)||this.Pvf()||(this.UZ(),this.ha.sourceRange=this.sourceRange.clone(),
this.$.Fe(-694765314,2,30,{[Gb.a.xNa]:this.C2,[Gb.a.Khd]:!0,[Gb.a.Lhd]:this.dU,[Gb.a.eea]:this.ha.sourceRange,[Gb.a.dea]:this.ha.ra.Ye,[Gb.a.Pzb]:this.D2}),this.C2))){if(this.Bd.top>this.sourceRange.top&&(this.isRow||this.Bd.left===this.sourceRange.left&&this.dU)){var Jc=this.Bd.height;this.Bd.top-=Jc;this.Bd.bottom-=Jc}else this.Bd.left>this.sourceRange.left&&(this.Ci||this.Bd.top===this.sourceRange.top&&!this.dU)&&(Jc=this.Bd.width,this.Bd.left-=Jc,this.Bd.right-=Jc);this.UZ()}k.ULS.sendTraceTag(509150290,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.rM(this.MNb,this.NNb);this.Wha=this.tableRange=null;this.Yo=-1;this.dU=!1;this.CGd();return!0};this.lqa=Jc=>{const ld=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ld&&(Jc=P.a(this.$).jg(Jc));var Zd=Jc.clientPoint;ld||(Jc=P.a(this.$).jg(Jc));this.Zr&&(this.kZ=Jc);if(Jc=this.ha.ms(Zd,Jc.Nd,5,void 0,void 0,!0)){if(this.tableRange.contains(Jc.topLeft)){if(this.xwg(Jc,this.Dfa(),
Zd),this.Bd=this.KLa(Jc),this.ha.sourceRange=this.Bd,this.zd.sm(this.Bd,this.ij),k.ULS.shipAssertTag(509159428,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zd.tt(this.ij),k.ULS.shipAssertTag(509159427,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.zd.Sl(this.pn()),6!==this.Yo){for(Zd=1;4>=Zd;Zd++)if(Jc=this.Up[Zd.toString()])Jc.parentNode.removeChild(Jc),this.zd.DF(this.Dfa()?11:12,Zd).Ng.appendChild(Jc);this.Yo=
6}}else if(this.Bd=this.pwb(Jc),this.Zr)this.Kkf(!1);else if(this.zd.sm(this.Bd,this.pn()),k.ULS.shipAssertTag(509159426,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.zd.tt(this.pn()),k.ULS.shipAssertTag(509159425,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zd.Sl(this.ij),5!==this.Yo){for(Zd=1;4>=Zd;Zd++)if(Jc=this.Up[Zd.toString()])Jc.parentNode.removeChild(Jc),this.zd.DF(this.QCb(),Zd).Ng.appendChild(Jc);
this.Yo=5}this.HI()}return!0};this.MNb=Jc=>{var ld=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ld&&(Jc=P.a(this.$).jg(Jc));var Zd=Jc.clientPoint;ld||(Jc=P.a(this.$).jg(Jc));this.kZ=Jc;if(ld=this.ha.ms(Zd,Jc.Nd,5,void 0,void 0,!0)){if(this.omf(ld))return this.Bd=this.pwb(ld),this.Jkf(!1),!0;var De=Qa.h(this.$),Ve=De.Bi(ld),Se=De.Ih(this.paneType);Zd=Bb.a.hy(Se.view.pk,this.domElement.parentNode,Zd,De.rtl);Se=!1;let sf=2;this.dU=!1;if(this.isRow||this.Ci){this.isRow&&
Zd.y-Ve.topLeft.y>Ve.height/2?(Se=!0,sf=1):this.Ci&&Zd.x-Ve.topLeft.x>Ve.width/2&&(Se=!0);if(Se){Jc=De.xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",De.pT,sf);try{Jc.Vx(ld),Jc.$$mn(),ld=Jc.$$cu().range}finally{Jc&&Jc.dispose()}}this.Bd=this.pwb(ld)}else{Zd.x-Ve.topLeft.x===Ve.width?(this.dU=!1,Se=!0):Zd.y-Ve.topLeft.y>Ve.height/2&&(this.dU=Se=!0,sf=1);this.Wha&&(this.dU=this.cU);if(Se){De=De.xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",De.pT,
sf);try{De.Vx(ld),De.$$mn(),ld=De.$$cu().range}finally{De&&De.dispose()}}k.ULS.shipAssertTag(509159424,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.zd.Sl(this.ij);this.ij=this.dU?[11]:[12];for(De=1;4>=De;De++)(Ve=this.Up[De.toString()])&&Ve.parentNode.removeChild(Ve),this.Up[De.toString()]=null;this.Daa(Jc.clientPoint,Jc.Nd,this.dU?11:12,!0);this.Bd=this.KLa(ld)}this.ha.sourceRange=this.Bd;this.zd.sm(this.Bd,this.ij);k.ULS.shipAssertTag(509159395,0,!!this.ij,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.zd.tt(this.ij);k.ULS.shipAssertTag(509159394,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.zd.Sl(this.pn());if(6!==this.Yo){for(Jc=1;4>=Jc;Jc++)if(ld=this.Up[Jc.toString()])ld.parentNode.removeChild(ld),this.zd.DF(this.isRow||this.dU?11:12,Jc).Ng.appendChild(ld);this.Yo=6}this.HI()}return!0};this.Qeb=()=>{this.Zr?this.TB&&5<=this.Yo&&(this.tableRange?this.D2?(k.ULS.shipAssertTag(509159381,
0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!0)):(k.ULS.shipAssertTag(509159380,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150280,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Qwb(!0)):this.D2?this.isRow||this.Ci?(k.ULS.shipAssertTag(509159385,
0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!0)):(k.ULS.shipAssertTag(509159384,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150284,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Pwb(!0)):this.isRow||this.Ci?(k.ULS.shipAssertTag(509159383,0,!!this.ij,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Pwb(!0)):(k.ULS.shipAssertTag(509159382,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150282,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!0))):this.TB&&5<=this.Yo&&(this.tableRange?(k.ULS.shipAssertTag(509159378,
0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.zd.Sl(this.ij),k.ULS.sendTraceTag(509150278,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rM(this.lqa,this.mqa)):(k.ULS.shipAssertTag(509159379,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.zd.Sl(this.pn()),k.ULS.sendTraceTag(509150279,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rM(this.Zk,
this.Li)))};this.tableRange=null;this.ARa=this.C2=this.D2=!1;this.ha.M5c(this.Qeb)}dispose(){hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.eDc(this.Qeb);this.C2&&this.ELc();this.Zr&&this.D2&&this.ELc(1);super.dispose()}cOd(A){this.Zr&&(this.kZ=A,this.Wha=null,this.cU=this.isRow=this.Ci=this.dU=!1,cf.KeyInputManager.instance.ta(wb.a.Rd,this.domElement.ownerDocument.body,this.onKeyDown));this.TB=!0;this.tableRange=this.ndh(this.tableManager.Vt(this.sourceRange.topLeft));
Qa.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zr?(this.Wha=this.tableRange,this.DM=1,this.ij=(this.cU=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Yo=6,k.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.VQ(this.lqa,this.mqa),this.yNa=this.yfc,this.sXa=this.fHc,this.Daa(A.clientPoint,A.Nd,this.cU?11:12,!0,!0),k.ULS.shipAssertTag(509159447,0,!!this.ij,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(!0)):(this.ij=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Yo=6,k.ULS.sendTraceTag(509150304,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.VQ(this.lqa,this.mqa),this.Daa(A.clientPoint,A.Nd,this.isRow?11:12,!0)):(this.tableRange=null,this.Zr?(this.isRow=this.sourceRange.isRow,this.Ci=this.sourceRange.Ci,this.isRow||
this.Ci?(this.DM=3,this.Z0=this.isRow?1:2,this.Yo=6,this.ij=this.isRow?[11]:[12],k.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.VQ(this.MNb,this.NNb),this.yNa=this.yfc,this.sXa=this.fHc,this.Daa(A.clientPoint,A.Nd,this.isRow?11:12,!0,!0),k.ULS.shipAssertTag(509159446,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(!0)):(this.DM=2,this.Z0=0,k.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),
this.VQ(this.Zk,this.Li),this.yNa=this.zZe,this.sXa=this.Sig,this.Daa(A.clientPoint,A.Nd,this.QCb(),!1,!0),k.ULS.shipAssertTag(509159445,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV(!0))):(k.ULS.sendTraceTag(509150301,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.VQ(this.Zk,this.Li),cf.KeyInputManager.instance.ta(wb.a.Rd,this.domElement.ownerDocument.body,this.onKeyDown),this.Z0=this.sourceRange.isRow?1:this.sourceRange.Ci?
2:0,this.Daa(A.clientPoint,A.Nd,this.QCb(),!1),k.ULS.shipAssertTag(509159444,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV()))}VTa(){this.TB=!1;this.Zr&&(this.DM=0);k.ULS.shipAssertTag(509159431,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.zd.Sl(this.pn());if(!this.$.wu([this.Bd],!1))return k.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rM(this.Zk,
this.Li),this.Yo=-1,!0;if(this.ha.ra.Ye.equals(this.Bd)||this.tGb(this.Bd)||this.tGb(this.sourceRange))this.Yo=-1;else{this.UZ();this.ha.sourceRange=this.sourceRange.clone();const A=this.ha.sourceRange,ea=this.ha.ra.Ye;this.Zr?this.$.Fe(-694765314,2,30,{[Gb.a.xNa]:this.C2,[Gb.a.eea]:A,[Gb.a.dea]:ea,[Gb.a.Pzb]:this.D2}):this.$.Fe(-694765314,2,30,{[Gb.a.xNa]:this.C2,[Gb.a.eea]:A,[Gb.a.dea]:ea})}if(this.Zr||!this.tableRange)k.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.rM(this.Zk,this.Li);this.CGd();return!0}dOd(A){const ea=this.ha.ms(A.clientPoint,A.Nd,5,void 0,void 0,!0);this.kZ=A;return this.omf(ea)?(this.Bd=this.KLa(ea),this.Jkf(!0),!0):this.Iqi(ea)?(this.Bd=this.pwb(ea),this.Kkf(!0),!0):!1}HI(A){A=void 0===A?!1:A;const ea=this.Bd.toString();if(this.Zr)for(var Ma=1;4>=Ma;Ma++){const Vb=this.Up[Ma.toString()];Vb&&Vb.childNodes&&0<Vb.childNodes.length&&(Vb.childNodes[0].innerText=ea,Vb.childNodes[1].innerText=this.yNa,A&&(Vb.childNodes[2].innerText=this.sXa))}else for(A=
1;4>=A;A++)if(Ma=this.Up[A.toString()])Ma.innerText=ea}omf(A){return!!this.Wha&&1!==this.DM&&!!A&&this.Wha.contains(A.topLeft)}Iqi(A){return!!this.Wha&&1===this.DM&&!!A&&!this.Wha.contains(A.topLeft)}Jkf(A){this.tableRange=this.Wha;this.DM=1;const ea=!this.D2;A?(k.ULS.shipAssertTag(509159393,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!1),this.ij=
this.cU?[11]:[12],this.sQb(ea),k.ULS.shipAssertTag(509159392,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(ea)):(k.ULS.shipAssertTag(509159391,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Pwb(!1),this.Uqa(ea),k.ULS.shipAssertTag(509159390,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.lV(ea))}Kkf(A){this.tableRange=null;this.DM=2;const ea=!this.D2;A?(k.ULS.shipAssertTag(509159389,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),k.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XW(!1),this.ij=this.cU?[11]:[12],this.dU=this.cU,this.EUd(ea),k.ULS.shipAssertTag(509159388,0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.cta(ea)):(k.ULS.shipAssertTag(509159387,
0,!!this.ij,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),k.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Qwb(!1),this.Uqa(ea),k.ULS.shipAssertTag(509159386,0,!!this.pn(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.lV(ea))}Ajb(){if(!Qa.h(this.$).ha.ra.yj)return!1;const A=Qa.h(this.$).getRangeInformation(this.ha.ra.Ye);for(const ea of A)if(Object(Ha.a)(jc.PivotTableRange,ea))return!1;
return!0}ndh(A){if(A&&A.contains(this.sourceRange)&&!A.equals(this.sourceRange)){if(A.$na&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===A.top){const ea=new wa.Range(this.sourceRange.top,this.sourceRange.left,A.bottom,this.sourceRange.right,!1,!1);if(!ea.equals(A))return this.sourceRange=ea,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),A}this.Zr?this.cU=A.left===this.sourceRange.left&&A.right===this.sourceRange.right:this.isRow=A.left===this.sourceRange.left&&
A.right===this.sourceRange.right;if(A.top===this.sourceRange.top&&A.bottom===this.sourceRange.bottom||this.Dfa())return A}return null}KLa(A){const ea=A.clone();this.Dfa()?ea.left=Math.max(A.left-this.iwd,1):ea.top=Math.max(A.top-this.Gbe,1);ea.right=ea.left+this.sourceRange.width-1;ea.bottom=ea.top+this.sourceRange.height-1;return this.pub(ea)}Pvf(){const A=this.Bd.topLeft.Te(this.sourceRange);return A||this.Zr&&!this.tableRange?A:this.Dfa()?this.Bd.top===this.sourceRange.bottom+1:this.Bd.left===
this.sourceRange.right+1}evj(){if(this.Dfa()&&this.Bd.left!==this.tableRange.left||!this.Dfa()&&this.Bd.top!==this.tableRange.top){const A=fe.a.Ze(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Rc.a(this.$).Xu([A]);return!0}return!1}mqj(){const A=this.$.Jd.Le("UserAction","RearrangeRowColumnClientSide"),ea={["CopyPasteTargetType"]:1,["OperationId"]:qa.a.create().toString(),["Stopwatch"]:A,["DragDropIsShiftKeyDown"]:this.D2,["EncounteredDeploymentErrors"]:!1},Ma=this.C2?2:1,Vb=this.$.ea.Ba(254);(new Promise((tc,
Jc)=>{this.W5e(ld=>{ld.Errors&&0<ld.Errors.length?Jc(new $d(22,ld.Errors)):tc(!0)},ld=>{ld=wc.a.Bg(ld.data);Jc(new $d(22,ld))})})).then(()=>{k.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Vb&&Vb.uUi(ea,Ma,this.sourceRange,this.Bd);return Promise.resolve(!0)},tc=>{k.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${tc?copyPasteInfra.getStringifiedError(tc):"null"}, copyPasteTargetType="${1}"`);
return Vb?Vb.Idj(tc,ea,Ma,this.sourceRange,this.Bd):Promise.reject(tc)})}W5e(A,ea){A=void 0===A?null:A;ea=void 0===ea?null:ea;const Ma={};this.Dfa()?(Ma.FirstRow=this.Bd.top-1,Ma.FirstColumn=0,Ma.DeltaColumn=0,Ma.DeltaRow=this.Bd.bottom-this.Bd.top+1):(Ma.FirstRow=0,Ma.FirstColumn=this.Bd.left-1,Ma.DeltaColumn=this.Bd.right-this.Bd.left+1,Ma.DeltaRow=0);Ma.LastRow=Bc.a.GA;Ma.LastColumn=Bc.a.$y;Ma.SheetName=this.$.va.na?this.$.va.na.name:this.$.Gd.getItemByName(this.$.Gd.na.name).sheetName;const Vb=
Zb.v(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new de.a(514,0,(tc,Jc,ld)=>{var Zd=this.$.pa.ua;tc=A?gd.b(tc,A):tc;Jc=ea?gd.a(Jc,ea):Jc;const De=Zd.Ra(41,null);De.sourceRange=Vb;De.destinationRange=Ma;return fd.g(Zd,"RearrangeRowColumn",De,tc,Jc,ld,null,0)},64,()=>new Cd(Vb,Ma)),null)}ELc(A){A=void 0===A?0:A;0===A?this.C2=!1:1===A&&(this.D2=!1);this.Zr&&(this.C2||this.D2)||(cf.KeyInputManager.instance.Aa(wb.a.Hf,this.domElement.ownerDocument.body,this.onKeyUp),this.ARa=
!1)}Uqa(A){A=void 0===A?!1:A;this.Yo=5;k.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.VQ(this.Zk,this.Li);this.yNa=this.zZe;this.sXa=this.Sig;this.Daa(this.kZ.clientPoint,this.kZ.Nd,this.QCb(),!1,A)}EUd(A){A=void 0===A?!1:A;this.Yo=6;k.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.VQ(this.MNb,this.NNb);this.yNa=this.yfc;this.sXa=this.fHc;this.Daa(this.kZ.clientPoint,this.kZ.Nd,
this.isRow||this.cU?11:12,!0,A)}sQb(A){A=void 0===A?!1:A;this.Yo=6;k.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.VQ(this.lqa,this.mqa);this.yNa=this.yfc;this.sXa=this.fHc;this.Daa(this.kZ.clientPoint,this.kZ.Nd,this.Dfa()?11:12,!0,A)}Dfa(){return!this.Zr&&this.isRow||this.Zr&&this.cU}Pwb(A){this.zd.Sl(this.ij);this.rM(this.MNb,this.NNb,void 0,A)}CGd(){const A=ua.a.instance.Ed("Common.ISystemInitiatedFeedback");A&&A.execute(ea=>{ea.logActivity("DragDrop",
null)})}}Object(x.a)(vd,"DragSelectionClickBehaviorCellRangeAndTable",Sc,[]);var Jd=a(330);class pe extends Sc{constructor(A,ea,Ma,Vb,tc){super(A,ea,Ma,Vb,tc);this.Qeb=()=>{this.TB&&(k.ULS.shipAssertTag(509159371,0,!!this.ij,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),k.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.Qwb(!0));5===this.Yo&&(k.ULS.shipAssertTag(509159370,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
k.ULS.sendTraceTag(509150339,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.XW(!0))};this.mqa=Jc=>{P.a(this.$).jg(Jc);this.TB=!1;k.ULS.shipAssertTag(509159369,0,!!this.ij,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.zd.Sl(this.ij);this.ha.sourceRange=this.sourceRange.clone();this.Kxf?this.$.Fe(927125067,Z.a.ld,30,null):this.QAa?(this.UZ(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Fe(-694765314,2,30,{[Gb.a.xNa]:!0,[Gb.a.eea]:this.ha.sourceRange,
[Gb.a.dea]:this.ha.ra.Ye,[Gb.a.Pzb]:!1}),k.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),Qa.h(this.$).Ti.Ar(Gb.a.jY),this.QAa=!1):this.dqj();k.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.rM(this.lqa,this.mqa);this.Yo=-1;return!0};this.lqa=Jc=>{Jc=P.a(this.$).jg(Jc);const ld=Jc.clientPoint;this.kZ=Jc;let Zd=this.ha.ms(ld,Jc.Nd,5,void 0,void 0,!0);if(Zd){if(!this.jCd(Zd))return this.Gni(Jc),
!0;this.xwg(Zd,this.isRow,ld);if(this.isRow||this.Ci)this.Bd=this.KLa(Zd);this.ha.sourceRange=this.Bd;this.zd.sm(this.Bd,this.ij);k.ULS.shipAssertTag(509159368,0,!!this.ij,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.zd.tt(this.ij);k.ULS.shipAssertTag(509159367,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");this.zd.Sl(this.pn());this.HI()}return!0};this.onKeyDown=Jc=>this.rab(Jc)?(this.ARa||(cf.KeyInputManager.instance.ta(wb.a.Hf,
this.domElement.ownerDocument.body,this.onKeyUp),this.ARa=!0),this.QAa||(Qa.h(this.$).Ti.Ar(Te.ndd),this.QAa=!0),!0):!1;this.onKeyUp=Jc=>{this.rab(Jc)&&(cf.KeyInputManager.instance.Aa(wb.a.Hf,this.domElement.ownerDocument.body,this.onKeyUp),this.ARa=!1,this.TB?Qa.h(this.$).Ti.Ar(Te.Szb):Qa.h(this.$).Ti.Ar(Gb.a.jY),this.QAa=!1);return!0};this.ERf=Jc=>{Jc.Errors&&0<Jc.Errors.length?(k.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${fe.a.me(Jc.Errors)}]`),
this.Bd.left=this.sourceRange.left,this.Bd.right=this.sourceRange.right,this.Bd.top=this.sourceRange.top,this.Bd.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Bd.top&&this.sourceRange.bottom>=this.Bd.top-1?(this.Bd.top=this.sourceRange.top,this.Bd.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Bd.top||(this.Bd.top-=this.sourceRange.height),this.Bd.bottom=this.Bd.top+this.sourceRange.height-1):this.sourceRange.left<=this.Bd.left&&this.sourceRange.right>=this.Bd.left-
1?(this.Bd.left=this.sourceRange.left,this.Bd.right=this.sourceRange.right):(this.sourceRange.left>this.Bd.left||(this.Bd.left-=this.sourceRange.width),this.Bd.right=this.Bd.left+this.sourceRange.width-1);this.UZ();this.Yo=-1};this.DRf=Jc=>{Jc=wc.a.Bg(Jc.data);k.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${fe.a.me(Jc)}]`)};this.ha.M5c(this.Qeb);this.QAa=this.ARa=!1}dispose(){hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&
this.ha&&this.ha.eDc(this.Qeb);super.dispose()}cOd(A){this.kZ=A;this.isRow=this.Ci=!1;this.Z0=null!=this.Bd?this.Bd.isRow?1:this.Bd.Ci?2:0:0;this.TB=!0;cf.KeyInputManager.instance.ta(wb.a.Rd,this.domElement.ownerDocument.body,this.onKeyDown);this.Qd=this.tableManager.Ena(this.sourceRange);this.Jsf=this.lJi(this.Bd);this.Qd||k.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.Kxf=(new Xc.a(this.$.va)).Ej;
Qa.h(this.$);Qa.h(this.$).Ti.Ar(Te.Szb);this.jCd(this.Bd)?(this.isRow=this.eKi(),this.Ci=this.kDi(),this.isRow||this.Ci?(this.kbb=!1,this.sQb(A),this.Bd=this.KLa(this.Bd),k.ULS.shipAssertTag(509159377,0,!!this.ij,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.cta()):(this.kbb=!0,this.Uqa(A),k.ULS.shipAssertTag(509159376,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.lV())):(this.kbb=!0,this.Uqa(A),k.ULS.shipAssertTag(509159375,
0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.lV())}VTa(){hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7657099_CleaningUpIsDragging")&&(this.TB=!1);return this.Kxf?(this.$.Fe(927125067,Z.a.ld,30,null),k.ULS.shipAssertTag(509159374,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),k.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.XW(!0),this.kbb=!1,this.Yo=-1,
!0):this.QAa||hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046087_MovePivotTables")&&hb.EwaSettings.isChangeGateEnabled("OfficeVSO:8046086_DragDropSelectionBugFix")&&this.Jsf?(this.UZ(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Fe(-694765314,2,30,{[Gb.a.xNa]:this.QAa,[Gb.a.eea]:this.ha.sourceRange,[Gb.a.dea]:this.ha.ra.Ye,[Gb.a.Pzb]:!1}),k.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.QAa}"`),
Qa.h(this.$).Ti.Ar(Gb.a.jY),k.ULS.shipAssertTag(509159373,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),k.ULS.sendTraceTag(509150342,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.XW(!0),this.kbb=!1,this.Yo=-1,this.Jsf=!1,!0):5===this.Yo?(k.ULS.shipAssertTag(509159372,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),k.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),
this.XW(!0),this.kbb=!1,this.m0j(),this.Yo=-1,!0):!1}dOd(A){const ea=this.ha.ms(A.clientPoint,A.Nd,5,void 0,void 0,!0);this.kZ=A;return this.kbb?!1:this.jCd(ea)?(this.Hni(A),!0):!1}HI(){let A=new wa.Range(this.Bd.top,this.Bd.left,this.Bd.bottom,this.Bd.right,!1,!0);6===this.Yo&&(this.isRow?(--A.top,A.bottom=A.top+this.Bd.height-1):(--A.left,A.right=A.left+this.Bd.width-1));for(let ea=1;4>=ea;ea++){const Ma=this.Up[ea.toString()];Ma&&Ma.childNodes&&0<Ma.childNodes.length&&(Ma.childNodes[0].innerText=
A.toString())}}Ajb(){if(!Qa.h(this.$).ha.ra.yj)return!1;var A=Qa.h(this.$).getRangeInformation(this.ha.ra.Ye);for(var ea of A)if(Object(Ha.a)(jc.PivotTableRange,ea)&&(A=this.tableManager.Ena(ea)))return ea=!A.isOlap||!A.fSa(!0),k.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",A),A.isActionable&&ea;return!1}KLa(A){A=A.clone();this.isRow?(A.left=this.sourceRange.left,A.right=this.Qd.right,A.bottom=A.top+this.sourceRange.height-
1):this.Ci?(A.top=this.sourceRange.top,A.bottom=this.Qd.wC?this.Qd.wC.bottom:this.Qd.bottom,A.right=A.left+this.sourceRange.width-1):k.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.pub(A)}dqj(){const A={},ea=Zb.v(this.sourceRange,this.$);Qa.h(this.$).getRangeInformation(this.Bd);if(this.isRow){ea.FirstColumn=A.FirstColumn=this.Bd.left-1;ea.LastColumn=A.LastColumn=this.Bd.right-1;if(this.sourceRange.top<=this.Bd.top&&
this.sourceRange.bottom>=this.Bd.top-1){k.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Bd.top?A.LastRow=A.FirstRow=this.Bd.top-1:(A.FirstRow=this.Bd.top-this.sourceRange.height-1,A.LastRow=A.FirstRow+this.sourceRange.height-1)}else{A.FirstRow=Math.min(this.Bd.top,this.Bd.bottom-1);A.LastRow=this.Bd.bottom-1;if(this.sourceRange.left<=this.Bd.left&&this.sourceRange.right>=this.Bd.left-1){k.ULS.sendTraceTag(520176344,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}A.LastColumn=this.sourceRange.left>this.Bd.left?A.FirstColumn=this.Bd.left-1:A.FirstColumn=this.Bd.left-this.sourceRange.width-1}const Ma={};Ma.SheetName=this.$.va.na?this.$.va.na.name:this.$.Gd.getItemByName(this.$.Gd.na.name).sheetName;Ma.Ranges=Array(2);Ma.Ranges[0]=ea;Ma.Ranges[1]=A;this.QSh(Ma)}QSh(A){this.$.userOperationManager.enqueueOperation(new de.a(265,0,(ea,Ma,Vb)=>{var tc=this.$.pa.ua;ea=this.ERf?gd.b(ea,
this.ERf):ea;Ma=this.DRf?gd.a(Ma,this.DRf):Ma;const Jc=tc.Ra(1,null);Jc.moveRange=A;return fd.g(tc,"MoveLineItems",Jc,ea,Ma,Vb,null,0)},64),null)}jCd(A){return null!==this.Qd&&this.cHi(A)&&this.ZJi(A)&&this.oMi(A)&&this.oCi(A)}cHi(A){return this.Qd.wC?A.left>=this.Qd.wC.left:this.Qd.$z?A.left>=this.Qd.$z.left:A.left>=this.Qd.left}ZJi(A){return this.Qd.$z?A.right<=this.Qd.$z.right:this.Qd.wC?A.right<=this.Qd.wC.right:A.right<=this.Qd.right}oMi(A){return this.isRow?null!==this.Qd.wC&&A.top>=this.Qd.wC.top:
this.Ci?null!==this.Qd.$z&&A.top>=this.Qd.$z.top:null===this.Qd.top||A.top>=this.Qd.top}oCi(A){return this.Qd.wC?A.bottom<=this.Qd.wC.bottom:this.Qd.$z?A.bottom<=this.Qd.$z.bottom:A.bottom<=this.Qd.bottom}lJi(A){return null!==this.Qd&&this.Qd.left>=A.left&&this.Qd.right<=A.right&&this.Qd.top>=A.top&&this.Qd.bottom<=A.bottom}eKi(){return null!==this.Qd&&null!==this.Qd.wC&&this.Qd.wC.top<=this.Bd.top&&this.Qd.wC.left<=this.Bd.left&&this.Qd.wC.right>=this.Bd.left}kDi(){return null!==this.Qd&&null!==
this.Qd.$z&&this.Qd.$z.top===this.Bd.top&&this.Qd.$z.left<=this.Bd.left&&this.Qd.$z.right>=this.Bd.right}sQb(A){this.Yo=6;this.ij=this.isRow?[11]:[12];k.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.VQ(this.lqa,this.mqa);this.Daa(A.clientPoint,A.Nd,this.isRow?11:12,!0,!1)}Uqa(A){this.Yo=5;k.ULS.sendTraceTag(509150336,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.VQ(this.Zk,this.Li);this.Daa(A.clientPoint,
A.Nd,this.QCb(),!1,!1)}Hni(A){k.ULS.shipAssertTag(509159366,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");k.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.XW(!1);this.sQb(A);this.Bd=this.KLa(this.Bd);k.ULS.shipAssertTag(509159365,0,!!this.ij,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.cta()}Gni(A){k.ULS.shipAssertTag(509159364,0,!!this.ij,
"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");k.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.Qwb(!1);this.Uqa(A);k.ULS.shipAssertTag(509159363,0,!!this.pn(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.lV()}m0j(){if((null==this.sourceRange||null==this.Bd||this.sourceRange.sA(!1)!==this.Bd.sA(!1))&&!this.tGb(this.Bd)){var A=fe.a.Ze(1,0,904,903,0,2069074184,
"PivotTableInvalidMove");A.HelpTopicId=Jd.a.a4j;A.HelpDescription=qb.a.instance.ia(913);Rc.a(this.$).Xu([A])}}}Object(x.a)(pe,"DragSelectionClickBehaviorPivotTableRange",Sc,[]);var Ge=a(385);class $e extends Ai{constructor(A,ea){super(A);this.dh=()=>{this.domElement.classList.remove(Xf.selecting);Ge.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Ou=()=>{this.domElement.classList.add(Xf.selecting)};this.onPointerDown=Ma=>{2===Ma.ud&&Ma.kq===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=
4,this.gridView.ha.sourceRange=this.gridView.ha.ra.Ye,Ge.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.vga=()=>{this.gridView.$.Fe(1983983164,2,30,null);return!0};this.kf=()=>{ia.DOMElementExtensions.setVisible(this.sea,this.gridView.$.isEditMode)};this.mDa=()=>{ia.DOMElementExtensions.setVisible(this.sea,!1)};this.lDa=()=>{ia.DOMElementExtensions.setVisible(this.sea,!0)};this.PPf=()=>{ia.DOMElementExtensions.setVisible(this.sea,!1)};this.OPf=()=>{ia.DOMElementExtensions.setVisible(this.sea,
!0)};this.ZMb=(Ma,Vb)=>{ia.DOMElementExtensions.setVisible(this.sea,!Vb.rze)};this.gridView=ea;ea=document.createElement("div");ea.className=xh.a.lRh;this.sea=ea;this.kf(null,null);A.appendChild(ea);Bg.a.instance.ta(wb.a.pointerDown,this.sea,this.onPointerDown);ui.a.instance.ta(wb.a.om,this.sea,this.vga);this.gridView.$.Pm(this.kf);this.gridView.$.hd.Y5c(this.mDa);this.gridView.$.hd.X5c(this.lDa);this.gridView.TBe(this.ZMb);this.gridView.cellTextEditBox.yp(this.PPf);this.gridView.cellTextEditBox.yq(this.OPf)}dispose(){Bg.a.instance.Aa(wb.a.pointerDown,
this.sea,this.onPointerDown);ui.a.instance.Aa(wb.a.om,this.sea,this.vga);this.gridView.$&&(this.gridView.ha.pha(this.Ou),this.gridView.ha.eaa(this.dh),this.gridView.$.Rn(this.kf),this.gridView.$.hd.GWd(this.mDa),this.gridView.$.hd.FWd(this.lDa),this.gridView.k7f(this.ZMb),this.gridView.cellTextEditBox.lp(this.PPf),this.gridView.cellTextEditBox.Pp(this.OPf));super.dispose()}}Object(x.a)($e,"FillHandleClickBehavior",Ai,[]);class Bf extends zh{constructor(A,ea){super(A);this.Xej=Ma=>{const Vb=Xb.HelperMethods.Vs(Ma);
var tc=this.$za.Mbe(Ma.clientPoint);if(!tc)return!1;var Jc=tc.fg,ld=this.$za.za.eDb(Jc.hashCode).sza(tc.LL);if(!ld)return!1;Ma=Jc.fl.domElement;tc=Xb.HelperMethods.UAe(Xb.HelperMethods.EDb(Jc.domElement,Ma),tc.LL);Jc=0;ld=this.$za.yd(ld.getRange());for(let De=0,Ve=Bf.uMe.length;De<Ve;++De){const Se=Bf.uMe[De];if((128===Se||64===Se)&&this.$za.$.isEditMode)continue;var Zd=ld.uPa(Se);if(!Zd||!Zd.V$a||"none"===Zd.V$a.style.display)continue;Zd=Zd.V$a;const sf=Xb.HelperMethods.EDb(Zd,Ma);Zd=new Sys.UI.Bounds(sf.x,
sf.y,Zd.offsetWidth,Zd.offsetHeight);if(Vi.a.UT(Zd,tc)){Jc=Se;break}}return 0!==Jc?(ld.invoke(Jc,Vb),!0):!1};this.rKg=ea;ui.a.instance.ta(wb.a.click,A,this.Xej)}get $za(){return this.rKg}}Bf.uMe=[1,2,32,256,128,64];Object(x.a)(Bf,"IPadSelectionClickThroughBehavior",zh,[]);class yf{constructor(A){this.sof=ea=>{this.dMc(ea.Nd,1);return!0};this.tof=ea=>{this.dMc(ea.Nd,-1);return!0};this.dh=()=>{this.ZAd=!1};this.Ou=()=>{this.ZAd=!0};this.gridView=A;this.v$a=0;this.ZAd=this.oqc=!1;this.D9=Number.NaN;
this.gridView.ha.Hka(this.Ou);this.gridView.ha.Gka(this.dh);this.gridView.ha.M5c(this.dh)}dispose(){this.gridView.ha.pha(this.Ou);this.gridView.ha.eaa(this.dh);this.gridView.ha.eDc(this.dh)}b4(){this.v$a=0;this.oqc=!1;this.D9=Number.NaN}xZe(A){this.oqc=!0;this.dMc(A,1)}yZe(A){this.oqc=!1;this.dMc(A,-1)}dMc(A,ea){if(A)if(A.parentNode)if(this.ZAd)isNaN(this.D9)||(this.uMc(this.D9,!1),this.D9=Number.NaN);else if(A=parseInt(A.parentNode.getAttribute(Gb.a.M$a),10),isNaN(A))k.ULS.shipAssertTag(537159366,
0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.D9)&&A!==this.D9){if(this.oqc)return;this.uMc(this.D9,!1)}if(isNaN(this.D9)||A!==this.D9)this.D9=A,this.v$a=0;!this.v$a&&0<ea&&this.uMc(A,!0);this.v$a=Math.max(this.v$a+ea,0);!this.v$a&&0>ea&&(this.uMc(A,!1),this.D9=Number.NaN)}else k.ULS.shipAssertTag(537159367,0,!!A.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else k.ULS.shipAssertTag(537159368,
0,!!A,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}uMc(A,ea){var Ma=this.gridView.Tc.JNc;for(const Vb of Ma)for(Ma=this.gridView.zd.DF(3,Vb,A).Ng,ia.DOMElementExtensions.toggleCssClass(Ma,Xf.IQh,ea),Ma=Ma.firstChild;Ma;Ma=Ma.nextSibling)Lc.a.contains(Ma.className,"resizemarqueehandle",!0)&&ia.DOMElementExtensions.toggleCssClass(Ma,Xf.MQh,ea)}}Object(x.a)(yf,"MarqueeHoveringManager",null,[]);var wf=a(184),sg=a(873),Sf=a(1196);class eg extends zh{constructor(A,ea){super(A);this.Hmc=
!1;this.kyc=()=>{if(!this.Xt)return k.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Xt.ktj(this.Zea);this.Xt.uGh(this.$ea);if(3===this.Xt.model.state)return!0;this.Xt.ywd(!0);return!0};this.Cga=()=>{if(!this.Xt)return!1;this.Xt.E1f(!1);this.Xt.VXd(this.$ea,!1);if(3===this.Xt.model.state)return!0;this.Xt.ywd(!1);return!0};this.onPointerDown=Ma=>this.Xt?2===Ma.ud&&Ma.kq===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.BNb=
()=>{if(!this.Xt)return!1;this.Xt.VXd(this.$ea,!0);this.Xt.ywd(!1);this.Xt.iya();return!0};this.onDoubleClick=Ma=>{if(Ma.Ca)return Ma.Ca.stopPropagation(),!0;k.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.container=A;this.Xt=Object(y.a)(Sf.a,ea.metadata);this.Qjg(ea)&&this.vqf(ea.isVisible)}dispose(){this.$5f();this.Xt=null;super.dispose()}m3a(A){this.Xt=Object(y.a)(Sf.a,A.metadata);this.Qjg(A)?this.vqf(A.isVisible):
this.$5f();!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&A.isVisible!==A.NBa&&this.Xt&&(this.Xt.RUj(A.isVisible?1:0),ia.DOMElementExtensions.setVisible(this.$ea,A.isVisible))}vqf(A){this.Hmc||(this.Hmc=!0,this.$ea=document.createElement("div"),this.$ea.id=`${this.container.id}-${Gb.a.nMe}`,this.$ea.className=sg.a.Seh,this.Zea=document.createElement("div"),this.Zea.id=`${this.container.id}-${Gb.a.A$c}`,this.Zea.className=sg.a.A$c,this.HT=document.createElement("div"),
this.HT.appendChild(this.Zea),this.HT.className=sg.a.Reh,this.$ea.appendChild(this.HT),this.container.appendChild(this.$ea),k.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),Bg.a.instance.ta(wb.a.lZ,this.HT,this.kyc),Bg.a.instance.ta(wb.a.aE,this.HT,this.Cga),Bg.a.instance.ta(wb.a.pointerDown,this.HT,this.onPointerDown),wf.a.instance.ta(wb.a.click,this.HT,this.BNb),wf.a.instance.ta(wb.a.om,this.HT,
this.onDoubleClick),ia.DOMElementExtensions.setVisible(this.HT,A))}$5f(){this.Hmc&&(this.Hmc=!1,Bg.a.instance.Aa(wb.a.lZ,this.HT,this.kyc),Bg.a.instance.Aa(wb.a.aE,this.HT,this.Cga),Bg.a.instance.Aa(wb.a.pointerDown,this.HT,this.onPointerDown),wf.a.instance.Aa(wb.a.click,this.HT,this.BNb),wf.a.instance.Aa(wb.a.om,this.HT,this.onDoubleClick),ia.DOMElementExtensions.xh(this.Zea),this.Zea=null,ia.DOMElementExtensions.xh(this.$ea),this.$ea=null)}Qjg(A){A=new Ud.a(A.range,A.sheetId);return!!this.Xt&&(!this.Xt.jN()||
this.Xt.Xoc(A))}}Object(x.a)(eg,"RangeCatchUpActivityHighlightBehavior",zh,[]);class xg extends Ch{constructor(A,ea,Ma,Vb){super(A,ea,Ma,Vb)}get I8(){return 16}get wib(){return this.gridView.ha.rangePicker.mod(!1)}wXa(){return(this.gridView.inRangePicker||this.gridView.Jk)&&super.wXa()}}Object(x.a)(xg,"RangePickerTouchGrippiesBehavior",Ch,[]);class mg extends zh{constructor(A,ea){super(A);const Ma=document.createElement("div"),Vb=document.createElement("div");Ma.className=ea?Xf.tRh:Xf.vRh;Vb.className=
ea?Xf.uRh:Xf.sRh;A.appendChild(Ma);A.appendChild(Vb)}}Object(x.a)(mg,"RearrangeHighlightBehavior",zh,[]);var nd;(function(A){A[A.topLeft=0]="topLeft";A[A.topRight=1]="topRight";A[A.bottomLeft=2]="bottomLeft";A[A.bottomRight=3]="bottomRight";A[A.error=4]="error"})(nd||(nd={}));Object(x.b)("Corner",nd);class je extends zh{constructor(A,ea,Ma,Vb,tc){super(A);this.we=this.CI=null;this.n7=0;this.Bd=this.sourceRange=null;this.dYa=!1;this.onPointerDown=Jc=>{Jc=P.a(this.$).jg(Jc);if(this.sjg(Jc)&&!this.dYa){this.TDf();
this.we=this.Aq.hjc();this.CI=this.Aq.Ghf(Jc);if(!this.we||!this.CI||!this.CI.range)return k.ULS.shipAssertTag(537159361,0,!!this.we,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),k.ULS.shipAssertTag(537159360,0,!!this.CI,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),k.ULS.shipAssertTag(537159331,0,!!this.CI.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Bd=this.CI.range.clone();this.sourceRange=this.Bd.clone();
this.n7=this.gdf(Jc);if(4===this.n7)return k.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const ld=this.jff(Jc,!0);if(!ld)return k.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.MTe(ld))return k.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.KQa=!0;this.we.dH(!1);
this.iI.xZe(Jc.Nd);this.Aq.R1f(!0,this.afa.YW);this.we.textBox.removeSelection();this.we.z7b(this.llf);this.p5f();this.dYa=!0;Hg.b(this.$,!0)}return!0};this.Zk=Jc=>{Jc=P.a(this.$).jg(Jc);Jc=this.jff(Jc,!1);if(!Jc)return!0;Jc=this.MTe(Jc);if(!Jc)return k.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.fic(!0),!1;if(this.Bd.equals(Jc))return!0;this.Bd=Jc;Jc=this.lV();Jc||(k.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.fic(!0));return Jc};this.Li=Jc=>{P.a(this.$).jg(Jc);Jc=this.UZ();k.ULS.shipAssertTag(537159325,0,Jc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.fic(!Jc);return Jc};this.llf=()=>{this.fic(!0)};this.gridView=ea;this.$=ea.$;this.UN=[];this.ha=this.gridView.ha;this.iI=Ma;this.Aq=Vb;this.afa=tc;this.coloredReferencesManager=this.$.ea.Ba(281);k.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
if(this.$P=le.a.PF())ea=this.$.ea.Ba(464),k.ULS.shipAssertTag(510255176,0,!!ea,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.AD=ea.AD;for(const Jc of this.F$f())ea=this.Aq.Rdd(A,Jc,this.xDe(),this.onPointerDown),this.UN.push(ea);for(const Jc of this.UN)Bg.a.instance.ta(wb.a.lZ,Jc,this.iI.sof),Bg.a.instance.ta(wb.a.aE,Jc,this.iI.tof);this.m3a(tc)}dispose(){this.UN.forEach(A=>{Bg.a.instance.Aa(wb.a.pointerDown,A,
this.onPointerDown)});this.UN.length=0;super.dispose()}m3a(A){this.afa=A;this.GDe(A);this.Aq.RTb(A,this.UN,this.z3d());this.iI.b4()}jff(A,ea){const Ma=A.Nd;A=A.clientPoint;if(!Ma||!A)return k.ULS.shipAssertTag(537159324,0,!!Ma,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),k.ULS.shipAssertTag(537159323,0,!!A,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ea&&(A=this.dIf(A));ea=this.ha.ms(A,Ma,0,!0,!1,!0);ea||(A=this.dIf(A),ea=this.ha.ms(A,Ma,0,!0,!1,!0));
return ea}dIf(A){A.y+=0===this.n7||1===this.n7?2:-2;A.x+=0===this.n7||2===this.n7?2:-2;return A}MTe(A){if(!A||!this.sourceRange)return k.ULS.shipAssertTag(537159322,0,!!A,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),k.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.n7)return new wa.Range(A.top,A.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.n7)return new wa.Range(A.top,this.sourceRange.left,
this.sourceRange.bottom,A.right,!0,!1);if(2===this.n7)return new wa.Range(this.sourceRange.top,A.left,A.bottom,this.sourceRange.right,!0,!1);if(3===this.n7)return new wa.Range(this.sourceRange.top,this.sourceRange.left,A.bottom,A.right,!0,!1);k.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${nd[this.n7]}`);return null}UZ(){return this.$P?this.AD.NLb(this.we,this.CI,this.Bd):this.coloredReferencesManager.NLb(this.we,this.CI,this.Bd)}lV(){return this.UZ()}fic(A){A&&
k.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.iI.yZe(this.UN[0]);this.Aq.R1f(!1,this.afa.YW);this.we.textBox.setCaretPositionToEnd();this.we.TCc(this.llf);this.Dug();this.dYa=this.gridView.KQa=!1;Hg.b(this.$,!1);this.Aq.L3f()}}Object(x.a)(je,"ResizeMarqueeBehaviorBase",zh,[]);class ug extends je{constructor(A,ea,Ma,Vb,tc){super(A,ea,Ma,Vb,tc)}F$f(){return[Xf.zRh,Xf.ARh,Xf.xRh,
Xf.yRh]}xDe(){return[Xf.wRh]}gdf(A){A=A.Nd;if(A===this.UN[0])return 0;if(A===this.UN[1])return 1;if(A===this.UN[2])return 2;if(A===this.UN[3])return 3;k.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}p5f(){this.Aq.VQ(this.Zk,this.Li,!0)}Dug(){this.Aq.g$d(this.Zk,this.Li,!0)}sjg(A){return 2===(Z.a.ld=A.ud)&&A.kq===Sys.UI.MouseButton.leftButton}z3d(){return!0}TDf(){k.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}GDe(A){for(const ea of this.UN)ea.style.backgroundColor=
A.Ng.style.borderColor}}Object(x.a)(ug,"ResizeMarqueeMouseBehavior",je,[]);class kh extends je{constructor(A,ea,Ma,Vb,tc){super(A,ea,Ma,Vb,tc);this.vNb=()=>{const Jc=3===Z.a.ld;this.WEd&&!Jc?this.Aq.RTb(this.afa,this.UN,!1):!this.WEd&&Jc&&this.Aq.RTb(this.afa,this.UN,!0);this.WEd=Jc};this.bej=(Jc,ld)=>{ld.M$a===this.afa.YW&&this.Aq.RTb(this.afa,this.UN,!ld.start&&this.z3d())};Z.a.xCe(this.vNb);this.WEd=3===Z.a.ld;this.Aq.M_g(this.bej)}dispose(){Z.a.I7f(this.vNb);super.dispose()}F$f(){return[xh.a.BQh,
xh.a.AQh]}xDe(){const A=!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[A?xh.a.a5e:xh.a.$4e,xh.a.Ygc,A?xh.a.zQh:xh.a.Xgc]}gdf(A){A=A.Nd;if(A===this.UN[0])return 0;if(A===this.UN[1])return 3;k.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}p5f(){ja.a.WB?this.Aq.VQ(this.Zk,this.Li,!1):this.Aq.wxj(this.Zk,this.Li)}Dug(){ja.a.WB?this.Aq.g$d(this.Zk,this.Li,!1):this.Aq.Sfk(this.Zk,this.Li)}sjg(A){return 3===
(Z.a.ld=A.ud)}z3d(){return 3===Z.a.ld}TDf(){k.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}GDe(){}}Object(x.a)(kh,"ResizeMarqueeTouchBehavior",je,[]);class qh extends zh{constructor(A,ea){super(A);qh.cyb(A,zi.a.RQh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.horizontal);qh.cyb(A,zi.a.QQh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.vertical);qh.cyb(A,zi.a.NQh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.horizontal);
qh.cyb(A,zi.a.PQh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.vertical);qh.cyb(A,xh.a.OQh)}static cyb(A,ea,Ma){const Vb=document.createElement("div");Vb.className=ea;Ma&&(Vb.style.backgroundImage=`url("${Ma}")`);A.appendChild(Vb)}}Object(x.a)(qh,"SelectionCutCopyBehavior",zh,[]);class Xh extends zh{constructor(A){super(A);appChrome.renderSpinner(A)}}Object(x.a)(Xh,"SelectionPasteBehavior",zh,[]);class oh extends zh{constructor(A,ea){super(A);oh.tyb(A,zi.a.rRh+" "+xh.a.Jya,null===ea||void 0===ea?
void 0:ea.horizontal);oh.tyb(A,zi.a.qRh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.vertical);oh.tyb(A,zi.a.nRh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.horizontal);oh.tyb(A,zi.a.pRh+" "+xh.a.Jya,null===ea||void 0===ea?void 0:ea.vertical);oh.tyb(A,xh.a.oRh)}static tyb(A,ea,Ma){const Vb=document.createElement("div");Vb.className=ea;Ma&&(Vb.style.backgroundImage=`url("${Ma}")`);A.appendChild(Vb)}}Object(x.a)(oh,"SelectionRangePickerBehavior",zh,[]);class pi extends Ch{constructor(A,ea,Ma,Vb){super(A,
ea,Ma,Vb)}get I8(){return 0}get wib(){return this.gridView.ha.ra.Ye}wXa(){const A=this.gridView.Jk||this.gridView.Xc;return this.gridView.ha.ra.yj&&!A&&super.wXa()}}Object(x.a)(pi,"SelectionTouchGrippiesBehavior",Ch,[]);let ji=class extends gh.a{constructor(A,ea){super();this.lvb=(Ma,Vb)=>{Ma=Vb.I8;const tc=this.gridView;Vb=Vb.Xsi;const Jc=Vb.Ng,ld=Vb.J0;ja.a.Ki&&ld.push(new Bf(Jc,tc));switch(Ma){case 24:Vb.J0.push(new eg(Jc,Vb));break;case 0:Vb.J0.push(new $e(Jc,tc));ja.a.rr||(ld.push(new vd(Jc,
this.gridView.$,Vb.paneType,this.tableManager,this.Aq)),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7824744_ManualDragDropInPivotTables")&&ld.push(new pe(Jc,this.gridView.$,Vb.paneType,this.tableManager,this.Aq)));ld.push(new pi(Vb,Jc,tc,Vb.paneType));break;case 3:ld.push(new Ai(Jc));ja.a.rr||(ld.push(new H(Jc,this.gridView.$,Vb.paneType,this.iI,this.Aq,Vb)),ld.push(new ug(Jc,this.gridView,this.iI,this.Aq,Vb)),ld.push(new kh(Jc,this.gridView,this.iI,this.Aq,Vb)));break;case 4:case 5:ld.push(new qh(Jc,
this.WEe));break;case 30:ld.push(new Xh(Jc));break;case 16:ld.push(new oh(Jc,this.WEe));ld.push(new xg(Vb,Jc,tc,Vb.paneType));break;case 11:case 12:ld.push(new mg(Jc,11===Ma));break;case 17:ld.push(new Ai(Jc));break;case 19:ld.push(new Ai(Jc)),ld.push(new $h(Vb,Jc,tc,Vb.paneType))}Vb.C9b=!0};this.$=A;this.gridView=Qa.h(A);this.tableManager=ea;this.iI=new yf(this.gridView);this.Aq=new Yh(this.gridView);this.gridView.zd&&(this.gridView.zd.e_g(this.lvb),this.gridView.zd.update(!1));hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightsBehaviorManager",
!1)||A.ea.Ja(64,this)}get WEe(){hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.VEe&&(this.VEe={vertical:hd.a.current.gq(103),horizontal:hd.a.current.gq(104)});return this.VEe}dispose(){this.gridView.zd.ZBj(this.lvb);this.iI&&(this.iI.dispose(),this.iI=null);super.dispose()}};ji=Object(ra.a)([Object(Ib.d)(Yc.pb),Object(ra.b)(0,Object(Yc.R)()),Object(ra.b)(1,Object(Yc.Gc)())],ji);Object(x.a)(ji,"GridHighlightsBehaviorManager",gh.a,[]);class Qi extends Pb.a{constructor(A){super();
this.$=A;this.Md()}create(){const A=ea=>{this.qd(this.$.ea.Ba(64)||new ji(this.$,ea))};hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?void Ib.a.resolve(Yc.Gc,{Qa:this.Na}).then(A):Ed.TaskExtensions.ya(Ac.GetServiceTaskFactory.create(this.$.ea,134,this.ka,this.Na),ea=>A(ea.result),this.ka,3)}static la(A){A.ea.Ja(149,new Qi(A))}}Object(x.a)(Qi,"GridHighlightsBehaviorManagerFactory",Pb.a,[]);var Kh=a(564);class Hi{constructor(){this.UOc={}}fUg(A){this.UOc[A.id.toString()]=
A}H1i(A){const ea=this.UOc;for(let Ma in ea)ea[Ma].notify(A,!1);this.UOc={}}lrj(A,ea){ea&&this.fUg(ea);return this.uTf(A,ea)}Fid(A){this.H1i(A)}J_e(A,ea){A.notify(ea,!0)}}Object(x.a)(Hi,"AEventEmitter",null,[529]);var lj;(function(A){A[A.notStarted=0]="notStarted";A[A.waiting=1]="waiting";A[A.shouldRetry=2]="shouldRetry";A[A.complete=3]="complete"})(lj||(lj={}));Object(x.b)("EventResultState",lj);class Yi{constructor(){this._state=0}get state(){return this._state}set state(A){k.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:lj[this._state],["NewState"]:lj[A]},"ResultType",this.ehf());this._state=A}}Object(x.a)(Yi,"AEventResult",null,[600]);class ij extends Yi{constructor(){super();this.v1c=this.$qb=null;this.state=0;this.iVc=this.Vle=!1}get BU(){return this.$qb}get qsa(){return this.v1c}get Izi(){return this.Vle}ehf(){return"GetMoreInfo Result"}}Object(x.a)(ij,"GetMoreInfoResult",Yi,[601,600]);var Di=a(715),th=a(386),Wg=a(666),mj=a(587);class Vh{constructor(A,ea,
Ma,Vb,tc,Jc,ld,Zd){this.Oa=A;this.Ei=ea;this.FFg=Ma;this.g5=Vb;this.Uf=tc;this.MTc=Jc;this.wKg=ld;this.e5b=Zd}Twj(){this.Odb.Pd(pa.a.openUrlInNewTab,Fb.a.frame,Object(z.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.Odb.Pd(pa.a.jUa,Fb.a.frame,Object(z.a)(this,this.jUa,"openDocumentUrl"));G.AFrameworkApplication.tP?this.uDf():this.Odb.pg(pa.a.ofc,Fb.a.frame,Object(z.a)(this,this.ofc,"documentLoaded"),96)}openUrlInNewTab(A,ea,Ma,Vb,tc){tc&&tc.MenuItemId&&(k.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",
{["Id"]:tc.SourceControlId,["AppType"]:mj.a[this.pQ]}),Vi.a.Gg(tc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}jUa(A,ea,Ma,Vb,tc){if(tc&&tc.MenuItemId){const Jc=G.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),ld=G.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");k.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Jc,ld);if(Jc&&ld){k.ULS.sendTraceTag(592237458,202,
50,"Opening new tab {0}",{["Id"]:tc.SourceControlId,["AppType"]:mj.a[this.pQ]});A=tc.MenuItemId.toString();const Zd={};Zd[th.a.nVa]="1";Zd[th.a.documentUrl]=A;Zd[th.a.reason]=Wg.a.open;k.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");G.AFrameworkApplication.BT().execute(De=>{De.sendMessage(ba.a.s1,Zd)})}else this.openUrlInNewTab(A,ea,Ma,Vb,tc)}return 32}ofc(){this.uDf();return 32}Xfa(A,ea,Ma){Ma=void 0===Ma?"":Ma;if(ea&&ea.YH){const Vb=Di.a[ea.status];ea=
ea.YH.getTime();const tc=this.Ly()-ea;k.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:A,["RequestStatus"]:Vb,["ElapsedMs"]:tc,["StartTime"]:ea,["Notes"]:Ma})}else k.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:A})}uDf(){var A=G.AFrameworkApplication.fa.qa("QPGVCI"),ea=K.a.Tv(document.URL,"wdNewAndOpenCt",A);if(ea){ea=parseInt(ea);var Ma=K.a.Tv(document.URL,"wdPreviousSession",A);A=K.a.Tv(document.URL,
"wdPreviousCorrelation",A);var Vb=G.AFrameworkApplication.fa.qa("NAOPLP");if(G.AFrameworkApplication.tP){var tc=G.AFrameworkApplication.tP.getTime();!ea||ea>tc?k.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:ea,["DocumentLoadedTime"]:tc,["SessionId"]:Ma,["Correlation"]:A}):k.ULS.sendTraceTag(5849683,202,Vb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:tc-ea,["ClickTimestamp"]:ea,
["SessionId"]:Ma,["Correlation"]:A})}else k.ULS.sendTraceTag(5849681,202,Vb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:ea,["SessionId"]:Ma,["Correlation"]:A})}}get Odb(){return this.Oa.value}get fMb(){return this.Ei.value}get ZIf(){return this.FFg.value}get pQ(){return this.g5.value}get $vc(){return this.Uf.value}get Ly(){return this.MTc}get XY(){return this.wKg.value}get supportsGetMoreInfoForPersonalStorage(){return this.e5b.value}static get instance(){return Vh.La||
(Vh.La=Vh.HP())}static HP(){return new Vh(new Kh.a(()=>G.AFrameworkApplication.jd),new Kh.a(()=>G.AFrameworkApplication.mf),new Kh.a(()=>G.AFrameworkApplication.sa),new Kh.a(()=>G.AFrameworkApplication.sa.Sa.Xi),new Kh.a(()=>G.AFrameworkApplication.Lj),()=>(new Date).getTime(),new Kh.a(()=>G.AFrameworkApplication.sa.Sa.XY),new Kh.a(()=>G.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}Vh.La=null;Object(x.a)(Vh,"NewAndOpenCommonHelpers",null,[528]);class cj{constructor(A,ea,Ma){this.p4b=
this.Sk=null;this.H_c=0;this.pQg=A;this.Uf=ea;this.fie=Ma}t2g(){this.H_c=this.$hb+1}$Xd(A){this.Sk&&(this.Uf.hr(this.Sk),this.Sk=null);A&&(this.H_c=0)}B5j(A){const ea=this.U$j;0<=ea?(this.t2g(),this.$Xd(!1),this.Sk=new re.a(4,1,ea,A,107),this.Uf.Ah(this.Sk)):(this.$Xd(!0),k.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.fie}))}get $hb(){return this.H_c}get U$j(){return this.$hb>=this.yeg.length?-1:this.yeg[this.$hb]}get yeg(){if(!this.p4b){const A=(this.pQg.value||"0").split(",");
this.p4b=[];for(let ea=0;ea<A.length;ea++){const Ma=parseInt(A[ea]);isNaN(Ma)?k.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.fie,["Entry"]:A[ea]}):Array.add(this.p4b,Ma)}}return this.p4b}}Object(x.a)(cj,"RetryHelper",null,[]);class uh extends Hi{constructor(A,ea){super();this.Q5=A;this.zrb=new cj(ea,this.ILb.$vc,"GetMoreInfo");this.Yq=new ij}BWi(){this.uId("Document opened")}hsh(A){return()=>{this.uId(A,!0)}}uTf(A,ea){ea=void 0===ea?null:ea;
k.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:A});3===this.Yq.state?(ea&&this.J_e(ea,this.Yq),k.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:A})):this.uId(A);return this.Yq}uId(A,ea){this.zrb.$Xd(!(void 0===ea?0:ea));1===this.Yq.state?k.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:A,["RetryIndex"]:this.zrb.$hb}):(k.ULS.sendTraceTag(5849621,202,50,
"Making GetMoreInfo request {0}",{["Trigger"]:A,["RetryIndex"]:this.zrb.$hb}),this.Yq.state=1,ea=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.ILb.XY,G.AFrameworkApplication.tk),this.ILb.fMb.r6(ea,1,null,null,[uh.pse,uh.pwe],!1,5,this.orh(),this.nrh(A),null))}orh(){return A=>{var ea=!1;let Ma=!1;var Vb=!1,tc;if(G.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody"))if(A.data.Lf){let Jc=I.d(A.data.Lf);({zu:tc}=Jc);Jc.returnValue?tc?(Vb=!0,this.Yq.v1c=tc.StorageServiceDisplayName,this.Yq.$qb=
uh.Qyf(tc.PersonalFileStorageUrl)?tc.PersonalFileStorageUrl:"",""===this.Yq.BU&&"SharePointOnlineConsumer"===G.AFrameworkApplication.fa.Ta("FileSource")&&(this.Yq.$qb=K.a.V3(G.AFrameworkApplication.breadcrumbFolderUrl)),ea=""===this.Yq.BU&&""!==this.Yq.qsa):k.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):k.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else k.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");Vb||((tc=A.data.responseHeaders)?(this.Yq.v1c=(tc[uh.pwe]||"").toString(),ea=(tc[uh.pse]||"").toString(),this.Yq.$qb=uh.Qyf(ea)?ea:"",""===this.Yq.BU&&"SharePointOnlineConsumer"===G.AFrameworkApplication.fa.Ta("FileSource")?(this.Yq.$qb=K.a.V3(G.AFrameworkApplication.breadcrumbFolderUrl),ea=""===this.Yq.BU&&""!==this.Yq.qsa):ea=""===ea&&""!==this.Yq.qsa):(k.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),Ma=!0));Vb=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.zrb.$hb,Ma,ea,Vb);this.ILb.Xfa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",A.data,Vb);this.Peg(3,ea,Ma)}}nrh(A){return ea=>{this.ILb.Xfa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",ea.data,"Failure");this.Peg(2);this.zrb.B5j(this.hsh(A))}}Peg(A,ea,Ma){this.Yq.state=A;this.Yq.Vle=void 0===
ea?!1:ea;this.Yq.iVc=void 0===Ma?!1:Ma;this.Fid(this.Yq)}get ILb(){return this.Q5.value}static get instance(){return uh.La||(uh.La=uh.HP())}static HP(){return new uh(new Kh.a(()=>Vh.instance),new Kh.a(()=>G.AFrameworkApplication.Zbi))}static Qyf(A){if(!A)return k.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Sa.a.Im(A).startsWith("https://"))return!0;k.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}uh.pse="PersonalFileStorageUrl";
uh.pwe="StorageServiceDisplayName";uh.La=null;Object(x.a)(uh,"GetMoreInfoActor",Hi,[]);class ci{constructor(A,ea,Ma,Vb,tc){this.bLg=6E4;this.gpf="inactive";this.gze="active";this.OV=!0;this.Uf=A;this.cKg=ea;this.MTc=Ma;this.v5b=Vb;this.Za=new $f.a;tc&&this.s5j();this.aoe=this.Eef()}Zze(A){this.Za.addHandler(this.gze,A)}IWg(A){this.Za.addHandler(this.gpf,A)}s5j(){const A=new re.a(5,2,this.bLg,Object(z.a)(this,this.zui,"inactiveLoop"),108);this.Aui.Ah(A)}zui(){const A=this.Eef(),ea=this.Ly()-A;ea>this.BKc&&
this.OV&&(k.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ea}),this.OV=!1,this.Za.raiseEvent(this.gpf));A-this.aoe>this.BKc&&(this.OV=!0,this.Za.raiseEvent(this.gze));this.aoe=A}get Aui(){return this.Uf.value}get Eef(){return this.cKg}get Ly(){return this.MTc}get BKc(){return this.v5b.value}static get instance(){return ci.La||(ci.La=ci.HP())}static HP(){return new ci(new Kh.a(()=>sb.a.instance),()=>G.AFrameworkApplication.qFd.getTime(),()=>(new Date).getTime(),
new Kh.a(()=>G.AFrameworkApplication.BKc),!0)}}ci.La=null;Object(x.a)(ci,"InactivityManager",null,[]);var dj=a(978);class kg extends Yi{constructor(){super();this.kqe=this.mqe=this.lqe=null;this.state=this.gxe=0;this.iVc=!1}get RJd(){return this.lqe}get hIf(){return this.mqe}get QJd(){return this.kqe}get $$j(){return this.gxe}ehf(){return"MruActor Result"}}Object(x.a)(kg,"MruResult",Yi,[599,600]);class Ji{constructor(A,ea,Ma){this.task=null;this.hoc=A;this.oYi=ea;this.taskManager=Ma;this.retryCount=
this.rGb=0;this.UZc=this.OJb=null}DIi(A,ea){return A===L.a.$md||20===ea||18===ea||3===ea}VJi(A){return 3===A||5===A||6===A||7===A||9===A||10===A||11===A||12===A||13===A||14===A||15===A||16===A||23===A||26===A||27===A||28===A}get IAc(){return this.UZc}reset(){this.rGb=this.retryCount=0;this.UZc=this.OJb=null;this.task&&(this.taskManager.hr(this.task),this.task=null)}Nyi(A,ea,Ma,Vb){this.UZc=String.format("{0}_{1}",Ma,Vb);if(this.retryCount>=this.oYi)return k.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),
!1;if(this.DIi(Ma,Vb))return k.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.VJi(Vb)&&1<=this.rGb)return this.OJb=Ma,!1;ea=Math.max(ea,this.hoc*Math.pow(2,this.rGb));if(26===Vb)ea=Math.max(ea,3E4);else if(27===Vb||28===Vb)ea=Math.max(ea,6E4);9===Vb||412===Ma&&(null==this.OJb||412!==this.OJb)?ea=500:this.rGb+=1;this.OJb=Ma;this.retryCount+=1;this.task&&this.taskManager.hr(this.task);k.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
ea);this.task=new re.a(2,1,ea,A,107);this.taskManager.Ah(this.task);return!0}}Object(x.a)(Ji,"RetryManager",null,[]);class mi{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(x.a)(mi,"WriteOptions",null,[]);class bh extends Hi{constructor(A,ea,Ma,Vb,tc,Jc,ld){super();this.Q5=A;this.XMg=ea;this.uva=new Ji(G.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),G.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.kz.$vc);this.Yva=new Ji(G.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),G.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.kz.$vc);this.oPg=Ma;this.Cye=Vb;this.ATg={};this.SV=new kg;this.ZJg=tc;this.C2b="";this.ny=Jc;this.jje=ld;this.pPg=G.AFrameworkApplication.fa.Af("WordRecentLinksCount",25)}get bOc(){return this.ATg}Syj(){this.kz.Odb.Pd(pa.a.renameMostRecentlyUsedFileEntry,Fb.a.frame,
Object(z.a)(this,this.$Dj,"renameMruEntry"))}$Dj(){return this.Ice("Rename")}LWi(){this.kGf("File Opened")}MWi(){this.kGf("IntervalUpdate")}kGf(A){k.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:A});this.Ice(A)}o8(A){(A=Sa.a.o8(A))&&A.startsWith(".")&&(A=A.substring(1,A.length));return A}qjc(){switch(this.kz.pQ){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Oki(A){var ea=this.ZJg();
if(!ea)return null;const Ma=new mi;Ma.documentUrl=this.jje.value?encodeURI(ea):ea;Ma.mruItemId=this.C2b;Ma.app=this.qjc();if(ea=this.ny())Ma.folderName=ea.breadcrumbFolderName,ea=ea.zp,Ma.documentName=Sa.a.Ur(ea),Ma.documentExt=this.o8(ea);A&&(Ma.documentName?Ma.documentName.length?255<=Ma.documentName.length?A.set("DocumentNameLength","Long"):2084<=Ma.documentName.length&&A.set("DocumentNameLength","VeryLong"):A.set("DocumentNameLength","0"):A.set("DocumentNameLength","Null"));return JSON.stringify(Ma)}Ice(A,
ea){ea=void 0===ea?!1:ea;if(4===this.kz.pQ&&!G.AFrameworkApplication.kya)return 2;var Ma=U.a.Pt();Ma&&(Ma.set("Trigger",A),Ma.set("IsRetry",ea?"true":"false"),Ma.set("MruIdSent",this.C2b?"true":"false"),Ma.set("URLEncoded",this.jje.value?"true":"false"));F.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Ma);A=this.Oki(Ma);if(!A)return ea=!G.AFrameworkApplication.webEditingEnabled,Ma&&(Ma.set("WebEditingIsEnabled",G.AFrameworkApplication.webEditingEnabled?"true":"false"),Ma.set("ProtectedFile",
G.AFrameworkApplication.VAc?"true":"false")),F.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ea,!1,Object.assign(new Ka.a,{extendedProperties:Ma})),2;this.Yva&&!ea&&this.Yva.reset();Ma=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.kz.XY,this.localeName);this.Cye?this.bOc["X-FileId"]=G.AFrameworkApplication.tk:Ma+=String.format("&{0}",G.AFrameworkApplication.tk);G.AFrameworkApplication.fe&&(this.bOc["X-Office-AudienceGroup"]=Object(y.a)(String,G.AFrameworkApplication.fe.AudienceGroup)||
"");this.bOc["X-Timeout"]=15E3;return this.kz.fMb.Vo(Ma,2,A,this.bOc,!0,5,Object(z.a)(this,this.Hpk,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.Lvh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}Hpk(A){this.rlf(A.data)}rlf(A){const ea=U.a.Pt();this.Yva&&(ea&&this.Yva.IAc&&(ea.set("LastError",this.Yva.IAc),ea.set("NumRetries",this.Yva.retryCount.toString())),this.Yva.reset());const Ma=dj.c(A.Lf);Ma&&Ma.diagnostics_data&&(this.C2b=Ma.diagnostics_data.mru_id);
A=+A.a7-+A.YH;ea&&ea.set("RequestDuration",A.toString());F.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Ka.a,{extendedProperties:ea}))}Lvh(A){if(A.data.httpStatus===L.a.xyb)this.rlf(A.data);else{var ea=A.data.httpStatus===L.a.nPb,Ma=U.a.Pt();this.Elf(this.Yva,A,this.zvh(),Ma);Ma&&(Ma.set("StatusCode",A.data.httpStatus.toString()),ea||this.l4c(A.data,Ma));F.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",A.data.httpStatus),ea,!1,Object.assign(new Ka.a,
{extendedProperties:Ma}))}}zvh(){return()=>{this.Ice("Retry",!0)}}gci(){this.Suc("Polling")}fci(){this.Suc("Retry",!0)}DWi(){this.Suc("Open")}CWi(){this.Suc("Activity")}Suc(A,ea){ea=void 0===ea?!1:ea;var Ma=void 0===Ma?!1:Ma;k.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:A});const Vb=U.a.Pt();Vb&&(Vb.set("Trigger",A),Vb.set("IsRetry",ea?"true":"false"),Ma&&Vb.set("RecentLinks","true"));F.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Vb);this.uva&&!ea&&this.uva.reset();
Ma?this.oTe(Object(z.a)(this,this.hci,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(z.a)(this,this.dci,"getMruForRecentLinksFromServerFailureCallback"),!0):this.oTe(Object(z.a)(this,this.ici,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.eci,"getMruFromServerFailureCallback"))}l4c(A,ea){A&&A.responseHeaders&&(A=A.responseHeaders["X-CorrelationId"])&&ea.set("ServerCorrelationId",A)}qTi(A,ea){A&&(ea&&ea.set("RequestDuration",(+A.a7-+A.YH).toString()),F.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new Ka.a,{extendedProperties:ea})))}ici(A){this.lff(A)}lff(A,ea){ea=void 0===ea?!1:ea;var Ma="";let Vb=null,tc=null,Jc=null;const ld=dj.c(A.data.Lf);ld&&(Vb=ld.places?ld.places.items:[],tc=ld.documents?ld.documents.items:[],(Jc=dj.a(ld,ea))&&(Ma=I.c(Jc)));G.AFrameworkApplication.sa&&G.AFrameworkApplication.sa.Sa.R2&&Wd.c()&&!ea&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ma,!0));Ma=U.a.Pt();this.uva&&(Ma&&this.uva.IAc&&(Ma.set("LastError",this.uva.IAc),Ma.set("NumRetries",
this.uva.retryCount.toString())),this.uva.reset());ea&&Ma&&Ma.set("RecentLinks","true");Jc||Vb||tc?(ea?this.kz.Xfa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",A.data,"Success"):this.kz.Xfa("MruActor.GetMruV2FromServerSuccessCallback",A.data,"Success"),this.AMc(3,Jc,Vb,tc),this.qTi(A.data,Ma)):(ea?this.kz.Xfa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",A.data,"Failure: Invalid JSON"):this.kz.Xfa("MruActor.GetMruV2FromServerSuccessCallback",A.data,"Failure: Invalid JSON"),
Ma&&this.l4c(A.data,Ma),F.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Ka.a,{extendedProperties:Ma})),this.AMc(3,null,null,null,!0));this.Fid(this.SV)}hci(A){this.lff(A,!0)}Elf(A,ea,Ma,Vb){let tc=0,Jc=0;const ld=dj.c(ea.data.Lf);ld&&(null!=ld.response_code&&(tc=ld.response_code,Vb&&Vb.set("MruResponseCode",tc.toString()),9===tc&&(this.C2b="")),ld.error_data&&null!=ld.error_data.retry_after_ms&&(Jc=ld.error_data.retry_after_ms,Vb&&Vb.set("ExpectedRetryAfter",
Jc.toString())));A&&(ea=A.Nyi(Ma,Jc,ea.data.httpStatus,tc),Vb&&(Vb.set("CurrentRetryCount",A.retryCount.toString()),Vb.set("RetryScheduled",ea?"true":"false")))}eci(A){this.kff(A)}kff(A,ea){ea=void 0===ea?!1:ea;const Ma=A.data.httpStatus===L.a.nPb,Vb=U.a.Pt();Vb&&(Vb.set("StatusCode",A.data.httpStatus.toString()),ea&&Vb.set("RecentLinks","true"),Ma||this.l4c(A.data,Vb));ea?this.kz.Xfa("MruActor.GetMruForRecentLinksFromServerFailureCallback",A.data,"Failure"):this.kz.Xfa("MruActor.GetMruFromServerFailureCallback",
A.data,"Failure");this.AMc(2);this.Elf(this.uva,A,Object(z.a)(this,this.fci,"getMruFromServerRetryTask"),Vb);F.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",A.data.httpStatus),Ma,!1,Object.assign(new Ka.a,{extendedProperties:Vb}));this.Fid(this.SV);G.AFrameworkApplication.sa&&G.AFrameworkApplication.sa.Sa.R2&&Wd.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ea||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}dci(A){this.kff(A,
!0)}AMc(A,ea,Ma,Vb,tc){if(3!==this.SV.state||3===A)this.SV.lqe=void 0===ea?null:ea,this.SV.mqe=void 0===Ma?null:Ma,this.SV.kqe=void 0===Vb?null:Vb,this.SV.state=A,this.SV.iVc=void 0===tc?!1:tc,this.SV.gxe=this.kz.Ly()}uTf(A,ea){k.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:A,["ResultState"]:this.SV.state});ea&&3===this.SV.state&&this.J_e(ea,this.SV);return this.SV}oTe(A,ea,Ma){Ma=void 0===Ma?!1:Ma;this.AMc(1);let Vb;const tc={};Vb=Ma?String.format(this.kz.XY+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.pPg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.kz.XY+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.qjc(),this.localeName);this.oPg.value||(Vb+="&entity=docs");G.AFrameworkApplication.fe&&(tc["X-Office-AudienceGroup"]=Object(y.a)(String,G.AFrameworkApplication.fe.AudienceGroup)||"");Ma&&(tc["X-Office-Application"]="147");this.Cye?tc["X-FileId"]=G.AFrameworkApplication.tk:Vb+=String.format("&{0}",G.AFrameworkApplication.tk);this.kz.fMb.Vo(Vb,1,null,tc,
!0,5,A,ea,null)}get kz(){return this.Q5.value}get localeName(){return this.XMg.value}static get instance(){return bh.La||(bh.La=bh.HP())}static HP(){return new bh(new Kh.a(()=>Vh.instance),new Kh.a(()=>Wf.a.XM(G.AFrameworkApplication.lcid).name),new Kh.a(()=>G.AFrameworkApplication.sa.Sa.Tx),G.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>G.AFrameworkApplication.sa.Sa.Gv,()=>G.AFrameworkApplication.Bo,new Kh.a(()=>G.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}bh.La=null;Object(x.a)(bh,
"MruActor",Hi,[]);class ch{constructor(){this.Fsb=this.qte=this.Rc=null;this.So=!1}get name(){return"Common.App.NewAndOpen.Core"}Oj(A){this.Rc=A;A.register(528,"Common.INewAndOpenCommonHelpers").se().Ae(()=>Vh.instance);A.register(529,"Common.IEventEmitter<Common.IGetMoreInfoResult>").se().Ae(()=>uh.instance);A.register(529,"Common.IEventEmitter<Common.IMruResult>").se().Ae(()=>bh.instance)}init(){G.AFrameworkApplication.fa.Xw(()=>{this.aGb()})}aGb(){this.Rc.resolve("Common.INewAndOpenCommonHelpers");
this.Rc.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Rc.resolve("Common.IEventEmitter<Common.IMruResult>");var A=!1;Vh.instance.Twj();G.AFrameworkApplication.Mpa&&(A=!0);G.AFrameworkApplication.f3f&&(bh.instance.DWi(),0<G.AFrameworkApplication.iIf&&this.BAe(),this.RVj(),A=!0);G.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&A&&uh.instance.BWi();G.AFrameworkApplication.hjk&&(A=bh.instance,A.Syj(),A.LWi(),sb.a.instance.Ah(this.ijk))}RVj(){ci.instance.Zze(Object(z.a)(bh.instance,
bh.instance.CWi,"makeGetMruRequestActivityTrigger"));ci.instance.Zze(Object(z.a)(this,this.BAe,"addGetMruFromServerTask"));ci.instance.IWg(Object(z.a)(this,this.Nyh,"deleteGetMruFromServerTask"))}Nyh(){sb.a.instance.hr(this.jIf)}BAe(){sb.a.instance.Ah(this.jIf)}get jIf(){return this.qte||(this.qte=new re.a(5,2,G.AFrameworkApplication.iIf,Object(z.a)(bh.instance,bh.instance.gci,"getMruFromServerTask"),109))}get ijk(){return this.Fsb||(this.Fsb=new re.a(2,2,6E4*G.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",
1440),Object(z.a)(bh.instance,bh.instance.MWi,"makeUpdateMruTask"),197))}dispose(){this.So||(this.So=!0,this.Fsb&&(sb.a.instance.hr(this.Fsb),this.Fsb=null))}}Object(x.a)(ch,"CorePackageManager",null,[3,4,5]);var nj=a(809);class Qh{constructor(A,ea){this.M0c=this.L0c=null;this.S1a=new Mf.a;this.Ei=A;this.bKa=ea.appSettings[Qh.Kok]||""}get QWj(){return this.S1a.task}get T6(){return this.Ei.value}qGj(){const A={};A[Qh.xqi]=G.AFrameworkApplication.tk;A["Content-Type"]="application/json; charset=utf-8";
k.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ea=K.a.Om(this.bKa+Qh.RWj,Qh.g3i,G.AFrameworkApplication.sa.Sa.Xi.toString());this.T6.Vo(ea,1,"",A,!0,2,Object(z.a)(this,this.cOb,"onSuccessCallback"),Object(z.a)(this,this.gNb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}STi(A){try{const ea={};ea.FlightName=A.FlightName;ea.SessionID=A.SessionID;k.ULS.sendTraceTag(594883776,215,50,I.c(ea))}catch(ea){k.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}cOb(A){if((A=A.data.Lf)&&A.length)try{const ea=I.a(A);this.L0c=ea.NavBarDataJson;k.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.L0c?(()=>{let Ma=I.d(ea.NavBarDataJson);({zu:this.M0c}=Ma);return Ma})().returnValue?(this.STi(this.M0c),this.S1a.setResult(this.M0c)):(k.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:nj.a.flb(this.L0c)}),this.S1a.iw()):(k.ULS.sendTraceTag(9000737,215,
15,"ShellData is null"),this.S1a.iw())}catch(ea){k.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.S1a.iw()}else k.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}gNb(){this.S1a.iw();k.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Qh.La||(Qh.La=Qh.jna())}static jna(){return new Qh(new Kh.a(()=>G.AFrameworkApplication.mf),G.AFrameworkApplication.fa,G.AFrameworkApplication.sa.Sa.Xi)}}
Qh.xqi="X-qs";Qh.g3i="at";Qh.RWj="O365ShellServiceProxy.ashx";Qh.La=null;Qh.Kok="ShellWebServiceBase";Object(x.a)(Qh,"O365ShellActor",null,[532]);class Zi{constructor(){this.Rc=null}get name(){return"Common.App.O365Shell"}Oj(A){this.Rc=A;this.Rc.register(Qh,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").se().Ae(()=>new Qh(new Kh.a(()=>G.AFrameworkApplication.mf),G.AFrameworkApplication.fa,G.AFrameworkApplication.sa.Sa.Xi))}init(){G.AFrameworkApplication.fa.Xw(Object(z.a)(this,
this.VD,"onFullAppSettingsReady"))}VD(){G.AFrameworkApplication.useO365ShellService&&G.AFrameworkApplication.sa.Sa.Yv&&this.Rc.resolve("Common.App.O365Shell.O365ShellActor").qGj()}dispose(){}static main(){Ta.a.instance.Mk(new Zi)}}Object(x.a)(Zi,"PackageManager",null,[3,4]);var ih=a(490),oj=a(534),pj=a(185),ej=a(191),ni=a(77);class Yg extends ki.a{constructor(A,ea,Ma,Vb){super(A);this.Mpg=[6];this.Ipg=[26];this.Ls=null;this.fIb=this.msc=!1;this.Ju=this.Sea=null;this.onPointerDown=tc=>{if(1!==this.$.Ha.iK())return!0;
tc=P.a(this.$).jg(tc);if(this.LD)return!0;var Jc=Rc.a(this.$).WAd||Rc.a(this.$).qr();if(this.VCd||Jc)return this.Nhb(),!0;this.Ju=this.pp;this.fVd();this.$vd();Jc=2===tc.ud&&tc.kq===Sys.UI.MouseButton.leftButton;const ld=3===tc.ud;if(Jc||ld)tc=this.ha.ms(tc.clientPoint,tc.Nd,5,void 0,void 0,!0),tc||(tc=this.Ju),this.fIb=Jc,this.msc=ld,this.Ju=this.hjf(tc),this.$vd(),Jc?this.Qxj():ld&&this.Iyj(),Hg.b(this.$,!0);return!0};this.Zk=tc=>{tc=P.a(this.$).jg(tc);if(!this.LD)return!1;let Jc=this.fIb?this.ha.ms(tc.clientPoint,
tc.Nd,5,void 0,void 0,!0):this.ha.ms(tc.clientPoint,tc.Nd,5,!0,!1,!0);Jc||(Jc=this.ha.Rub(tc.clientPoint,tc.Nd,5));Jc&&(tc=this.hjf(this.pub(Jc)),this.Y9b(tc.bottomRight),this.Ju.equals(tc)||(this.Ju=tc,this.JQb(!1),this.fVd(!1),this.$vd(!1),this.Rsi(),this.zd.update(!1)),this.Lhk(this.Ju));return!0};this.Li=tc=>{P.a(this.$).jg(tc);if(!this.LD)return!1;this.resizeTable();this.Nhb();return!0};this.hOb=tc=>{P.a(this.$).jg(tc);if(!this.LD)return k.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),
!1;this.resizeTable();this.Nhb();return!0};this.Cga=tc=>{P.a(this.$).jg(tc);this.Nhb();return!0};this.mMf=()=>{this.LD&&this.Nhb()};this.gridView=ea;this.$=ea.$;this.tableManager=Vb;this.ha=ea.ha;this.zd=ea.zd;this.parentElement=A;this.fbh();ja.a.rr||ja.a.J2||Bg.a.instance.ta(wb.a.pointerDown,this.Sea,this.onPointerDown);this.pp=Ma;this.tWc=this.VCd=!1;this.tableManager.VYg(this.mMf)}get LD(){return this.fIb||this.msc}get eyf(){return this.tWc}dispose(){this.Nhb();this.tableManager.YAj(this.mMf);
this.eyf||ja.a.rr||ja.a.J2||Bg.a.instance.Aa(wb.a.pointerDown,this.Sea,this.onPointerDown);if(this.LD){Hg.b(this.$,!1);try{this.jy()}catch(A){k.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${A}`)}}this.parentElement&&this.parentElement.contains(this.Sea)&&this.parentElement.removeChild(this.Sea);this.Sea=this.parentElement=null;super.dispose()}hjf(A){const ea=A.bottom-this.pp.topLeft.bottom-1;return 0<=A.right-this.pp.topLeft.right+
1&&0<=ea&&A.bottom>=this.pp.top&&A.right>=this.pp.left?new wa.Range(this.pp.top,this.pp.left,A.bottom,A.right,!1,!1):this.Ju}$vd(A){this.rGc([this.Ju],6,void 0===A?!0:A);this.zd.tt(this.Mpg)}JQb(A){A=void 0===A?!0:A;this.zd.Sl(this.Mpg);this.rGc([null],6,A)}fVd(A){A=void 0===A?!0:A;this.zd.Sl(this.Ipg);this.rGc([null],26,A)}Rsi(){var A=!1;A=void 0===A?!0:A;const ea=this.I8j();0<ea.length&&(this.rGc(ea,26,A),this.zd.tt(this.Ipg))}I8j(){const A=[];this.pp.contains(this.Ju)&&(this.pp.right!==this.Ju.right&&
A.push(new wa.Range(this.pp.top,this.Ju.right+1,this.Ju.bottom,this.pp.right,!1,!1)),this.pp.bottom!==this.Ju.bottom&&A.push(new wa.Range(this.Ju.bottom+1,this.pp.left,this.pp.bottom,this.pp.right,!1,!1)));return A}resizeTable(){if(!this.Ju.equals(this.pp)){const A=new wa.Range(this.pp.top,this.pp.left,this.Ju.bottom,this.Ju.right,!1,!1);this.Tck(A);this.VCd=!0}}onKeyDown(A){P.a(this.$).jg(A);return!0}UMd(){this.eyf&&(ja.a.rr||ja.a.J2||(Bg.a.instance.ta(wb.a.pointerDown,this.Sea,this.onPointerDown),
this.Sea.classList.remove("ewr-table-resize-default-cursor"),this.tWc=this.Sea.disabled=!1),this.tWc=!1)}fbh(){const A=document.createElement("div");A.className="ewr-table-resize-handle";const ea=document.createElement("div");ea.className="ewr-table-resize-fillhandle-higher";const Ma=document.createElement("div");Ma.className="ewr-table-resize-fillhandle-broader";A.appendChild(ea);A.appendChild(Ma);this.Sea=A;this.parentElement.appendChild(this.Sea)}Y9b(A){let ea=60;const Ma=this.Ju.contains(A);let Vb=
A.top,tc=A.bottom,Jc=A.left,ld=A.right,Zd=null;if(Ma){if(this.gridView.DK(this.pp.topLeft)&&!this.pp.nFa)return;A.bottom<this.Ju.bottom?(Vb=Math.max(1,tc-2,this.pp.top),ea=16):(Jc=Math.max(1,ld-2,this.pp.left),ea=4);tc=Vb;ld=Jc;Zd=new wa.Range(Vb,Jc,Vb,Jc,!1,!1)}else A.right>=this.pp.right?(ld+=2,ea=8):A.bottom>=this.pp.bottom&&(tc+=2,ea=32),Vb=tc,Jc=ld,Zd=new wa.Range(tc,ld,tc,ld,!1,!1),ea=16;this.gridView.DK(Zd)||(this.Ls?this.Ls.Go||(this.Ls=Na.a.instance.create(()=>{this.gridView.Oy(Zd,ea,"TableResizeBehavior.BringRangeIntoView")},
40,nb.a.Kpg)):this.Ls=Na.a.instance.create(()=>{this.gridView.Oy(Zd,ea,"TableResizeBehavior.BringRangeIntoView")},40,nb.a.Kpg))}pub(A){let ea=A;if(this.gridView.Tc.qY){if(!this.gridView.yd(A.topLeft)){const Ma=this.gridView.xj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.pT,this.Ju.top!==A.top?1:2);try{Ma.Bm=this.Ju.top<A.top||this.Ju.left<A.left,Ma.Vx(A.topLeft),ea=Ma.$$cu().range}finally{Ma&&Ma.dispose()}}ea.right=ea.left+A.width-1;ea.bottom=ea.top+A.height-1}return ea}rGc(A,ea,Ma){Ma=
void 0===Ma?!0:Ma;const Vb=[];for(const tc of A)Vb.push(new Ud.a(tc,wd.d(this.$.na)));this.zd.AC(Vb,[ea],!0,void 0,Ma)}Qxj(){Bg.a.instance.ta(wb.a.vn,document.documentElement,this.Zk);for(const A of this.gridView.Mp)Bg.a.instance.ta(wb.a.vn,A.domElement,this.Zk);Bg.a.instance.ta(wb.a.ri,document.documentElement,this.Li);this.TXe()}Iyj(){wh.a.instance.ta(wb.a.xi,document.documentElement,this.Zk);for(const A of this.gridView.Mp)wh.a.instance.ta(wb.a.xi,A.domElement,this.Zk);wh.a.instance.ta(wb.a.hg,
document.documentElement,this.hOb);this.TXe()}jy(){this.fIb&&this.Xfk();this.msc&&this.igk()}Xfk(){Bg.a.instance.Aa(wb.a.vn,document.documentElement,this.Zk);for(const A of this.gridView.Mp)Bg.a.instance.Aa(wb.a.vn,A.domElement,this.Zk);Bg.a.instance.Aa(wb.a.ri,document.documentElement,this.Li);this.s4f()}igk(){wh.a.instance.Aa(wb.a.xi,document.documentElement,this.Zk);for(const A of this.gridView.Mp)wh.a.instance.Aa(wb.a.xi,A.domElement,this.Zk);wh.a.instance.Aa(wb.a.hg,document.documentElement,
this.hOb);this.s4f()}TXe(){this.gridView.cellTextEditBox.Tfc(!0)}s4f(){this.gridView.cellTextEditBox.Tfc(!1)}Tck(A){this.$.Fe(-1400250766,Z.a.ld,30,{["ResizeTableRange"]:A,["OriginalTableRange"]:this.pp})}Lhk(A){if(!this.pp.contains(A)){A=this.H8j();for(const ea of A)if(this.tableManager.xDd(ea)){this.gridView.Ti.Ar(Gb.a.u1i);return}}this.gridView.rtl?this.gridView.Ti.Ar(Gb.a.A0i):this.gridView.Ti.Ar(Gb.a.U2i)}Nhb(){if(this.LD){Hg.b(this.$,!1);try{this.jy()}catch(A){k.ULS.sendTraceTag(537151232,0,
10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${A}`)}}this.Ls&&(this.Ls.cancel(),this.Ls.dispose());this.msc=this.fIb=!1;this.JQb();this.fVd();Hg.b(this.$,!1);this.gridView.Ti.Ar(Gb.a.jY)}H8j(){const A=[];this.pp.right!==this.Ju.right&&A.push(new wa.Range(this.pp.top,this.pp.right+1,this.Ju.bottom,this.Ju.right,!1,!1));this.pp.bottom!==this.Ju.bottom&&A.push(new wa.Range(this.pp.bottom+1,this.pp.left,this.Ju.bottom,this.pp.right,!1,!1));return A}static createInstance(A,
ea,Ma,Vb){if(!ea)return null;const tc=A.zd;tc.AC(Ma,[27],!0);tc.tt(Yg.A8j);Ma=tc.DF(27,A.Tc.Rj(ea.bottomRight),Yg.w7h(ea,Ma)).Ng;return new Yg(Ma,A,ea,Vb)}static w7h(A,ea){var Ma;for(let Vb=0;Vb<ea.length;Vb++)if((null===(Ma=ea[Vb])||void 0===Ma?0:Ma.range)&&ea[Vb].range.equals(A))return Vb;return 0}}Yg.A8j=[27];Object(x.a)(Yg,"TableResizeBehavior",ki.a,[]);class fj{}fj.$Nh="ewa-ttrd-buttonarea";Object(x.a)(fj,"CssClassNames",null,[]);var Cj=a(142),Ki=a(143),Dj=a(280);class fh extends Wi.a{constructor(A){super(document.createElement("div"));
this.E3c=this.$zd=this.HXf=this.ET=!1;this.o_d=null;this.Fg=()=>{Ie.c(this.$,this.gridView.ha.ra.activeCell)?(this.XQa=!0,this.Zxb(!1)):(this.E2=this.XQa=!1,this.Qug())};this.Nu=()=>{this.XQa?this.Zxb(!0):this.E2=!1};this.NCa=()=>{this.E3c=!0;this.XQa&&(this.E2=!1)};this.onContentReady=()=>{this.$.isEditMode?Ie.c(this.$,this.gridView.ha.ra.activeCell)&&(this.XQa=!0,this.Zxb(!1)):this.E2=!1};this.i$=()=>{this.E3c=!1;this.XQa?this.Zxb(!1):this.E2=!1};this.ih=(ea,Ma)=>{this.XQa&&(ea=this.gridView.tfb(Ma.Re.block.Pf.BlockCachePosition.PaneType).wE(Ma.Re.hash))&&
(ea.CWd(this.Umf),ea.W5c(this.Umf))};this.Umf=()=>{this.z8f()};this.$=A;this.gridView=Qa.h(this.$);this.parentElement=this.domElement;this.parentElement.className=fj.$Nh;this.$Pa=this.gridView.fn;this.umd=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.XQa=!0;this.qxi();this.umd&&this.ivi();this.s6g();this.Zxb(!1);k.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get E2(){return this.$zd}set E2(A){this.$zd!==A&&(this.$zd=this.isVisible=
A)}get fJb(){return!!(this.$.sf&16)}get ZGi(){const A=this.gridView.ha.ra.activeCell;return A.right===A.maxColumns}get ctb(){const A=this.gridView.yd(null);return A&&this.gridView.Afa(A.range)?this.Kza(A):(A&&k.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Azh();this.$=this.gridView=this.parentElement=this.$Pa=null;super.dispose()}p5h(A){const ea=this.Zji(this.gridView.yd(null).range);return ea?this.umd?
`=${this.Bif()}(${A}${this.$.listSeparator}${ea})`:`=SUBTOTAL(${A},${ea})`:null}Bif(){var A,ea,Ma;return null!==(Ma=null===(ea=null===(A=this.calcManager)||void 0===A?void 0:A.localeInfo)||void 0===ea?void 0:ea.getWorksheetFuncName(344))&&void 0!==Ma?Ma:"SUBTOTAL"}Zji(A){var ea=Qa.h(this.$).ed.Dh(A);if(!ea)return null;ea=ej.a(ea,!1);ea.right=ea.left=A.left;return ea.toString()}qxi(){fh.lM={};fh.lM["100"]=qb.a.instance.ia(1105);fh.lM["101"]=qb.a.instance.ia(1108);fh.lM["102"]=qb.a.instance.ia(1107);
fh.lM["103"]=qb.a.instance.ia(1112);fh.lM["104"]=qb.a.instance.ia(1109);fh.lM["105"]=qb.a.instance.ia(1110);fh.lM["109"]=qb.a.instance.ia(1106);fh.lM["107"]=qb.a.instance.ia(1113);fh.lM["110"]=qb.a.instance.ia(1115);fh.lM["111"]=qb.a.instance.ia(1166)}ivi(){(hb.EwaSettings.JD()?A=>Ib.a.resolve(Yc.m).then(ea=>setTimeout(()=>A(ea),0)):A=>this.$.ea.Zc(266,A))(A=>{this.calcManager=A})}Yjj(){var A=this.gridView.yd(null);if(A&&(A=A.Qy?A.formulaBarText:null))if(this.umd){const ea="="+this.Bif()+"(",Ma=ea.length;
if(A.toUpperCase().startsWith(ea)){if(A=A.substring(Ma,Ma+3),A in fh.lM)return A}else return"111"}else if("=SUBTOTAL("===A.substring(0,10)){if(A=A.substring(10,13),A in fh.lM)return A}else return"111";return"100"}s6g(){this.gridView.za.yw(this.ih);this.gridView.ha.add_activeCellChanged(this.Fg);this.gridView.tu(this.onContentReady);this.gridView.cellTextEditBox.yp(this.NCa);this.gridView.cellTextEditBox.yq(this.i$)}Azh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.remove_activeCellChanged(this.Fg),
this.gridView.za.Tu(this.ih)),this.gridView.hx(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.lp(this.NCa),this.gridView.cellTextEditBox.Pp(this.i$)),this.Qug())}Zxb(A){this.Whk(A);this.fJb&&(this.d7j(),this.ctb?(this.HXf||this.D6g(),this.E3c?this.E2=!1:(this.E2=!0,this.z8f())):(k.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.E2=!1))}z8f(){appChrome.renderTableTotalRowOptions(this.parentElement,
fh.lM,fh.lM[this.Yjj()].toString(),Math.round(P.a(this.$).Cj(17)),A=>{k.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${A}`);let ea={["SelectedOption"]:fh.lM[A],["FunctionKeyCode"]:A,["Location"]:"canvas"};Ki.b(this.$).Xe(Cj.a.M8j,ea,null,!0);if("111"===A)return this.LAi(),!0;if("100"!==A){this.o_d=this.p5h(A);if(!this.o_d)return k.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),
!0;this.RWa(this.o_d)}else this.RWa("");ia.DOMElementExtensions.setFocus(this.gridView.Vd.textBox.domElement);return!0})}LAi(){k.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const A=new We.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ha.kd(A)}Kza(A){if(!A)return null;var ea=this.gridView.cellTextEditBox.textBox.domElement;var Ma=0<ia.DOMElementExtensions.getHeight(ea)&&0<ia.DOMElementExtensions.getWidth(ea)&&0<=ea.offsetTop&&
0<=ea.offsetLeft;if(Ma)ea=ia.DOMElementExtensions.Kza(ea,this.gridView.fn);else{ea=this.gridView.getCellBounds(A.cell);var Vb=ia.DOMElementExtensions.getBoundingClientRect(this.gridView.fn);ea=new Sys.UI.Bounds(ea.x-Vb.x,ea.y-Vb.y,ea.width,ea.height)}if(ea)if(Ma)2<ea.height&&2<ea.height&&(ea.x+=1,ea.y+=1,ea.height-=2,ea.width-=2);else if(Ma=Qa.h(this.$).VM(A.cell))Ma=Ma.width,Vb=Lc.a.equals(jb.a.KCb(A.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Vb&&(ea.x=ea.x+ea.width-Ma),A.Cfa&&this.gridView.rtl===
Vb&&(ea.width=Ma);else return null;return ea}Whk(A){var ea=this.ctb;if(ea){var Ma=17>=ea.height?ea.y:ea.y+ea.height-17-2;ea=this.ZGi?this.gridView.rtl?ea.x:ea.x+ea.width-(17<ea.height?17:ea.height):this.gridView.rtl?ea.x-(17<ea.height?17:ea.height):ea.x+ea.width;var Vb=P.a(this.$).Gna(new Sys.UI.Point(ea,Ma));this.parentElement.style.top=Xb.HelperMethods.De(Vb.y);this.parentElement.style.left=Xb.HelperMethods.De(Vb.x);P.a(this.$).QSj(this.parentElement);A&&(this.E2=this.gridView.xsc(new ub.a(ea,Ma)))}else this.E2=
!1}D6g(){this.$Pa.insertBefore(this.parentElement,this.$Pa.firstChild);this.HXf=!0}d7j(){this.ET||(this.gridView.view.uu(this.Nu),this.ET=!0)}Qug(){this.ET&&this.gridView.view&&(this.gridView.view.pt(this.Nu),this.ET=!1)}RWa(A){const ea=this.gridView.Vd,Ma=this.gridView.yd(null);Ma&&(A=Object(fb.a)(new Dj.a,{Text:A}),this.gridView.setCell(A,Ma.range,0,127,null),ea.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}fh.L8j="TableTotalRowDropDownIconButtonId";fh.lM=null;Object(x.a)(fh,"TableTotalRowOptions",
Wi.a,[5]);let jj=class extends ih.a{constructor(A){super(Qa.h(A));this.owb=this.G4=this.TJc=this.mwb=null;this.$Ee=!1;this.$ne=null;this.y_b=0;this.Cdc=null;this.r9b=()=>{const ea={},Ma=this.dsd();for(let tc in Ma){const Jc=Ma[tc];if(!Jc)continue;const ld=this.aji(Jc);if(ld){if(ld in this.kKa){var Vb=this.kKa[ld];if(Vb.LD){Vb.pp.equals(Jc)||(Vb.pp=Jc);delete this.kKa[ld];ea[ld]=Vb;continue}}(Vb=Yg.createInstance(Qa.h(this.$),Jc,this.r2h(),this))?ea[ld]=Vb:k.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${Jc.sA(!1)}`)}}this.Eac(null,
null);this.eZb=ea};this.Eac=()=>{const ea=this.kKa;for(let tc in ea){var Ma=tc,Vb=ea[tc];Vb&&(Vb.dispose(),delete this.kKa[Ma])}this.eZb={}};this.B2f=()=>{this.Eac(null,null);this.r9b(null,null)};this.onFocus=()=>{this.$ne=Qa.h(this.$).ha.ra.activeCell};this.f$=()=>{this.$.isEditMode&&this.Fg(null,null)};this.Fg=()=>{!this.$Ee&&Ie.c(this.$,this.gridView.ha.ra.activeCell)&&this.rRi()};this.$F=()=>{this.fGb(1);this.$.da.mo(this.$F)};this.iPb=()=>{this.$Ee=!0;this.TJc=new fh(this.$)};this.$=A;this.gridView=
Qa.h(this.$);hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)||this.$.ea.Ja(66,this);this.eZb={};this.r9b(null,null);this.$.va&&this.$.va.Fi(this.B2f);this.H5c(this.r9b);this.$.da.y0(this.f$);this.gridView.ha.add_activeCellChanged(this.Fg);this.$.isEditMode&&this.Fg(null,null)}H5c(A){this.addHandler(ih.a.Dgb,A)}rWd(A){this.removeHandler(ih.a.Dgb,A)}VYg(A){this.addHandler("tce",A)}YAj(A){this.removeHandler("tce",A)}get kKa(){return this.eZb}get OEd(){return this.$ne}get dNa(){return this.y_b}get yu(){const A=
Qa.h(this.$);return A.ed.Dh(A.ha.ra.activeCell,!1)}get URd(){return this.OEd?Qa.h(this.$).ed.Dh(this.OEd,!1):null}xDd(A){return!!this.egf(A)}Vt(A){return this.sfi(this.Ngf(A))}qCb(A){return this.Ngf(A)}Fyj(A){A?(this.owb?this.owb!==A&&(fa.a.Ma(this.G4),this.G4=null,this.owb=A):this.owb=A,this.G4||(this.G4=rd.a.instance.Zf(this.owb)),this.G4.Ik("focusin")||this.G4.la("focusin",this.onFocus)):k.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}zuf(A,
ea){return A?A.$na&&A.top===ea.top:(k.ULS.shipAssertTag(537151244,0,!!A,"autofilterRange can't be null"),!1)}Ena(A){A=this.mwb?Zb.J(A,this.mwb):this.view.getRangeInformation(A);return 0<A.length&&Object(Ha.a)(jc.PivotTableRange,A[0])?A[0]:null}jDi(A,ea){return A?!A.Lpc&&!!A.$z&&A.$z.Te(ea):(k.ULS.shipAssertTag(537151243,0,!!A,"Pivot table can't be null"),!1)}cKi(A,ea){return A?!A.Lpc&&!!A.wC&&A.wC.Te(ea):(k.ULS.shipAssertTag(537151242,0,!!A,"Pivot table can't be null"),!1)}e7b(A){super.e7b(A);if((A=
Xb.HelperMethods.pgf(A))&&0<A.length){this.mwb=Array(A.length);for(let ea=0;ea<A.length;ea++)this.mwb[ea]=pj.a.oT(A[ea])}}DQb(){super.DQb();this.mwb=null}roh(A,ea){let Ma;Ma=!1;if(!A||!ea)return{returnValue:!1,K0:Ma};A=A.clone();A.right+=1;A.left=A.right;if(!A.SF)return{returnValue:!1,K0:Ma};if(A.top<ea.Tc.Hk){const Vb=A.clone();Vb.bottom>=ea.Tc.Hk&&(Vb.bottom=ea.Tc.Hk-1);if(!(()=>{let tc=this.$Re(Vb,ea);({K0:Ma}=tc);return tc})().returnValue)return{returnValue:!1,K0:Ma}}if(A.bottom>=ea.Tc.Hk){const Vb=
A.clone();Vb.top<=ea.Tc.Hk&&(Vb.top=ea.Tc.Hk);if(!(()=>{let tc=this.$Re(Vb,ea);({K0:Ma}=tc);return tc})().returnValue)return{returnValue:!1,K0:Ma}}return{returnValue:!0,K0:Ma}}Lpg(A){(A=this.Vt(A.topLeft))&&A.toString()in this.kKa&&(this.kKa[A.toString()].VCd=!1)}gsj(){this.raiseEvent("tce")}zl(A,ea){if(!this.TJc)return!1;switch(ea){case -569786022:case 541421805:if(this.TJc.E2){const Ma=document.getElementById(fh.L8j);Ma&&Na.a.instance.create(()=>{ia.DOMElementExtensions.Koc(Ma,null)},0,nb.a.E8j,
!0,!0)}return!0;default:return!1}}dispose(){this.Eac(null,null);this.rWd(this.r9b);this.$.va.hj(this.B2f);this.$.Ym(this.Eac);this.eZb=null;this.$.da&&this.$.da.X3(this.f$);this.gridView.ha.remove_activeCellChanged(this.Fg);this.TJc=null;this.G4&&(fa.a.Ma(this.G4),this.G4=null);super.dispose()}gqi(A,ea,Ma,Vb){var tc=this.gridView.ed.Dh(new wa.Range(ea,Ma,ea,Ma,!1,!1));if(this.Cdc=tc){var Jc=tc.usedRange,ld=A.ctrlKey||ja.a.isMac&&ni.b(A);tc=!A.shiftKey&&ld;A=A.shiftKey&&!ld;Qa.h(this.$).ha.selectionType=
3;switch(Vb){case 0:this.y_b=0;ea=this.Xed(A,Jc.top,Ma,Jc.bottom,Ma);this.D1d(ea,tc,A);break;case 1:this.y_b=1;ea=this.Xed(A,ea,Jc.left,ea,Jc.right);this.D1d(ea,tc,A);break;case 2:this.y_b=2;ea=this.Xed(A,Jc.top,Jc.left,Jc.bottom,Jc.right);this.D1d(ea,tc,A);break;default:k.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Vb.toString()}`);return}Qa.h(this.$).ha.selectionType=3;k.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else k.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}yXj(A){const ea=this.Cdc.usedRange;return this.Bwf(A)||1!==this.dNa&&this.Bwf(new wa.Range(ea.top,A.left,ea.bottom,A.right,!1,!1))?!0:!1}lTd(A){return A.Autofilters}$Re(A,ea){let Ma;Ma=!1;const Vb=ea.Tc.Rj(A),tc=ea.Ih(Vb).Yk;if(!tc)return k.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Vb}`),{returnValue:!1,K0:Ma};if(!tc.Xf(A))return{returnValue:!0,
K0:Ma};A=ea.xj("TableManager.CouldExpandImpl",A,2);try{for(;A.$$mn();){if(A.$$cu().text||A.Yn.REb)return Ma=!0,{returnValue:!1,K0:Ma};if(A.$$cu().bI)return{returnValue:!1,K0:Ma}}}finally{A&&A.dispose()}return{returnValue:!0,K0:Ma}}sfi(A){if(!A)return null;const ea=new oj.AutofilterRange(A.top,A.left,A.bottom,A.right,null,null,null,A.id,A.$na);ea.nFa=A.nFa;const Ma=this.gridView.ed.Dh(A,!0);if(!Ma)return null;for(let Vb=0,tc=this.rangeList.length;Vb<tc;Vb++){const Jc=this.rangeList[Vb],ld=this.gridView.ed.Dh(Jc,
!0);ld&&ld.name===Ma.name&&Jc!==A&&this.dJi(Jc)&&(ea.union(Jc),Jc.nFa&&(ea.nFa=!0))}return ea}dJi(A){return!!Qa.h(this.$).ed.Dh(A)}r2h(){const A=[];for(const ea of this.rangeList){const Ma=new Ud.a(this.Vt(ea.topLeft),wd.d(this.$.na));A.push(Ma)}return A}dsd(){const A={};for(const ea of this.rangeList){if(!ea)continue;const Ma=this.Vt(ea.topLeft);Ma&&(A[Ma.toString()]=this.Vt(ea.topLeft))}return A}rRi(){this.$.da.Og?this.fGb(0):this.$.da.Ol(this.$F)}fGb(A){this.$.QB(ea=>{ea.j8(A).then(this.iPb)})}aji(A){const ea=
this.gridView.ed.Dh(A);return ea?ea.name:A.toString()}D1d(A,ea,Ma){A&&(Ma=Ma?Qa.h(this.$).ha.ra.activeCell:A.topLeft,ea?this.gridView.ha.updateSelection(A,Ma,0,1):this.gridView.ha.FI([A],0,Ma,0))}Xed(A,ea,Ma,Vb,tc){const Jc=ej.d(this.Cdc),ld=ej.g(this.Cdc),Zd=ea+(1!==this.dNa&&Jc?1:0),De=Vb-(1!==this.dNa&&ld?1:0),Ve=this.gridView.inRangePicker||this.gridView.Jk;if(A){var Se=Ve&&!Ud.a.Vcc(this.gridView.ha.rangePicker.HN).length?new wa.Range(Zd,Ma,De,tc,!1,!1):Ve?this.gridView.ha.rangePicker.activeCell:
this.gridView.ha.ra.activeCell;Se=new wa.Range(Se.top<Zd?Se.top:Zd,Se.left<Ma?Se.left:Ma,Se.bottom>De?Se.bottom:De,Se.right>tc?Se.right:tc,!1,!1)}else Se=new wa.Range(Zd,Ma,De,tc,!1,!1);if(1!==this.dNa&&(Jc||ld)&&(!A||A&&this.hcd(Se,Zd,Ma,De,tc))){A=Ve?Ud.a.Vcc(this.gridView.ha.rangePicker.HN):this.gridView.ha.ra.selectedRanges;for(const sf of A)if(this.hcd(sf,Zd,Ma,De,tc)){Se.top=ea;Se.bottom=Vb;break}}return Se}Bwf(A){const ea=this.gridView.inRangePicker||this.gridView.Jk?Ud.a.Vcc(this.gridView.ha.rangePicker.HN):
this.gridView.ha.ra.selectedRanges;for(const Ma of ea)if(this.hcd(Ma,A.top,A.left,A.bottom,A.right))return!0;return!1}hcd(A,ea,Ma,Vb,tc){return!!A&&A.top===ea&&A.bottom===Vb&&A.left===Ma&&A.right===tc}};jj=Object(ra.a)([Object(Ib.d)(Yc.Gc),Object(ra.b)(0,Object(Yc.R)())],jj);Object(x.a)(jj,"TableManager",ih.a,[490,5]);class Ei extends Pb.a{constructor(A){super();this.tableManager=null;this.$=A;this.Md()}create(){this.qd(this.tableManager||(this.tableManager=new jj(this.$)))}}Object(x.a)(Ei,"TableManagerFactory",
Pb.a,[]);var Gg=a(260),Fi=a(667),gi=a(275),Gi=a(182),sj=a(88),zj=a(586);class Ti extends ki.a{constructor(A,ea){super(A);this.RV=[];this.Wne=null;this.VRb=Ma=>{let Vb="forward";Ma.Values[th.a.direction]?Vb=Ma.Values[th.a.direction].toLowerCase():k.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Ma=0;let tc=!0;"backward"===Vb?(Ma=this.JEd.length-1,tc=!1):"forward"===Vb?(Ma=0,tc=!0):k.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Vb}`);this.bIf(tc,
Ma,!1)};this.GQf=()=>{this.RV=[]};this.QTa=Ma=>{-411645385===this.$.shortcutKeyManager.Ut(Ma,!0)&&this.fvf()&&(this.$.Ha.kd(new We.a(-411645385,1,this.$.ee,6,null),{["event"]:Ma},Ma),Ma.stopPropagation())};this.cbj=Ma=>{this.iqa(Ma)};this.dd=ea;this.pv=Qa.h(this.dd);this.Me.la("keydown",this.cbj);this.Me.la("keyup",this.QTa);gi.a(ea).U0g(this.GQf);sj.a(ea.xa,27)&&Ed.TaskExtensions.ya(Ac.GetServiceTaskFactory.Vc(ea.ea,21,137,1),Ma=>{Ma=Ma.result;Ma.Vn(ba.a.Znf);Ma.em(ba.a.Znf,this.VRb)},ea.ka)}get $(){return this.dd}get JEd(){this.RV.length||
(this.RV=this.Aef());return this.RV}get kpa(){return this.Wne}set kpa(A){this.Wne=A;this.RV=this.Aef()}dispose(){this.$&&gi.a(this.$).uDj(this.GQf);this.dd=null;this.RV.length=0;super.dispose()}Wpj(A){this.iqa(A)}bIf(A,ea,Ma,Vb){Vb=void 0===Vb?null:Vb;var tc=this.Y7j(A,ea,void 0===Ma?!0:Ma,Vb);if(!tc){Ma=ea;var Jc=A?1:-1,ld=this.JEd;do{tc=!1;if(sj.a(this.$.xa,27)){if(Ma+=Jc,Ma>=ld.length||0>Ma)tc=!0}else Ma=(Ma+Jc+ld.length)%ld.length;if(tc){this.CVi(A,ea,Vb);break}else if(tc=this.wpg(A,ea,Ma,!1,
Vb))break}while(Ma!==ea)}}Y7j(A,ea,Ma,Vb){Vb=void 0===Vb?null:Vb;let tc=null;0<=ea&&(tc=this.RV[ea]);return(null===tc||void 0===tc?0:tc.Vh)&&tc.$h(A,void 0===Ma?!0:Ma)?(Vb&&ni.g(Vb),k.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${tc.Tf} into a sub region`),tc.Vk(),!0):!1}wpg(A,ea,Ma,Vb,tc){tc=void 0===tc?null:tc;Ma=this.RV[Ma];if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const Jc=gi.a(this.dd).Ny(Gg.a.Wya),ld=gi.a(this.dd).Ny(Gg.a.sEb),
Zd=this.pv.ha.Va.TT;if(Ma===ld&&Zd||Ma===Jc&&!Vb&&!Zd)return!1}if((null===Ma||void 0===Ma?0:Ma.Vh)&&Ma.$h(A,!1)){tc&&ni.g(tc);Ma.Vk();if(A=this.RV[ea])A.yl(),k.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${A.Tf} to ${Ma.Tf}`);return!0}return!1}CVi(A,ea,Ma){(Ma=void 0===Ma?null:Ma)&&ni.g(Ma);if(ea=this.RV[ea])ea.yl(),k.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ea.Tf}`);Ed.TaskExtensions.ya(Ac.GetServiceTaskFactory.Vc(this.$.ea,21,137,0),Vb=>{Vb.result.sendMessage(ba.a.Ssb,
{[th.a.direction]:A?"forward":"backward"})},this.$.ka)}iqa(A){var ea=this.$.isEditMode?Gi.a(this.$):null;if(!this.$.hd.eBa||Ti.AGi(ea))if(117===A.keyCode&&(A.ctrlKey||ni.b(A))){ea=this.Chf(A.target);var Ma=!A.shiftKey;k.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ea}`);if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var Vb=gi.a(this.dd).Ny(Gg.a.aSb);Vb=this.RV.indexOf(Vb);G.AFrameworkApplication.sa.Sa.Xy&&
this.$.T2&&-1!==Vb&&ea===Vb&&Fi.ShyRibbon.pM(this.$.Ljb,0)}else G.AFrameworkApplication.sa.Sa.Xy&&this.$.T2&&1===ea&&Fi.ShyRibbon.pM(this.$.Ljb,0);this.bIf(Ma,ea,!0,A)}else 117!==A.keyCode||Ti.A6e?-411645385===this.$.shortcutKeyManager.Ut(A)?this.fvf()&&(this.$.Ha.kd(new We.a(-411645385,1,this.$.ee,6,null),{["event"]:A},A),A.stopPropagation()):1588554917===this.$.shortcutKeyManager.Ut(A)?0===this.mode?(zj.a(this.$)||this.$.Ha.kd(new We.a(1588554917,1,this.$.ee,6,null),{["event"]:A},A),A.preventDefault(),
A.stopPropagation()):3===this.mode&&(A.preventDefault(),A.stopPropagation()):-1966746939===this.$.shortcutKeyManager.Ut(A)?(A.preventDefault(),A.stopPropagation()):hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Ut(A)?(ea=this.Chf(A.target),Vb=gi.a(this.dd).Ny(Gg.a.aSb),Ma=gi.a(this.dd).Ny(Gg.a.Wya),Vb=this.RV.indexOf(Vb),Ma=this.RV.indexOf(Ma),G.AFrameworkApplication.sa.Sa.Xy&&this.$.T2&&-1!==Vb&&ea===Vb&&1===this.$.Ljb&&
Fi.ShyRibbon.pM(1,0),-1!==Ma&&ea!==Ma&&this.wpg(!0,ea,Ma,!0,A)):this.$ni(A):(A=gc.a.rB.notificationBar.e1(yh.a.s8h(),!1),le.a.zIb()?A.image=3:A.image=0,gc.a.rB.notificationBar.gD(A),Ti.A6e=!0)}Chf(A){const ea=this.JEd;for(let Ma=0,Vb=ea.length;Ma<Vb;++Ma){const tc=ea[Ma];if(tc&&tc.nj(A))return Ma}return-1}Aef(){const A=[];for(let ea=0,Ma=this.kpa.length;ea<Ma;ea++){const Vb=gi.a(this.$).Ny(this.kpa[ea]);Vb&&A.push(Vb)}return A}fvf(){return 0===this.mode||4===this.mode}static AGi(A){return A?A.inKeytipMode:
!1}}Ti.A6e=!1;Object(x.a)(Ti,"AccessibilityManager",ki.a,[562,5]);var $i=a(168);class lh extends Ti{constructor(A){super(document.documentElement,A);this.PE=0;this.S7g=[Gg.a.LRe,Gg.a.gLd,Gg.a.anc,Gg.a.E8d,Gg.a.aSb,Gg.a.u9c,Gg.a.rnd,Gg.a.ikf,Gg.a.G8c,Gg.a.YJc,Gg.a.h3j,Gg.a.sEb,Gg.a.H9e,Gg.a.w$c,Gg.a.Wya,Gg.a.E2d,Gg.a.C$c,Gg.a.Sng,Gg.a.OBf,Gg.a.Y8c];this.Onk=[Gg.a.anc,Gg.a.Uyg,Gg.a.Tyg,Gg.a.Vyg];this.ypj=[Gg.a.anc,Gg.a.P_f,Gg.a.Q_f,Gg.a.T_f];this.gfh=[Gg.a.x9e,Gg.a.hkf,Gg.a.w9e,Gg.a.u9e,Gg.a.KVe];this.$oj=
[Gg.a.LRe,Gg.a.gLd,Gg.a.u9c,Gg.a.rnd,Gg.a.G8c,Gg.a.YJc,Gg.a.sEb,Gg.a.w$c,Gg.a.Wya,Gg.a.E2d,Gg.a.l_f,Gg.a.C$c,Gg.a.Y8c];this.npj=[Gg.a.sEb,Gg.a.E9e];const ea=qb.a.instance.Ia(253);this.sRj=this.$.shortcutKeyManager.hDb(ea);this.mode=0;A.ea.Ja(15,this);Ed.TaskExtensions.ya(Ac.GetServiceTaskFactory.Vc(A.ea,21,137,1),Ma=>{Ma=Ma.result;Ma.Vn(ba.a.Ssb);Ma.em(ba.a.Ssb,this.VRb)},A.ka)}get mode(){return this.PE}set mode(A){this.PE=A;switch(A){case 0:this.kpa=this.S7g;break;case 2:this.kpa=this.Onk;break;
case 3:this.kpa=this.ypj;break;case 4:this.kpa=this.gfh;break;case 5:this.kpa=this.$oj;break;case 6:this.kpa=this.npj;break;default:k.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}iqa(A){this.$.sf&65536&&super.iqa(A)}$ni(A){if(Lc.a.equals(this.sRj,this.$.shortcutKeyManager.Aqd(A),!1)){const ea=$i.b(this.$);if(null===ea||void 0===ea?0:ea.Vh)ni.g(A),ea.$h(!0,!1)}}}Object(x.a)(lh,"EwaAccessibilityManager",Ti,[]);class oi extends Pb.a{constructor(A){super();this.$=
A;this.Md()}create(){this.qd(this.$.ea.Ba(15)||new lh(this.$))}static la(A){A.ea.Ja(157,new oi(A))}}Object(x.a)(oi,"AccessibilityManagerFactory",Pb.a,[]);var hi=a(8),Li=a(130),ii=a(38);let wi=class extends Li.a{constructor(A,ea){A=void 0===A?hi.a.NWa:A;ea=void 0===ea?hi.a.Zz:ea;super(A,ea)}execute(A){const ea=Object(y.a)(8,A.sg);k.ULS.shipAssertTag(537153921,0,fe.a.Tub(A.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");ea.uI(!0,!0);A.activityState[ii.a.I6b]=
ea.da.sessionId;A.activityState[ii.a.ktb]=!0;A.activityState[ii.a.O6b]=!0;k.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};wi=Object(ra.a)([Object(Ib.d)(Yc.rc)],wi);Object(x.a)(wi,"SessionReloadActivity",Li.a,[]);class tj extends Pb.a{constructor(){super();this.Md()}create(){this.qd(new wi(hi.a.NWa,hi.a.Zz))}static la(A){A.ea.Ja(142,new tj)}}Object(x.a)(tj,"SessionReloadActivityFactory",Pb.a,[]);var Mh=a(283),Oi=a(50),kj=a(259),
qj=a(132);class Rh extends Li.a{constructor(A,ea,Ma,Vb,tc){super(A,ea);Rh.kId=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Rh.jId=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Rh.WFf=[-1468309555,611268539,-1750576502,61029505,-658377927];Rh.VFf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.kIc=Ma;this.I2j=Vb;this.mbk=tc}execute(A){var ea=Object(y.a)(8,A.sg);A.activityState[ii.a.fwa]=
!0;var Ma=Rh.Yhi(A);if(Rh.mXj(A,Ma))return Rh.qXi(A),Ma=50,0<A.errors.length&&(Ma=15),k.ULS.sendTraceTag(537153891,0,Ma,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${fe.a.me(A.errors)}`),A.activityState[ii.a.fwa]=!1,this.Ni(hi.a.idle),3;switch(Ma){case 1:case 3:this.Pyi(A,Ma);break;case 2:this.Oyi(A);break;case 0:A.activityState[ii.a.F2a]=null}k.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${Ma}. activityName:${this.activityName}. NextActivityName:${this.m3}. TimeFromLastStatefulResponse:${ea.da.g_}.`);
var Vb=Wc.a.yi(A.activityState,qj.a.alb);k.ULS.shipAssertTag(40502925,0,!Vb||Vb&&(1===Ma||3===Ma),`triggerSilentReloadAfterTokenRefresh: ${Vb}, silentReloadType: ${Ma}`);ea=ea.Xm.reloadCount;return 0!==Ma&&0<ea?(Vb=Mh.a.IPa(ea,200),k.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${Ma}] retryNum [${ea}] delayInMs [${Vb}] activityName [${this.activityName}]`),Na.a.instance.create(()=>{Rh.TJ(A)},Vb,nb.a.$Oj),1):3}Pyi(A,ea){k.ULS.sendTraceTag(8438495,0,50,
"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const Ma=Object(y.a)(8,A.sg);A.activityState[ii.a.ktb]=!0;Ma.Yoc||Oi.PageLoadTrackingInfo.instance.Nl("ReopenOnLoad");!Rh.isEditMode(A)&&fe.a.Tub(A.errors)&&(k.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),A.activityState[ii.a.I6b]=Ma.da.sessionId,A.activityState[ii.a.O6b]=!0);A.CId();3===ea?(Ma.da.Fh()||Ma.da.e2i(),Ma.uI(!0,!0),
this.Ni(this.mbk),A.activityState[ii.a.Hze]=Ma.workbookContext.CalcMode):(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ea&&Ma.uI(!0,!0),A.activityState[ii.a.V3c]=!1,this.Ni(this.kIc))}Oyi(A){k.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");A.activityState[ii.a.F2a]=null;A.CId();this.Ni(this.I2j);A=Object(y.a)(8,A.sg);A.Yoc||(Oi.PageLoadTrackingInfo.instance.Nl("RefreshOnLoad"),A.uRb())}static TJ(A){A.TJ()}static Yhi(A){const ea=
Object(y.a)(8,A.sg),Ma=ea.da,Vb=Rh.isEditMode(A);var tc=fe.a.aj(A.errors,Vb?Rh.jId:Rh.kId);const Jc=fe.a.aj(A.errors,Vb?Rh.VFf:Rh.WFf),ld=ea.OT,Zd=ea.Xm.reloadCount,De=ea.xa.MaxConsecutiveSilentReloadAllowed,Ve=ea.Xm.xmf(),Se=fe.a.me(A.errors),sf=fe.a.me(A.JDa),Of=0<fe.a.zP(Cg=>!Cg.triggerSilentReopenOnly,A.errors).length;let qg=tc;const yg=Wc.a.yi(A.activityState,qj.a.alb);yg&&(qg=!0);const lg={name:"SessionReloadSilentActivity.GetSilentReloadType"};lg.editMode=Vb;lg.isSilentReopenError=tc;lg.isSilentRefreshError=
Jc;lg.reloadSequenceCount=ea.Xm.FVa;lg.reloadCount=Zd;lg.maxReloads=De;lg.stopSilentReloads=Ve;lg.errorNames=Se;lg.processedErrorNames=sf;lg.isClientDirty=ld;lg.errorsForSilentReopenOnly=Of;lg.triggerSilentReloadAfterTokenRefresh=yg;lg.IsReopenDisabled=ea.PRa;tc=hf.a.ye(lg);k.ULS.sendTraceTag(21837004,0,50,tc);if(!Ve){if(qg&&(Vb?Rh.dXj(A):Rh.fXj(A)))return kj.a.cjg(A,ea)?3:ea.PRa?2:1;if(Jc&&(Vb||!Ma.Qgb))return 2}return 0}static mXj(A,ea){for(const Ma of A.errors)if(-1337545025===Ma.MessageId||-238814601===
Ma.MessageId)return!1;return fe.a.zP(Ma=>!Ma.triggerSilentReopenOnly,A.errors).length?3!==ea:!1}static qXi(A){const ea=fe.a.zP(Ma=>!Ma.triggerSilentReopenOnly,A.errors);for(const Ma of ea)A.dga(Ma)}static isEditMode(A){const ea=Object(y.a)(8,A.sg);return ea.da.Zd?ea.Zs&&!!(ea.sf&64):Wc.a.yi(A.activityState,ii.a.pu)}static fXj(A){const ea=Object(y.a)(8,A.sg),Ma=fe.a.U7(A.errors,Rh.kId);if(lb.b(Ma,Vb=>Vb.ForceVersionUpgrade))return!1;A=fe.a.Tub(A.errors);return!ea.da.Qgb||A?!0:!1}static dXj(A){A=fe.a.U7(A.errors,
Rh.jId);return!lb.b(A,ea=>ea.ForceVersionUpgrade)}}Rh.kId=null;Rh.jId=null;Rh.WFf=null;Rh.VFf=null;Object(x.a)(Rh,"SessionReloadSilentActivity",Li.a,[]);class aj extends Pb.a{constructor(A,ea){super();this.activityName=A;this.HM=ea;this.Md()}create(){this.qd(new Rh(this.activityName,this.HM,hi.a.Zz,hi.a.xk,hi.a.LWb))}static la(A){A.ea.Ja(143,new aj(hi.a.Gra,hi.a.w9b));A.ea.Ja(144,new aj(hi.a.SFc,hi.a.kUa));A.ea.Ja(145,new aj(hi.a.TFc,hi.a.cPd));A.ea.Ja(154,new aj(hi.a.Hib,hi.a.IR))}}Object(x.a)(aj,
"SessionReloadSilentActivityFactory",Pb.a,[]);let bj=class extends ih.a{constructor(A){super(Object(Qa.h)(A))}gii(A){for(const ea of this.rangeList)if(A.range.contains(ea))return ea;return null}lTd(A){return A.GridBlockModel&&(A=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(A.GridBlockModel))?A.getSparklineRanges():null}};bj=Object(ra.a)([Object(Ib.d)(Yc.Ec),Object(ra.b)(0,Object(Yc.R)())],bj);Object(x.a)(bj,"SparklineManager",ih.a,[489]);Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
La.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(()=>{Qe.a.Fa(A=>{Be.la(A)})})();(()=>{Qe.a.Fa(A=>{ce.la(A)})})();(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices7",!1)||ue.la(A)})})();Xe.a.wk(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices7",!1)||Ug.la(A)})})();(()=>{Qe.a.Fa(A=>{Object(Re.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")||xa.la(A)})})();Type.registerNamespace("Common.App.GestureManager");jg.main();Type.registerNamespace("Common.App.AccessibilitySettings");Lf.main();(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",
!1)||ac.la(A);hb.EwaSettings.rd()?Kc.la(A):Y.la(A);fg.la(A);Object(Re.b)("OfficeVSO:7641163_MigratingWorkbookReadoutHandlerService")||eh.la(A)})})();Xe.a.wk(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightsBehaviorManager",!1)||Qi.la(A)});Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)||ah.la(A)})})();Type.registerNamespace("Common.App.NewAndOpen.Core");Ta.a.instance.Mk(new ch);Type.registerNamespace("Common.App.O365Shell");Zi.main();Xe.a.wk(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)||A.ea.Ja(134,new Ei(A))})})();Qe.a.Fa(oi.la);(()=>{Qe.a.Fa(A=>{hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSessionReloadActivity",!1)||tj.la(A);aj.la(A)})})();String(c);String(b);String(n);String(v);String(h);String(r);String(e);String(u);window.___1688279196293_closurehack=c;window.___1688279196293_closurehack=b;window.___1688279196293_closurehack=n;window.___1688279196293_closurehack=
v;window.___1688279196293_closurehack=h;window.___1688279196293_closurehack=r;window.___1688279196293_closurehack=e;window.___1688279196293_closurehack=u}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/baf883a73aa53591e5f11a61ef7c464f/EwaTS.frs.js.map