'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1366:function(w,D,a){function b(P){const ta=f(P);let Z=[];if(0===ta&&1===P.length)return Z.push({destination:P[0],source:null,orc:!1}),Z;for(let aa=0;aa<=ta;aa++){const Ea=P.filter(za=>za.k8().topLeft.Y===aa);for(let za=0;za+1<Ea.length;za+=1)Z.push({destination:Ea[za],source:Ea[za+1],orc:!1})}T.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${Z.length}`);
return Z}function c(P,ta){let Z;const aa=qa.HelperMethods.qU(()=>{Z=gridRenderer.CanvasRendererGlobals.hideRowCols(P,ta,!1)});d("HideRowCols",aa);return Z}function e(P,ta,Z,aa){P=gridRenderer.CanvasRendererGlobals.performModelCascade(P,ta,Z,aa);P.metric&&d("ModelCascade",P.metric.Hsk);return P}function f(P){let ta=-1;for(let Z=0;Z<P.length;Z++){const aa=P[Z].k8().topLeft.Y;aa>ta&&(ta=aa)}return ta}function d(P,ta){T.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${P} is time=${ta}`)}
function h(){return Va}function r(){Va={dispose(){}}}a.r(D);w={};a.r(w);a.d(w,"GridInstantaneousAction",function(){return Jb});a.d(w,"testableGetBlockPairsInViewport",function(){return b});a.d(w,"testablePerformHideColumnOperation",function(){return c});a.d(w,"testablePerformModelCascade",function(){return e});a.d(w,"testableGetPartialInteractivityState",function(){return h});a.d(w,"testableInitPartialInteractivityState",function(){return r});D=a(523);var n=a(10),u=a(0),v=a(234),x=a(9),k=a(18),m=
a(72),t=a(69),z=a(7),y=a(36);class C{}C.$Mh="ewa-resizehdr-row-hidden";C.ZMh="ewa-resizehdr-col-hidden";Object(u.a)(C,"CssClassNames",null,[]);var J=a(250),F=a(14),K=a(175),L=a(651),S=a(33),W=a(235),G=a(6),O=a(238),T=a(15),I=a(76),N=a(142),R=a(46),V=a(27),sa=a(57),U=a(13),ka=a(77),ja=a(1),Da=a(103),qa=a(12),Ba=a(16),ua=a(265),pa=a(143),Ka=a(385),$a=a(47),ha=a(37);class cb{constructor(P,ta,Z,aa,Ea,za,bb){this.kAa=P;this.JLb=ta;this.Tpa=Z;this.Cvd=aa;this.Vhb=Ea;this.Byf=za;this.Jqi=bb}}Object(u.a)(cb,
"HeaderEventCachedInfo",null,[]);class Ia{constructor(P){this.Uhd=P}BRe(P){P=qa.HelperMethods.yQd(P);return Math.max(0,Math.min(Ia.XGf,P))}rRe(P){return this.gmj(P)}Ajh(P){return Math.round(this.Uhd*P+2*this.Gcf()+1)}gmj(P){return Math.max(0,Math.min(Ia.CGf,(Math.max(0,Math.min(x.a.cvc,P))-2*this.Gcf()-1)/this.Uhd))}Gcf(){return Math.floor(Math.max((this.Uhd+3)/4,2))}Okc(P,ta){return ta?P?Ia.XGf:x.a.OId:P?Ia.CGf:x.a.cvc}}Ia.XGf=409;Ia.CGf=255;Object(u.a)(Ia,"ResizeHeadersConverter",null,[]);var ob=
a(190);class gb extends Da.a{constructor(P,ta){super(ta.domElement);this.W_=this.J$f=!1;this.fk=this.qcb=this.qFa=null;this.IXd=!0;this.Grc=!1;this.DSb=this.kn=this.offset=0;this.NP=this.LU=this.D4=null;this.Vri="headerResizeTooltip";this.VI=this.bHd=null;this.k8c=this.G5=this.qEa=!1;this.bXf=this.gfb=x.a.FAa;this.uYb=!1;this.gz=Z=>{if(this.grid.mk)return!1;Z=ha.a(this.grid.$).jg(Z);if(3===Z.ud&&!this.Cyf(Z.Ca)||!this.XZf(Z,!1))return!1;T.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");
const aa=this.fIc();this.bod(Z.clientPoint,aa,!0);this.qEa||(J.a.instance.ta(F.a.vn,this.domElement.ownerDocument.body,this.peb),K.a.instance.ta(F.a.xi,this.domElement.ownerDocument.body,this.peb),this.qEa=!0);this.W_&&this.Uof(Z);return!1};this.$Mb=Z=>{Z=ha.a(this.grid.$).jg(Z);this.k8c&&this.Uof(Z);if(!Z.Ca.type.includes("touch")&&Z.Ca.button!==Sys.UI.MouseButton.leftButton||!this.GIb)return!1;ka.g(Z.Ca);this.k0e();Z=this.grid.mk?this.gfb:x.a.FAa;if(this.grid.mk&&this.fk){var aa=Z!==this.kn;!aa&&
this.uYb&&(this.fg.removeRowColFromModel(this.fk.Osb,this.fk.J5f),this.fg.sia(this.grid.ha.ra.selectedRanges),this.fg.ns("HeaderResizeBehavior::onDocumentMouseUp"))}else this.fk&&(Z=this.G5?this.Ipd():this.fk.s8()),aa=Z!==this.kn;if(this.qFa&&aa&&Z!==x.a.FAa){Z=this.grid;var Ea=this.isd(Z);aa={};aa.SheetMultiRange=R.r(Ea,Z.$);gb.r1d(aa,this.isRow,this.kn);this.grid.mk&&(Ea=aa.SheetMultiRange.Ranges[0],T.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.fk?
this.fk.Osb:-1}, isResizingHiddenHeader=${this.G5}, headerViewBlockHashCode=${this.fg.hashCode},
          rangeFirstRow=${Ea.FirstRow}, rangeFirstColumn=${Ea.FirstColumn}, rangeLastRow=${Ea.LastRow}, rangeLastColumn=${Ea.LastColumn},`));this.CGh(aa);Z.j8j=!0}else this.dh(null,null),this.NQb();return this.uYb=this.G5=!1};this.vga=Z=>{if(this.grid.mk)return!1;Z=L.a.create(Z.eventName,Z.Nd,Z.Ca,Z.ud);Z=ha.a(this.grid.$).jg(Z);if(!this.XZf(Z,!0))return!1;Z=this.grid;var aa=this.isd(Z);aa=R.r(aa,Z.$);Z.zd.Sl([this.isRow?13:14]);Z.zd.IXa();this.NQb();Z.$.Fe(this.isRow?146338636:1391094586,I.a.ld,
30,{["autoFitRanges"]:aa});return!1};this.XPf=Z=>{this.W_?(this.G5&&!this.uYb&&(this.$Vg(),this.fg.ns("HeaderResizeBehavior::onHeaderResizeChanged")),this.Grc||this.hqf(),Z=new Sys.UI.DomEvent(Z),Z=L.a.create(F.a.ila,this.domElement,Z,2),Z=ha.a(this.grid.$).jg(Z),this.mNd(Z.clientPoint)):T.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.fk?this.fk.Osb:-1}, isRow = ${this.isRow}`)};this.YPf=Z=>{Z=new Sys.UI.DomEvent(Z);
Z=L.a.create(F.a.ila,this.domElement,Z,2);this.$Mb(Z)};this.aaj=Z=>{this.UCa(Z,this.fk,!1)};this.peb=Z=>{Z=ha.a(this.grid.$).jg(Z);ka.g(Z.Ca);return this.mNd(Z.clientPoint)};this.XK=Z=>{if(this.grid.mk)return!1;Z=ha.a(this.grid.$).jg(Z);let aa;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return $a.a(this.grid.$).qr()&&(aa=this.Eqd(Z))&&(aa.kAa.style.cursor=""),!1;if(this.W_)return this.hqf(),!1;aa=this.Eqd(Z);if(!aa)return!1;aa.kAa.style.cursor=!this.grid.Xc&&this.kEd(aa)?
this.isRow?"row-resize":"col-resize":"";ka.g(Z.Ca);return!0};this.Ou=()=>{this.NQb()};this.dh=()=>{if((3===I.a.ld||S.a.rr)&&this.grid.ha.ra.yj){var Z=this.grid.ha.ra.Ye;if(!(!Z.isRow&&!Z.Ci||!this.domElement||Z.isRow&&this.isRow&&!this.fg.Qw.includes(Z.top)||Z.Ci&&!this.isRow&&!this.fg.Qw.includes(Z.left))){var aa=this.grid.Bi(Z,this.fg.fl.paneType);if(aa){if(this.grid.mk){const Ea=this.isRow?Z.bottom:Z.right;this.fk=this.fg.Fu(V.Range.xe(Z.bottom,Z.right));if(!this.fk){T.ULS.sendTraceTag(522826880,
2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Ea}, is row ${this.isRow}`);return}}this.VI||this.ovh();Z.isRow&&this.isRow?(U.DOMElementExtensions.setVisible(this.VI,!0),this.VI.style.top=aa.bottomRight.y-this.VI.offsetHeight/2+"px"):Z.isRow||this.isRow||(U.DOMElementExtensions.setVisible(this.VI,!0),ua.c(this.VI.style,this.grid.rtl,aa.bottomRight.x-this.VI.offsetWidth/2+"px"))}}}};this.FQ=(Z,aa)=>{ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&
T.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${aa.oS}`);aa.oS&&this.ywb()};this.fg=ta;this.isRow=ta.isRow;this.rtl=ta.fl.rtl;this.grid=P;this.EGf=this.isRow?x.a.OId:x.a.cvc;this.Pri=Ba.a.instance.ia(436);this.Zri=Ba.a.instance.ia(435);this.Sri=Ba.a.instance.ia(437);pa.a(this.grid.$,Z=>{this.bHd=Z.US(N.a.wHj,!1)});this.fxj();this.grid.ha.YG(this.dh);this.grid.ha.Hka(this.Ou);this.grid.tu(this.dh);$a.a(this.grid.$).gi.Fka(this.FQ)}get GIb(){return this.W_}get yHj(){this.mHh();
return gb.Whb}UCa(P,ta,Z){var aa=new Sys.UI.DomEvent(P);aa=L.a.create(F.a.ila,this.domElement,aa,2);aa=ha.a(this.grid.$).jg(aa);this.WZf(ta,aa.clientPoint.x,aa.clientPoint.y,!1,Z,P);P=this.fIc();this.bod(this.qFa,P,!0);this.qEa||(P=this.domElement.ownerDocument.body,P.addEventListener(F.a.ila,this.XPf),P.addEventListener(F.a.yLa,this.YPf),this.qEa=!0)}Y$i(P,ta,Z){this.WZf(ta,P.clientX,P.clientY,!0,Z,P);P=this.grid;ta=this.isd(P);ta=R.r(ta,P.$);P.zd.Sl([this.isRow?13:14]);P.zd.IXa();this.NQb();P.$.Fe(this.isRow?
146338636:1391094586,I.a.ld,30,{["autoFitRanges"]:ta})}dispose(){this.Kad();this.grid.ha&&(this.grid.ha.lG(this.dh),this.grid.ha.pha(this.Ou));this.grid.hx(this.dh);$a.a(this.grid.$)&&$a.a(this.grid.$).gi.bra(this.FQ);W.a.instance.Aa(F.a.om,this.domElement,this.vga);J.a.instance.Aa(F.a.ri,this.domElement.ownerDocument.body,this.$Mb);K.a.instance.Aa(F.a.hg,this.domElement.ownerDocument.body,this.$Mb);S.a.rr||(J.a.instance.Aa(F.a.pointerDown,this.domElement,this.gz),J.a.instance.Aa(F.a.vn,this.domElement,
this.XK));this.qEa&&(J.a.instance.Aa(F.a.vn,this.domElement.ownerDocument.body,this.peb),K.a.instance.Aa(F.a.xi,this.domElement.ownerDocument.body,this.peb),this.qEa=!1);this.VI&&(J.a.instance.Aa(F.a.pointerDown,this.VI,this.gz),W.a.instance.Aa(F.a.om,this.VI,this.vga),this.Kad(),this.VI=null);this.J$f&&(U.DOMElementExtensions.xh(gb.Whb),gb.Whb=null);this.fg=null;super.dispose()}fxj(){W.a.instance.ta(F.a.om,this.domElement,this.vga);J.a.instance.ta(F.a.ri,this.domElement.ownerDocument.body,this.$Mb);
K.a.instance.ta(F.a.hg,this.domElement.ownerDocument.body,this.$Mb);S.a.rr||(J.a.instance.ta(F.a.pointerDown,this.domElement,this.gz),J.a.instance.ta(F.a.vn,this.domElement,this.XK))}mHh(){if(!gb.Whb){document.getElementById(gb.I$f);this.J$f=!0;var P=gb.Whb=document.createElement("div");this.grid.$.frame.Gea().appendChild(P);P.id=gb.I$f;P.className=y.a.aNh;U.DOMElementExtensions.setVisible(P,!1)}}k0e(){if(this.qEa){const P=this.domElement.ownerDocument.body;this.grid.mk?(P.removeEventListener(F.a.ila,
this.XPf),P.removeEventListener(F.a.yLa,this.YPf)):(J.a.instance.Aa(F.a.vn,P,this.peb),K.a.instance.Aa(F.a.xi,P,this.peb));this.qEa=!1}this.W_=!1;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.I6f():(this.uag(),this.DVd());Ka.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}uag(){this.grid.zd.Sl([this.isRow?13:14]);this.grid.zd.IXa()}$Vg(){this.fg.addRowColToModel(this.fk.Osb-1,this.fk.J5f);this.uYb=!0}mNd(P){if(!this.W_)return!1;const ta=this.isRow;
if(!this.grid.mk&&!this.D4){this.D4=document.createElement("div");this.D4.style.cssText="position: relative; width: inherit; height: inherit;"+(ta?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Z=this.fk.JH();Z.nextSibling;)this.D4.appendChild(Z.nextSibling);Z.parentNode.appendChild(this.D4)}Z=ta?P.y-this.qcb.y:(this.rtl?-1:1)*(P.x-this.qcb.x);const aa=ta?P.y-this.qFa.y:(this.rtl?-1:1)*(P.x-this.qFa.x),Ea=this.grid.mk?this.gfb:this.fk.s8();if(Ea===x.a.FAa)return!1;Z&&(0<this.kn||0<Ea+aa)&&
Ea+aa<=this.EGf&&(this.kn=this.fIc(aa),this.bod(P,this.kn,!1),this.grid.mk?this.kn>=gb.Ymf?(this.IXd=!0,this.fk.setCellExtent(this.kn)):this.IXd&&(this.IXd=!1,this.fk.setCellExtent(gb.Ymf)):(U.DOMElementExtensions.eta(this.fk.JH(),!ta,Math.max(this.DSb+aa,0)),this.D4.style[ta?"top":this.rtl?"right":"left"]=Math.max(aa,-this.DSb)+"px"),Z=(this.grid.mk?this.bXf:ta?this.fk.fg.$E:this.fk.fg.bF)+Math.max(aa,this.grid.mk?-this.gfb+gb.cmc:-this.DSb),U.DOMElementExtensions.eta(this.fk.fg.domElement,!ta,Z),
this.grid.mk&&this.fk.fg.FPj(Z),this.qcb=new Sys.UI.Point(P.x,P.y),U.DOMElementExtensions.setVisible(this.VI,!1));return!0}s8(){return this.fk?this.G5?gb.fsi:this.fk.s8():x.a.FAa}bod(P,ta,Z){this.NP&&Z&&(T.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.DVd());this.NP||Z||T.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");
this.bHd&&this.bHd(()=>({["Location"]:"canvas"}));this.NP?this.L$e(ta):(this.NP=document.createElement("div"),this.NP.id=this.Vri,this.L$e(ta),this.NP.className=y.a.ALh,ta=document.getElementById(this.grid.$.Ad+z.a.qIf),ta.insertBefore(this.NP,ta.firstChild),P=ha.a(this.grid.$).Gna(P),this.NP.style.left=(this.rtl?Math.max(P.x-this.NP.offsetWidth,0):P.x-Math.max(P.x+this.NP.offsetWidth-ta.offsetWidth,0)).toString()+"px",ta=document.getElementById(z.a.Awa),this.NP.style.top=(P.y-(G.AFrameworkApplication.sa&&
G.AFrameworkApplication.sa.Sa.$g?0:ta.offsetHeight)-this.NP.offsetHeight).toString()+"px")}DVd(){U.DOMElementExtensions.xh(this.NP);this.NP=null}L$e(P){var ta=new Ia(this.grid.$.workbookContext.DxDigitNormal);ta=this.isRow?ta.BRe(P).toFixed(2):ta.rRe(P).toFixed(2);this.NP.innerText=`${this.isRow?this.Pri:this.Zri} ${ta} (${P.toString()} ${this.Sri})`}XZf(P,ta){let Z;const aa=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===P.ud&&P.Ca.button!==Sys.UI.MouseButton.leftButton||
!this.kEd(Z=this.Eqd(P))||!aa)return!1;ka.g(P.Ca);this.qFa=this.qcb=new Sys.UI.Point(P.clientPoint.x,P.clientPoint.y);this.uch(Z,ta);if(!this.fk)return!1;this.W_=!0;this.OJi(this.fk,Z)&&this.Zvi();this.DSb=this.Ipd();return this.YZf(P.Ca.rawEvent,ta)}WZf(P,ta,Z,aa,Ea,za){this.W_=!0;this.G5=Ea;this.fk=P;this.Grc=!1;this.qFa=this.qcb=new Sys.UI.Point(ta,Z);P=this.fk.getRange();this.LU=Ea?this.ODe(P):P;this.gfb=this.s8();this.bXf=this.isRow?this.fk.fg.$E:this.fk.fg.bF;this.YZf(za,aa)}YZf(P,ta){const Z=
this.grid.mk?{["IsResizingHiddenHeader"]:this.G5,["IsAutoFitting"]:ta,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas",["ResizeRange"]:this.LU,["ResizedCellAbsoluteIndex"]:this.fk.Osb,["HeaderViewBlockHashCode"]:this.fg.hashCode}:{["IsResizingHiddenHeader"]:this.G5,["IsAutoFitting"]:ta,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas"};pa.b(this.grid.$).Xe(N.a.nHj,Z);this.grid.a_j&&(ta=ta?"header_resize_autofit":"header_resize_start",ob.b(this.grid.$).YFa(P,ta,
void 0));this.offset=this.fk.Nea();this.kn=this.grid.mk?this.gfb:this.fk.s8();if(this.kn===x.a.FAa)return!1;Ka.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}OJi(P,ta){var Z=this.fk.JH();if(!Z)return T.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Z=Z.nextSibling;if(!Z)return!1;P=P.getRange();Z=this.fg.rza(Z).getRange();if(!P||!Z)return T.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;P=this.isRow?P.bottom:
P.right;Z=this.isRow?Z.bottom:Z.right;return P+1!==Z&&P!==Z&&this.kEd(ta,!0)}Zvi(){var P=this.fk.JH();const ta=this.fg.rza(P.nextSibling);gb.PJi(ta,this.isRow)?(this.fk=ta,this.LU=this.fk.getRange()):(this.aWg(P),this.fk=ta,P=this.fk.getRange(),this.LU=this.ODe(P),this.G5=!0)}ODe(P){return this.isRow?new V.Range(P.top-1,P.left,P.top-1,P.right,!1,!0):new V.Range(P.top,P.left-1,P.bottom,P.left-1,!1,!0)}aWg(P){const ta=this.fg.rza(P.nextSibling),Z=gb.yrh(ta,this.isRow,this.rtl);Z&&P.parentNode.insertBefore(Z,
ta.JH())}isd(P){const ta=this.LU,Z=P.ha.ra.selectedRanges;if(P.ha.ra.Kzb(ta))if(this.isRow){if(O.a.all(Z,aa=>aa.isRow))return Z}else if(O.a.all(Z,aa=>aa.Ci))return Z;return[ta]}getCellExtent(){return this.fk.getCellExtent()}Ipd(){const P=this.fk.JH().style;return Math.max(0,Math.min(this.EGf,0|parseInt(this.isRow?P.height:P.width,10)))}fIc(P=0){const ta=this.grid;var Z=this.fg.fl.paneType;let aa;aa=this.isRow?3===Z?[3,2]:[1,4]:4===Z?[2,4]:[1,3];var Ea=Math.max(this.grid.mk?this.gfb:this.fk.s8(),0);
P=this.G5&&!this.grid.mk?Math.max(this.Ipd(),0):Math.max(Ea+P,0);Z=ta.Abi(Z,this.isRow);Z=this.isRow?new t.a(0,this.offset,Z,P):new t.a(this.offset,0,P,Z);Ea=[this.isRow?13:14];ta.zd.sm(new V.Range(1,1,x.a.qh,x.a.ph,!1,!0),Ea,!1);ta.zd.tt(Ea,Z,aa);return P}Kad(){this.LU=this.qFa=this.qcb=null;if(this.D4){const P=this.D4.parentNode;if(P)for(P.removeChild(this.D4);this.D4.firstChild;)P.appendChild(this.D4.firstChild);this.D4=null}this.fk=null;this.W_=!1;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.I6f()}I6f(){this.Grc=!1;this.DVd();U.DOMElementExtensions.setVisible(gb.Whb,!1);U.DOMElementExtensions.setVisible(this.VI,!1);ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.uag()}Eqd(P){if(U.DOMElementExtensions.UB(P.Nd,"a"))return null;const ta=this.Cyf(P.Ca);if(ta&&this.grid.ha.ra.yj){var Z=this.grid.ha.ra.Ye;Z=this.fg.Fu(V.Range.xe(Z.bottom,Z.right))}else Z=this.fg.rza(P.Nd);if(!Z)return null;const aa=Z.JH(),Ea=new Sys.UI.Bounds(aa.offsetLeft,aa.offsetTop,
aa.offsetWidth,aa.offsetHeight);var za=U.DOMElementExtensions.getBoundingClientRect(P.Nd);za=new Sys.UI.Point(P.clientPoint.x-za.x,P.clientPoint.y-za.y);this.isRow&&!ta&&(za.y+=qa.HelperMethods.EF(P.Nd,aa,this.rtl).y);return new cb(aa,za,Ea,Z.getRange(),Math.max(gb.pZi,Math.min(gb.nYi,(this.isRow?Ea.height:Ea.width)*gb.xHj)),ta,!this.isRow&&0<aa.getElementsByTagName("input").length)}kEd(P,ta=!1){if(!P||this.grid.Xc)return!1;if(P.Byf)return!0;var Z=P.Tpa;const aa=P.Vhb;var Ea=this.fg.fl.paneType,za=
this.grid.Ih(Ea).Yk,bb=!!za&&za.top===P.Cvd.top,Mb=!!za&&za.left===P.Cvd.left;Ea=!!za&&za.bottom===P.Cvd.bottom&&(3===Ea||2===Ea);this.isRow?(Mb=P.JLb.y,P=Mb<=aa&&!bb,Z=Mb>=Z.height-aa-(Ea?gb.FZh:0),ta=ta?P:Z||P):(Ea=P.Jqi,bb=this.rtl,za=P.JLb.x,P=za<=aa&&(!Mb||bb)&&(!Ea||!bb),Z=za>=Z.width-aa&&(!bb||!Mb)&&(!Ea||bb),ta=ta?bb?Z:P:P||Z);return ta}uch(P,ta){const Z=this.isRow;if(P.Byf)this.fk=this.fg.rza(P.kAa);else if(Z&&P.JLb.y<=P.Vhb&&P.Tpa.height>P.Vhb||!Z&&P.Tpa.width>P.Vhb&&(!this.rtl&&P.JLb.x<=
P.Vhb||this.rtl&&P.JLb.x>=P.Tpa.width-P.Vhb)){if(this.fk=P.kAa.previousSibling?this.fg.rza(P.kAa.previousSibling):this.Oai(),ta&&P.kAa.classList.contains(Z?y.a.r5e:y.a.q5e)&&(P=this.fg.rza(P.kAa)))P=P.getRange(),this.LU=Z?new V.Range(P.top-1,P.left,P.top-1,P.right,!1,!0):new V.Range(P.top,P.left-1,P.bottom,P.left-1,!1,!0)}else this.fk=this.fg.rza(P.kAa);!this.LU&&this.fk&&(this.LU=this.fk.getRange())}Oai(){var P=this.isRow?1:0;return(P=this.fg.fl.wE(this.fg.fl.za.Ji(this.grid.$.na,m.a.AM(this.fg.position.X+
P-1,this.fg.position.Y-P,this.fg.position.PaneType))))?P.Nai():null}hqf(){this.Grc=!0;const P=this.yHj;U.DOMElementExtensions.setVisible(P,!0);P.style.cursor=this.isRow?y.a.N2e:y.a.J1e;this.fIc()}CGh(P){this.grid.$.Fe(this.isRow?745189930:-445963340,I.a.ld,30,{["resizeRowColumnParameters"]:P})}ovh(){const P=document.createElement("div");P.className=y.a.ZNh;const ta=document.createElement("div");ta.className=k.a.nH;P.appendChild(ta);const Z=document.createElement("img");Z.src=sa.a.di(0);Z.className=
this.isRow?k.a.YMh:k.a.TMh;ta.appendChild(Z);this.fg.Sz.domElement.parentNode.insertBefore(P,this.fg.Sz.domElement);this.grid.mk?P.addEventListener(F.a.jda,this.aaj):(J.a.instance.ta(F.a.pointerDown,P,this.gz),W.a.instance.ta(F.a.om,P,this.vga));U.DOMElementExtensions.setVisible(P,!1);this.VI=P}NQb(){this.Kad();this.VI&&(this.fg.Sz.domElement.parentNode.removeChild(this.VI),this.VI=null)}Cyf(P){return U.DOMElementExtensions.Eh(this.VI,P.target)}ywb(){this.W_&&(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&
this.grid.mk&&this.mNd(this.qFa),this.k0e(),this.grid.mk||U.DOMElementExtensions.eta(this.fk.JH(),!this.isRow,this.DSb),this.NQb(),this.uYb=this.G5=!1)}Uof(P){(P=P.Ca.rawEvent)&&P.detail===gb.kMj&&(P.type===F.a.ur?(this.W_=!1,this.k8c=!0):P.type===F.a.TK&&(this.W_=!0,this.k8c=!1))}static vrh(P,ta){return new gb(P,ta)}static r1d(P,ta,Z){if(ta){P.ColumnWidth=-1;P.RowHeight=Z;for(const aa of P.SheetMultiRange.Ranges)aa.FirstColumn=0,aa.LastColumn=0}else{P.RowHeight=-1;P.ColumnWidth=Z;for(const aa of P.SheetMultiRange.Ranges)aa.FirstRow=
0,aa.LastRow=0}}static PJi(P,ta){if(!P||!P.JH())return T.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Z=P.getRange();P=P.JH().style;if(!Z||!P)return T.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;P=ta?P.height:P.width;return(ta?Z.top:Z.left)===(ta?x.a.qh:x.a.ph)&&P===gb.pAg}static yrh(P,ta,Z){if(!P)return T.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var aa=P.JH();if(!aa||!aa.style)return T.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;P=document.createElement("div");const Ea=aa.style;P.style.top=ta?Ea.top:gb.pAg;ta||(Z?P.style.right=Ea.right:P.style.left=Ea.left);P.classList.add(ta?C.$Mh:C.ZMh);P.classList.add(ta?y.a.UAb:y.a.TAb);Z=document.createElement("div");Z.classList.add(ta?y.a.g5e:y.a.Hkd);aa=ta?Number.parseInvariant(aa.innerText):V.Range.x5a(aa.innerText);Z.innerText=ta?(aa-1).toString():V.Range.lP(aa-1);P.appendChild(Z);return P}}gb.pZi=0;gb.nYi=5;gb.cmc=1;gb.Ymf=
1;gb.fsi=0;gb.FZh=3;gb.xHj=.1;gb.I$f="ewa-rszrbg";gb.pAg="0px";gb.kMj=2;gb.Whb=null;Object(u.a)(gb,"HeaderResizeBehavior",Da.a,[558]);class Za extends v.a{constructor(){super();this.Md()}create(){this.qd(gb.vrh)}static la(P){P.ea.Ja(136,new Za)}}Object(u.a)(Za,"HeaderResizeBehaviorFactory",v.a,[]);var da=a(62),ya=a(734),ib=a(54),vb=a(40),eb=a(178),Ta=a(432),La=a(384),fb=a(202),Pb=a(160),Sa=a(248),Wa=a(295),pb=a(68),wa=a(21);class hb{constructor(P,ta){this.isRow=!1;this.autoFitRange=null;this.isRow=
P;this.autoFitRange=ta}}Object(u.a)(hb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[134]);class Sb{constructor(P){this.resizeParameters=null;this.resizeParameters=P}}Object(u.a)(Sb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[134]);var Bc=a(139);Da=a(296);var ab=a(24),qb=a(64);class mc extends Da.a{constructor(P,ta){super(P);this.tPa=Z=>{Z=this.Rqd(Z);return this.Tnd(Z)};this.oHj=(Z,aa)=>{var Ea=this.Obb=aa[mc.XDi];1===Z?(Z=aa[mc.O2j],Ea=this.jjf(Z,Ea),T.ULS.shipAssertTag(537153996,
0,Ea!==mc.ofa,`ResizeHeadersDialogHandler - invalid size input, size = ${Z}`),Z=Ea!==this.Fxd,T.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.Obb,Ea,Z),Z&&this.Zoh(Ea)):T.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===ta.command;this.gridView=wa.h(this.$);this.TDc=new Ia(this.$.workbookContext.DxDigitNormal);
this.Fxd=this.$ch();P=this.Fnh(this.Fxd);ta=this.Hnh(this.Fxd);this.nm=Ba.a.instance.ia(this.isRow?478:479);P=this.oK(P,ta);this.initializeAndShow(this.nm,this.oHj,P);T.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get pe(){return"ResizeHeadersDialog"}get Obb(){return mc.Bne}set Obb(P){mc.Bne=P}oK(P,ta){return{[mc.QP]:this.pe,[mc.dKi]:this.isRow,[mc.xwi]:P,[mc.wwi]:ta,[mc.EGi]:this.Obb,[mc.Qqd]:this.tPa}}$ch(){const P=this.R1h();try{return this.s6h(P)}finally{P&&
P.dispose()}}Zoh(P){const ta={};ta.SheetMultiRange=R.r(this.gridView.ha.ra.selectedRanges,this.$);mc.r1d(ta,this.isRow,P);this.$.Fe(this.isRow?745189930:-445963340,I.a.ld,8,{["resizeRowColumnParameters"]:ta})}jjf(P,ta){return ab.a.l9(P)?ta?this.Enh(P):this.Gnh(P):mc.ofa}Gnh(P){return Math.floor(parseFloat(P))}Enh(P){P=parseFloat(P);return 0>P?mc.ofa:P?this.isRow?qa.HelperMethods.qmj(P):this.TDc.Ajh(P):0}Hnh(P){return P===mc.ofa?"":this.isRow?this.TDc.BRe(P).toString():this.TDc.rRe(P).toFixed(2)}Fnh(P){return P===
mc.ofa?"":P.toString()}s6h(P){if(!P||!P.$$mn()||!P.Yn)return mc.ofa;var ta=Object(Bc.a)(245,P.Yn);if(!ta)return mc.ofa;for(ta=this.isRow?ta.dGb:ta.Dxd;P.$$mn();){const Z=Object(Bc.a)(245,P.Yn);if(Z&&(this.isRow?Z.dGb:Z.Dxd)!==ta)return mc.ofa}return ta}R1h(){const P=[];for(const Z of this.gridView.ha.ra.selectedRanges){const aa=Z.clone();var ta=this.gridView.Ih(this.gridView.Tc.Rj(aa));ta=aa.Xf(ta.Yk);if(!ta)return null;this.isRow?aa.right=aa.left=ta.left:aa.top=aa.bottom=ta.top;P.push(aa)}return P.length?
this.gridView.h7("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",P):null}Rqd(P){if(!ab.a.l9(P))return 1;P=this.jjf(P,this.Obb);if(0===P){const ta=this.gridView.ha.ra.selectedRanges,Z=this.gridView.Uk("ResizeHeaderDialog");if(Object(qb.c)(Z)){if(!Z.value.kLe(ta,this.isRow))return 3}else if(this.NJi())return 3}return this.$Mi(P)?0:2}NJi(){const P=this.gridView.ha.ra.selectedRanges;return this.isRow&&R.Q(P)||!this.isRow&&R.P(P)}Tnd(P){let ta="";switch(P){case 0:ta="";break;case 1:ta=Ba.a.instance.ia(767);
break;case 2:ta=String.format(Ba.a.instance.gd(99),0,this.Okc(this.Obb));break;case 3:ta=Ba.a.instance.ia(768)}return ta}$Mi(P){return 0<=P&&P<=this.Okc(!1)}Okc(P){return this.TDc.Okc(P,this.isRow)}static r1d(P,ta,Z){if(ta){P.ColumnWidth=mc.ofa;P.RowHeight=Z;for(const aa of P.SheetMultiRange.Ranges)aa.FirstColumn=0,aa.LastColumn=0}else{P.RowHeight=mc.ofa;P.ColumnWidth=Z;for(const aa of P.SheetMultiRange.Ranges)aa.FirstRow=0,aa.LastRow=0}}}mc.QP="id";mc.dKi="isRow";mc.xwi="initialSizeInPx";mc.wwi=
"initialSizeInDefaultUnits";mc.EGi="isInitialUnitsDefaultUnits";mc.Qqd="getInputErrorIfInvalid";mc.O2j="size";mc.XDi="isDefaultUnits";mc.ofa=-1;mc.Bne=!0;Object(u.a)(mc,"ResizeHeadersDialog",Da.a,[]);var yb=a(65);const vc=(P,ta,Z,aa,Ea,za,bb=null)=>{bb=P.Ra(41,bb);bb.resizeRowColumnParameters=ta;return yb.g(P,"ResizeRowsColumns",bb,Z,aa,Ea,za,0)};var Db=a(298),Ga=a(155),Eb=a(35),Zb=a(360);class ic{constructor(P,ta,Z,aa){this.$dj=(Ea,za)=>{if(!Sa.a(Ea)&&za){const bb=!!Ea&&!!Ea.RequestTelemetryData;
wa.h(this.$).Ri.Dpa(za,Ea.StateId,bb?Ea.RequestTelemetryData.EcsOperationDuration:0,bb?Ea.RequestTelemetryData.EcsRequestDuration:0,bb?Ea.RequestTelemetryData.WfeRequestDuration:0)}};this.b6i=(Ea,za)=>{vb.TaskExtensions.ya(ib.GetServiceTaskFactory.Vc(this.$.ea,534,535,1),bb=>{bb.result.Vck(za)},this.$.ka,3)};this.$=P;this.Tg=ta;this.gridInstantaneousAction=Z;this.grid=wa.h(this.$);this.rEb=aa}Ce(P,ta){P=!0;switch(ta){case -445963340:case 1391094586:P=this.Gf(8);break;case 745189930:case 146338636:P=
this.Gf(16)}return!P}executeCommand(P,ta,Z){var aa=wa.h(this.$);const Ea=ta.command;var za=eb.a.create().toString();let bb=vb.TaskExtensions.Hl();switch(Ea){case 1391094586:case 146338636:P=1391094586===Ea;(za=Z.autoFitRanges)&&za.Ranges&&za.Ranges.length||(za=R.r(aa.ha.ra.selectedRanges,this.$));bb=this.rCh(P?1:0,za,ta);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:P=-445963340===Ea||-706918724===Ea||369708605===Ea;ja.EwaSettings.vRa()&&-706918724===
Ea&&aa.Ri.w4(18,za,Ta.a(Ea));if(-445963340===Ea||745189930===Ea){var Mb=Ta.a(ta.command);aa.Ri.w4(16,za,Mb);aa=Z.resizeRowColumnParameters}else{Z=aa.ha.ra.selectedRanges;let Xa=0,bc=!1,Ac="",Xc=!1;const Ed=ja.EwaSettings.JHb();Ed&&(Ac=Ta.a(ta.command),bc=1<Z.length?!0:!1);for(var zb of Z){if(Ed&&this.rEb){var oa=this.grid.za.N1(zb);this.rEb.h4c(oa,Ac)}if(-706918724===Ea||369708605===Ea)oa=zb.right-zb.left+1,Xa+=0<oa?oa:-1*oa;else if(1542466017===Ea||1051390410===Ea)Xc=!0,Xa+=zb.bottom-zb.top+1}Ed&&
this.rEb&&(this.rEb.bBe(Xa,Ac),this.rEb.hAe(Ac,Xc,Xa,Z[0]));369708605===Ea||1542466017===Ea?T.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Xa}, isDiscontinuous=${bc}`):(-706918724===Ea||1051390410===Ea)&&T.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Xa}, isDiscontinuous=${bc}`);if(!Object(qb.c)(aa.Uk("ResizeCmdHandler"))){if(-706918724===Ea&&6===ta.Hg&&R.P(Z)){T.ULS.sendTraceTag(537154007,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Ea&&6===ta.Hg&&R.Q(Z)){T.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}zb=369708605===Ea||1542466017===Ea?-2:0;aa={};aa.SheetMultiRange=R.r(Z,this.$);if(P)for(Mb of aa.SheetMultiRange.Ranges)Mb.FirstRow=0,Mb.LastRow=0;else for(const Qd of aa.SheetMultiRange.Ranges)Qd.FirstColumn=
0,Qd.LastColumn=0;aa.RowHeight=P?-1:zb;aa.ColumnWidth=P?zb:-1}bb=this.NCh(aa,ta,za,P);break;case 957527587:case 2040891415:new mc(this.$,ta)}return bb}qe(P,ta,Z,aa){if(P=!!Z&&!!aa&&1===aa.Xz)switch(ta.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:P=!1}return P}Ge(){return!1}zTi(P){T.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Db.c)(P)}. Reason: ${Object(Db.c)(P)?
void 0:P.reason}.`)}Gf(P){return(new Pb.a(this.$.va)).Gf(P)}rCh(P,ta,Z){const aa=this.$.pa.ua.Ud(),Ea=0===P,za=()=>new hb(Ea,ta);return La.a(this.$.userOperationManager,(bb,Mb,zb)=>{var oa=this.$.pa.ua;bb=Wa.b(bb,this.b6i);var Xa={iDi:!Ea,tvb:ta};const bc=oa.Ra(41,aa);bc.isRow=Ea;bc.autoFitRanges=ta;return yb.g(oa,"AutoFit",bc,bb,Mb,zb,Xa,0)},bb=>new fb.a(135,0,bb,void 0,za),Z)}NCh(P,ta,Z,aa){const Ea=ta.command,za=wa.h(this.$),bb=R.g(P.SheetMultiRange.Ranges);if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Mb=
1051390410===Ea||745189930===Ea&&0===P.RowHeight;const bc=-706918724===Ea||-445963340===Ea&&0===P.ColumnWidth,Ac=za.Uk("ResizeCmdHandler");if((Mb||bc)&&Object(qb.c)(Ac)&&!Ac.value.kLe(bb,!aa))return this.zBh(aa),vb.TaskExtensions.Hl()}let zb;Mb=ja.EwaSettings.vRa()&&-706918724===Ea;if(745189930===Ea||-445963340===Ea||Mb)T.ULS.shipAssertTag(537154002,0,this.$.activeItemName===P.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Mb?(this.gridInstantaneousAction.Nvj(),
Object(Ga.c)(()=>{za.Ri.Yuc();this.gridInstantaneousAction.S6g(Ea)},this.$.ka,0)):(zb=this.Tg.l4d(za,bb,aa?P.ColumnWidth:P.RowHeight,!aa),this.zTi(zb),Object(Db.c)(zb)&&za.Ri.oR(Z,pb.BasicTelemetryCalculator.VP));const oa=this.$.pa.ua.Ud({Cpa:!0,ooa:3});aa=(bc,Ac,Xc)=>{this.$.VA();R.i(bb,",",this.$,!1);return vc(this.$.pa.ua,P,Wa.b(bc,this.$dj),Ac,Xc,Z,oa)};const Xa=()=>new Sb(P);return zb&&Object(Db.c)(zb)?La.a(this.$.userOperationManager,aa,bc=>new fb.a(136,0,bc,64,Xa),ta):La.a(this.$.userOperationManager,
aa,bc=>new fb.a(136,0,bc,void 0,Xa),ta)}zBh(P){P=Eb.a.Ze(1,0,P?769:771,P?770:772,0,P?-2037763134:503471870,P?"HideAllColumnsError":"HideAllRowsError");new Zb.a(this.$,P)}}Object(u.a)(ic,"ResizeCommandHandler",null,[190]);var mb=a(92),Hb=a(151),Wb=a(19);class Ob extends ya.a{constructor(P){super(P)}yf(){let P;P=ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7896261_FormatCellsActionNewService")?Object(mb.d)(Hb.a.resolve(Wb.bb,{Qa:this.Na})):ib.GetServiceTaskFactory.create(this.$.ea,18,this.ka,this.Na);
let ta;ta=ja.EwaSettings.vRa()?ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)?Object(mb.d)(Hb.a.resolve(Wb.qb,{Qa:this.Na})):ib.GetServiceTaskFactory.Vc(this.$.ea,528,529,this.Na):da.Task.Wa(null);let Z;Z=ja.EwaSettings.JHb()?Object(mb.d)(Hb.a.resolve(Wb.nb,{Qa:this.Na})):da.Task.Wa(null);vb.TaskExtensions.ya(vb.TaskExtensions.Bf([P,Z],this.ka),()=>{this.gf([new ic(this.$,P.result,ta.result,Z.result)])},this.ka,3)}static la(P){ya.a.Nf(113,new Ob(P))}}
Object(u.a)(Ob,"ResizeCommandHandlerFactory",ya.a,[]);Da=a(733);var Gc=a(96);let Va=null,Jb=class{constructor(P){this.Uj=()=>{Va&&(Gc.a.Ma(Va),Va=null);this.HHb&&(this.$.LAd=!1)};this.$=P;this.gridView=wa.h(this.$);this.za=this.gridView.za;this.wIb=!1;this.kfd=this.$.da.mg;this.QRb={};this.O8={};this.HHb=ja.EwaSettings.getBooleanFeatureGate("isGlobalStylesSlice1Enabled",!1);this.za.su(this.Uj)}dispose(){this.gridView=this.$=null;this.O8={};this.wIb=!1;this.QRb={};this.za.eu(this.Uj)}S6g(P){if(this.wIb)T.ULS.sendTraceTag(509658009,
0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${P}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);else{var ta=this.za.Maf(),Z=b(ta);this.O8={};this.KGi(P,ta,Z)?(this.wIb=!0,this.$.LAd=!0,this.u0f(P,!1,Z,ta)):this.gridView.Ri.Yuc(!1)}}Nvj(){this.kfd=this.$.da.mg}KGi(P,ta,Z){var aa=this.gridView;if(-706918724!==P||aa.rtl)return!1;if(aa.Tc.qY)return T.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = hasPanes, value=true, isRow=false`),
!1;var Ea=aa.Uk("GridInstantaneousAction");if(!Object(qb.c)(Ea))return T.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;aa=aa.ha.ra.selectedRanges;var za=aa[0];const bb=aa.length;if(1<bb)return T.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = SelectedRanges, value=${bb}, reason = Discontinuous selection, isRow=false`),
!1;if(Ea.value.jbb(za))return T.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;Ea=za.right-za.left+1;if(Ea>ja.EwaSettings.CXi())return T.ULS.sendTraceTag(509658005,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = ColumnCount, value=${Ea}, reason = Multiple columns selected, isRow=false`),!1;ta=ta.length;if(ta>ja.EwaSettings.BXi())return T.ULS.sendTraceTag(509658004,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = BlocksInViewport, value=${ta}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(Mb of Z){if(!Mb||!Mb.source||!Mb.destination){T.ULS.sendTraceTag(509649925,0,50,"GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null");var Mb=!1;break a}ta=Mb.source.Jf.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(ta,ta.ColumnNumbers[0],
!1)){Mb=!1;break a}}Mb=!0}if(!Mb)return T.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;a:{Mb=za.left;za=this.za.ZOa(za,this.$.activeItemName);for(zb of za)if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(zb.Jf.GridBlockModel,Mb,!1)){var zb=!1;break a}zb=!0}if(!zb)return T.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=false`),
!1;aa=aa[0];zb=0;for(let oa of Z)if(oa.destination.Qf.Te(aa)||oa.destination.Qf.left>aa.right)zb+=1;Z=zb;if(Z>ja.EwaSettings.FXi())return T.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = TransitionCount, value=${Z}, reason = Transition count limit exceeded, isRow=false`),!1;T.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${P}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);
return!0}u0f(P,ta,Z,aa){try{const Ea=qa.HelperMethods.Dd(),za=ja.EwaSettings.EXi();let bb=Z.filter(Mb=>!Mb.orc);for(let Mb of bb){if(this.Jye("WebServiceResponseReceivedInProcessGridAction",aa,P))return;const zb=this.gridView.ha.ra.selectedRanges[0],oa=Mb.destination.Qf.right;if(oa<zb.left){Mb.orc=!0;T.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${P}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${zb.left}, blockRangeRightMostValue=${oa}, hashCode=${Mb.destination.af}, isRow=false`);
continue}const Xa=ta?zb.topLeft.top:zb.topLeft.left,bc=this.Vaf("SourceModel",Mb.source),Ac=this.Vaf("DestinationModel",Mb.destination),Xc=Mb.destination.af;if(Mb.destination.Qf.Te(zb)){if(!c(Ac,Xa)){this.Zva();T.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${P}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${Xc}, isRow=${ta}, rowColNumber=${Xa}`);return}T.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${P}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${Xc}, isRow=${ta}, rowColNumber=${Xa}`)}const Ed=
bc.ColumnNumbers[0],Qd=Mb.source.af;if(e(bc,Ac,Ed,ta).isSuccess)Mb.orc=!0,T.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${P}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${Qd}, isRow=${ta}, rowColNumber=${Ed}`);else{this.Zva();T.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${P}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${Qd}, isRow=${ta}, rowColNumber=${Ed}`);
return}this.J6j(Ac,bc,Mb);if(qa.HelperMethods.Dd()-Ea>za){this.uLj(P,ta,bb,aa);return}}this.tkh(ta,P,aa);d("ProcessGridAction",qa.HelperMethods.Dd()-Ea)}catch(Ea){this.joi(Ea)}}tkh(P,ta,Z){if(!this.Jye("CommitGridInstantaneousActionResults",Z,ta)){var aa=qa.HelperMethods.Dd();if(this.O8&&0!==Object.keys(this.O8).length)if(this.Emj(Z),this.QDg(ta,Z)){var Ea=eb.a.create().toString(),za=this.gridView.Uk("GridInstantaneousAction");Object(qb.c)(za)?(za.value.oae(this.gridView.ha.ra.selectedRanges,0,P),
ta=Object.keys(this.O8),this.za.z1f(ta,Ea,P?"row":"column",!0),this.wIb=!1,Va=$a.a(this.$).gi.iKa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,Ba.a.instance.ia(2188)),d("CommitGridInstantaneousActionResults",qa.HelperMethods.Dd()-aa)):(this.W$f(Z),this.Zva(),T.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${ta}, parameter = ActiveSheetProcessedData, value=null, isRow=${P}`))}else this.W$f(Z),this.Zva();else this.Zva(),
T.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${ta}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${P}`)}}Vaf(P,ta){let Z=this.O8[ta.af];if(!Z){const aa=qa.HelperMethods.qU(()=>{Z=ta.d5h()});d(P,aa)}return Z}Emj(P){for(let ta of P)P=ta.af,this.QRb[P]||(this.QRb[P]=ta.klc())}W$f(P){for(let ta of P){P=ta.af;const Z=this.QRb[P];if(Z&&!ta.P8f(Z)){T.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${P}`);
this.Zva();break}}}QDg(P,ta){for(let Z of ta)if(ta=Z.af,this.O8[ta]&&!Z.P8f(this.O8[ta]))return T.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${P}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${ta}, isRow=false`),!1;return!0}uLj(P,ta,Z,aa){window.setTimeout(()=>{this.u0f(P,ta,Z,aa)},0)}AMi(P){for(let ta of P)if(ta.Jf.Information.Revision>this.kfd)return!0;return!1}Jye(P,ta,Z){return this.AMi(ta)?(this.kfd=
this.$.da.mg,this.Zva(),T.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${Z}, parameter = ${P}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Zva(){this.O8={};this.wIb=!1;this.QRb={};this.gridView.Ri.Yuc(!1)}joi(P){this.Zva();T.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${P}.`)}J6j(P,ta,Z){this.O8[Z.destination.af]=P;this.O8[Z.source.af]=
ta}};Jb=Object(Da.a)([Object(Hb.d)(Wb.qb),Object(Da.b)(0,Object(Wb.R)())],Jb);Object(u.a)(Jb,"GridInstantaneousAction",null,[494]);var ub=a(737);class Qa extends v.a{constructor(P){super();this.$=P;this.Md()}create(){this.qd(Object(ub.a)(this.$.ea,528,()=>new Jb(this.$)))}static la(P){P.ea.Ja(529,new Qa(P))}}Object(u.a)(Qa,"GridInstantaneousActionFactory",v.a,[]);D.a.wk(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(()=>{n.a.Fa(P=>{Za.la(P);
Ob.la(P)})})();(()=>{n.a.Fa(P=>{ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)||Qa.la(P)})})();String(w);window.___1688279196356_closurehack=w}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/d6227ea41bf7282791a88e04d9c602f5/EwaTS.rsz.js.map