'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1342:function(w,D,a){a.r(D);var b={};a.r(b);a.d(b,"EwaNotificationFocusManager",function(){return y});var c={};a.r(c);a.d(c,"LineageDiscoverabilityCallout",function(){return cb});var e={};a.r(e);a.d(e,"ShowCalloutCommandHandler",function(){return cc});var f={};a.r(f);a.d(f,"OptimizeWorkbookManager",function(){return Gb});var d=a(0),h=a(234),r=a(733),n=a(2),u=a(15),v=a(275),x=a(260),k=a(147),m=a(1088),t=a(151),
z=a(19);let y=class{constructor(fc){this.V8c=this.Nmd=null;this.h_a=this.isFocused=!1;this.$=fc}dispose(){}get de(){return null}get Vh(){return this.h_a}get Tf(){return x.a.gLd}$h(fc,Oa){Oa||this.isFocused||!this.Nmd||this.Nmd();return!Oa}nj(fc){return fc===document.activeElement&&this.isFocused}Vk(){this.isFocused=!0}yl(){this.isFocused&&this.V8c&&(this.V8c(),this.isFocused=!1)}ixi(){u.ULS.shipAssertTag(537169939,0,k.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");
const fc=Object(n.a)(new m.a,{onFirstActionableAppear:()=>{v.a(this.$).Wj(this);this.h_a=!0},onLastActionableDisappear:()=>{v.a(this.$).TA(this);this.h_a=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(fc).then(Oa=>{this.Nmd=()=>{Oa.focus()};this.V8c=()=>{Oa.blur()};return null})}};y=Object(r.a)([Object(t.d)(z.S),Object(r.b)(0,Object(z.R)())],y);Object(d.a)(y,"EwaNotificationFocusManager",null,[290,5,33]);class C extends h.a{constructor(fc){super();
this.$=fc;this.Md()}create(){this.qd(this.$.ea.Ba(357)||new y(this.$))}static la(fc){fc.ea.Ja(358,new C(fc))}}Object(d.a)(C,"EwaNotificationFocusManagerFactory",h.a,[]);var J=a(1),F=a(1258),K=a(920),L=a(921),S=a(181),W=a(192);class G{constructor(fc){this.BN=null;this.$=fc}show(){const fc=this.qza();u.ULS.shipAssertTag(537169938,0,!!fc,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");W.UISurfaces.nK().then(Oa=>{const Lb=Oa.callout(fc);this.BN=Oa.addNotification(Lb)},Oa=>{u.ULS.sendTraceTag(537169936,
0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${Oa}`);return null})}dismiss(){this.BN&&W.UISurfaces.nK().then(fc=>{fc.removeNotification(this.BN);return this.BN=null})}bZa(fc){W.UISurfaces.nK().then(Oa=>{Oa.updateNotification(this.BN,Oa.callout(Object.assign(new K.a,fc)))},Oa=>{u.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${Oa}`);return null})}}Object(d.a)(G,"EwaReactCallout",null,[335]);class O{static HIb(fc){return!!(fc&1)}static xCd(fc){return!!(fc&
2)}static Slk(fc){return!!(fc&O.Uui)}}O.Uui=6;Object(d.a)(O,"EwaReactCalloutModeUtil",null,[]);class T{constructor(){this.h1=0;this.JJb=null;this.BJc=!0}}Object(d.a)(T,"EwaReactShowOrDismissCalloutMetadata",null,[]);var I=a(61),N=a(40),R=a(120),V=a(834);class sa{constructor(fc,Oa,Lb){this.indexedDB=null;this.$=fc;this.dP=Oa;this.PLa=Lb}bCf(){const fc=new S.a;let Oa=new T;N.TaskExtensions.ya(this.J0e(),Lb=>{Lb.result?N.TaskExtensions.ya(this.indexedDB.h9a(this.dP),Fc=>{if(Fc=Fc.result){Fc=I.a.nk(Fc);
if(!Fc){this.D6e(fc);return}if(O.HIb(this.PLa)){const Wc=Fc.NumberOfDisplays;Oa.h1=Wc?Number.parseLocale(Wc):0}O.xCd(this.PLa)&&(Fc=Fc.LastDisplay,Oa.JJb=Fc?new Date(Number.parseLocale(Fc)):null)}fc.setResult(Oa)},this.$.ka):this.D6e(fc)},this.$.ka,3);return fc.task}jcg(fc){const Oa=new S.a;N.TaskExtensions.ya(this.J0e(),Lb=>{Lb.result||Oa.setResult(!1);Lb={};O.HIb(this.PLa)&&(Lb.NumberOfDisplays=fc.h1.toString());O.xCd(this.PLa)&&(Lb.LastDisplay=R.toTimestamp(fc.JJb).m.toString());Lb=I.a.ye(Lb);
N.TaskExtensions.ya(this.indexedDB.pib(new V.a(this.dP,Lb)),Fc=>{Oa.setResult(Fc.result)},this.$.ka,3)},this.$.ka,3)}J0e(){const fc=new S.a;this.indexedDB?fc.setResult(!0):void t.a.resolve(z.vb,{Qa:1}).then(Oa=>{Oa.Rh()?(Oa.initialize("Callouts","EwaCallouts"),this.indexedDB=Oa,fc.setResult(!0)):(u.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),fc.setResult(!1))});return fc.task}D6e(fc){const Oa=new T;Oa.BJc=!1;fc.setResult(Oa)}}
Object(d.a)(sa,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[336]);class U{constructor(fc,Oa,Lb,Fc,Wc,td){this.J$b=Oa;this.L$b=Lb;this.PLa=Fc;this.dP=Wc;this.localStorage=td;this.$=fc}bCf(){const fc=new S.a,Oa=new T;if(O.HIb(this.PLa)){let Lb=0;Oa.BJc=(()=>{let Fc=this.Ndk();({oga:Lb}=Fc);return Fc})().returnValue&&Oa.BJc;Oa.h1=Lb}fc.setResult(Oa);return fc.task}jcg(fc){const Oa=new S.a;var Lb=!0;if(O.HIb(this.PLa)){const Fc=this.abf();Fc&&(Lb=Number.parseLocale(Fc),Lb=this.vek((Lb&~this.L$b|
fc.h1<<this.J$b).toString()))}Oa.setResult(Lb)}Ndk(){var fc;return(fc=this.abf())?(fc=(Number.parseLocale(fc)&this.L$b)>>this.J$b,u.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.dP} already appeared. Found the callout in storage.`),{returnValue:!0,oga:fc}):{returnValue:!1,oga:0}}vek(fc){try{if(!this.localStorage.Rh())return!1;try{return this.localStorage.setItem("CalloutIds",fc),!0}catch(Oa){u.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${Oa.message||
"Unknown"}`)}}catch(Oa){u.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${Oa.message}`)}return!1}abf(){try{if(!this.localStorage.Rh())return u.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.dP}.`),null;const fc=this.localStorage.getItem("CalloutIds");
return fc?fc:(u.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(fc){return u.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${fc.message}`),null}}}Object(d.a)(U,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[336]);var ka=a(76),ja=a(142),Da=a(197),qa=a(143),Ba=
a(586);class ua extends G{constructor(fc,Oa,Lb,Fc,Wc,td,na,Pa,lb,Nb,xc,Oc,yd,Sd,ve,Ee,Ue,hf){Nb=void 0===Nb?!1:Nb;xc=void 0===xc?!1:xc;Oc=void 0===Oc?!1:Oc;yd=void 0===yd?!1:yd;Sd=void 0===Sd?!1:Sd;ve=void 0===ve?!0:ve;Ee=void 0===Ee?!1:Ee;Ue=void 0===Ue?null:Ue;hf=void 0===hf?!1:hf;super(fc);this.h1=0;this.X3d=this.MNc=this.Azg=!1;this.HSf=()=>{this.Coc()};this.NGg=Oa;this.J_j=Lb;this.kBh=Fc;this.Bv=Wc;this.Av=td;this.localStorage=lb;this.MGg=na;this.LGg=Pa;this.vQi=Nb;this.Uvd=xc;this.nBh=Oc;this.setInitialFocus=
yd;this.useCoachmark=Sd;this.PEc=!1;this.WRj=ve;this.DHf=this.Lbi();this.OLa=Ue;this.X3d=hf;this.hasDynamicSizing=Ee}get oub(){return{}}set xBg(fc){this.Bv=fc}kde(){}iPa(){return 1}lpd(){return 0}get oga(){return 1}get v_f(){return!0}get dP(){return this.NGg}get L$b(){return this.MGg}get J$b(){return this.LGg}show(){N.TaskExtensions.ya(this.Haa(),fc=>{fc.result&&this.b0j()},this.$.ka)}XCf(){qa.b(this.$).Xe(ja.a.J2e,this.mjf("dismiss"),void 0,!0)}RDf(){qa.b(this.$).Xe(ja.a.J2e,this.mjf("show"),void 0,
!0)}qza(){const fc=Object(n.a)(new F.a,{label:this.kBh,onExecute:()=>{this.kde();this.XCf();this.MNc=!0;this.Coc()}});let Oa=null;this.Uvd||(Oa=Object(n.a)(new F.a,{label:this.J_j,onExecute:()=>{this.MNc=!0;this.RDf();const Lb=Da.c({["InputMethod"]:ka.a.ld},this.oub);this.$.Ha.kd(this.ribbonCommandInfo,Lb);this.Coc()}}));return Object(n.a)(new K.a,{target:this.fEb(),content:this.Av,title:this.Bv,primaryButtonProps:this.Uvd?fc:Oa,secondaryButtonProps:this.Uvd?null:fc,showCloseIcon:this.X3d,preventLightDismiss:!this.vQi,
hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.Coc()},directionalHint:this.OLa,preventDismissOnScroll:!0,preventDismissOnResize:!this.nBh,isBeakVisible:this.WRj,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Coc(){this.Azg=!0;const fc=this.$.ea.Ba(418);fc&&fc.cDj(this.HSf);(this.v_f&&this.MNc||this.X3d)&&this.utg(!0);this.MNc||u.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.dP} was dismissed without user interaction`);
this.dismiss()}Haa(){const fc=new S.a;this.roa()?N.TaskExtensions.ya(this.DHf.bCf(),Oa=>{var Lb=this.iPa();Oa=Oa.result;if(Oa.BJc)if(this.h1=Oa.h1,O.HIb(Lb)&&(this.PEc||Oa.h1>=this.oga))u.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.dP} already appeared. Found the callout in storage.`),this.PEc=!0,fc.setResult(!1);else{if(O.xCd(Lb)&&Oa.JJb&&(Lb=R.getElapsedSeconds(Oa.JJb,new Date),(Oa=this.lpd())||u.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.dP} with mode RestrictedBycooldown`),
Lb<Oa)){fc.setResult(!1);return}Lb=!this.BN&&!!this.fEb()&&!Ba.a(this.$);fc.setResult(Lb)}else fc.setResult(!1),u.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.dP}.`)},this.$.ka):fc.setResult(!1);return fc.task}roa(){return!0}fEb(){if(document.querySelector(this.GU))return this.GU;if(document.querySelector(this.FU))return this.FU;if(document.querySelector(this.hU))return this.hU;u.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.dP}`);
return null}utg(fc){fc=void 0===fc?!1:fc;this.PEc=!0;this.iPa();const Oa=new T;Oa.h1=fc?this.oga:this.h1+1;Oa.JJb=new Date;this.DHf.jcg(Oa)}b0j(){this.PEc=!0;this.utg();u.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.dP} callout, current number of displayes: ${this.h1}`);this.$.ea.Zc(418,fc=>{this.Azg||fc.A0g(this.HSf)});super.show()}Lbi(){const fc=this.iPa();return O.Slk(fc)?new sa(this.$,this.dP,fc):new U(this.$,this.J$b,this.L$b,fc,this.dP,this.localStorage)}mjf(fc){return{["selection"]:fc,
["callout"]:this.dP,["Location"]:"floatie",["displayCount"]:this.h1}}}Object(d.a)(ua,"EwaReactShowOrDismissCallout",G,[]);var pa=a(94),Ka=a(277),$a=a(16),ha;let cb=ha=class extends ua{constructor(fc){super(fc,ha.AQi,$a.a.instance.Ia(650),$a.a.instance.Ia(652),$a.a.instance.Ia(648),$a.a.instance.Ia(649),3072,10,new Ka.a)}oZj(){return this.Haa()}get GU(){return"[data-unique-id=Review]"}get FU(){return"[data-unique-id=pivotOverflowButton]"}get hU(){return'[id="'+this.$.Ad+'Ribbon.Review-title"]'}get v_f(){return!1}get ribbonCommandInfo(){return new pa.a(1834994092,
ka.a.ld,this.$.ee,9,null)}get oga(){return J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LineageDiscoverabilityCalloutDisplayLimit",3)}iPa(){return 3}lpd(){return 86400}roa(){return this.$.da.Mcb}};cb.AQi="LineageDiscoverabilityCallout";cb=ha=Object(r.a)([Object(t.d)(z.Bb),Object(r.b)(0,Object(z.R)())],cb);Object(d.a)(cb,"LineageDiscoverabilityCallout",ua,[291]);class Ia extends h.a{constructor(fc){super();this.$=fc;this.Md()}create(){const fc=new cb(this.$);this.qd(this.$.ea.Ba(456)||this.$.ea.Ja(456,
fc))}static la(fc){fc.ea.Ja(457,new Ia(fc))}}Object(d.a)(Ia,"LineageDiscoverabilityCalloutFactory",h.a,[]);var ob=a(734),gb=a(9);const Za='[id="'+gb.a.Qng+'"]';class da extends ua{constructor(fc,Oa,Lb,Fc,Wc,td,na,Pa,lb,Nb){super(fc,Oa,null,Lb,Fc,Wc,td,na,new Ka.a,Pa,!0,!0,lb,!1,!1,void 0,Nb)}get GU(){return Za}get FU(){return Za}get hU(){return Za}get ribbonCommandInfo(){return new pa.a(-847286761,ka.a.ld,this.$.ee,0,null)}roa(){return!(this.$.isMobileMode||this.$.da.ae.inEmbedView||this.$.da.ae.inWebPart)}}
Object(d.a)(da,"ZoomTeachingCallout",ua,[]);class ya extends da{constructor(fc){super(fc,"AdjustZoomTeachingCallout",$a.a.instance.Ia(694),null,$a.a.instance.Ia(693),2,1,!1,!0,2)}}Object(d.a)(ya,"AdjustZoomTeachingCallout",da,[]);class ib extends ua{constructor(fc){super(fc,"ConditionalFormattingManageRulesTeachingCallout",$a.a.instance.Ia(643),$a.a.instance.Ia(644),$a.a.instance.Ia(641),$a.a.instance.Ia(642),2,1,new Ka.a)}get GU(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get FU(){return'[data-unique-id="RibbonOverflowMenu"]'}get hU(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new pa.a(-20558303,
ka.a.ld,this.$.ee,0,null)}}Object(d.a)(ib,"ConditionalFormattingManageRulesTeachingCallout",ua,[]);var vb;(function(fc){fc[fc.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";fc[fc.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";fc[fc.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";fc[fc.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";fc[fc.lineageDiscoverability=4]="lineageDiscoverability";fc[fc.lineageTeachingCallout=5]="lineageTeachingCallout";
fc[fc.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";fc[fc.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";fc[fc.linkedEntityGallery=8]="linkedEntityGallery";fc[fc.fixedFreezePane=9]="fixedFreezePane";fc[fc.phoneticTeachingCallout=10]="phoneticTeachingCallout";fc[fc.powerQueryCallout=11]="powerQueryCallout";fc[fc.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";fc[fc.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";fc[fc.tableInNewWorkbook=
14]="tableInNewWorkbook";fc[fc.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";fc[fc.dataCleansing=16]="dataCleansing";fc[fc.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";fc[fc.excelBetterEntryTeachingCallout=19]="excelBetterEntryTeachingCallout";fc[fc.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";fc[fc.functionDialog=21]="functionDialog";fc[fc.length=22]="length"})(vb||(vb={}));Object(d.b)("EwaCalloutName",vb);
var eb=a(41);class Ta extends da{constructor(fc){super(fc,"FixedFreezePaneTeachingCallout",$a.a.instance.Ia(647),$a.a.instance.Ia(645),$a.a.instance.Ia(646),65536,16,!0,!1,8)}iPa(){return 0}}Object(d.a)(Ta,"FixedFreezePaneTeachingCallout",da,[]);class La extends ua{constructor(fc){super(fc,La.EQi,"",$a.a.instance.Ia(651),$a.a.instance.Ia(653),$a.a.instance.Ia(654),4096,12,new Ka.a,void 0,!0);this.OLa=9}get GU(){return La.XFd}get FU(){return La.XFd}get hU(){return La.XFd}get ribbonCommandInfo(){return null}}
La.EQi="LineageTeachingCallout";La.XFd="#LineagePaneFilterButton";Object(d.a)(La,"LineageTeachingCallout",ua,[]);var fb=a(105),Pb=a(7),Sa=a(57),Wa=a(24),pb=a(992);class wa extends pb.a{constructor(fc){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=fc.paragraphs;this.image=fc.image;this.imageWidth=fc.imageWidth;this.imageHeight=fc.imageHeight}}Object(d.a)(wa,"TextAboveImage",pb.a,[]);class hb{constructor(fc,Oa){this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=fc;this.image=Oa}}Object(d.a)(hb,"TextAboveImageCustomProps",null,[]);var Sb=a(898);class Bc extends G{constructor(fc){super(fc);this.Aeg=0;this.NXa=this.target=null;this.VMc=!1;this.Av=this.Bv=null;this.H8c=0}MF(fc,Oa,Lb,Fc,Wc,td){if(!this.iq()){switch(Fc){case "DataTypes_PBI":this.H8c=1;break;default:this.H8c=0}this.target=fc;this.Bv=String.format($a.a.instance.Ia(676),Oa);this.Av=String.format($a.a.instance.Ia(677),Lb);this.Aeg=td;this.hPj(Fc,Wc)}}hPj(fc,
Oa){const Lb=!!this.$.xa&&Wa.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.VMc=Oa&&Lb;Oa&&!Lb?this.NXa="BlankCell":fc?this.NXa=fc:(u.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.NXa="BlankCell")}show(){u.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.Av&&!!this.Bv,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.iq()||(u.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}iq(){return!!this.BN}qza(){const fc=Object(n.a)(new F.a,{label:$a.a.instance.Ia(682),ariaDescription:$a.a.instance.Ia(683),onExecute:()=>{u.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),Oa=Object(n.a)(new F.a,{label:this.VMc?$a.a.instance.Ia(680):
$a.a.instance.Ia(678),ariaDescription:this.VMc?$a.a.instance.Ia(681):$a.a.instance.Ia(679),onExecute:()=>{u.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.VMc?"Try sample data":"Learn more")+'" button');var td=new Map;td.set("Domain",this.Aeg.toString());fb.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",td);td=new pa.a(-859308420,ka.a.ld,this.$.ee,9,null);this.$.Ha.kd(td,{[ka.a.Lh]:"HelpID="+this.NXa,["InputMethod"]:ka.a.ld,
["ShouldCanvasTakeFocus"]:!0,[ka.a.Ie]:Pb.a.OP});this.dismiss()}});var Lb=!!this.$&&!!this.$.frame&&!!this.$.frame.KF&&this.$.frame.KF.bQ;switch(this.H8c){case 1:var Fc=Lb?126:123;break;default:Fc=Lb?125:120}Fc=Object(n.a)(new Sb.a(Sa.a.current.gq(Fc)),{alt:$a.a.instance.gd(184)});const Wc=this.Av.split("\n\n");Lb=Object(n.a)(new hb(Wc,Fc),{imageWidth:280,imageHeight:Lb?142:192});Lb=new wa(Lb);return Object(n.a)(new K.a,{target:this.target,content:Lb,title:this.Bv,primaryButtonProps:Oa,secondaryButtonProps:fc,
showCloseIcon:!0,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(d.a)(Bc,"LinkedEntityBlankCellConvertTeachingCallout",G,[]);class ab extends ua{constructor(fc){super(fc,"LinkedEntityFirstOrganizationDataCallout",$a.a.instance.Ia(672),$a.a.instance.Ia(674),$a.a.instance.Ia(670),$a.a.instance.Ia(671),8192,13,new Ka.a,
void 0,void 0,!0,!0);this.target=null;this.NXa="DataTypes_PBI"}get GU(){return this.target.toString()}get FU(){return this.target.toString()}get hU(){return'[id="'+this.$.Ad+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new pa.a(-859308420,ka.a.ld,this.$.ee,9,null)}get oub(){return{[ka.a.Lh]:"HelpID="+this.NXa,["ShouldCanvasTakeFocus"]:!0,[ka.a.Ie]:Pb.a.OP}}MF(fc){this.iq()||(this.target=fc,this.NXa="DataTypes_PBI")}iq(){return!!this.BN}roa(){u.ULS.shipAssertTag(537169921,0,!!this.target,
"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.iq()}}Object(d.a)(ab,"LinkedEntityFirstOrganizationDataTeachingCallout",ua,[]);class qb extends ua{constructor(fc){super(fc,"LinkedEntityGalleryTeachingCallout","",$a.a.instance.Ia(682),$a.a.instance.Ia(684),$a.a.instance.Ia(685),49152,14,new Ka.a,void 0,!0,!0,!0,!0);this.target=null;this.OLa=
5}get oga(){return 2}get GU(){return this.target.toString()}get FU(){this.OLa=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get hU(){return""}get ribbonCommandInfo(){return new pa.a(-847286761,ka.a.ld,this.$.ee,0,Pb.a.YPb)}show(){u.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.iq()||(u.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),
super.show())}MF(fc){this.iq()||(this.target=fc)}iq(){return!!this.BN}roa(){u.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.iq()}}Object(d.a)(qb,"LinkedEntityGalleryTeachingCallout",ua,[]);var mc=a(12);class yb extends G{constructor(fc){super(fc);this.Av=this.Bv=this.target=null}MF(fc,Oa,Lb){this.iq()||(this.target=
fc,this.Bv=String.format($a.a.instance.gd(186),Oa),this.Av=String.format($a.a.instance.gd(188),Lb))}show(){u.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.Av&&!!this.Bv,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.iq()||(u.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}iq(){return!!this.BN}qza(){const fc=
Object(n.a)(new F.a,{label:$a.a.instance.ia(1806),ariaDescription:$a.a.instance.ia(1807),onExecute:()=>{u.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');fb.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",null);mc.HelperMethods.Gg("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var Oa=Object(n.a)(new Sb.a(Sa.a.current.gq(this.$&&
this.$.frame&&this.$.frame.KF&&this.$.frame.KF.bQ?127:124)),{alt:$a.a.instance.gd(189)});Oa=Object(n.a)(new hb([this.Av],Oa),{imageWidth:280,imageHeight:142});Oa=new wa(Oa);return Object(n.a)(new K.a,{target:this.target,content:Oa,title:this.Bv,primaryButtonProps:fc,showCloseIcon:!0,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}
Object(d.a)(yb,"LinkedEntityNoCuratedDataTeachingCallout",G,[]);var vc=a(179),Db=a(359);class Ga extends G{constructor(fc){super(fc);this.Av=this.Bv=null}MF(fc){this.iq()||(this.target=fc,this.KPj())}show(){u.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.Av&&!!this.Bv,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.iq()||(u.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),
vc.a.sendTelemetryEvent(Object(n.a)(new Db.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}iq(){return!!this.BN}qza(){return Object(n.a)(new K.a,{target:this.target,title:this.Bv,content:this.Av,showCloseIcon:!0,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}KPj(){let fc=
-1,Oa=0;const Lb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?t.a.Ph(z.Sb):this.$.ea.Ba(465);Lb&&(fc=Lb.Mqb,Oa=Lb.uob);switch(Oa){default:this.Bv=$a.a.instance.Ia(722);this.Av=$a.a.instance.Ia(725);break;case 1:this.Bv=String.format($a.a.instance.Ia(723),fc);this.Av=$a.a.instance.Ia(726);break;case 2:this.Bv=String.format($a.a.instance.Ia(724),fc),this.Av=$a.a.instance.Ia(726)}}}Object(d.a)(Ga,"OptimizeWorkbookBusinessBarCallout",G,[]);var Eb=a(149);
class Zb extends ua{constructor(fc,Oa,Lb,Fc,Wc,td,na,Pa,lb){Pa=void 0===Pa?!1:Pa;super(fc,void 0===lb?"OverrideBrowserShortcutsTeachingCallout":lb,Oa,Lb,Fc,Wc,td,na,new Ka.a,Pa)}get GU(){return"[data-unique-id=Help]"}get FU(){return"[data-unique-id=pivotOverflowButton]"}get hU(){return'[id="'+this.$.Ad+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new pa.a(-1018439626,ka.a.ld,this.$.ee,0,Pb.a.P3)}roa(){return!Eb.a.get(Pb.a.mUb)}}Object(d.a)(Zb,"OverrideBrowserShortcutsTeachingCallout",ua,[]);
class ic extends Zb{constructor(fc,Oa,Lb,Fc,Wc,td,na,Pa){super(fc,Oa,Lb,Fc,Wc,td,na,void 0===Pa?!1:Pa,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new pa.a(-901364793,ka.a.ld,this.$.ee,0,Pb.a.P3)}get oub(){return{[Pb.a.xPd]:!1}}}Object(d.a)(ic,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",Zb,[]);var mb=a(42);class Hb extends ua{constructor(fc,Oa,Lb,Fc,Wc,td,na,Pa,lb,Nb,xc,Oc,yd,Sd,ve,Ee,Ue,hf,Rb){super(fc,Oa,Lb,Fc,Wc,td,Pa,lb,Nb,void 0===xc?!1:
xc,void 0===Oc?!1:Oc,void 0===yd?!1:yd,void 0===Sd?!1:Sd,void 0===ve?!1:ve,void 0===Ee?!0:Ee,void 0===Ue?!1:Ue,void 0===hf?null:hf,void 0===Rb?!1:Rb);this.learnMoreUrl=null;this.learnMoreUrl=na}rij(){try{mb.a.mT(this.learnMoreUrl)}catch(fc){}}kde(){null!=this.learnMoreUrl&&this.rij()}}Object(d.a)(Hb,"EwaReactShowOrLearnMoreCallout",ua,[]);const Wb='[id="'+gb.a.Qng+'"]';class Ob extends Hb{constructor(fc){super(fc,"PhoneticTeachingCallout",$a.a.instance.Ia(695),$a.a.instance.Ia(698),$a.a.instance.Ia(697),
$a.a.instance.Ia(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new Ka.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get GU(){return Wb}get FU(){return Wb}get hU(){return Wb}get ribbonCommandInfo(){return new pa.a(1455037301,ka.a.ld,this.$.ee,0,null)}XCf(){u.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}RDf(){u.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(d.a)(Ob,"PhoneticTeachingCallout",Hb,[]);var Gc=a(182);
class Va extends ua{constructor(fc,Oa,Lb,Fc,Wc,td){super(fc,Oa,$a.a.instance.Ia(708),$a.a.instance.Ia(707),$a.a.instance.Ia(703),Lb,Fc,Wc,new Ka.a,!0,!1,void 0,void 0,void 0,!0,!0);this.OLa=5;this.rwb=td}get oga(){return 2}get GU(){return 1===Gc.a(this.$).bR?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get FU(){return"[data-unique-id=Connections_MLR"}roa(){return this.rwb}get hU(){return'[id="'+this.$.Ad+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new pa.a(-859308420,
ka.a.ld,this.$.ee,9,null)}get oub(){return{[ka.a.Lh]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[ka.a.Ie]:Pb.a.OP}}gFa(){return this.Haa()}show(){this.fEb()?super.show():u.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(d.a)(Va,"PowerQueryRefreshTeachingCalloutBase",ua,[]);class Jb extends Va{constructor(fc){super(fc,"PowerQueryRefreshFromTableTeachingCallout",$a.a.instance.Ia(705),3145728,20,J.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?
J.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"):J.EwaSettings.KIi())}}Object(d.a)(Jb,"PowerQueryRefreshFromTableTeachingCallout",Va,[]);class ub extends ua{constructor(fc){super(fc,"QueriesTaskPaneTeachingCallout",$a.a.instance.Ia(702),$a.a.instance.Ia(701),$a.a.instance.Ia(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?849:699),$a.a.instance.Ia(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?850:700),12582912,22,new Ka.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.OLa=5;this.rwb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?J.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations"):J.EwaSettings.$Ii()}get oga(){return 2}get GU(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get FU(){return"[data-unique-id=Connections_MLR]"}get hU(){return'[id="'+this.$.Ad+'Ribbon.Data.Queries"]'}gFa(){return this.Haa()}show(){this.fEb()?
super.show():u.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}roa(){return this.rwb}get ribbonCommandInfo(){return new pa.a(1156885807,ka.a.ld,this.$.ee,0,Pb.a.YPb)}}Object(d.a)(ub,"QueriesTaskPaneTeachingCallout",ua,[]);var Qa=a(433),P=a(202),ta=a(931),Z=a(248),aa=a(295);class Ea extends Va{constructor(fc){super(fc,"PowerQueryAuthenticatedRefreshTeachingCallout",$a.a.instance.Ia(706),805306368,28,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1))}}Object(d.a)(Ea,"PowerQueryAuthenticatedRefreshTeachingCallout",Va,[]);class za extends ua{constructor(fc){super(fc,"PowerQueryClearAllPermissionsTeachingCallout",$a.a.instance.Ia(708),$a.a.instance.Ia(701),$a.a.instance.Ia(852),$a.a.instance.Ia(853),3,32,new Ka.a,!0,!1,void 0,void 0,void 0,!0,!0);this.OLa=5;this.rwb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get oga(){return 2}get GU(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get FU(){return"[data-unique-id=Connections_MLR]"}get hU(){return'[id="'+
this.$.Ad+'Ribbon.Data.Queries"]'}gFa(){return this.Haa()}show(){this.fEb()?super.show():u.ULS.sendTraceTag(508687132,0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}roa(){return this.rwb}get ribbonCommandInfo(){return new pa.a(-859308420,ka.a.ld,this.$.ee,9,null)}get oub(){return{[ka.a.Lh]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[ka.a.Ie]:Pb.a.OP}}}Object(d.a)(za,"PowerQueryClearAllPermissionsTeachingCallout",ua,[]);var bb=a(92);class Mb{constructor(fc){this.fvd=
this.rvd=!1;this.Haa=!0;this.n$i=Oa=>{if(Oa&&!Z.a(Oa))try{const Lb=Oa.Result,Fc=Lb.QueryGroups;if(0<Lb.Queries.length||0<Fc.length)this.rvd=!0,this.fvd=Lb.PowerQueryDataSources?Lb.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||Lb.PowerQueryDataSources.includes("OData.Feed"):!1,J.EwaSettings.isChangeGateEnabled("OfficeVSO:7971437_RefactorShowCalloutIfNeeded")?void this.V0j():this.YHc()}catch(Lb){u.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${Lb}.`)}};
this.vxc=()=>{u.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=fc;this.YAc=new ub(fc);this.powerQueryClearAllPermissionsCallout=new za(fc);this.Ufb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new Ea(fc):new Jb(fc)}show(){this.Haa&&this.GNj()}GNj(){this.$.userOperationManager.enqueueOperation(new P.a(587,0,(fc,Oa,Lb)=>ta.d(this.$.pa.ua,aa.b(fc,this.n$i),aa.a(Oa,this.vxc),Lb,null),80,()=>new Qa.a),null)}YHc(){this.YAc.gFa().continueWith(fc=>
{fc.result&&this.rvd?(this.YAc.show(),this.Haa=!1):this.Ufb.gFa().continueWith(Oa=>{Oa.result&&(this.Ufb instanceof Ea||this.fvd)?(this.Ufb.show(),this.Haa=!1):this.powerQueryClearAllPermissionsCallout.gFa().continueWith(Lb=>{Lb.result&&this.powerQueryClearAllPermissionsCallout.show();this.Haa=!1})})})}V0j(){const fc=this;return Io(function*(){(yield bb.c(fc.YAc.gFa()))&&fc.rvd?fc.YAc.show():(yield bb.c(fc.Ufb.gFa()))&&(fc.Ufb instanceof Ea||fc.fvd)?fc.Ufb.show():(yield bb.c(fc.powerQueryClearAllPermissionsCallout.gFa()))&&
fc.powerQueryClearAllPermissionsCallout.show();fc.Haa=!1})}}Object(d.a)(Mb,"PowerQueryCallout",null,[335]);class zb extends G{constructor(fc){super(fc);this.UKd=this.hdd=this.Av=this.Bv=this.target=null}MF(fc,Oa,Lb){this.iq()||(this.target=fc,this.hdd=Oa,this.UKd=Lb,this.Bv=$a.a.instance.Ia(710),this.Av=$a.a.instance.Ia(711))}show(){u.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.Av&&!!this.Bv&&!!this.hdd&&!!this.UKd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.iq()||(u.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}iq(){return!!this.BN}qza(){const fc=Object(n.a)(new F.a,{label:$a.a.instance.Ia(712),ariaDescription:$a.a.instance.Ia(714),onExecute:()=>{u.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.hdd();this.dismiss()}}),Oa=Object(n.a)(new F.a,{label:$a.a.instance.Ia(713),ariaDescription:$a.a.instance.Ia(715),onExecute:()=>
{u.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.UKd();this.dismiss()}});return Object(n.a)(new K.a,{target:this.target,content:this.Av,title:this.Bv,primaryButtonProps:fc,secondaryButtonProps:Oa,showCloseIcon:!0,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(d.a)(zb,
"TableAIConvertToTableCallout",G,[]);var oa=a(185),Xa=a(84);class bc{constructor(fc){this.jck=fc}show(){Xa.a.instance.Ed("Common.ISystemInitiatedFeedback").execute(fc=>{fc.logActivity(this.jck,null)})}}Object(d.a)(bc,"EwaLppCallout",null,[335]);var Ac=a(46);class Xc extends bc{constructor(fc){super("ExcelTableInNewWorkbook");this.Kzd=this.vBa=!1;this.createTable=()=>{const Oa=Ac.v(new oa.a(1,1,8,3,gb.a.qh,gb.a.ph),this.$),Lb={};Lb.TableRange=Oa;Lb.HasHeader=!1;this.$.Fe(71074531,ka.a.ld,9,Lb)};this.lUe=
()=>{this.createSampleTable("0")};this.mUe=()=>{this.createSampleTable("2")};this.nUe=()=>{this.createSampleTable("1")};this.$=fc;(this.vBa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.Kzd=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.lUe,!0),window.addEventListener("ExcelCreateSampleTableContact",
this.mUe,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.nUe,!0)}dispose(){this.vBa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.Kzd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.lUe,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.mUe,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.nUe,!0))}createSampleTable(fc){const Oa={};Oa[ka.a.Ie]=fc;this.$.Fe(1371713064,ka.a.ld,9,Oa)}}Object(d.a)(Xc,"TableInNewWorkbookCallout",
bc,[]);var Ed=a(983);class Qd extends G{constructor(fc){super(fc);this.iIc=5E3;this.Bv=Ed.a.Title;this.currentState=0}cT(fc,Oa){Ed.c.get(this.currentState).includes(fc)&&(6===fc?window.requestAnimationFrame(()=>this.w7a(fc,Oa)):this.w7a(fc,Oa))}GXb(fc){this.target=fc}show(){super.dismiss();this.t$f();super.show()}dismiss(){this.cT(0);window.clearTimeout(this.R5f);super.dismiss()}qza(){return Object(n.a)(new K.a,{target:this.target,title:this.Bv,content:this.Av,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.t$f();super.bZa({message:this.Av})}w7a(fc,Oa){const Lb=Ed.b.get(fc);this.ehk(this.eDh(fc)?`${Lb}${Oa}`:Lb);this.currentState=fc;0!=this.currentState?(this.update(),this.show()):this.dismiss()}eDh(fc){switch(fc){case 5:case 6:return!0;default:return!1}}t$f(){window.clearTimeout(this.R5f);this.R5f=window.setTimeout(()=>
this.dismiss(),this.iIc)}ehk(fc){this.Av=fc}}Object(d.a)(Qd,"FormulaByExampleCurtainLifterCallout",G,[]);var zd=a(188);class fe extends ua{constructor(fc){super(fc,"DataCleansingTeachingCallout",zd.a.ia(1952),zd.a.ia(1953),"",zd.a.ia(1954),16777216,24,new Ka.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.k6d="[id=DataCleansingTaskPane]";this.Uzg=!1}MF(fc,Oa){this.xBg=String.format($a.a.instance.gd(213),fc);this.Uzg=Oa}iPa(){return J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)&&this.Uzg?0:2}lpd(){return 2592E3}get GU(){return this.k6d}get FU(){return this.k6d}get hU(){return this.k6d}get ribbonCommandInfo(){return new pa.a(-1190551534,ka.a.ld,this.$.ee,0,null)}}Object(d.a)(fe,"DataCleansingTeachingCallout",ua,[]);var jd=a(118);class Xb extends G{constructor(fc){super(fc);this.Av=this.Bv=this.target=null;this.duration=0}MF(fc,Oa,Lb){this.iq()||(this.target=fc,this.Bv=this.t4h(Oa),this.Av=$a.a.instance.Ia(737),this.operation=Oa,this.duration=Lb)}show(){u.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.Av&&!!this.Bv,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.iq()){u.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var fc={["Operation"]:this.operation,["Duration"]:this.duration};vc.a.sendTelemetryEvent(Object(n.a)(new Db.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:jd.a.Ek(fc)}));super.show()}}iq(){return!!this.BN}qza(){return Object(n.a)(new K.a,{target:this.target,title:this.Bv,content:this.Av,showCloseIcon:!0,calloutProps:Object(n.a)(new L.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}t4h(fc){switch(fc){case 0:return $a.a.instance.Ia(727);case 1:return $a.a.instance.Ia(728);case 2:return $a.a.instance.Ia(729);
case 3:return $a.a.instance.Ia(730);case 4:return $a.a.instance.Ia(731);case 5:return $a.a.instance.Ia(732);case 6:return $a.a.instance.Ia(733);case 7:return $a.a.instance.Ia(734);case 8:return $a.a.instance.Ia(735);case 9:return $a.a.instance.Ia(736);default:return""}}}Object(d.a)(Xb,"OptimizeWorkbookSlowOperationsCallout",G,[]);class Lc extends G{constructor(){super(...arguments);this.FCg="ClickOnLaunch";this.$Bg="ClickOnDismiss";this.BDg="Show";this.lCg="BetterEntryPoint_InsertTab";this.PDg=500;
this.zCg=280;this.yCg=192;this.iDg="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.rCg="[data-unique-id=Home]";this.BCg="InsertAddinTransitionEntry";this.sCg="Home";this.ACg="InsertAddInFlyout";this.kDg="RibbonOverflowMenu-overflow"}MF(){}show(){this.aC(this.BDg);u.ULS.sendTraceTag(509367621,0,50,"ExcelBetterEntryTeachingCallout.Show() - Showing ExcelBetterEntryTeachingCallout callout.");super.show()}qza(){let fc=this.iDg;var Oa=document.getElementById(this.BCg),Lb=Oa?window.getComputedStyle(Oa,
null):null;if(null==Oa||Lb&&"none"===Lb.display)fc=this.rCg;Oa=CommonUIStrings.l_BetterEntryPointTUI_Title;var Fc=CommonUIStrings.l_BetterEntryPointTUI_Content;Lb=new Sb.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF8");Fc=Fc.split("\n");Lb=Object.assign(new hb(Fc,Lb),{imageWidth:this.zCg,imageHeight:this.yCg});Lb=new wa(Lb);Fc=Object.assign(new F.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,onExecute:()=>
{this.fpi();this.aC(this.FCg);this.dismiss()}});const Wc=Object.assign(new F.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,onExecute:()=>{this.aC(this.$Bg);this.dismiss()}});return Object.assign(new K.a,{target:fc,content:Lb,title:Oa,primaryButtonProps:Fc,secondaryButtonProps:Wc,showCloseIcon:!0,hasDynamicSizing:!1,preventLightDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new L.a,{onDismiss:()=>{this.dismiss()},
setInitialFocus:!0})})}fpi(){appChrome.api.dispatch(appChrome.actions.setCurrentTab(this.sCg));window.setTimeout(()=>{this.AFd()},this.PDg)}AFd(){const fc=document.getElementById(this.ACg),Oa=fc?window.getComputedStyle(fc,null):null;if(null==fc||Oa&&"none"===Oa.display){const Lb=document.getElementById(this.kDg);null!=Lb?(Lb.onclick=function(){window.setTimeout(()=>{const Fc=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=Fc&&(Fc.click(),u.ULS.sendTraceTag(509367620,
0,50,"Launch flyout in overflow"))},500);Lb.onclick=function(){}},Lb.click()):u.ULS.sendTraceTag(509367619,0,10,"Neither ribbon nor overflow can launch flyout")}else fc.click(),u.ULS.sendTraceTag(509367618,0,50,"Launch flyout in ribbon button")}aC(fc){fc={["AppTeachingUICalloutAction"]:fc,["AppTeachingUICalloutGoal"]:this.lCg};vc.a.sendTelemetryEvent(Object.assign(new Db.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:jd.a.Ek(fc)}))}}Object(d.a)(Lc,"ExcelBetterEntryTeachingCallout",
G,[]);class Bd extends ua{constructor(fc){super(fc,"FunctionDialogTeachingCallout",void 0,$a.a.instance.Ia(763),$a.a.instance.Ia(760),$a.a.instance.Ia(761),1073741824,30,new Ka.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}MF(fc){this.C6c=`[id=${"CellEdit"===fc?this.$.Ad+Pb.a.Lic:"InsertFunction"}]`}iPa(){return 1}get GU(){return this.C6c}get FU(){return this.C6c}get hU(){return this.C6c}get ribbonCommandInfo(){return null}}Object(d.a)(Bd,"FunctionDialogTeachingCallout",ua,[]);class Nc extends bc{constructor(fc){super("ExcelLiveWebEntryPointCallout");
this.VAa=!1;this.lng=()=>{this.$.Fe(327119921,ka.a.ld,9,null)};this.$=fc;(this.VAa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.lng,!0)}dispose(){this.VAa&&window.removeEventListener("TryCoEditInTeams",this.lng,!0)}}Object(d.a)(Nc,"ExcelLiveWebEntryPointCallout",bc,[]);class rb{constructor(fc){this.$=fc;this.Ay=new eb.a(!1)}qdi(fc){if(!this.Ay.Wc(vb[fc]))switch(fc){case 0:this.Ooh(fc);break;
case 2:this.Ay.add(vb[fc],new Bc(this.$));break;case 3:this.Ay.add(vb[fc],new yb(this.$));break;case 6:this.Ay.add(vb[fc],new ab(this.$));break;case 1:this.Ay.add(vb[fc],new ib(this.$));break;case 4:this.Ay.add(vb[fc],new cb(this.$));break;case 5:this.Ay.add(vb[fc],new La(this.$));break;case 7:this.Ay.add(vb[fc],new ya(this.$));break;case 8:this.Ay.add(vb[fc],new qb(this.$));break;case 9:this.Ay.add(vb[fc],new Ta(this.$));break;case 13:this.Ay.add(vb[fc],new Ga(this.$));break;case 10:this.Ay.add(vb[fc],
new Ob(this.$));break;case 11:this.Ay.add(vb[fc],new Mb(this.$));break;case 12:this.Ay.add(vb[fc],new zb(this.$));break;case 14:this.Ay.add(vb[fc],new Xc(this.$));break;case 15:this.Ay.add(vb[fc],new Qd(this.$));break;case 16:this.Ay.add(vb[fc],new fe(this.$));break;case 18:this.Ay.add(vb[fc],new Xb(this.$));break;case 20:this.Ay.add(vb[fc],new Nc(this.$));break;case 19:this.Ay.add(vb[fc],new Lc(this.$));break;case 21:this.Ay.add(vb[fc],new Bd(this.$));break;default:return null}return this.Ay.getItem(vb[fc])}Ooh(fc){this.Ay.add(vb[fc],
new ic(this.$,$a.a.instance.Ia(640),$a.a.instance.Ia(637),$a.a.instance.Ia(638),$a.a.instance.Ia(639),16,4,!0))}}Object(d.a)(rb,"EwaCalloutFactory",null,[]);var va=a(59),yc=a(62),Zc=a(161);let cc=class{constructor(fc){this.$=fc;this.YIh=new rb(this.$)}Ce(){return!1}Ge(){return!1}qe(fc,Oa,Lb){fc=Lb.CalloutName;this.WZj=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(Zc.c)(this.$)&&!this.CCi(fc);return!!Oa&&-847286761===Oa.command&&va.a.mi.XT&&!this.WZj}CCi(fc){return J.EwaSettings.isChangeGateEnabled("OfficeVSO:6774891_ShowCalloutForExcelLiveOnMobile")&&
this.$.Yw&&9===fc}executeCommand(fc,Oa,Lb){fc=Lb.CalloutName;if(Oa=this.YIh.qdi(fc)){switch(fc){case 2:Oa.MF(Lb.Target,Lb.RibbonButtonLabel,Lb.ExampleEntities,Lb.BlankCellResourceId,Lb.HasBlankCellWalkthrough,Lb.ServiceDomain);break;case 3:Oa.MF(Lb.Target,Lb.RibbonButtonLabel,Lb.ExampleEntities);break;case 6:Oa.MF(Lb.Target);break;case 8:Oa.MF(Lb.Target);break;case 13:Oa.MF(Lb.Target);break;case 15:return Oa.GXb(Lb.Target),Oa.cT(Lb.NewState,Lb.Reason),yc.Task.Wa(!0);case 12:Oa.MF(Lb.Target,Lb.ConvertToTableCallback,
Lb.NoThanksCallback);break;case 16:Oa.MF(Lb.SuggestionsCount,Lb.WithoutCoolDown);break;case 18:Oa.MF(Lb.Target,Lb.Operation,Lb.Duration);break;case 19:Oa.MF();break;case 21:Oa.MF(Lb.Trigger)}Oa.show();return yc.Task.Wa(!0)}return yc.Task.Wa(!1)}};cc=Object(r.a)([Object(t.d)(z.xc),Object(r.b)(0,Object(z.R)())],cc);Object(d.a)(cc,"ShowCalloutCommandHandler",null,[190]);class Le extends ob.a{constructor(fc){super(fc)}dispose(){super.dispose()}yf(){this.gf([new cc(this.$)])}static la(fc){ob.a.Nf(378,
new Le(fc))}}Object(d.a)(Le,"ShowCalloutCommandHandlerFactory",ob.a,[]);var Re=a(10),Ib=a(87),Yc=a(54),Cb=a(65);const pc=(fc,Oa,Lb,Fc,Wc,td,na)=>{na=fc.Ra(1,void 0===na?null:na);na.sheetName=Oa;return Cb.g(fc,"EvaluateSheetOptimizableContent",na,Lb,Fc,Wc,td,4)};var Mc=a(21),xd=a(43),Nd=a(139);class te{constructor(fc,Oa){this.sessionID=null;this.$Wf=Lb=>{if(Lb){let Fc=xd.d(Lb.data);({zu:Lb}=Fc);if(Fc.returnValue&&(Lb=Object(Nd.a)(Object,Lb))&&"OptimizeWorkbookTaskPane"===Lb.Origin)if(this.sessionID!==
Lb.SessionId)u.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(Lb.Event){case "Error_LoadBookData":this.optimizeWorkbookManager.sSj();u.ULS.sendTraceTag(509673560,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Load book data error Event.");break;case "OptimizeTriggered":this.optimizeWorkbookManager.RSj();u.ULS.sendTraceTag(509688027,
0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Optimize Event.");break;case "TriggerFeedback":this.optimizeWorkbookManager.t0j();u.ULS.sendTraceTag(509748061,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Feedback Event.");break;default:u.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.optimizeWorkbookManager=fc;this.sessionID=
Oa}initialize(){window.addEventListener("message",this.$Wf,!1)}dispose(){window.removeEventListener("message",this.$Wf,!1)}}Object(d.a)(te,"OptimizeWorkbookTaskPaneListener",null,[]);var tb=a(86);let Gb=class extends Ib.a{constructor(fc){super();this.businessBar=null;this.uob=2;this.Mqb=-1;this.QEc=!1;this.tOb=null;this.WBf=this.Xpg=this.fwf=this.ZWf=!1;this.W7i=Oa=>{this.$&&((Oa=Oa.Result)?Oa.HasSignificantOptimizableContent?(u.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),
Oa.OptimizableRangesOrPercentage&&(this.Mqb=Oa.OptimizableRangesOrPercentage),0>=this.Mqb&&0!==this.uob&&(u.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.uob=0),this.KUb()):u.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):u.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};
this.fej=(Oa,Lb,Fc)=>{(Oa=Oa.Result)?Oa.HasSignificantOptimizableContent?(u.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.QEc=!0,this.e2j(Lb,Fc)):u.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):u.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.$=fc;this.n5j();
this.QEc=!1;this.UDh=J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.tOb=new te(this,this.$.da.sessionId)}dispose(){this.l$a();this.$=this.businessBar=null;this.BYe();super.dispose()}yyi(){this.tOb&&this.tOb.initialize()}BYe(){this.tOb&&this.tOb.dispose()}l$a(){this.businessBar&&this.businessBar.Foa(62)&&this.businessBar.removeEntry(62)}n5j(){Xa.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",
!1).then(Oa=>{if(Oa){var Lb=this.$.pa.ua,Fc=this.uob,Wc=this.W7i;const td=Lb.Ra(1,null);td.businessBarMessageType=Fc;Cb.g(Lb,"EvaluateOptimizableContentV2",td,Wc,null,null,null,4)}return Oa})})}KUb(){const fc=Object(tb.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(bb.d)(t.a.resolve(z.l,{Qa:1})):Yc.GetServiceTaskFactory.Vc(this.$.ea,5,4,1);N.TaskExtensions.ya(fc,()=>{const Oa=fc.result;Oa&&(Oa.ki(62,null,null,this.X3h()),this.businessBar=Oa)},this.$.ka,3)}X3h(){switch(this.uob){default:return $a.a.instance.ia(2239);
case 1:return String.format($a.a.instance.Ia(720),this.Mqb);case 2:return String.format($a.a.instance.Ia(721),this.Mqb)}}Iyi(){!J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1)||!this.fwf||this.ZWf||this.Xpg||this.WBf||(Xa.a.instance.Ed("Common.ISystemInitiatedFeedback").execute(fc=>{fc.logActivity("Office_Excel_OptimizeWorkbook_InitializeClosePaneFloodgate",null)}),u.ULS.sendTraceTag(509688028,0,50,"OptimizeWorkbookManager.initiateClosePaneFeedback() - Feedback Triggered."))}bSj(fc){this.fwf=
fc}RSj(){this.ZWf=!0}sSj(){this.WBf=!0}Yaa(fc,Oa,Lb){if(Oa&&Oa.RequestTelemetryData&&!(Oa.RequestTelemetryData.EcsOperationDuration<this.UDh)&&this.businessBar&&this.businessBar.Foa(62)&&!this.QEc){var Fc=Lb?Lb:this.$.na.sheetName;if(6===fc||7===fc||8===fc||9===fc)this.evaluateSheetOptimizableContent(Fc,fc,Oa.RequestTelemetryData.EcsOperationDuration);else{const Wc=()=>{Mc.h(this.$).za.eu(Wc);this.evaluateSheetOptimizableContent(Fc,fc,Oa.RequestTelemetryData.EcsOperationDuration)};Mc.h(this.$).za.su(Wc)}}}evaluateSheetOptimizableContent(fc,
Oa,Lb){pc(this.$.pa.ua,fc,Fc=>{this.fej(Fc,Oa,Lb)},null,null,null)}e2j(fc,Oa){const Lb=new pa.a(-847286761,ka.a.ld,this.$.ee,0,null),Fc={CalloutName:18};Fc.Target=this.businessBar.Dod(62);Fc.Operation=fc;Fc.Duration=Oa;this.$.Ha.kd(Lb,Fc)}t0j(){this.$.Fe(802602464,ka.a.ld,12,{[Pb.a.bK]:"OptimizeWorkbookTaskPane"});this.Xpg=!0}};Gb=Object(r.a)([Object(t.d)(z.Sb),Object(r.b)(0,Object(z.R)())],Gb);Object(d.a)(Gb,"OptimizeWorkbookManager",Ib.a,[493]);var fd=a(737);class lc extends h.a{constructor(fc){super();
this.$=fc;this.Md()}create(){const fc=Object(fd.a)(this.$.ea,465,()=>new Gb(this.$));this.qd(fc)}static la(fc){fc.ea.Ja(466,new lc(fc))}}Object(d.a)(lc,"OptimizeWorkbookManagerFactory",h.a,[]);var $c=a(178),Md=a(766),dd=a(739);class ee extends Md.a{constructor(){super();this.range=null;this.H_=Object.assign(new dd.a,{T_:ee.getTypeName(),B_:ee.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(d.a)(ee,
"ExcelRangeWrapperAnnotation",Md.a,[]);class Tc extends ee{constructor(){super();this.hasMergedcells=this.tableName=this.interpretations=null;this.H_=Object.assign(new dd.a,{T_:Tc.getTypeName(),B_:Tc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(d.a)(Tc,"ExcelRecognizedTableNew",ee,[]);class wd extends Tc{constructor(){super();this.requestId=null;
this.H_=Object.assign(new dd.a,{T_:wd.getTypeName(),B_:wd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(d.a)(wd,"ExcelRangeMetadata",Tc,[]);var Kb=a(1013);class Vc extends Kb.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new dd.a,{T_:Vc.getTypeName(),B_:Vc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell",
"AugLoop_Core_GridCell"]}}Object(d.a)(Vc,"ExtendedExcelCell",Kb.a,[]);var Hd=a(875);class Xd extends Hd.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new dd.a,{T_:Xd.getTypeName(),B_:Xd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(d.a)(Xd,"RangeDataSignal",Hd.a,[]);var qe=a(1222),$d=a(108),de=a(39);class le extends Sys.EventArgs{constructor(fc){super();
this.cQb=fc}}Object(d.a)(le,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var $b=a(200),wc=a(27),gd=a(358);class Ud{constructor(fc,Oa,Lb,Fc,Wc){this.jD=fc;this.interpretations=Oa;this.tableName=Lb;this.id=Fc;this.ymf=Wc}}Object(d.a)(Ud,"RecognizedTable",null,[]);class ne{constructor(fc,Oa,Lb){this.classification=fc;this.aggregations=Oa;this.headerReferences=Lb}}Object(d.a)(ne,"TableField",null,[]);var rc=a(1139);const kd=fc=>{var Oa=new gd.a(qd(fc.range),fc.range.worksheetId);var Lb=fc.interpretations;
var Fc=new $b.a;if(Lb&&Lb.length)for(const Ee of Lb){b:switch(Ee.orientation.toLowerCase()){case "columnmajor":Lb=2;break b;case "rowmajor":Lb=1;break b;default:u.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),Lb=0}const Ue=Lb;if(0===Ue)u.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{Lb=rc.a;var Wc=qd(Ee.location),td=Ee.confidence,na=Ee.headerRowCount,Pa=Ee.headerColumnCount;var lb=Ee.fields;var Nb=new $b.a;if(lb)for(const hf of lb){lb=
Nb;var xc=lb.add;c:switch(hf.classification.toLowerCase()){case "dimension":var Oc=1;break c;case "measure":Oc=2;break c;default:u.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Oc=0}var yd=hf.aggregations;var Sd=new $b.a;if(yd)for(const Rb of yd)switch(Rb.toLowerCase()){case "sum":Sd.add(0);break;case "count":Sd.add(1);break;case "average":Sd.add(2);break;case "min":Sd.add(3);break;case "max":Sd.add(4);break;case "distinctcount":Sd.add(5);break;case "stddev":Sd.add(6);
break;case "variance":Sd.add(7);break;default:u.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}yd=Sd;var ve=hf.headerReferences;Sd=new $b.a;if(ve)for(const Rb of ve)ve=new wc.Range(Rb.top,Rb.left,Rb.top,Rb.left,!1,!1),Sd.add(ve);xc.call(lb,new ne(Oc,yd,Sd))}Lb=new Lb(Wc,td,na,Pa,Ue,Nb);Fc.add(Lb)}}return new Ud(Oa,Fc,fc.tableName,fc.id,fc.hasMergedcells)},qd=fc=>new wc.Range(fc.top,fc.left,fc.bottom,fc.right,!1,!1);var oe=a(1003);class Yd{constructor(fc,Oa){this.pNc=0;this.SA=
new Map;this.yyd=!1;this.tableIntelligenceManager=fc;this.augmentationLoopManager=Oa;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Ifc=new oe.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Ifc.start(),this.kJc=!0);this.tableIntelligenceManager.N2a("Valid",this.ihj.bind(this));this.tableIntelligenceManager.N2a("Invalid",this.Qaj.bind(this));J.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.augmentationLoopManager.jVg(this.Z5i.bind(this))}FPa(fc,
Oa,Lb){if(!this.SA)return u.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Fc=Oa;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==Lb&&this.pNc>Lb&&(u.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${Lb}, versionChanges: ${this.pNc}`),Fc=Oa^4);return this.SA.has(fc.sheetId)?(Oa=this.SA.get(fc.sheetId).filter(Wc=>Wc.table.jD.range.Te(fc.range)&&(Fc&Wc.ELb)==Wc.ELb),u.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${Oa.length}`),
Oa):[]}ihj(fc,Oa){if(this.SA){if(!this.yyd){J.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.kJc&&(this.Ifc.stop(),u.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.Ifc.Ee),this.kJc=!1);for(const Lb of this.SA){const [Fc,Wc]=Lb;Wc.every(td=>4===td.ELb)?this.SA.delete(Fc):this.SA.set(Fc,Wc.filter(td=>4!==td.ELb))}this.yyd=!0}fc=Oa.cQb;this.SA.has(fc.jD.sheetId)||this.SA.set(fc.jD.sheetId,[]);this.SA.get(fc.jD.sheetId).push({table:fc,
ELb:2});this.pNc=0}else u.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}Qaj(fc,Oa){this.yyd=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.kJc&&(this.Ifc.start(),this.kJc=!0);fc=Oa.cQb;if(!this.SA)u.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.SA.has(fc.jD.sheetId))for(const Lb of this.SA.get(fc.jD.sheetId))Lb.table.id===Oa.cQb.id&&(Lb.ELb=4)}Z5i(){this.pNc++}}Object(d.a)(Yd,"TableIntelligenceQueryManager",null,[589]);class We{}
Object(d.a)(We,"RecognizedTableLog",null,[]);class He{}Object(d.a)(He,"Interpretation",null,[]);class bf{constructor(fc){this.SA=new Map;this.w8b=void 0;this.Dub=new Set;this.OMb=void 0;this.tableIntelligenceManager=fc}ICg(){this.OMb?u.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.OMb=this.NMb.bind(this),this.tableIntelligenceManager.N2a("Valid",this.OMb))}vUi(fc){fc=this.sanitize(fc);u.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(fc)}`)}NMb(fc,
Oa){fc=Oa.cQb;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Dub&&this.SA?(this.Dub.has(fc.id)||(this.fYg(fc),this.Dub.add(fc.id)),this.w8b||(this.w8b=window.setTimeout(this.t$.bind(this),2E3))):u.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Dub}, recognizedTableStore = ${!!this.SA}`))}t$(){for(const fc of this.SA){const [,Oa]=fc;u.ULS.sendTraceTag(521233110,306,15,JSON.stringify(Oa))}window.clearTimeout(this.w8b);
this.Dub=this.w8b=void 0;this.SA.clear();this.SA=void 0;this.tableIntelligenceManager.qAj(this.OMb);this.OMb=void 0}fYg(fc){const Oa=fc.jD.sheetId;this.SA.has(Oa)||this.SA.set(Oa,[]);this.SA.get(Oa).push(this.sanitize(fc))}sanitize(fc){const Oa=[];for(const Lb of fc.interpretations){let Fc=0,Wc=0;for(const td of Lb.fields)1===td.classification?Fc++:2===td.classification&&Wc++;Oa.push({confidence:Lb.confidence,headerRowCount:Lb.headerRowCount,headerColumnCount:Lb.headerColumnCount,orientation:Lb.orientation,
measureCount:Wc,dimensionCount:Fc})}return{interpretations:Oa,range:{top:fc.jD.range.top,bottom:fc.jD.range.bottom,left:fc.jD.range.left,right:fc.jD.range.right},isTable:!!fc.tableName,annotationId:fc.id}}}Object(d.a)(bf,"RecognizedTableLogger",null,[]);class ef extends de.a{constructor(fc,Oa){super();this.Ppc=this.Ptf=!1;this.instantaneousSupportInformationManager=null;this.WTd=void 0;this.oEf=!1;this.tSh=(Lb,Fc)=>{var Wc;if(1===Fc.operationType){const na=Fc.annotation;if(na){u.ULS.sendTraceTag(537151251,
306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${na.requestId}`);Lb=kd(na);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Wc=this.WTd)||void 0===Wc?void 0:Wc.vUi(Lb));var td=null;(()=>{let Pa=this.W4d.Ve(na.requestId);({value:td}=Pa);return Pa})().returnValue?(this.W4d.remove(na.requestId),td(Lb)):u.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${na.requestId}`)}else u.ULS.sendTraceTag(537151252,
306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.LUg=(Lb,Fc)=>{this.j0f("RecognizedTableUpdate",Fc)};this.augmentationLoopManager=fc;this.$=Oa;this.W4d=new $d.a;this.$.ea.Ja(20,this);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.WTd=new bf(this));this.augmentationLoopManager.register(this.augmentationLoopManager.YX().TZ("TableIntelligence").RZ(()=>{}).build())}Jna(){this.nkb||(this.nkb=new Yd(this,this.augmentationLoopManager));
return this.nkb}Kbi(fc,Oa){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<fc.range.Ew)return u.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${fc.range.Ew} exceeds limit of ${1E4}`),4;this.gUg();if(this.gJi(fc.range))return this.ofi(fc,Oa);u.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}C0g(fc){this.hUg();this.addHandler("RecognizedTableUpdate",fc);this.gqf()}eDj(fc){this.removeHandler("RecognizedTableUpdate",
fc)}Vdd(fc){return(Oa,Lb)=>{this.j0f(this.wId(fc),Lb)}}N2a(fc,Oa){var Lb,Fc;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(Fc=null===(Lb=this.$)||void 0===Lb?void 0:Lb.va)||void 0===Fc?0:Fc.count)&&this.$.va.count>J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?u.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.va.count}`):
(this.Ppc||(this.augmentationLoopManager.X$("TableIntelligence",{Yt:!0,annotationType:Tc.getTypeName(),AN:this.Vdd("New"),Tlb:this.Vdd("Valid"),Foc:this.Vdd("Invalid")}),this.Ppc=!0),this.iXg(fc,Oa),this.gqf())}qAj(fc){this.removeHandler(this.wId("Valid"),fc)}iXg(fc,Oa){this.addHandler(this.wId(fc),Oa)}ixj(){J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&this.augmentationLoopManager.X$("TableIntelligence",{annotationType:Tc.getTypeName(),Yt:!0,AN:this.LUg})}hxj(){this.augmentationLoopManager.X$("TableIntelligence",
{annotationType:wd.getTypeName(),Yt:!1,AN:this.tSh})}hUg(){var fc,Oa;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(Oa=null===(fc=this.$)||void 0===fc?void 0:fc.va)||void 0===Oa?0:Oa.count)&&this.$.va.count>J.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?u.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.va.count}`):
this.Ppc||(this.ixj(),this.Ppc=!0)}gUg(){this.Ptf||(this.Ptf=!0,this.hxj())}j0f(fc,Oa){1===Oa.operationType&&((Oa=Oa.annotation)?(Oa=kd(Oa),this.raiseEvent(fc,new le(Oa))):u.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}wId(fc){return`${"RecognizedTableUpdate"}_${fc}`}ofi(fc,Oa){u.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const Lb=fc.range,Fc=Mc.h(this.$).xj("TableIntelligence",
Lb,1),Wc=[],td=[];let na=0;const Pa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);for(this.instantaneousSupportInformationManager||this.$.ea.Zc(268,lb=>{this.instantaneousSupportInformationManager=lb});Fc.$$mn();){const lb=Fc.$$cu();if(!lb)continue;if(0===lb.sl.type&&Wa.a.ds(lb.sl.value))continue;lb.bI&&lb.range&&td.push(Object(n.a)(new qe.a,{worksheetId:fc.sheetId,left:lb.range.left-1,top:lb.range.top-1,right:lb.range.right-1,bottom:lb.range.bottom-1}));
const Nb=lb.range.top-1,xc=lb.range.left-1;let Oc=null,yd=null;({category:yd}=this.instantaneousSupportInformationManager.Vsa(lb.cell.Di,!0));lb.text!=lb.sl.value&&(Oc=lb.text,Pa&&na++);Wc.push(Object.assign(new Vc,{row:Nb,column:xc,value:lb.sl.value,type:lb.sl.type,displayText:Oc,esk:yd}))}Pa&&u.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${na}, number of values: ${Wc.length}, range size: ${Lb.height} rows by ${Lb.width} columns`);
if(0<Wc.length)return this.Ith(Wc,fc,td,Oa),td.length?5:0;u.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}Ith(fc,Oa,Lb,Fc){var Wc=Oa.range;Wc=Object(n.a)(new qe.a,{top:Wc.top,left:Wc.left,bottom:Wc.bottom,right:Wc.right,worksheetId:Oa.sheetId});Oa=$c.a.create().toString();fc=Object(n.a)(new Xd,{cells:fc,range:Wc,mergeCellAddresses:Lb,requestId:Oa});this.augmentationLoopManager.ekb(fc);this.W4d.add(Oa,Fc)}gJi(fc){const Oa=Mc.h(this.$);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const Lb=Oa.ona();u.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${Lb.width}, viewportHeight: ${Lb.height}`)}return Oa.za.YT(4,this.$.na)&&!!Oa.yd(fc.topLeft)&&!!Oa.yd(fc.bottomLeft)&&!!Oa.yd(fc.topRight)&&!!Oa.yd(fc.bottomRight)}gqf(){var fc;!this.oEf&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.oEf=!0,null===(fc=this.WTd)||void 0===fc?void 0:fc.ICg())}}Object(d.a)(ef,"TableIntelligenceManager",de.a,[5,544]);class nc extends h.a{constructor(fc){super();
this.$=fc;this.Md()}create(){N.TaskExtensions.ya(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?Object(bb.d)(t.a.resolve(z.i,{Qa:1})):Yc.GetServiceTaskFactory.Vc(this.$.ea,328,327,1),fc=>{if(fc=fc.result){let Oa=this.$.ea.Ba(20);Oa||(Oa=new ef(fc,this.$),this.$.ea.Ja(20,Oa));this.qd(Oa)}else u.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),
this.qd(null)},this.$.ka,3)}static la(fc){fc.ea.Ja(404,new nc(fc))}}Object(d.a)(nc,"TableIntelligenceManagerFactory",h.a,[]);class id{constructor(fc,Oa){this.MEe=!1;this.tableIntelligenceManager=fc;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void Yc.GetServiceTaskFactory.t8(Oa.ea,510,511,1);this.tableIntelligenceManager.N2a("Valid",()=>{this.MEe||(u.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.MEe=!0)})}}Object(d.a)(id,
"TableIntelligenceDarkActivationManager",null,[539]);class Dd extends h.a{constructor(fc){super();this.$=fc;this.Md()}static la(fc){fc.ea.Ja(481,new Dd(fc))}create(){const fc=Yc.GetServiceTaskFactory.Vc(this.$.ea,20,404,1);N.TaskExtensions.ya(fc,()=>{const Oa=fc.result,Lb=Object(fd.a)(this.$.ea,480,()=>new id(Oa,this.$));this.qd(Lb)},this.$.ka,3)}}Object(d.a)(Dd,"TableIntelligenceDarkActivationManagerFactory",h.a,[]);(()=>{Re.a.Fa(fc=>{J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices1",
!1)||Le.la(fc)});Re.a.Fa(fc=>{J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSmallServices",!1)||C.la(fc)});Re.a.Fa(fc=>{J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)||Ia.la(fc)})})();(()=>{Re.a.Fa(fc=>{J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)||lc.la(fc)})})();(()=>{Re.a.Fa(fc=>{nc.la(fc);Dd.la(fc)})})();String(e);String(b);String(f);String(c);window.___1688279196349_closurehack=
e;window.___1688279196349_closurehack=b;window.___1688279196349_closurehack=f;window.___1688279196349_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/59049dc0ef30cce2bc877878044aaa04/EwaTS.pid.js.map