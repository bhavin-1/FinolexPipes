'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1381:function(w,D,a){a.r(D);w=a(523);var b=a(1),c=a(10);D=a(0);var e=a(734),f=a(54),d=a(40),h=a(997);class r extends e.a{constructor(t){super(t)}yf(){d.TaskExtensions.ya(f.GetServiceTaskFactory.create(this.$.ea,102,this.$.ka,this.Na),t=>{this.gf([new h.FormulaBarCommandHandler(this.$,t.result)])},this.$.ka)}static la(t){e.a.Nf(280,new r(t))}}Object(D.a)(r,"FormulaBarCommandHandlerFactory",e.a,[]);var n=a(234),
u=a(7),v=a(903),x=a(50),k=a(737);class m extends n.a{constructor(t){super();this.$=t;this.Md()}create(){x.PageLoadTrackingInfo.instance.Kra(u.a.ena);const t=f.GetServiceTaskFactory.Vc(this.$.ea,388,387,this.Na);d.TaskExtensions.ya(d.TaskExtensions.Bf([t],this.ka),()=>{this.qd(Object(k.a)(this.$.ea,172,()=>new v.FormulaBar(this.$,t.result)))},this.$.ka,3)}}Object(D.a)(m,"FormulaBarFactory",n.a,[]);w.a.wk(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-new-theme,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#217346}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}");
(()=>{c.a.Fa(t=>{t.ea.Ja(186,new m(t));b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices7",!1)||r.la(t)})})();String(h);window.___1688279196417_closurehack=h},903:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(93),e=a(6),f=a(117),d=a(14),h=a(96),r=a(719),n=a(33),u=a(376),v=a(70),x=a(150),k=a(90);class m{}m.QKh="ewa-fb";m.VKh="ewa-fb-placeholder";m.WKh="ewa-fb-text-box";m.ZKh="ewa-fb-text-box-new-theme";m.XKh="ewa-fb-text-box-monospace-experiment";m.YKh="ewa-fb-text-box-new";
m.g2e="ewa-fb-refactor";m.e2e="ewa-fb-extended";m.y1i="not-ie";m.d$e="functionbox";m.qmi="green-fill-paths";m.$S="drop-down";m.Cwc="ok-cancel-buttons-container";m.UKf="okbox";m.cMe="cancelbox";m.f2e="ewa-fb-nb";m.UKh="ewa-fb-name-box-placeholder";m.kKe="button-disabled";m.TKh="ewa-fb-expand-button-img";m.SKh="ewa-fb-expand-button-container";m.$Kh="ewa-fb-text-div-container";m.d2e="ewa-fb-drag-resize";m.RKh="ewa-fb-drag-handler";m.$2e="ewa-svg-icon";m.gX="cui-disabled";Object(w.a)(m,"CssClassNames",
null,[]);var t=a(7),z=a(275),y=a(632),C=a(630),J=a(492),F=a(168),K=a(142),L=a(87),S=a(103);class W extends S.a{constructor(Va,Jb,ub,Qa,P,ta){super(Va);this.BQ=()=>{this.domElement.disabled||(this.obc.className=this.Xdc+" "+this.YHf)};this.AQ=()=>{this.domElement.disabled||(this.obc.className=this.Xdc+" "+this.c_i)};this.wRf=Z=>{if(!this.domElement.disabled){const aa=Z.keyCode;if("mousedown"===Z.type||13===aa||32===aa)this.obc.className=this.Xdc+" "+this.epj}};this.xRf=()=>{this.domElement.disabled||
(this.obc.className=this.Xdc+" "+this.YHf)};this.Xdc=ub;this.YHf=Qa;this.c_i=P;this.epj=ta;this.Me.la("mouseover",this.BQ);this.Me.la("mouseout",this.AQ);this.Me.la("focus",this.BQ);this.Me.la("blur",this.AQ);this.Me.la("mousedown",this.wRf);this.Me.la("keydown",this.wRf);this.Me.la("mouseup",this.xRf);this.Me.la("keyup",this.xRf);this.obc=Jb}}Object(w.a)(W,"PseudoClassBehavior",S.a,[]);var G=a(13);class O extends L.a{constructor(Va){super();this.kyd=[];this.$=Va}dispose(){h.a.te(this.kyd);this.kyd.length=
0;this.$=null;super.dispose()}q9b(Va,Jb,ub,Qa,P){const ta=G.DOMElementExtensions.getElementById(this.$.domElement,this.$.Ad+Va);Va=Va===Jb?ta:G.DOMElementExtensions.getElementById(this.$.domElement,this.$.Ad+Jb);if(!ta)return null;ub=new W(ta,Va,ub,Qa,"",P);this.kyd.push(ub);return ub}}O.Mbh="ewa-menu-btn-hover";O.Obh="ewa-menu-btn-pressed";Object(w.a)(O,"InitializePseudoClasses",L.a,[]);var T=a(31),I=a(260),N=a(204),R=a(160),V=a(40),sa=a(21);class U{constructor(Va,Jb){this.$=Va;this.we=Jb;z.a(this.$).Wj(this)}get de(){return this.we.textBox.Ag}get Vh(){return sa.h(this.$).Xc&&
sa.h(this.$).pr}get Tf(){return I.a.x9e}$h(Va,Jb){Jb||G.DOMElementExtensions.setFocus(this.de);return!Jb}nj(Va){return G.DOMElementExtensions.Eh(this.de,Va)}Vk(){}yl(){}dispose(){z.a(this.$).TA(this)}}Object(w.a)(U,"FormulaBarFocusManager",null,[33,5]);var ka=a(235),ja=a(250),Da=a(18),qa=a(57),Ba=a(94),ua=a(752),pa=a(171),Ka=a(1);class $a extends L.a{constructor(Va,Jb,ub,Qa=null){super();this.SUa=this.B$a=null;this.$Of=()=>{const P=new Ba.a(753860909,2,this.$.ee,2,null);this.$.Ha.kd(P);return!0};
this.aPf=P=>P.Ca.keyCode===c.a.Yj?(P=new Ba.a(753860909,1,this.$.ee,2,null),this.$.Ha.kd(P),!0):!1;this.bPf=()=>{if(this.gridView.Xc){const P=this.gridView.Fk;Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?P.textBox.P9b():P.textBox.QH=!0}return!1};this.$=ub;this.gridView=sa.h(ub);this.svgIconProvider=Qa;this.TZh=Jb.ia(1035);this.SZh=m.d$e+" "+m.$S;this.DU=Va.q9b(t.a.Lic,t.a.Lic,this.SZh,m.qmi,"");Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:8026743_insertFunctionButtonTooltipEnabled")&&
(this.DU.domElement.role="button",this.DU.domElement.title=Jb.ia(1035));this.B$a=Qa?Qa.kfa(ua.a.RZh,13,13,this.DU.domElement,void 0,void 0,void 0,Jb.ia(1035)):pa.createClusteredImageFromClusterWithImageClass(13,13,Da.a.xOh,qa.a.di(0),null,null,!0,Jb.ia(1035));this.DU.domElement.appendChild(this.B$a);ka.a.instance.ta(d.a.click,this.DU.domElement,this.$Of);f.KeyInputManager.instance.ta(d.a.Rd,this.DU.domElement,this.aPf);ja.a.instance.ta(d.a.pointerDown,this.DU.domElement,this.bPf)}dispose(){this.DU&&
(ka.a.instance.Aa(d.a.click,this.DU.domElement,this.$Of),f.KeyInputManager.instance.Aa(d.a.Rd,this.DU.domElement,this.aPf),ja.a.instance.Aa(d.a.pointerDown,this.DU.domElement,this.bPf));h.a.Ma(this.DU);this.DU=null;G.DOMElementExtensions.xh(this.B$a);this.SUa=this.B$a=null;super.dispose()}qik(Va){!this.SUa&&this.svgIconProvider&&(this.SUa=this.svgIconProvider.kfa(ua.a.ZZh,13,13,this.DU.domElement,void 0,void 0,void 0,this.TZh))&&this.SUa.classList.add("ewa-fb-function-button-img");this.B$a&&this.SUa&&
(G.DOMElementExtensions.setVisible(this.B$a,!Va),G.DOMElementExtensions.setVisible(this.SUa,Va))}}Object(w.a)($a,"FormulaBarFunctionControl",L.a,[]);var ha=a(184),cb=a(175),Ia=a(49),ob=a(9),gb=a(164),Za=a(148),da=a(12);class ya{constructor(Va){this.nya=this.Ema=this.zTc=this.yTc=this.xTc=null;this.Mrc=this.cAd=this.a9=!1;this.Kte=this.Upb=this.DKe=this.H$f=0;this.lxc=Jb=>{this.h6e();Jb.Ca.rawEvent.preventDefault();return!0};this.hxc=Jb=>{this.cAd=!0;this.H$f=Jb.clientPoint.y;document.body.classList.add(m.d2e);
this.a9||(this.bWa=0);this.a7a.la("mousemove",this.YNf,!0);this.a7a.la("touchmove",this.YNf);this.a7a.la("mouseup",this.SMd);this.a7a.la("touchend",this.SMd);this.a7a.la("mouseleave",this.SMd);return!0};this.SMd=()=>{this.cAd=!1;this.bWa=this.Sr.clientHeight-gb.c;document.body.classList.remove(m.d2e);this.a7a.zH();b.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Sr.clientHeight} pixel`)};this.YNf=Jb=>{this.cAd?(Jb=da.HelperMethods.Hjc(Jb).y,
Jb=this.tff(this.bWa+Math.min(Jb,this.$.domElement.clientHeight-75)-this.H$f),this.a9=Jb>=this.lineHeight,G.DOMElementExtensions.toggleCssClass(this.Sr,m.e2e,this.a9),Jb=gb.c+Math.round(Math.max(Jb-2,0)),this.Sr.clientHeight!==Jb&&(this.Sr.style.height=Jb+"px",this.$.pEa())):b.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.DQ=Jb=>{this.a9&&(this.GOa=Math.round((Math.round(this.GOa/this.lineHeight)+(0<Jb.sta?
1:-1))*this.lineHeight));Jb.Ca.preventDefault();return!1};this.q$=()=>{this.ZGj();this.Mrc&&(ha.a.instance.Aa(d.a.TK,document.body,this.q$),ha.a.instance.Aa(d.a.rCa,document.body,this.q$),cb.a.instance.Aa(d.a.hg,document.body,this.q$),this.Mrc=!1);return!1};this.Fg=()=>{this.GOa=0};this.onScroll=Jb=>{this.Mrc||(ha.a.instance.ta(d.a.TK,document.body,this.q$),ha.a.instance.ta(d.a.rCa,document.body,this.q$),cb.a.instance.ta(d.a.hg,document.body,this.q$),this.Mrc=!0);Jb.preventDefault()};this.ogj=Jb=>
{this.GOa=this.DKe;Jb.preventDefault()};this.$=Va;this.a7a=Za.a.instance.MMa(document.body.ownerDocument)}get lineHeight(){return this.Upb?this.Upb:ob.a.z9e}set lineHeight(Va){this.Upb=Va}get Sr(){const {FormulaBar:Va}=a(903);this.xTc||(this.xTc=Va.qkc(this.$));return this.xTc}get Mic(){this.yTc||(this.yTc=document.getElementById(t.a.UBb));return this.yTc}get Bea(){this.zTc||(this.zTc=document.getElementById(t.a.UBb+"_"+t.a.pKc));return this.zTc}get GOa(){return this.Bea.scrollTop}set GOa(Va){this.DKe=
Va;this.Bea.scrollTop!==Va&&(this.Bea.scrollTop=Va)}get bZh(){return 2*this.lineHeight-2}get bWa(){return this.Kte}set bWa(Va){this.Kte=Va}h6e(){this.a9=!this.a9;G.DOMElementExtensions.toggleCssClass(this.Sr,m.e2e,this.a9);this.a9&&!this.bWa&&(this.bWa=this.bZh);this.Sr.style.height=gb.c+(this.a9?this.bWa:0)+"px";this.Ema.setAttribute(t.a.Aw,this.a9?"Collapse the formula bar":"Expand the formula bar");this.$.pEa();b.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.a9?
"expanded":"collapsed"}`)}cvh(Va){const Jb=document.createElement("div");Jb.id=this.$.Ad+t.a.C9e;Jb.className=m.$Kh;this.Ema=ya.irh(this.$.Ad,Va);Jb.appendChild(this.Ema);this.nya=ya.Gqh(this.$.Ad);Jb.appendChild(this.nya);return Jb}pyj(){ha.a.instance.ta(d.a.ur,this.Ema,this.lxc);cb.a.instance.ta(d.a.lh,this.Ema,this.lxc);ha.a.instance.ta(d.a.ur,this.nya,this.hxc);cb.a.instance.ta(d.a.lh,this.nya,this.hxc)}syj(){ha.a.instance.ta(d.a.XF,this.Mic,this.DQ);Ia.a.addHandler(this.Bea,d.a.scroll,this.onScroll);
Ia.a.addHandler(this.Bea,d.a.focus,this.ogj);sa.h(this.$).ha.add_activeCellChanged(this.Fg)}egk(){void 0!==this.Ema&&null!==this.Ema&&(ha.a.instance.Aa(d.a.ur,this.Ema,this.lxc),cb.a.instance.Aa(d.a.lh,this.Ema,this.lxc));void 0!==this.nya&&null!==this.nya&&(ha.a.instance.Aa(d.a.ur,this.nya,this.hxc),cb.a.instance.Aa(d.a.lh,this.nya,this.hxc));void 0!==this.Mic&&null!==this.Mic&&ha.a.instance.Aa(d.a.XF,this.Mic,this.DQ);sa.h(this.$).ha.remove_activeCellChanged(this.Fg)}ZGj(){this.GOa=Math.round(this.tff(this.GOa))}tff(Va){return Math.round(Va/
this.lineHeight)*this.lineHeight}static irh(Va,Jb){const ub=document.createElement("a");ub.id=Va+t.a.eZh;ub.classList.add(m.SKh);G.DOMElementExtensions.wz(ub,t.a.zv);ub.setAttribute(t.a.Aw,"Expand the formula bar");Jb.kfa(ua.a.xkh,12,12,ub).classList.add(m.TKh);return ub}static Gqh(Va){const Jb=document.createElement("div");Jb.id=Va+t.a.cZh;Jb.className=m.RKh;return Jb}}Object(w.a)(ya,"FormulaBarResizeControl",null,[]);S=a(249);var ib=a(46),vb=a(1012),eb=a(191),Ta=a(113),La=a(47),fb=a(1091);class Pb{}
Pb.disabled="disabled";Pb.W4j="stale";Pb.Zoj="presentationMode";Object(w.a)(Pb,"NameBoxStateUpdateKey",null,[]);class Sa extends S.a{constructor(Va,Jb){super(document.createElement("div"));this.eh=null;this.Jck=()=>{this.$.Ha.BEb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.lNd=()=>{var ub=this.gridView.ha;const Qa=ub.ra.MEb()?ub.ra.mzb:ub.ra.activeRange;ub=Qa.isSingle?ub.ra.activeCell.toString():Qa.ufi();this.XN(ub)};this.cm=(ub,Qa)=>{this.fha(ub,Qa);this.qTb(ub,Qa)};this.qTb=()=>{let ub=fb.c(this.$,
this.gridView);vb.c(ub,!0)||(this.eh&&(ub=this.$.Gd.getItemByName(this.eh))&&ub.deactivate(),this.XN(this.gridView.ha.ra.activeCell.toString()))};this.JCa=(ub,Qa)=>{if(ub=Qa.na){var P=ub.usedRange;2===ub.type&&(P=eb.a(ub));var ta=this.gridView.ha.ra.yj,Z=this.gridView.inRangePicker||this.gridView.Jk,aa=!1;2===ub.type&&ta&&!Z&&(ta=this.gridView.ha.ra.activeRange,aa=ub.sheetName===this.$.va.na.name&&!!ta&&ta.top===P.top&&ta.left===P.left&&ta.bottom===P.bottom&&ta.right===P.right);P=ib.v(P,this.$),P.NamedObjectName=
ub.name,P.SheetName=ub.sheetName,this.gridView.qj(P,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,Qa.disableAutoFocusOnGrid);Qa=vb.a(ub.name);this.XN(Qa.name,Qa.fullName)}};this.Wx=()=>{const ub=fb.b(this.gridView);null!=ub&&this.XN(ub.name)};this.SOf=(ub,Qa)=>{this.lNd(ub,Qa)};this.kj=()=>{this.M6a(!1)};this.mDa=()=>{this.M6a(!0)};this.lDa=()=>{this.M6a(!1)};this.ez=()=>{this.M6a(!this.$.isEditMode)};this.FQ=(ub,Qa)=>{this.M6a(Qa.oS?!0:!this.$.isEditMode)};
this.onKeyDown=ub=>ub.Ca.keyCode===c.a.nta?(this.gridView.focus(),!0):!1;this.fha=()=>{this.cae({[Pb.W4j]:!0})};this.$=Va;this.gridView=sa.h(Va);this.Z9g(Jb)&&(this.XN(this.gridView.ha.ra.activeCell.toString()),this.M6a(La.a(this.$).qr()||!this.$.isEditMode),this.al(),f.KeyInputManager.instance.ta(d.a.Rd,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&(this.$.hd.GWd(this.mDa.bind(this)),this.$.hd.FWd(this.lDa.bind(this)),this.$.da.Y3(this.ez.bind(this)),Ta.a(this.$).OCc(this.SOf.bind(this)),
Ta.a(this.$).tWd(this.Wx.bind(this)),La.a(this.$).gi.bra(this.FQ.bind(this)),this.$.Gd&&(this.$.Gd.hj(this.JCa.bind(this)),this.$.Gd.SCc(this.qTb.bind(this)),this.$.Gd.SCc(this.t4f.bind(this)),this.$.Gd.daa(this.fha.bind(this)),this.$.Gd.ara(this.fha.bind(this)),this.$.Gd.RVa(this.fha.bind(this)),this.$.Gd.ZQb(this.fha.bind(this))),this.$.va&&this.$.va.hj(this.cm.bind(this)));if(this.gridView){const Va=this.gridView.ha;Va.eaa(this.qTb.bind(this));Va.zZ(this.lNd.bind(this));Va.Va.caa(this.Wx.bind(this))}super.dispose()}oik(Va){this.cae({[Pb.Zoj]:Va})}Z9g(Va){const Jb=
document.getElementById(this.$.Ad+t.a.A9e);void 0!==Jb&&null!==Jb&&Va.removeChild(Jb);appChrome.renderNameBoxUI(this.domElement,this.Jck.bind(this));Va.insertBefore(this.domElement,Va.firstChild);return!0}al(){this.$.hd.Y5c(this.mDa.bind(this));this.$.hd.X5c(this.lDa.bind(this));this.$.da.B0(this.ez.bind(this));const Va=this.gridView.ha;this.$.Gd.Fi(this.JCa.bind(this));this.$.va.Fi(this.cm.bind(this));Va.Gka(this.qTb.bind(this));Va.zW(this.lNd.bind(this));Va.Va.wW(this.Wx.bind(this));Ta.a(this.$).L5c(this.Wx.bind(this));
Ta.a(this.$).u7b(this.SOf.bind(this));La.a(this.$).gi.Fka(this.FQ.bind(this));this.$.Gd.x7b(this.qTb.bind(this));this.$.Gd.x7b(this.t4f.bind(this));this.$.Gd.C0(this.fha.bind(this));this.$.Gd.Dka(this.fha.bind(this));this.$.Gd.yKa(this.fha.bind(this));this.$.Gd.X2a(this.fha.bind(this))}XN(Va,Jb=""){this.eh=""!==Jb?Jb:this.eh;appChrome.setNamedObjectOrActiveCellRange(Jb,Va)}M6a(Va){this.cae({[Pb.disabled]:Va})}t4f(Va,Jb){fb.a(this.$,!0);this.fha(Va,Jb)}cae(Va){appChrome.updateNameBoxState(Va)}}Object(w.a)(Sa,
"NameBox",S.a,[5]);var Wa=a(190);const pb=m.UKf+" "+m.$S,wa=m.cMe+" "+m.$S;class hb extends L.a{constructor(Va,Jb,ub,Qa){super();this.xwb=this.KMb=this.TLa=this.ETa=null;this.BK=this.xrc=!1;this.q5f=()=>{this.gridView.FM.yp(this.dk);this.gridView.FM.yq(this.kj);this.xrc=!0};this.dk=()=>{this.sHb?this.Brg(!0):this.Cwc.style.display="flex"};this.kj=()=>{this.sHb?this.Brg(!1):this.Cwc.style.display="none"};this.YRf=ta=>this.Qwc(!0,`OkCancelEditControl.OnOkClick: ${ta.ud}`,da.HelperMethods.Vs(ta));this.ZRf=
ta=>this.Qwc(!0,`OkCancelEditControl.OnOkKeyDown: ${ta.ud}`);this.kMf=ta=>this.Qwc(!1,`OkCancelEditControl.OnCancelClick: ${ta.ud}`,da.HelperMethods.Vs(ta));this.nMf=ta=>this.Qwc(!1,`OkCancelEditControl.OnCancelKeyDown: ${ta.ud}`);this.onPointerDown=()=>{this.gridView.Xc&&(this.gridView.Fk.textBox.QH=!0);return!1};const {FormulaBar:P}=a(903);this.$=ub;this.gridView=sa.h(ub);this.BK=T.a.BK();this.Cwc=hb.hdi(ub);this.sHb=T.a.Poa();Qa?(this.ETa=Qa.TPa(ua.a.Vgh,16),this.TLa=Qa.TPa(ua.a.Oyh,16),this.sHb&&
(this.KMb=Qa.TPa(ua.a.Wgh,16),this.xwb=Qa.TPa(ua.a.Pyh,16),this.ETa.style.display="none",this.TLa.style.display="none")):(this.ETa=pa.createClusteredImageFromClusterWithImageClass(16,16,Da.a.pOh,qa.a.di(1),null,null,!0,Jb.ia(1041)),this.TLa=pa.createClusteredImageFromClusterWithImageClass(16,16,Da.a.rOh,qa.a.di(1),null,null,!0,Jb.ia(1042)));this.e$=Va.q9b(P.QLd,P.QLd,pb,"","");this.e$.domElement.appendChild(this.ETa);this.L6=Va.q9b(P.b$c,P.b$c,wa,"","");this.L6.domElement.appendChild(this.TLa);this.sHb&&
(this.e$.domElement.appendChild(this.KMb),this.L6.domElement.appendChild(this.xwb));this.gridView.cellTextEditBox.yp(this.dk);this.gridView.cellTextEditBox.yq(this.kj);ka.a.instance.ta(d.a.click,this.e$.domElement,this.YRf);f.KeyInputManager.instance.ta(d.a.Rd,this.e$.domElement,this.ZRf);ja.a.instance.ta(d.a.pointerDown,this.e$.domElement,this.onPointerDown);ka.a.instance.ta(d.a.click,this.L6.domElement,this.kMf);f.KeyInputManager.instance.ta(d.a.Rd,this.L6.domElement,this.nMf);ja.a.instance.ta(d.a.pointerDown,
this.L6.domElement,this.onPointerDown);this.BK&&this.gridView.tZg(this.q5f)}dispose(){this.gridView&&this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.lp(this.dk),this.gridView.cellTextEditBox.Pp(this.kj));this.gridView&&this.BK&&(this.gridView.vBj(this.q5f),this.xrc&&(this.gridView.FM.lp(this.dk),this.gridView.FM.Pp(this.kj),this.xrc=!1));this.e$&&(ka.a.instance.Aa(d.a.click,this.e$.domElement,this.YRf),f.KeyInputManager.instance.Aa(d.a.Rd,this.e$.domElement,this.ZRf),ja.a.instance.Aa(d.a.pointerDown,
this.e$.domElement,this.onPointerDown));this.L6&&(ka.a.instance.Aa(d.a.click,this.L6.domElement,this.kMf),f.KeyInputManager.instance.Aa(d.a.Rd,this.L6.domElement,this.nMf),ja.a.instance.Aa(d.a.pointerDown,this.L6.domElement,this.onPointerDown));h.a.Ma(this.e$);this.e$=null;h.a.Ma(this.L6);this.L6=null;G.DOMElementExtensions.xh(this.TLa);this.TLa=null;G.DOMElementExtensions.xh(this.ETa);this.ETa=null;this.sHb&&(G.DOMElementExtensions.xh(this.xwb),this.xwb=null,G.DOMElementExtensions.xh(this.KMb),this.KMb=
null);super.dispose()}Qwc(Va,Jb,ub=null){const Qa=this.gridView.Fk;if(ub){const P=this.gridView.pr?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let ta;ta=[Object(Wa.a)(this.gridView.cellTextEditBox.textBox.GFa)];Wa.b(this.$).YFa(ub.rawEvent,P,ta)}this.xrc&&this.gridView.FM.tH?this.gridView.FM.endEdit(Va,Jb,0):Qa.endEdit(Va,Jb,0);this.gridView.focus();return!0}Brg(Va){const Jb=Va?"block":"none";Va=Va?"none":"block";this.ETa.style.display=Jb;this.TLa.style.display=Jb;this.KMb.style.display=
Va;this.xwb.style.display=Va}static hdi(Va){const {FormulaBar:Jb}=a(903);return document.getElementById(Va.Ad+Jb.TKf)}}Object(w.a)(hb,"OkCancelEditControl",L.a,[]);var Sb=a(299),Bc=a(273),ab=a(77),qb=a(201),mc=a(16),yb=a(265),vc=a(206),Db=a(297),Ga=a(143),Eb=a(174),Zb=a(50),ic=a(326),mb=a(328),Hb=a(166),Wb;(function(Va){Va[Va.loaded=0]="loaded";Va[Va.error=1]="error";Va[Va.loading=2]="loading";Va[Va.unloaded=3]="unloaded";Va[Va.missing=4]="missing";Va[Va.undefined=5]="undefined";Va[Va.unexpected=
6]="unexpected"})(Wb||(Wb={}));Object(w.b)("LoadStatus",Wb);a.d(D,"FormulaBar",function(){return Ob});class Ob extends u.a{constructor(Va,Jb=null){super(sa.h(Va));this.Lqg=null;this.aKd=["nameBox","nameBoxData"];this.nke=this.Ix=this.clearContentNotifier=this.nameBox=this.Sr=null;this.ece=!1;this.Bea=null;this.Epc=this.FKe=this.uvf=this.lEf=this.PEb=!1;this.YMi=Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFontValidation",!1);this.zyg=!1;this.zYh=Ka.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaBarFontStatusLogDelay",
2E3);this.dk=()=>{this.$pc&&(this.ece=!1);this.F1d();this.Epc&&this.IKc(!this.tuf)};this.kj=()=>{this.F1d();this.rd||this.NNe();this.Epc&&this.IKc(!1)};this.IKc=ub=>{Ob.eza&&this.FKe!==ub&&(G.DOMElementExtensions.toggleCssClass(Ob.eza,m.kKe,ub),this.FKe=ub)};this.pVf=()=>{this.Xc||this.textBox.disabled||this.startEdit(!0,!1,null)};this.Lp=()=>{this.XEa()};this.FQ=(ub,Qa)=>{this.XEa();Ob.eza&&(Qa.oS?Ob.eza.classList.add(m.kKe):this.i6c())};this.jt=(ub,Qa)=>{ub=this.grid;this.$pc&&(this.ece=!0);this.Xc?
(this.Qab||(Qa.eHb||this.uG(null),this.raiseEvent(u.a.Fwb,Qa)),this.rd&&this.Qab||(this.rd?ub.cellTextEditBox.textBox.isCursorAttached()&&!this.textBox.isCursorAttached()&&ub.cellTextEditBox.textBox.clearCursorFormatLocation():this.rd||this.rlb())):ub.Xc&&this.XEa()};this.ih=(ub,Qa)=>{(ub=this.grid.ha.ra.activeCell)&&(Qa=this.grid.wE(Qa.Re.hash))&&ub.Te(Qa.Qf)&&this.XEa()};this.KNb=(ub,Qa)=>{-185374993===Qa.command&&(b.ULS.sendTraceTag(537161939,0,50,"FormulaBar: OnPasteCSERendered updated instantaneously"),
this.XEa())};this.Vf=()=>{this.XEa();V.TaskExtensions.ya(N.a(this.$.ea),()=>{this.jgg()},this.ka,11)};this.sga=()=>{this.jgg();Zb.PageLoadTrackingInfo.instance.rha(t.a.ena,["formulaButton","textbox","textboxData"]);Zb.PageLoadTrackingInfo.instance.haa(t.a.ena,["formulaButton","textbox","textboxData"]);Zb.PageLoadTrackingInfo.instance.gaa(t.a.ena,["formulaButton"])};this.onKeyDown=ub=>{if(!this.rd){var Qa=this.$.shortcutKeyManager.Ut(ub.Ca);this.w_f(ub.Ca,Qa)}if(ub.Ca.keyCode===c.a.gB){var P=this.zza();
Qa=G.DOMElementExtensions.Jn(P);P=G.DOMElementExtensions.BD(P);return G.DOMElementExtensions.TEa(ub.Ca,Qa,P)}return!1};this.zQ=()=>{this.i6c()};this.jGb=()=>{this.Sr?(this.nameBox=new Sa(this.$,this.Sr),this.CFj()):this.o9f()};Jb||b.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");T.a.Poa()?(this.nke=new ya(Va),this.initialize(this.Y0d(Va,Jb)),this.FOa.pyj()):(this.initialize(Ob.ZRj(Va)),this.Sr=Ob.qkc(Va));if(e.AFrameworkApplication.sa.Sa.$g){const ub=document.getElementById("AdditionalBarsRegion");
ub&&(ub.style.height="")}this.Lzd=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.cF=new Sb.a(this.Sr,1);this.AFi=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.Xbb=this.PF&&Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:8026558_ParenthesesCoupling");this.$pc=Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.uvf=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");
this.qoc=new O(Va);this.qoc.q9b(t.a.zrg,t.a.zrg,t.a.Aak+" cui-TabRowRight",O.Mbh,O.Obh);this.y9e=new $a(this.qoc,mc.a.instance,Va,Jb);this.A3i=new hb(this.qoc,mc.a.instance,Va,Jb);this.Lqg=mb.b(()=>{this.Fhg()},1,this.$.ka,"FormulaBar.setTextBoxForActiveItem",!0);Va.va.Fi(this.Vf);Jb=this.grid;Jb.cellTextEditBox.yp(this.dk);Jb.cellTextEditBox.yq(this.kj);Jb.cellTextEditBox.xKa(this.jt);Jb.XG(this.Lp);Jb.za.yw(this.ih);Jb.za.Lca(this.ih);Jb.E5c(this.KNb);La.a(Va).gi.Fka(this.FQ);Va.da.y0(this.zQ);
Ta.a(Va).L5c(this.Lp);Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&Va.ea.Zc(313,ub=>{this.clearContentNotifier=ub;this.clearContentNotifier.PBe(this.jt)});f.KeyInputManager.instance.ta(d.a.Rd,this.de,this.onKeyDown);Jb=this.textBox.style;yb.c(Jb,Va.isChromeRtl,"0px");Jb.textAlign=this.$rf?"right":"left";this.isVisible=!1;this.Lzd&&(this.textBox.isVisible=!1);F.a(this.$).zKa(this.sga);this.$.da.MAa&&(b.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),
this.sga(null,null));this.XEa();this.i6c();this.textBox.Ijg=!0;this.Nxi();z.a(Va).Wj(this);this.textBox.kCe(this.pVf);this.Qab=!1;this.Ix=new U(this.$,this);T.a.CAd()&&this.kwi();this.textBox.GS(()=>{Zb.PageLoadTrackingInfo.instance.gaa(t.a.ena,["textbox","textboxData"]);this.toggleEditingEvents(!1)});this.Epc=Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:8031579_disableFunctionButton")}set text(Va){this.rd&&this.Xc?this.textBox.setPlainText(Va):super.text=Va}get Xc(){return super.Xc}set Xc(Va){super.Xc=
Va;this.toggleEditingEvents(Va)}get tuf(){return this.Snc||0>=this.text.length}get OVb(){return!0}get formattedText(){return this.rd?this.textBox.getFormattedText():super.formattedText}set formattedText(Va){this.rd?this.textBox.setFormattedText(Va):super.formattedText=Va}get Bab(){return this.Xc}get isVisible(){return G.DOMElementExtensions.isVisible(this.Sr)}set isVisible(Va){this.Lzd?G.DOMElementExtensions.setVisible(this.Sr,Va):(G.DOMElementExtensions.setVisible(this.Sr,Va),this.textBox.isVisible=
Va)}get de(){return this.Sr}get Vh(){return this.isVisible}get Tf(){return I.a.rnd}get FOa(){return this.nke}$h(Va,Jb){Va=!1;Jb||(Va=this.mYh());return Va}dispose(){const Va=this.$;if(Va){Va.va.hj(this.Vf);var Jb=this.grid;Jb.cellTextEditBox.lp(this.dk);Jb.cellTextEditBox.Pp(this.kj);Jb.cellTextEditBox.PVa(this.jt);Jb.zI(this.Lp);Jb.za.Tu(this.ih);Jb.za.OVa(this.ih);La.a(this.$).gi.bra(this.FQ);Va.da.X3(this.zQ);Ta.a(Va).tWd(this.Lp);Jb=F.a(this.$);f.KeyInputManager.instance.Aa(d.a.Rd,this.de,this.onKeyDown);
T.a.Poa()&&this.FOa.egk();Jb&&Jb.SVa(this.sga);z.a(Va).TA(this);Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.LVd(this.jt),Va.ea.sX(313))}this.textBox&&this.textBox.x7f(this.pVf);this.nameBox&&this.$.da.mo(this.jGb);h.a.te([this.cF,this.y9e,this.A3i,this.qoc,this.nameBox]);h.a.Ma(this.Ix);this.Sr&&(G.DOMElementExtensions.kH(this.Sr),this.Sr.className="");b.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");
this.Sr=null;super.dispose()}endEdit(Va,Jb,ub,Qa=null){this.textBox.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Va,["Caller"]:Jb});this.yFa(!1);if(this.Xc){var P=null;this.$pc&&Qa&&(P=this.$.shortcutKeyManager.Ut(Qa));var ta=this.grid.Vd;this.rd||this.textBox.clear("FormulaBar.EndEdit");this.Xc=!1;this.dH(!0);this.ZRa()&&this.grid.Jw&&this.grid.Jw.HOa&&this.grid.Jw.Dib(t.a.QFb);if(Va){var Z=new y.a(this.grid.ha.ra.activeCell,ta.text,ta.text,!1,this.grid.$.va.na);this.C1f(Z);null!==Z&&(ta.text=
Z.newValue)}else this.textBox.setPlainText(this.text);Z=new C.a(this.grid.ha.ra.activeCell,ta.text,Va);this.TSd(Z);ta.endEdit(Va,`${Jb}->FormulaBar.EndEdit`,ub,Qa);this.cyf(P)||ta.textBox.focus();this.textBox.dkb("FormulaBar.EndEdit")}else this.textBox.dkb("FormulaBar.EndEdit",{["IsEditing"]:"false"})}f8(Va,Jb,ub,Qa=!0,P=!0){super.f8(Va,Jb,ub,Qa,P);this.rd&&this.grid.Vd.f8(Va,Jb,ub,Qa,P)}y_f(Va){if(this.rd){const Jb=this.grid.Vd,ub=this.textBox.selection;ub.length&&Jb.f8(ub.index,ub.length,Va,!1,
!1)}}nj(Va){return G.DOMElementExtensions.Eh(this.Sr,Va)}Vk(){e.AFrameworkApplication.sa.Cg.gm(this.Tf)}yl(){}$vg(Va){this.nameBox.oik(Va);this.y9e.qik(Va)}xae(){if(this.Bea){var Va=Object(Hb.g)(this.text);this.PEb!==Va&&(this.Ghg(Va),this.PEb=Va)}}bMd(){this.textBox.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Va=this.grid.Vd;if(this.rd){if(!Va.Xc||!this.Xc)return;Va.formattedText=this.formattedText}else Va.text=this.text;Va.setCaretPosition(this.textBox.caretPosition)}eOb(Va){this.textBox.disabled||
(this.grid.cellTextEditBox.textBox.QH=!0,this.rd&&this.Xc||this.startEdit(!1,!0,Va),this.vla())}dUa(Va){this.rd?(this.SQ&&(this.JO=this.textBox.caretPosition,this.YV=this.textBox.LZ.length),this.PF&&this.uG(null)):super.dUa(Va);this.tha();this.Dtg()}qqa(Va){var Jb=this.$.shortcutKeyManager.Ut(Va);const ub=this.rd&&this.Qab;1872288872===Jb||125627505===Jb||267796030===Jb?super.qqa(Va):ub?ab.g(Va):this.Xc&&this.grid.Vd.Xc&&(Jb=this.grid.Vd,this.rd?Jb.formattedText=this.formattedText:Jb.text=this.text,
Jb.setCaretPosition(this.textBox.caretPosition),this.hMc(),this.Xbb&&0===this.textBox.selection.length&&this.uG(null,null),this.AFi&&this.inRangePicker&&this.T5d(),super.qqa(Va))}df(Va,Jb){this.Xc&&super.df(Va,Jb)}Ou(Va,Jb){this.Xc&&super.Ou(Va,Jb)}kwi(){const Va=this.grid.yd(void 0);Va?(this.PEb=Va.Qy||Object(Hb.g)(Va.text),this.Ghg(this.PEb)):b.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}Ghg(Va){G.DOMElementExtensions.toggleCssClass(this.Bea,m.XKh,
Va);this.uvf&&!this.lEf&&this.PEb&&(this.lEf=!0,this.oTi());this.dnk(Va)}dnk(Va){this.YMi&&!this.zyg&&Va&&(this.zyg=!0,this.fnk(),this.gnk(),this.enk())}fnk(){const Va=window.getComputedStyle(this.Bea).getPropertyValue("font-family").replace(/[""]/g,"").toLowerCase().split(",").map(ub=>ub.trim()),Jb=Gc.map(ub=>ub.toLowerCase()).reduce((ub,Qa,P)=>`${ub?ub+",":ub} ${Qa}=${Qa===Va[P]}`,"");b.ULS.sendTraceTag(508687192,0,50,`FormulaBar.validateMonospaceFontFamily: ${Jb}`)}gnk(){void document.fonts.ready.then(()=>
{var Va=document.createElement("canvas").getContext("2d");Va.font=`11pt ${Gc.join(", ")}`;const Jb=Va.measureText(".").width;Va=Va.measureText("X").width;b.ULS.sendTraceTag(508687191,0,50,`FormulaBar.validateMonospaceFontWidth: equals=${Jb===Va}, dot=${Jb}, x=${Va}`)})}enk(){void document.fonts.ready.then(()=>{const Va=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(Gc);Va.forEach(Jb=>{Jb.status=Wb[Jb.status]});b.ULS.sendTraceTag(508687190,0,50,`FormulaBar.validateMonospaceFontFace: ${JSON.stringify(Va)}`)})}oTi(){setTimeout(()=>
{const Va=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(Gc);let Jb="FormulaBar: Formula fonts load status: ";for(const ub of Va)Jb+=`${ub.font}: ${Wb[ub.status]}; `;b.ULS.sendTraceTag(509642332,0,50,Jb)},this.zYh)}Y0d(Va,Jb){this.Sr=Ob.qkc(Va);this.Sr.classList.add(m.f2e);this.Sr.classList.add(m.g2e);const ub=this.FOa.cvh(Jb);Jb=Ob.Zcc(this.rd,!0);ub.appendChild(Jb);Ob.eza=Ob.lTe(Va.Ad);const Qa=Ob.hTe(),P=Ob.QTe(Va.Ad),ta=Ob.PTe(Va.Ad),Z=Ob.FSe(Va.Ad);ta.tabIndex=-1;Z.tabIndex=-1;P.appendChild(Z);
P.appendChild(ta);P.appendChild(Ob.eza);Qa.appendChild(P);Qa.appendChild(ub);Va=Ob.HTe(Va.Ad);this.Sr.appendChild(Va);this.Sr.appendChild(Qa);const aa=new Db.a(Jb,this.rd,!1);this.Bea=Jb;this.FOa.lineHeight=aa.D9h();aa.GS(()=>{ic.c(aa.Ag,r.a.ariaLabel,"formula bar")});aa.GS(()=>{this.FOa.syj()});aa.isVisible=!1;return aa}cUa(Va){this.kBc(Va);super.cUa(Va);Ga.b(this.$).Xe(K.a.gZh,{["Location"]:"canvas"});n.a.Ki&&window.focus();const Jb=this.$.shortcutKeyManager.Ut(Va);this.rd&&this.w_f(Va,Jb);this.textBox.disabled||
this.rd&&this.Xc||this.startEdit(!0,!1,Va);let ub;ub={};ub.wasEditing=this.Xc;ub.formulaBar=!0;let Qa=this.zl(Va,Jb);!Qa&&qb.d(Jb,this.fbb,!0)&&(Qa=this.cyf(Jb)?!0:this.grid.ha.zl(Va,Jb,ub));Qa||Eb.a(this.$).nHd(Va,0,7)}startEdit(Va,Jb,ub){const Qa=this.grid;if(!this.Xc||!Qa.Xc){this.textBox.dkb("FormulaBar.StartEdit");this.textBox.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:Va,["IsOnMouseDown"]:Jb});Ga.b(Qa.$).Xe(K.a.fZh,{["Location"]:"canvas"});this.Xc=this.Qab=!0;Qa.nt&&
Qa.nt.aGc(this);Qa.cellTextEditBox.dH(!1);Qa.cellTextEditBox.KXd();this.dhg(!1);var P=()=>{var ta=Qa.$.va.na;const Z=Qa.yd(null);ta=new J.a(Z,ta,void 0,void 0,void 0,this.Oqd(Z));this.USd(ta);this.rd&&this.DTb(Qa.cellTextEditBox.textBox.wH);!this.rd&&Z&&Z.i4d&&(this.text="");this.rd?(window.setTimeout(()=>{if(this.Xc&&Qa.Xc){Qa.Xc&&Qa.cellTextEditBox.textBox.detachCursorFormat();if(!this.uG(null)){const Ea=Qa.cellTextEditBox.formattedText;var aa=this.textBox.caretPosition;const za=Ea.Text.length;
aa=this.textBox.text.length!==za?za:aa;this.formattedText=Ea;this.textBox.caretPosition=aa}this.Qab=!1;this.textBox.clearHistory()}else this.Xc=!1},0),Qa.cellTextEditBox.QXd()):(Jb||(this.rlb(),this.uG(null)),Qa.cellTextEditBox.QXd(),this.Qab=!1)};if(Qa.Xc)Qa.vD=1,P();else if(this.textBox.QH=!0,V.TaskExtensions.ya(Qa.startEdit(!1,1,ub,!1,void 0,Jb,1),ta=>{ta.result?(Qa.Xc||(this.textBox.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),b.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),
this.Xc&&Qa.Xc?(Qa.cellTextEditBox.textBox.QH=!0,ta=Qa.yd(null),this.textBox.Z8e(Number.NaN,this.Oqd(ta)),Va&&this.textBox.setCaretPositionToEnd(),P()):this.Xc=!1):this.Xc=!1},this.ka,11),this.textBox.QH=!1,ub=Qa.yd(null),null===ub||void 0===ub?0:ub.fBd)this.textBox.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=da.HelperMethods.Fog(this.text)}}qud(Va){super.qud(Va);this.Epc&&this.grid.Xc&&2===Va&&this.IKc(!this.tuf)}Fg(Va,Jb){super.Fg(Va,Jb);this.F1d()}mXa(Va){Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&
b.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Va}`);super.mXa(Va)}F1d(){const Va=this.grid;Va.Xc&&2===Va.vD||this.XEa()}dh(){var Va=this.grid;this.Xc&&Va.Xc&&(Va=Va.Vd,Va.text=this.text,Va.setCaretPosition(this.textBox.caretPosition),this.inRangePicker&&this.textBox.focus())}XEa(){this.rd?this.Lqg():this.Fhg()}Fhg(){if(this.textBox){var Va=this.grid;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",
{["IsEditing"]:this.Xc,["TextBox.Initialized"]:this.textBox.initialized,["Grid.IsEditing"]:Va.Xc});if(!this.Xc){var Jb=La.a(this.$).qr();this.Sr.disabled=Jb||!this.$.isEditMode;var ub=(Jb=this.$.hX===Va)&&1===Va.ha.ng;this.textBox.initialized&&(this.textBox.disabled=this.Sr.disabled||Jb&&!ub);Jb=new vc.a(this.textBox.style);var Qa=!1;if(ub)if(Va.Xc)this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),ub=
Va.cellTextEditBox.text;else{Qa=Va.yd(null);ub=new R.a(this.$.va);if(!Qa||!ub.RIb(Qa.range,Va))return;Va=ub.Ej;ub=Qa.Ui;var P=Qa.formulaBarText;const ta=Qa.text;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Va,["activeCell.IsHidden"]:ub,["activeCell.FormulaBarText"]:!!P,["activeCell.Text"]:!!ta});ub=Va&&ub?"":P||ta;Qa=Qa.i4d}else ub="",P=Va.ha.Va.Yd,P=(null===P||void 0===P?0:P.floatingObject)?P.floatingObject.xd:null,
64===Va.ha.ng&&P&&P.IsShapeFormulaPresent&&((Va=(Va=P.ShapeText)?Va.substring(Va.indexOf("\nFormula:")+9,Va.indexOf(";FormulaVal:")):null)?(this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),ub="="+Va):b.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.dhg(Qa);this.npb=this.B$b();Jb.bB.direction=this.U8?k.a.rtl:
k.a.WSa;Jb.bB.textAlign=this.U8?k.a.right:k.a.left;Jb.GW();this.text=ub}}}jgg(){var Va=this.$.hX;if(this.Lzd){const Jb=!!this.grid.FM&&this.grid.FM.tH;this.isVisible=Va=!!Va&&this.$.snd&&!this.$.da.ae.inEmbedView;Jb||(this.textBox.isVisible=Va)}else this.isVisible=!!Va&&this.$.snd&&!this.$.da.ae.inEmbedView;this.$.NH(t.a.k5d);this.$.eL()}dhg(Va){G.DOMElementExtensions.toggleCssClass(this.textBox.domElement,m.VKh,Va)}zza(){return this.Sr.querySelectorAll(G.DOMElementExtensions.Us+", div[tabindex]")}Jn(){return G.DOMElementExtensions.Jn(this.zza())}mYh(){const Va=
this.Jn();return Va?(G.DOMElementExtensions.setFocus(Va),!0):!1}w_f(Va,Jb){Jb=-287251124===Jb||-1925065947===Jb||1764140053===Jb;Bc.a.aSa()&&Jb&&Va.preventDefault()}i6c(){this.IKc(!this.$.isEditMode)}DTb(Va){this.rd&&(this.textBox.wH=Va)}toggleEditingEvents(Va){this.textBox.toggleEditingEvents(Va)}Nxi(){this.Sr?Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",!1)?this.jGb():Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?this.$.da.Og?
this.jGb():this.$.da.Ol(this.jGb):this.$.da.Ol(this.jGb):this.o9f()}CFj(){Zb.PageLoadTrackingInfo.instance.rha(t.a.ena,this.aKd);Zb.PageLoadTrackingInfo.instance.haa(t.a.ena,this.aKd);Zb.PageLoadTrackingInfo.instance.gaa(t.a.ena,this.aKd)}o9f(){b.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}cyf(Va){return this.$pc&&!this.ece&&(125627505===Va||706199415===Va)}get text(){return super.text}static qkc(Va){return document.getElementById(Va.Ad+
t.a.v6a)}static ZRj(Va){const Jb=Ka.EwaSettings.rd(),ub=Ob.qkc(Va);ub.classList.add(m.f2e);Ob.eza=Ob.lTe(Va.Ad);const Qa=Ob.Zcc(Jb,!0),P=Ob.hTe();P.appendChild(Ob.eza);P.appendChild(Qa);const ta=Ob.QTe(Va.Ad),Z=Ob.PTe(Va.Ad),aa=Ob.FSe(Va.Ad);ta.appendChild(Z);ta.appendChild(aa);P.appendChild(ta);Va=Ob.HTe(Va.Ad);ub.appendChild(Va);ub.appendChild(P);const Ea=new Db.a(Qa,Jb,!1);Ea.GS(()=>{ic.c(Ea.Ag,r.a.ariaLabel,"formula bar")});Ea.isVisible=!1;return Ea}static hTe(){const Va=document.createElement("div");
Va.className=m.QKh;Va.classList.add(m.$S);return Va}static QTe(Va){const Jb=document.createElement("div");Jb.id=Va+Ob.TKf;Jb.className=m.Cwc;Jb.classList.add(m.$S);return Jb}static Zcc(Va,Jb){const ub=Bc.a.aSa(),Qa=document.createElement(ub?"div":"textarea");Qa.className=m.WKh;T.a.$Hi()&&Qa.classList.add(m.ZKh);Jb&&Va&&Qa.classList.add(m.YKh);Va?Qa.classList.add(m.y1i):(Qa.setAttribute(x.a.autoCorrect,v.a.off),Qa.setAttribute(x.a.wrap,v.a.virtual),Qa.setAttribute(x.a.spellcheck,v.a.yGa),G.DOMElementExtensions.wz(Qa,
t.a.L3a),Qa.tabIndex=0);ub?(Qa.id=t.a.UBb,Va||Qa.setAttribute(x.a.contentEditable,v.a.tbe)):(Qa.cols=20,Qa.rows=2);return Qa}static lTe(Va){const Jb=document.createElement("div");Jb.id=Va+t.a.Lic;Jb.className=m.d$e;G.DOMElementExtensions.wz(Jb,t.a.zv);Jb.setAttribute(t.a.Aw,"insert function");Jb.tabIndex=0;Jb.classList.add(m.$S);return Jb}static PTe(Va){const Jb=document.createElement("div");Jb.id=Va+Ob.QLd;Jb.className=m.UKf;G.DOMElementExtensions.wz(Jb,t.a.zv);Jb.setAttribute(t.a.Aw,"commit edit");
Jb.tabIndex=0;Jb.classList.add(m.$S);return Jb}static FSe(Va){const Jb=document.createElement("div");Jb.id=Va+Ob.b$c;Jb.className=m.cMe;G.DOMElementExtensions.wz(Jb,t.a.zv);Jb.setAttribute(t.a.Aw,"cancel edit");Jb.tabIndex=0;Jb.classList.add(m.$S);return Jb}static HTe(Va){const Jb=document.createElement("div");Jb.id=Va+t.a.A9e;Jb.className=m.UKh;return Jb}}Ob.TKf="okCancelButtonContainer";Ob.QLd="okboxButton";Ob.b$c="cancelboxButton";Ob.eza=null;Object(w.a)(Ob,"FormulaBar",u.a,[33]);const Gc=["Consolas",
"Monaco","Menlo","Courier New","monospace"]}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/813c39d97047757a98692573d962018c/EwaTS.vrd.js.map