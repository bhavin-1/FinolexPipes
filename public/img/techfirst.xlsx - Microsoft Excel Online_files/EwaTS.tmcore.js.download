'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1194:function(w,D,a){a.r(D);w=a(0);var b=a(15);class c{constructor(r,n,u,v,x,k){r&&(this.N=r);n&&(this.S=n);u&&(this.M=u);v&&(this.F=v);null!=x&&(this.L=x);null!=k&&(this.C=k)}}Object(w.a)(c,"SerializableExceptionEntry",null,[]);class e{constructor(r,n,u,v,x){this.T=r;this.L=n;this.S=u;this.I=v;this.V=x}}Object(w.a)(e,"SerializableLogCache",null,[]);class f{constructor(r,n,u,v,x,k,m=!1,t=null,z=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=k;this.T=v;this.M=r;this.C=n;this.D=1E3*x+u;m&&(this.O=1);t&&(this.A=t);z&&(this.E=z)}Rfh(){if(!this.E)return 0;let r=7,n=0;this.E.N&&(r+=6+f.vda(this.E.N),n++);this.E.S&&(r+=6+f.vda(this.E.S),n++);this.E.M&&(r+=6+f.vda(this.E.M),n++);this.E.F&&(r+=6+f.vda(this.E.F),n++);this.E.L&&(r+=6+f.vda(this.E.L),n++);this.E.C&&(r+=6+f.vda(this.E.C),n++);1<n&&(r+=n-1);return r}glh(){let r=a(1194).LogCache.VSi+f.vda(this.G)+f.vda(this.T)+this.M.length+f.vda(this.C)+
f.vda(this.D)+this.Rfh();1===this.O&&(r+=6);if(this.A){r+=7;for(let n=0,u=this.A.length;n<u;++n)r+=this.A[n].length+3}return r}static vda(r){return(""+r).length}}Object(w.a)(f,"SerializableLogEntry",null,[]);var d=a(392);a.d(D,"LogCache",function(){return h});class h{constructor(r,n,u){this.d2c=0;this.l2b=null;this.lGa=this.G5b=this.Hnb=0;this.c1c=r;this.W0a=n;this.o0=u;this.c1c=262144>r?r:262144;this.kNg=this.c1c-4*(this.W0a+25);this.reset()}reset(){this.l2b=[];this.Hnb=25;this.d2c=(new Date).getTime()}get count(){return this.l2b.length}get MXb(){return this.G5b}set MXb(r){this.G5b=
r}rWg(r){if(r){r.message=this.UWb(r.message,"message",r.tag);var n=r.Tkd;n&&(n.name=this.UWb(n.name,"Exception.Name",r.tag),n.stack=this.UWb(n.stack,"Exception.Stack",r.tag),n.message=this.UWb(n.message,"Exception.Message",r.tag),n.file=this.UWb(n.file,"Exception.File",r.tag));if(r.uh)for(var u=0;u<r.uh.length;u++)r.uh[u].length>this.W0a&&(r.uh[u]=r.uh[u].substr(0,this.W0a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",u,d.a(r.tag)));n=n?new c(n.name,n.stack,n.message,
n.file,n.line,n.column):null;r=new f(r.message,r.category,r.level,r.timestamp-this.d2c,r.lHd,r.tag,r.CHi,r.uh,n);n=r.glh();0<this.G5b&&n+this.Hnb>this.G5b&&(u=this.count,this.reset(),b.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",u));Array.add(this.l2b,r);this.Hnb+=n}}UWb(r,n,u){let v=r;r&&r.length>this.W0a&&(v=r.substr(0,this.W0a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",n,d.a(u)));return v}get SDi(){return this.Hnb>
this.kNg}serialize(){return b.ULS.ye(new e(this.d2c,this.l2b,this.o0,this.lGa,1))}get f5d(){return this.c1c}get NGd(){return this.W0a}}h.VSi=31;Object(w.a)(h,"LogCache",null,[55,56])},1364:function(w,D,a){a.r(D);w=a(647);D=a(0);var b=a(15),c=a(80),e=a(63);class f{constructor(){$addHandler(document,"securitypolicyviolation",Object(c.a)(this,this.cUf,"onSecurityPolicyViolationEventHandler"))}cUf(Za){Za=Za.rawEvent;let da=Za.blockedURI;da=e.a.V3(da);const ya={};ya.effectiveDirective=Za.effectiveDirective;
ya.violatedDirective=Za.violatedDirective;ya.originalPolicy=Za.originalPolicy;ya.blockedURI=da;ya.disposition=Za.disposition;b.ULS.sendTraceTag(588084128,306,15,"{0}",ya)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(c.a)(this,this.cUf,"onSecurityPolicyViolationEventHandler"))}}Object(D.a)(f,"ContentSecurityPolicyListener",null,[5]);var d=a(261);class h{constructor(){this.Rc=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Rc.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const Za=
this.Rc.ai("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");Za&&Za.dispose()}Oj(Za){this.Rc=Za;this.Rc.register(f,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").se().Ae(()=>new f)}static main(){d.a.instance.Mk(new h)}}Object(D.a)(h,"ContentSecurityPolicyPackage",null,[3,4]);var r=a(43);class n{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=
this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=this.Flight=null}O_d(){return r.c(this)}}Object(D.a)(n,"DiagnosticsRequest",null,[]);var u=a(6),v=a(493),x=a(474),k=a(32);class m{constructor(Za,da,ya,ib,vb){this.cKa=Za;this.dHa=da;this.g5=ya;this.GPc=ib;this.NLg=vb}keg(Za,da){try{this.Frh().send(this.T0h(Za,da))}catch(ya){b.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",ya.toString())}}Frh(){const Za=new XMLHttpRequest;Za.open("POST",this.cKa,!0);Za.setRequestHeader("Content-Type",
"text/json; charset=utf-8");u.AFrameworkApplication.userSessionId&&Za.setRequestHeader(x.a.oZa,k.a.PH(u.AFrameworkApplication.userSessionId));this.dHa&&Za.setRequestHeader(x.a.o3,this.dHa);if(u.AFrameworkApplication.mf){const da=u.AFrameworkApplication.mf.LR;da&&Za.setRequestHeader(x.a.emb,da)}return Za}T0h(Za,da){if(!Za)return null;da=da?"<stack>"+da+"</stack>":"";const ya=new n;ya.Message=Za.message;ya.File=Za.source;ya.Line=Za.line;ya.Column=Za.column;ya.Stack=da;ya.ClientAppVersion=this.dHa;ya.AppType=
this.g5;ya.AppMode=this.GPc;ya.DeobfuscateWithSourceMaps=this.NLg;u.AFrameworkApplication.fa.qa("JavaScriptCrashJsonTagEnabled")&&(ya.SessionStartInfoJson=u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson||"",u.AFrameworkApplication.Jg&&(ya.DataPlumber=r.c(u.AFrameworkApplication.Jg)),ya.IsShuttingDown=u.AFrameworkApplication.fi,ya.Flight=u.AFrameworkApplication.flightId,ya.ErrorName=v.a.Ybf(Za));return ya.O_d()}}Object(D.a)(m,"JavascriptErrorReporter",null,[417]);class t{build(Za,da,ya,
ib,vb){return new m(Za,da,ya,ib,vb)}}Object(D.a)(t,"JavascriptErrorReporterFactory",null,[408]);class z{Oj(Za){Za.register(t,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").se().Ae(()=>new t)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){d.a.instance.Mk(new z)}}Object(D.a)(z,"DiagnosticsPackage",null,[3,4]);var y=a(57),C=a(106),J=a(234),F=a(40),K=a(181),L=a(357),S=a(39),W=a(59),G=a(45),O=a(1194);class T{constructor(Za=
null,da=null,ya=null,ib=null,vb=null,eb=null,Ta=null,La=null){this.NGd=3072;this.f5d=65536;this.yxg=6E4;this.Pqg=2E3;this.JWe=1E4;this.rHe=5E3;this.oHe=!1;this.MXb=0;null!=Za&&(this.NGd=Za);null!=da&&(this.f5d=da);null!=ya&&(this.yxg=ya);null!=ib&&(this.Pqg=ib);null!=vb&&(this.JWe=vb);null!=eb&&(this.rHe=eb);null!=Ta&&(this.oHe=Ta);null!=La&&0<La&&(this.MXb=La)}}Object(D.a)(T,"UlsUploadConfiguration",null,[]);var I=a(392);class N{constructor(Za,da,ya=null){this.n0b=0;this.NSc=!1;this.nMb=0;this.Rnb=
null;this.Dsb=0;this.Pi=null;this.G1d=this._disposing=!1;this.PE=this.a2c=this.MZb=this.H_b=0;this.xFc=!1;this.b_a=0;ya||(ya=new T);this.A0c=Za;this.uploadUrl=da;this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&b.ULS.disable();this.RSg=ya.yxg;this.nSg=ya.Pqg;this.uIg=ya.JWe;this.SSg=ya.rHe;this.VFg=ya.oHe;this.sja=new O.LogCache(ya.f5d,ya.NGd,Za);this.sja.MXb=ya.MXb;this.MXd();this.n$f();this.o$f()}n$f(){this.Rnb=[];this.NSc=!1}oY(Za){1<this.llb?256>
this.Rnb.length?Array.add(this.Rnb,Za):this.NSc=!0:(this.sja.rWg(Za),this.vTi(Za)&&!this.YXe()?(this.H8e("LogIndicatesError in HandleTrace"),b.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",I.a(Za.tag))):this.sja.SDi&&(this.IBb(!1,!0),b.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}vTi(Za){return!!Za&&(1===Za.lHd||10===Za.level)}YXe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.TXh(),b.ULS.J1d(null),window.clearTimeout(this.b_a),
window.clearTimeout(this.H_b),window.clearTimeout(this.MZb),this.MZb=this.H_b=this.b_a=0)}TXh(){this.mode=2;this.Fkf();this.xFc=!1;this.o0e();this.H8e("FlushForAppClose")}LXb(Za,da){Za.lGa=this.nMb;return this.zxg(Za.serialize(),da)?(this.nMb++,!0):!1}zxg(Za,da){da=this.VFg||!da;this.Pi&&da||(this.Pi=new XMLHttpRequest);if(0===this.Pi.readyState||4===this.Pi.readyState)return this.Pi.open("POST",this.uploadUrl,da),this.Pi.setRequestHeader("Content-Type","application/json"),this.Pi.setRequestHeader(N.f0d,
this.A0c),da&&(this.Pi.timeout=this.SSg),this.Pi.send(Za),!0;b.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.nMb,["XhrReadyState"]:this.Pi.readyState});return!1}ehj(){this.Pi&&this.Pi.abort()}MGc(Za,da,ya){try{return window.setTimeout(()=>{b.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",da,ya);Za()},da)}catch(ib){b.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",
ib.toString());if(!this.G1d){this.G1d=!0;try{Za()}finally{this.G1d=!1}}return 0}}o$f(){try{window.clearTimeout(this.H_b)}catch(Za){b.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",Za.toString())}this.H_b=this.MGc(Object(c.a)(this,this.Fkf,"handleDelayedLogs"),this.uIg,"ResetDelayedLoggingTimer")}get llb(){return b.ULS.llb+this.Dsb}Fkf(){const Za=this.Rnb.length;if(Za){var da=this.Rnb,ya=this.NSc;this.n$f();b.ULS.sendTraceTag(3731798,
100,50,"HandleDelayedLogs {0}",{["Count"]:Za,["Limit"]:256,["ExceededLimit"]:ya});this.Dsb++;for(ya=0;ya<Za;ya++)this.oY(da[ya]);this.Dsb--}this.o$f()}MXd(){try{window.clearTimeout(this.MZb)}catch(Za){b.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",Za.toString())}this.MZb=this.MGc(Object(c.a)(this,this.IBb,"flushImpl"),this.RSg,"ResetCadenceTimer")}get mode(){return this.PE}set mode(Za){const da=this.PE;this.PE=Za;if(0===this.PE&&0!==da)try{const ya=
this.a2c;this.a2c=0;window.clearTimeout(ya)}catch(ya){b.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",ya.toString())}else 0!==this.PE&&0===da&&(this.a2c=this.MGc(Object(c.a)(this,this.o0e,"endThrottling"),this.nSg,"ThrottlingMode Setter"))}o0e(){this.mode=0;this.xFc&&(this.xFc=!1,this.IBb())}HUb(Za){return 2===this.mode||1===this.mode&&!Za}H8e(Za){b.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",Za);this.IBb(!0)}GBb(){this.F8e(0)}F8e(Za){this.b_a||
(this.b_a=this.MGc(Object(c.a)(this,this.IBb,"flushImpl"),Za,"FlushAsynchronous"))}IBb(Za,da){this.Dsb++;try{window.clearTimeout(this.b_a)}catch(ib){b.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",ib.toString())}this.b_a=0;if(this.sja.count)if(!da&&this.HUb(Za))b.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",Za?"sync":"async"),this.xFc=!0;else{this.mode=Za?2:1;this.MXd();b.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",
Za?"sync":"async",this.sja.count);try{var ya=this.LXb(this.sja,Za)}catch(ib){this.ehj(),ya=!1}ya?(this.sja.reset(),this.n0b=0):(this.n0b++,this.n0b<N.ZGf?this.F8e(N.bEc):(this.sja.reset(),this.nMb++,this.n0b=0))}else this.MXd();this.Dsb--}GEb(){}Ztb(){}}N.ZGf=3;N.bEc=15E3;N.f0d="X-UserSessionId";Object(D.a)(N,"UploadingUlsHost",null,[25,5]);const R=Za=>{let da=0;u.AFrameworkApplication.fa&&(da=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.bUlsFetchRequestOption",-1),-1===
da&&(da=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.Excel.bUlsFetchRequestOption",-1)),-1===da&&(da=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.bUlsFetchRequestOption",-1)),-1===da&&(da=u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.bUlsFetchRequestOption",0)));return da===Za};class V{constructor(Za,da,ya,ib){this.lGa=Za;this.V7c=da;this.sessionId=ya;this.version=ib}}Object(D.a)(V,"UploadState",null,[]);class sa{constructor(Za){this.DMg=
Za}get jOi(){return this.DMg}}Object(D.a)(sa,"FetchRequestArgs",null,[]);var U=a(84),ka=a(545);class ja extends Sys.EventArgs{constructor(Za){super();this.uh=Za}}Object(D.a)(ja,"UlsLoggingEventArgs",Sys.EventArgs,[]);var Da=a(214);class qa extends N{constructor(Za,da,ya,ib,vb,eb=null){super(u.AFrameworkApplication.userSessionId,qa.x_h(qa.V3h(Za,ib),da,ya,eb),new T(void 0,u.AFrameworkApplication.Dli(),ib.Af("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,u.AFrameworkApplication.h$b));this.zie=
!1;this.G_c=this.osb=this.uZb=this.hJ=null;this.Ei=ya;this.Kta=ib;(this.msb=this.Kta.Ta("RemoteUlsETag"))&&qa.E0f(this.Kta.Ta("RemoteUlsSuppressions"));vb&&(this.uZb=vb,this.uZb.C5c(Object(c.a)(this,this.AUf,"onSettingsRefreshed")))}get events(){return this.hJ||(this.hJ=new Sys.EventHandlerList)}Ztb(Za){this.events.addHandler(qa.Rtg,Za)}get qfb(){return null}get APd(){return null}get p8c(){return this.Kta.qa("BUlsExceptionLoggingIsEnabled")}dispose(){this.zie||(this.zie=!0,super.dispose(),this.uZb&&
this.uZb.R7f(Object(c.a)(this,this.AUf,"onSettingsRefreshed")))}AUf(Za,da){da.Hbb(qa.u7d)&&(this.osb=this.Fif())}q4h(){return Error().stack}Fif(){let Za=null;if(this.Kta.Mr(qa.u7d)){Za=new Da.a;const da=this.Kta.Ox(qa.u7d);for(let ya=0;ya<da.length;ya++)Za.ga(da[ya],!0)}return Za}oY(Za){this.osb||(this.osb=this.Fif());if(this.osb&&this.osb.Wc(Za.tag))try{!Za.Tkd&&this.p8c?Za.Tkd=new ka.a(Error()):Za.message+=". JsCallStack: "+this.q4h()}catch(ya){Za.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+
this.p8c+" ("+ya.message+")]"}super.oY(Za);const da=this.events.getHandler(qa.Rtg);Za=new ja(Za);da&&da(null,Za)}LXb(Za,da){if(this.Ei){if(!this.g_j)return!1;const ya=Za.serialize();if(0<u.AFrameworkApplication.h$b&&ya.length>u.AFrameworkApplication.h$b)return!1;Za.lGa=this.nMb++;if(R(0)){if(this.Zjg())return this.bTb(this.uploadUrl,ya),!0;this.zBe(this.uploadUrl,ya,da&&!this.qfb?0:3,1,da&&u.AFrameworkApplication.fi,Za.lGa,this.qfb,this.APd)}else{if(this.Zjg()){if(R(1))return this.bTb(this.uploadUrl,
ya),!0;window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common")}this.S4c(this.uploadUrl,ya,3,1,Za.lGa,this.qfb,this.APd)}return!0}return R(0)?super.LXb(Za,da):(this.YNj(this.uploadUrl,Za.serialize()),!0)}Hyc(Za){try{if(Za&&Za.data&&Za.data.responseHeaders&&qa.gFb in Za.data.responseHeaders){var da=Za.data.responseHeaders[qa.gFb];da!==this.msb&&(this.msb=da,qa.E0f(Za.data.responseHeaders[qa.Evd]))}}catch(ya){b.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",
ya.message,ya.stack)}}nxc(Za){const da=Za.data;if(!da)b.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",Za);else if(13===da.status)b.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),this.zxg(da.request.get_body(),!1);else if(!da.responseHeaders)b.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",da.id,da.eWa,
da.Lf,da.httpStatus);else if(!(qa.sAi in da.responseHeaders||(Za=da.httpStatus,400<=Za&&499>=Za))){var ya=da.state;ya.V7c>=N.ZGf||(R(0)?window.setTimeout(()=>{this.zBe(da.request.get_url(),da.request.get_body(),3,ya.V7c+1,!1,ya.lGa,ya.sessionId,ya.version)},N.bEc):window.setTimeout(()=>{this.S4c(da.request.get_url(),da.request.get_body(),3,ya.V7c+1,ya.lGa,ya.sessionId,ya.version)},N.bEc))}}zBe(Za,da,ya,ib,vb,eb,Ta,La){R(0)?this.Ei.Vo(Za,2,da,this.hed(),!1,ya,Object(c.a)(this,this.Hyc,"onSuccessfulUpload"),
Object(c.a)(this,this.nxc,"onFailedUpload"),new V(eb,ib,Ta,La),null,vb,this.Kta.Af("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",Ta,void 0,La,[qa.gFb,qa.Evd]):this.S4c(Za,da,ya,ib,eb,Ta,La)}S4c(Za,da,ya,ib,vb,eb,Ta){let La;La=R(2)||R(3)?new sa(!0):new sa(!1);this.Ei.RVg(Za,da,this.hed(),La,ya,Object(c.a)(this,this.Hyc,"onSuccessfulUpload"),Object(c.a)(this,this.nxc,"onFailedUpload"),new V(vb,ib,eb,Ta),this.Kta.Af("BulsClientRequestManagerQueueTimeInMS",3E4),eb,Ta,[qa.gFb,qa.Evd])}YNj(Za,
da){const ya={};ya.body=da;ya.method="POST";ya.headers=this.hed();if(R(2)||R(3))ya.keepalive=!0;window.fetch(Za,ya).then(()=>null,()=>{b.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch");return null})}hed(){let Za=null;this.msb&&(Za={},Za[qa.gFb]=this.msb);if(this.p8c){const da=u.AFrameworkApplication.sa;let ya=null;da&&(ya=da.Sa);ya&&(Za||(Za={}),Za[qa.Qri]=ya.HCa,Za[qa.Rri]=ya.Xi,Za[qa.Xri]=u.AFrameworkApplication.cDi?"1":"0",R(0)||(Za[qa.Jri]="text/plain"))}return Za}bTb(Za,da){this.Ei.bTb(Za,
da)}Zjg(){return u.AFrameworkApplication.fi||u.AFrameworkApplication.Xrc}get sIj(){this.G_c||(this.G_c=this.Kta.Af("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.G_c}get g_j(){const Za=this.Ei.hbb;return Za&&(new Date).getTime()-this.Ei.UOi.getTime()>=this.sIj?!0:!Za}static V3h(Za,da){da=da.Ta("BulsEndpointUrl");return qa.Nvf(da)?da:Za}static Nvf(Za){return!(void 0===Za||null===Za)&&""!==Za}static x_h(Za,da,ya,ib){Za=qa.$Ug(Za,da);Za=qa.qYg(Za,ya);Za=qa.HWg(Za,ib);return Za=
qa.oYg(Za)}static $Ug(Za,da){return da?e.a.Om(Za,"build",u.AFrameworkApplication.buildVersion):Za}static qYg(Za,da){if(!da)return Za;da=da.LR;return da?Za=e.a.Om(Za,x.a.pYb,da):Za}static HWg(Za,da){return qa.Nvf(da)?e.a.Om(Za,"officeserverversion",da):Za}static oYg(Za){return u.AFrameworkApplication.userSessionId&&""!==u.AFrameworkApplication.userSessionId?e.a.Om(Za,u.AFrameworkApplication.kta,u.AFrameworkApplication.userSessionId):Za}static E0f(Za){b.ULS.Pac();if(Za){Za=Za.split(",");for(const da of Za)Za=
parseInt(da),!isNaN(Za)&&isFinite(Za)&&b.ULS.j7b(Za)}}}qa.gFb="X-bULS-SuppressionETag";qa.Evd="X-bULS-SuppressedTags";qa.Qri="X-bULS-OfficeAppMode";qa.Rri="X-bULS-OfficeAppType";qa.Xri="X-bULS-UseSourceMaps";qa.Jri="Content-Type";qa.Rtg="CommonUlsTraceEventKey";qa.u7d="TagCallStackInclusionList";qa.sAi="X-InvalidUlsJson";Object(D.a)(qa,"CommonUlsHost",N,[]);var Ba=a(107);class ua extends qa{constructor(Za,da){super(Za,!1,u.AFrameworkApplication.mf,U.a.instance.ai("Common.IRefreshableAppSettings")||
u.AFrameworkApplication.fa,U.a.instance.ai("Common.IRefreshableAppSettings"),da);this.Wek="usu";this.Tek="ufu";this.dd=null;this.Ua=new Ba.a}get $(){this.dd||(this.dd=0<W.a.getRegisteredEwaInstances().length?W.a.Fq(document.body):null);return this.dd}oY(Za){1===Za.lHd&&(Za.message="Assert: "+Za.message);super.oY(Za)}YXe(){return!0}LXb(Za,da){if(u.AFrameworkApplication.fi&&u.AFrameworkApplication.iaa)return!1;let ya=null;this.$&&(ya=this.$.Jd.Le("UserAction","CommonUlsHostOverrides:UploadLogs"));da=
!u.AFrameworkApplication.iaa&&da;Za=super.LXb(Za,da);ya&&ya.stop();return Za}Hyc(Za){super.Hyc(Za);this.Ua.raiseEvent(this.Wek,Za)}nxc(Za){super.nxc(Za);this.Ua.raiseEvent(this.Tek,Za)}}Object(D.a)(ua,"CommonUlsHostOverrides",qa,[404,25,5]);class pa{Sph(Za,da){return new ua(Za,da)}}Object(D.a)(pa,"CommonHostFactory",null,[414]);var Ka=a(66);class $a extends S.a{constructor(Za){super();this.tbc=Za;Sys.Application.registerDisposableObject(this)}Ztb(Za){this.tbc.Ztb(Za)}oY(Za){this.tbc.oY(Za)}GEb(Za){this.tbc.GEb(Za)}GBb(){this.tbc.GBb()}static la(Za,
da=null){const ya=new K.a;Object(L.a)($a,u.AFrameworkApplication.IFa)||(da=da||new pa,G.a.wxi(()=>{var ib;if(u.AFrameworkApplication.browserUlsIsEnabled){var vb=Za+"/RemoteUls.ashx";$a.$&&(vb=$a.yXg(vb));const eb=this.Phf();vb=da.Sph(vb,eb);null===(ib=u.AFrameworkApplication.IFa)||void 0===ib?void 0:ib.dispose();u.AFrameworkApplication.IFa=vb;b.ULS.setTraceLevel(50);b.ULS.J1d(vb);ya.setResult(new $a(vb))}else b.ULS.disable()},!u.AFrameworkApplication.TXj()));return ya.task}static yXg(Za){const da=
this.Phf();return e.a.Om(Za,"officeserverversion",da)}static Phf(){return $a.$?Ka.d($a.$)?$a.$.workbookContext.BuildVersion:$a.$.xa.BuildVersion:null}static get $(){$a.dd||($a.dd=0<W.a.getRegisteredEwaInstances().length?W.a.Fq(document.body):null);return $a.dd}}$a.dd=null;Object(D.a)($a,"EwaUlsHost",S.a,[404,25,5]);class ha extends J.a{constructor(Za){super();this.Bra=Za;this.Md()}create(){F.TaskExtensions.ya($a.la(this.Bra),Za=>{Za=Za.result;C.a.Ln.Ja(135,Za);this.qd(Za)},this.ka)}}Object(D.a)(ha,
"EwaUlsHostFactory",J.a,[]);var cb=a(167),Ia=a(41);class ob{constructor(Za){this.Jqe=null;this.ANi=Za}get WKd(){return this.Jqe||(this.Jqe={})}aqj(Za,da,ya){!Za&&da.source&&(Za=Ia.a.As(this.WKd,da.source)+1,this.WKd[da.source]=Za,Za-1&Za||b.ULS.sendTraceTag(537155536,0,15,`${Za} errors seen for location=${da.source}`));da.source&&1!==Ia.a.As(this.WKd,da.source,1)||(b.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),
this.ANi.keg(da,ya))}}Object(D.a)(ob,"JavaScriptCrashProcessor",null,[288]);var gb=a(79);Type.registerNamespace("_Ewa");Object(w.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");h.main();Type.registerNamespace("Common.App.Diagnostics");z.main();Type.registerNamespace("DiagUse");C.a.Ln.Ja(43,new ha(y.a.current.IN.ServerUriBase));(()=>{try{cb.a.Pjf().continueWith(Za=>{try{if(C.a.Ln.Ba(42))b.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const da=
Za.result,ya=U.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(y.a.current.IN.ServerUriBase+da.LayoutsRelativeUri+"/diagnostics.ashx",da.BuildVersion,1,0,!0);C.a.Ln.Ja(42,new ob(ya));b.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(da){b.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${da.message}, Callstack: ${da.stack}`)}},
3,null,gb.a.current)}catch(Za){b.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${Za.message}, Callstack: ${Za.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tmcore.js.map/153f78b49ee705a07d74358ce3f0616f/EwaTS.tmcore.js.map