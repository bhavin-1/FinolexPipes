'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1002:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(238),e;(function(k){k[k.paren=0]="paren";k[k.lead=1]="lead";k[k.intern=2]="intern";k[k.trail=3]="trail";k[k.undefined=4]="undefined"})(e||(e={}));Object(w.b)("CurrencyFormatOption",e);var f;(function(k){k[k.none=-1]="none";k[k.mdy=0]="mdy";k[k.dmy=1]="dmy";k[k.ymd=2]="ymd";k[k.myd=3]="myd";k[k.dym=4]="dym";k[k.ydm=5]="ydm"})(f||(f={}));Object(w.b)("DateOrderOption",
f);class d{constructor(k,m){({CalcHelper:k}=a(1002));m&&(m.Vg||b.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.VMg=k.CTe(m,k.mTe(m.hna));this.WMg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.WMg}get localeData(){return this.VMg}}Object(w.a)(d,"LocaleHolder",null,[]);var h=a(1130),r=a(57),n=a(1),u=a(24),v=a(127);a.d(D,"CalcHelper",function(){return x});class x{constructor(k){this.$=k;(this.Vw=this.$.ea.Ba(268))||
b.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let m;m=n.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?r.a.current.gq(75):r.a.current.gq(78);this.logger=new h.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.TRi=new d(k,this.Vw);excelOnlineCalc.config.initCalc(this.logger,this.Vw?t=>this.Vw.isFeatureEnabled(t):()=>!1,m);this.yt=
excelOnlineCalc.config.calcConfig(this.TRi.localeInfo)}get config(){return this.yt}iwh(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return b.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const k=this.$.va.na;return k?k.index:(b.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.na.index}createParser(){const k={};k.config=this.config;return excelOnlineCalc.parse.createParser(k)}createNumberFormatter(){const k=
excelOnlineCalc.numfmt.createFormatGlobals(this.config,(m,t)=>excelOnlineCalc.calc.getTime(this.config,m,t,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(k)}Buh(k,m,t,z){if(!z)return{range:{row:m,col:t},sheet:{document:this.documentLoc,index:k}};m=excelOnlineCalc.location.gridCell(m,t);k=excelOnlineCalc.location.sheetIndex(this.documentLoc,k);return excelOnlineCalc.location.sheetGridCell(k,m)}static CTe(k,m){m=void 0===m?null:m;const t=k.Oqh(),z=k.Vg.TrueValueString,y=k.Vg.FalseValueString,
C=k.Vg.DecimalSeparator.toString(),J=k.Vg.ListSeparator.toString(),F=k.Vg.ColumnSeparator.toString(),K=k.Vg.RowSeparator.toString(),L=k.Vg.ThousandsDataArray,S=k.Vg.ThousandSeparator.toString(),W=k.Vg.Lcid,G=k.Vg.Country,O=k.Vg.DigitsNumber,T=k.Vg.ExpSeparatedBySpace,I=k.Vg.FractionSeparator.toString(),N=k.Vg.PercentSeparatedBySpace,R=u.a.Deh(Enum.toString(e,k.Vg.CurrencyFormat)),V=k.Vg.CurrencySymbolLead,sa=k.Vg.CurrencySeparatedBySpace,U=k.Vg.CurrencySymbolString,ka=k.Vg.DigitsCurrency,ja=-1===
k.Vg.DateOrder?"MDY":v.e(Enum.toString(f,k.Vg.DateOrder)),Da=k.Vg.DateSeparator.toString(),qa=k.Vg.DateAlternativeSeparator.toString(),Ba=k.Vg.Year4Digits,ua=k.Vg.Month2Digits,pa=k.Vg.Day2Digits,Ka=k.Vg.LongDateFormat,$a=k.Vg.TimeSeparator.toString(),ha=k.Vg.TimeAltSeparator,cb=k.Vg.Hour2Digits,Ia=k.Vg.Use24HourClock,ob=k.Vg.AmPmSeparatedBySpace,gb=[k.Vg.AmString,k.Vg.PmString],Za=k.Vg.DayNameShortArray,da=k.Vg.DayNameLongArray,ya=k.Vg.MonthNameShortArray,ib=k.Vg.MonthNameLongArray,vb=k.Vg.PictureSpecialArray,
eb=c.a.map(("\x00"+k.Vg.PictureSingleString).split(""),Sb=>"\x00"===Sb?null:Sb),Ta=k.Vg.PictureColorArray,La=k.Vg.PictureDbnumArray,fb=k.Vg.RowLetter.toString(),Pb=k.Vg.ColumnLetter.toString(),Sa=k.Vg.LeftBrace.toString(),Wa=k.Vg.RightBrace.toString(),pb=k.Vg.LeftBracket.toString(),wa=k.Vg.RightBracket.toString(),hb=x.iii(k.Vg);return excelOnlineCalc.calc.localeData(m,t,z,y,fb,Pb,Sa,Wa,pb,wa,C,J,F,K,L,S,W,G,O,T,I,N,R,V,sa,U,ka,ja,Da,qa,Ba,ua,pa,Ka,$a,ha,cb,Ia,ob,gb,Za,da,ya,ib,vb,eb,Ta,La,hb,k.Vg.SysDateFormatString,
k.Vg.SysTimeFormatString)}static mTe(k){const m=[];if(!k)return m;for(const t of k)k=null,t.IsDynamicUdf||(k=excelOnlineCalc.calc.worksheetFunctionName(t.FunctionIndexInServer,t.NameUI)),k&&m.push(k);return m}static iii(k){const m=Array(6);m[1]="#"+k.AllStructRefString;m[3]="#"+k.HeadersStructRefString;m[2]="#"+k.DataStructRefString;m[4]="#"+k.TotalsStructRefString;m[5]="#"+k.ThisRowStructRefString;return m}}Object(w.a)(x,"CalcHelper",null,[])},1004:function(w,D,a){a.r(D);w=a(733);var b=a(0),c=a(15),
e=a(6),f=a(96),d=a(33),h=a(39),r=a(87),n;(function(U){U[U.unableToRefreshLock=0]="unableToRefreshLock";U[U.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";U[U.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";U[U.workbookTooLarge=3]="workbookTooLarge";U[U.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";U[U.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";U[U.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";U[U.unsupportedFeatures=
7]="unsupportedFeatures";U[U.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";U[U.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";U[U.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";U[U.lastGenericStatusError=11]="lastGenericStatusError";U[U.scratchPadWarning=12]="scratchPadWarning";U[U.authenticationLost=13]="authenticationLost";U[U.odfCompatibilityIssues=14]="odfCompatibilityIssues";U[U.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";
U[U.workbookIsIrmProtected=16]="workbookIsIrmProtected";U[U.biFeatureNotAvailable=17]="biFeatureNotAvailable";U[U.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";U[U.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";U[U.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";U[U.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";U[U.editAttemptInReadOnly=22]="editAttemptInReadOnly";U[U.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";
U[U.unsupportedBrowser=24]="unsupportedBrowser";U[U.readOnlyPermissions=25]="readOnlyPermissions";U[U.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";U[U.policyWarningMessage=27]="policyWarningMessage";U[U.workingOnIt=28]="workingOnIt";U[U.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";U[U.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";U[U.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";U[U.legacySharedWorkbookEditWarningBB=
32]="legacySharedWorkbookEditWarningBB";U[U.legacyConnectionsBB=33]="legacyConnectionsBB";U[U.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";U[U.groupedSlicersBB=35]="groupedSlicersBB";U[U.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";U[U.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";U[U.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";U[U.wacGdprNotice=39]="wacGdprNotice";U[U.automaticSensitivityLabel=40]="automaticSensitivityLabel";
U[U.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";U[U.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";U[U.localStorageDisabled=43]="localStorageDisabled";U[U.autoRefreshDisabled=44]="autoRefreshDisabled";U[U.corruptedFileRepaired=45]="corruptedFileRepaired";U[U.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";U[U.minorVersionLimitReached=47]="minorVersionLimitReached";U[U.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";U[U.sensitivityApplicationTooLargeFileError=
49]="sensitivityApplicationTooLargeFileError";U[U.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";U[U.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";U[U.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";U[U.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";U[U.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";
U[U.promptEnableExternalLinks=55]="promptEnableExternalLinks";U[U.networkDown=56]="networkDown";U[U.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";U[U.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";U[U.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";U[U.canvasHealth=60]="canvasHealth";U[U.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";U[U.optimizeWorkbook=62]="optimizeWorkbook";U[U.novModePostDepreciation=63]="novModePostDepreciation";
U[U.officeScriptsRunning=64]="officeScriptsRunning";U[U.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";U[U.readOnlyPivotTable=66]="readOnlyPivotTable";U[U.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";U[U.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";U[U.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";U[U.dataCleansingSuggestions=70]="dataCleansingSuggestions";U[U.editInMiniWAC=71]="editInMiniWAC";
U[U.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";U[U.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";U[U.count=74]="count"})(n||(n={}));Object(b.b)("EwaBusinessBarEntryType",n);var u=a(7),v=a(1120);class x extends Sys.EventArgs{constructor(U,ka,ja){ja=void 0===ja?null:ja;super();this.D4a=U;this.mhd=ka;this.data=ja}}Object(b.a)(x,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var k=a(1123),m=a(1121),t=a(1125);a(1124);var z=a(1118),y=a(487),C=a(54),
J=a(40),F=a(668),K=a(35),L=a(1),S=a(21),W=a(66),G=a(78),O=a(968),T=a(151),I=a(19),N=a(1122),R=a(92);a.d(D,"BusinessBarManager",function(){return sa});var V;let sa=V=class extends r.a{constructor(U,ka){ka=void 0===ka?!U.r2:ka;super();this.Ua=new h.a;this.ES=null;this.DSc=[];this.Lwc=()=>{this.$.pa.cRa?this.removeEntry(13):this.ki(13,null)};this.lj=(ja,Da)=>{for(let qa=0,Ba=V.Qlc().length;qa<Ba;qa++)ja=V.Qlc()[qa],this.removeEntry(ja);Da.context&&0<Da.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,
0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.SEj()};this.Jo=(ja,Da)=>{var qa;ja=this.vVh(Da.errors);let Ba=[];for(let pa=0,Ka=ja.length;pa<Ka;++pa){const $a=ja[pa];if(1===$a.Type&&$a.Appearance&32)Ba=this.Lpi($a,Ba);else if(Da.LOj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var ua=(null===(qa=Da.context)||void 0===qa?0:qa.stopwatch)?Da.context.stopwatch.Ee:-1;5E3>ua?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ua}ms).`):e.AFrameworkApplication.pLi()||this.lYg($a,Da.context.methodName)}ua=[...V.Qlc()];for(let ha=0,cb=Ba.length;ha<cb;++ha){const Ia=Ba[ha];this.ki(Ia,$a);Array.remove(ua,Ia)}for(let ha=0,cb=ua.length;ha<cb;++ha)this.removeEntry(ua[ha])}};
this.Qe=(ja,Da)=>{this.oe(ja,Da)};this.oe=()=>{const ja=this.$.da;ja.Zd||ja.Fh()||(this.$Ud(),this.DSc.length=0)};this.kf=(ja,Da)=>{this.$.da.Fh()&&!Da.GY||this.wpf(Da.GY)};this.nOb=()=>{const ja=this.$.userOperationManager.Blc();ja&&ja.operation.flags&1&&this.$kg()};this.QPf=()=>{this.$kg()};this.vh=()=>{this.ZMe();this.ilg()};this.zQ=()=>{if(this.$.o9&&this.$.da.Fh()&&this.$.da.Zd)if(this.$.da.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ja=this.$.ea.Ba(331);ja&&ja.nOa||this.removeEntry(55);this.removeEntry(5)}};this.$=U;this.w3a=ka;this.$5g();e.AFrameworkApplication.mf&&e.AFrameworkApplication.mf.Htb(this);this.z2a=Array(74);for(let ja=0;74>ja;ja++)this.z2a[ja]=null;this.oj=F.EcmaDateClock.instance;this.Yzf=this.oj.Wd.getTime();ka&&(ka=U.pa,ka.Pz(this.Jo),ka.Ht(this.lj),ka.Ntb(this.Lwc),ka.S2a(this.Lwc),U.da.Pl(this.Qe),U.da.zw(this.vh),
U.Pm(this.kf),U.sk(this.oe),U.da.y0(this.zQ),U.userOperationManager.Gt(this.nOb),L.EwaSettings.Da(158)&&U.da.Ii.get(45)&&e.AFrameworkApplication.fa.qa("SupportsPolicies")||this.tlf(),this.wpf(W.c(U)));L.EwaSettings.isChangeGateEnabled("OfficeVSO:8010793_ConvertBusinessBarManagerServiceStage2")||U.ea.Ja(5,this)}tlf(){K.a.Jr(this.$.da.rI)&&this.Jo(this,new y.a(this.$.da.rI,null,!1,-1,-1,-1,-1,"",-1,"",-1))}NBe(U){this.Ua.addHandler("bBarAttachedOrDetached",U)}get Aid(){return this.DSc}get domElement(){return this.ES?
this.ES.domElement:null}dispose(){if(this.$){const U=this.$,ka=U.pa;ka.UA(this.Jo);ka.Uu(this.lj);ka.FCc(this.Lwc);ka.VQb(this.Lwc);U.da.Vl(this.Qe);U.da.Zx(this.vh);U.Rn(this.kf);U.Ym(this.oe);U.da.X3(this.zQ);U.userOperationManager.mq(this.nOb);S.h(U).Vd.lp(this.QPf)}f.a.Ma(this.ES);this.$=this.ES=null;super.dispose()}uCi(U){switch(U){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}ki(U,ka,ja,Da,qa){ja=void 0===ja?null:ja;Da=void 0===Da?null:Da;qa=
void 0===qa?null:qa;if(!this.$.isMobileMode||this.uCi(U))this.w3a&&!this.jH(U)&&(this.z2a[U]=this.oj.Aia,this.ES.gD(U,ka,Da,qa),this.Ua.raiseEvent("bBarAttachedOrDetached",new x(U,!0,ja))),ka&&32===ka.Appearance&&G.a(this.$).ef.dga(ka)}I0j(U,ka,ja,Da){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");z.a.initialize(U,ka,ja,Da);this.ki(39,null)}D_j(U,ka,ja,Da){v.a.initialize(U,ka,ja,Da);this.ki(40,null)}S1j(U,ka,ja,Da){m.a.initialize(U,ka,ja,Da);this.ki(41,null)}f0j(U,
ka,ja,Da){N.a.initialize(U,ka,ja,Da);this.ki(70,null)}h1j(U,ka,ja,Da){k.a.initialize(U,ka,ja,Da);this.ki(42,null)}Y1j(U,ka,ja,Da){t.a.initialize(U,ka,ja,Da);this.ki(54,null)}removeEntry(U){this.w3a&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(n,U)}`),this.z2a[U]=null,this.ES.removeEntry(U)&&this.Ua.raiseEvent("bBarAttachedOrDetached",new x(U,!1)))}Foa(U){return this.w3a?this.ES.Foa(U):!1}jH(U){return this.w3a?
this.ES.jH(U):!1}Mdb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}eMb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}$5g(){const {BusinessBarControl:U}=a(1174);if(this.w3a&&!this.ES){S.h(this.$).Vd.yp(this.QPf);var ka=document.getElementById(this.$.Ad+u.a.eKe);this.ES=new U(this.$,ka)}}$Ud(){this.w3a&&this.ES.$Ud()}SEj(){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ka=
this.oj.Aia;if(3E5<=ka-this.Yzf){this.Yzf=ka;for(let ja=0;74>ja;ja++){var U=this.z2a[ja];if(U&&(U=ka-U,3E5<=U)){const Da=Enum.toString(n,ja);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Da}] was activated but not turned off for ${U} Millis`)}}}}}vVh(U){const ka=[];for(const ja of U)switch(ja.MessageId){case -113742550:const Da=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.da.isNamedObjectViewMode||K.a.aj(U,Da))&&ka.push(-113742550)}return K.a.hE(U,
ka)}Lpi(U,ka){switch(U.MessageId){case 2113407564:const ja=K.a.z4a([1821390342,-943219229,-502303485,1437034227]);for(let Da=0;Da<ja.length;Da++)ja[Da].HelpTopicId=U.HelpTopicId,ja[Da].HelpDescription=U.HelpDescription,this.DSc.push(ja[Da])}switch(U.MessageId){case -395951567:this.ki(6,U);break;case 1643490758:this.ki(4,U);break;case -907264831:this.ki(5,U);break;case 757111532:case 2113407564:this.ki(7,U);break;case 2010656511:this.ki(15,U);break;case 1321660996:this.$.Nfd=!0;this.ki(8,U);break;
case 526339737:this.$.Nfd=!0;this.ki(9,U);break;case -407088521:this.ki(10,U);break;case 1756116017:this.ki(14,U);break;case -1703455218:this.ki(17,U);break;case 1393475740:this.ki(25,U);break;case -949523941:this.ki(26,U);break;case 1779381952:this.ki(44,U);break;case 1421575100:this.ki(45,U);break;case 613676060:this.ki(46,U);break;case 1233668252:this.ki(61,U);break;case 1911608588:U=!!(this.$.sf&64);!this.$.da.Fh()&&U&&ka.push(29);break;case 1544494907:break;case -655555355:ka.push(this.HDd()?
1:0);break;case -1221382671:ka.push(2);break;case 1662282929:ka.push(3);break;case 104919273:this.$.da.Fh()||ka.push(30);break;case -689453604:U=!!(this.$.sf&64);this.$.da.Emf=!0;!this.$.da.Fh()&&U&&ka.push(31);break;case 157762400:this.$.da.wqc=!0;!this.$.da.Fh()&&this.$.sf&64&&!this.$.isEditMode&&ka.push(32);break;case -1125398042:!this.$.da.Fh()&&this.$.sf&64&&!this.$.isEditMode&&ka.push(34);break;case -73730134:!this.$.da.Fh()&&this.$.sf&64&&ka.push(33);break;case -293349236:ka.push(65);break;
case 1580811823:ka.push(67);break;case -37299333:break;case 136737622:ka.push(47);break;case -1780327030:this.ki(55,U);break;case -113742550:this.ki(57,U);break;case -260312420:this.$.da.Fh()||ka.push(66);break;case 784737213:this.$.da.Fh()||ka.push(70);break;default:this.ki(11,U)}return ka}swi(){if(e.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!O.a.jHi(O.a.Iaf(1))&&(d.a.Hp||d.a.Ki)){const U=L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(R.d)(T.a.resolve(I.w,
{Qa:1})):C.GetServiceTaskFactory.create(this.$.ea,155,this.$.ka,1);J.TaskExtensions.ya(U,()=>{this.ki(20,null)},this.ka,3)}}Kvi(U){U||3!==this.$.workbookContext.WorkbookNovType||this.ki(63,null)}get Bgk(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)}pwi(){this.Bgk&&d.a.vMi&&this.ki(24,null)}wpf(U){(!U&&!this.$.printingEnabled||this.$.ag.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.ki(16,null));this.swi();this.ZMe();this.ilg();this.Kvi(U);this.pwi()}ZMe(){this.$.workbookContext.Options&32768&&this.x0j()}x0j(){this.z2a[37]||this.ki(37,null)}C2j(){this.z2a[38]||this.ki(38,null)}ilg(){this.$.workbookContext.Options&524288&&this.ki(59,null)}Hlg(U,ka){this.ki(58,U,null,ka)}E4c(U,ka){var ja=null,Da=null;ja=void 0===ja?null:ja;Da=void 0===Da?null:Da;ka=void 0===ka?null:ka;
this.ES.jH(U)?this.ES.qXb(U,ka):this.ki(U,null,ja,Da,ka)}$kg(){this.$.sf&8&&this.ki(12,null)}HDd(){const U=this.$.ea.Ba(38);return U?U.tokenExpired:!1}lYg(U,ka){if(!this.jH(21)&&-1387426400!==U.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ja={};ja.FailedMethod=ka;this.ki(21,U,ja)}}static Qlc(){return V.iEe||(V.iEe=[0,1,2,3])}Dod(U){return this.ES.Dod(U)}};sa.iEe=null;sa=V=Object(w.a)([Object(T.d)(I.l),Object(w.b)(0,Object(I.R)())],
sa);Object(b.a)(sa,"BusinessBarManager",r.a,[860,5,94])},1115:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{}b.mOc="b-ring_Apc_Trans";b.YAg="cdn_static_resource_ewa_image";Object(w.a)(b,"ResourceHosts",null,[])},1116:function(w,D,a){a.d(D,"a",function(){return e});w=a(0);var b=a(61),c=a(1219);class e{static Znd(f,d,h,r){r=void 0===r?null:r;e.Zvc||(e.Zvc=Array.isArray(b.a.nk(h.xa.NetworkMeasurementUrlList))?b.a.nk(h.xa.NetworkMeasurementUrlList):null);const n=[];for(let u=0;u<e.Zvc.length;u++){const v=
e.Zvc[u];let x=v.key;x||(x=v.Key);if(r&&!r.includes(x))continue;let k=v.value;k||(k=v.Value);x&&k&&n.push(new c.a(h,x,k,f,d))}return n}}e.Zvc=null;Object(w.a)(e,"NetworkConnectionHelpers",null,[])},1118:function(w,D,a){a.d(D,"a",function(){return f});w=a(0);var b=a(15),c=a(42),e=a(63);a=a(747);class f extends a.a{constructor(d,h){super(d,h);b.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.aCa;this.hAa=!0}get linkText(){return f.DFf}jqa(d){super.jqa(d);
c.a.openWindow(4,e.a.lK(f.CFf))}aG(d){super.aG(d);f.QHd&&f.QHd(null)}static initialize(d,h,r,n){b.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.aCa=d;f.DFf=h;f.CFf=r;f.QHd=n}}f.aCa=null;f.DFf=null;f.CFf=null;f.QHd=null;Object(w.a)(f,"WacGdprNoticeBusinessBarEntry",a.a,[])},1119:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{}b.vIh="ewa-bb";b.xIh="ewa-bb-entry";b.FIh="ewa-bb-react";b.yIh="ewa-bb-entry-body";b.EIh="ewa-bb-icon";b.AIh="ewa-bb-entry-icon";
b.DIh="ewa-bb-entry-title";b.CIh="ewa-bb-entry-message";b.C1e="ewa-bb-entry-button";b.BIh="ewa-bb-entry-link";b.zIh="ewa-bb-entry-close";b.D1e="ewa-bb-entry-button-holder";b.wIh="ewa-bb-content";Object(w.a)(b,"CssClassNames",null,[])},1120:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(747);class b extends a.a{constructor(c,e){super(c,e);this.Wt=!0;this.title=b.c5;this.message=b.b5}get actionButton(){return b.w_}io(c){super.io(c);(c=b.uV)&&c(null)}static initialize(c,e,f,d){b.c5=c;b.b5=
e;b.w_=f;b.uV=d}}b.c5=null;b.b5=null;b.w_=null;b.uV=null;Object(w.a)(b,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1121:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(747);class b extends a.a{constructor(c,e){super(c,e);this.Wt=!0;this.title=b.c5;this.message=b.b5}get actionButton(){return b.w_}io(c){super.io(c);(c=b.uV)&&c(null)}static initialize(c,e,f,d){b.c5=c;b.b5=e;b.w_=f;b.uV=d}}b.c5=null;b.b5=null;b.w_=null;b.uV=null;Object(w.a)(b,"RecommendedSensitivityLabelBusinessBarEntry",
a.a,[])},1122:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(886);class b extends a.a{constructor(c,e,f){super(c,e,f);b.w_&&b.uV&&(this.Wt=!0);this.title=b.c5;this.message=b.b5}get actionButton(){return b.w_}static initialize(c,e,f,d){b.c5=c;b.b5=e;b.w_=f;b.uV=d}io(c){super.io(c);b.uV&&b.uV(null)}}b.c5=null;b.b5=null;b.w_=null;b.uV=null;Object(w.a)(b,"DataCleansingBusinessBarEntry",a.a,[])},1123:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(747);class b extends a.a{constructor(c,
e){super(c,e);this.Wt=!0;this.title=b.c5;this.message=b.b5}get actionButton(){return b.w_}io(c){super.io(c);(c=b.uV)&&c(null)}static initialize(c,e,f,d){b.c5=c;b.b5=e;b.w_=f;b.uV=d}}b.c5=null;b.b5=null;b.w_=null;b.uV=null;Object(w.a)(b,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1124:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(747);class b extends a.a{constructor(c,e){super(c,e);this.Wt=!0;this.title=b.hLb;this.message=b.aCa}get actionButton(){return b.fdb}io(c){super.io(c);
b.cCa&&b.cCa(null)}static initialize(c,e,f,d){b.hLb=c;b.aCa=e;b.fdb=f;b.cCa=d}}b.hLb=null;b.aCa=null;b.fdb=null;b.cCa=null;Object(w.a)(b,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1125:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);a=a(747);class b extends a.a{constructor(c,e){super(c,e);b.fdb&&b.cCa&&(this.Wt=!0);this.title=b.hLb;this.message=b.aCa}get actionButton(){return b.fdb}io(c){super.io(c);b.cCa&&b.cCa(null)}static initialize(c,e,f,d){b.hLb=c;b.aCa=e;b.fdb=
f;b.cCa=d}}b.hLb=null;b.aCa=null;b.fdb=null;b.cCa=null;Object(w.a)(b,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1127:function(w,D,a){a.d(D,"a",function(){return b});const b=c=>{const e=Array(c.length);for(let f=0,d=c.length;f<d;f++)e[f]=c[f].cloneNode(!0);return e}},1174:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(93),e=a(117),f=a(14),d=a(96),h=a(58),r=a(32),n=a(33),u=a(13),v=a(249),x=a(1119),k=a(7),m=a(275),t=a(1120),z=a(747),y=a(1004),C=a(886);class J extends C.a{constructor(Ob,
Gc,Va){super(Ob,Gc,Va)}aG(Ob){super.aG(Ob)}}Object(w.a)(J,"EditAttemptReadOnlyBusinessBarEntry",C.a,[]);var F=a(47);class K extends z.a{constructor(Ob,Gc,Va,Jb){super(Ob,Gc);this.error=Va;this.options=Jb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Wt=!(Jb&4)}io(Ob){super.io(Ob);this.error.Appearance&=-33;F.a(this.businessBar.$).Xu([this.error])}}Object(w.a)(K,"ErrorBusinessBarEntry",z.a,[]);var L=a(94);class S extends K{constructor(Ob,
Gc,Va,Jb,ub){super(Ob,Gc,Va,Jb);this.command=ub;this.pY=!0}YY(Ob){super.YY(Ob);this.businessBar.$.Ha.kd(new L.a(this.command,Ob,this.businessBar.$.ee,10,null))}}Object(w.a)(S,"ErrorAndCommandBusinessBarEntry",K,[]);var W=a(16);class G{constructor(Ob,Gc,Va,Jb,ub,Qa,P,ta,Z,aa){this.UL=this.rba=this.PR=0;this.DGg=Ob;this.bak=Gc;this.VL=Va;this.RKg=P;this.Uob=r.a.zy(Z);this.ZIg=Z;this.Qfe=ta;this.SKg=aa;0!==Jb&&(this.PR=Jb);0!==ub&&(this.rba=ub);0!==Qa&&(this.UL=Qa)}get title(){return G.ia(this.bak)}get message(){return G.ia(this.VL)}get messageId(){return this.VL}get iconName(){return this.SKg}get D4a(){return this.DGg}get actionButton(){return G.ia(this.PR)}get UKa(){return G.ia(this.rba)}get link(){return G.ia(this.UL)}get Cm(){return this.RKg}get businessBarType(){return this.Qfe}get hash(){return this.Uob}get alt(){const {BusinessBarControl:Ob}=
a(1174);switch(this.Cm){case Ob.yma:return G.ia(26);case Ob.ky:return G.ia(25);case Ob.lk:return G.ia(24);default:return G.ia(0)}}get RNa(){return this.ZIg}set businessBarType(Ob){this.Qfe=Ob}static ia(Ob){return W.a.instance.ia(Ob)}}Object(w.a)(G,"EwaBusinessBarEntry",null,[]);class O extends G{constructor(Ob,Gc,Va,Jb,ub,Qa,P,ta,Z){super(Ob,0,Gc,Va,Jb,ub,Qa,P,ta,Z)}get title(){return""}}Object(w.a)(O,"EwaNoTitleBusinessBarEntry",G,[]);var T=a(77);class I extends z.a{constructor(Ob,Gc){super(Ob,Gc);
this.pY=this.Wt=!0}io(Ob){super.io(Ob);this.set_visible(!1);this.businessBar.$.eL();this.businessBar.$.Ha.kd(new L.a(1038998010,Ob,this.businessBar.$.ee,10,null))}YY(Ob){super.YY(Ob);this.businessBar.$.Ha.kd(new L.a(-722953877,Ob,this.businessBar.$.ee,10,null))}aG(Ob){this.businessBar.removeEntry(55);T.g(Ob)}}Object(w.a)(I,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class N extends z.a{constructor(Ob,Gc){super(Ob,Gc);this.Wt=!0;this.pY=!1}io(Ob){super.io(Ob);this.businessBar.$.Ha.kd(new L.a(-722953877,
Ob,this.businessBar.$.ee,10,null))}aG(Ob){this.businessBar.removeEntry(5);T.g(Ob)}}Object(w.a)(N,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var R=a(12);class V extends z.a{constructor(Ob,Gc,Va){super(Ob,Gc);this.kFb=Va;this.Wt=!0}io(Ob){super.io(Ob);R.HelperMethods.yU(this.businessBar.$.vG,this.kFb,this.businessBar.$.HR)}}Object(w.a)(V,"HelpButtonBusinessBarEntry",z.a,[]);class sa extends z.a{constructor(Ob,Gc,Va){super(Ob,Gc);this.kFb=Va;this.hAa=!0}jqa(Ob){super.jqa(Ob);R.HelperMethods.yU(this.businessBar.$.vG,
this.kFb,this.businessBar.$.HR)}}Object(w.a)(sa,"HelpTextBusinessBarEntry",z.a,[]);var U=a(76);class ka extends z.a{constructor(Ob,Gc,Va,Jb){super(Ob,Gc);this.kFb=Va;this.command=Jb;this.hAa=!0;this.Wt=1461300262!==Jb}io(Ob){super.io(Ob);this.businessBar.$.Ha.kd(new L.a(this.command,Ob,this.businessBar.$.ee,10,null))}jqa(Ob){super.jqa(Ob);const Gc=new L.a(-859308420,Ob,this.businessBar.$.ee,12,null);this.businessBar.$.Ha.kd(Gc,{[U.a.Lh]:"HelpID="+this.kFb,["InputMethod"]:Ob,[U.a.Ie]:k.a.OP,[k.a.Csa]:!0})}}
Object(w.a)(ka,"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class ja extends z.a{constructor(Ob,Gc){super(Ob,Gc);this.pY=this.Wt=!0}io(Ob){super.io(Ob);this.set_visible(!1);this.businessBar.$.eL();this.businessBar.$.Ha.kd(new L.a(-1081442996,Ob,this.businessBar.$.ee,10,null))}YY(Ob){super.YY(Ob);this.businessBar.$.Ha.kd(new L.a(1702917262,Ob,this.businessBar.$.ee,10,null))}aG(Ob){this.businessBar.removeEntry(59);T.g(Ob)}}Object(w.a)(ja,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
z.a,[]);var Da=a(1123);class qa extends z.a{constructor(Ob,Gc){super(Ob,Gc);(this.policyManager=Ob.$.ea.Ba(274))?(this.message=this.policyManager.cAc,this.title=this.policyManager.title,this.hAa=!0):b.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}jqa(Ob){super.jqa(Ob);(Ob=this.policyManager.wbj)&&Ob(null)}}Object(w.a)(qa,"PolicyBusinessBarEntry",z.a,[]);var Ba=a(1121),
ua=a(1125),pa=a(1124);a(429);var Ka=a(112),$a=a(28);class ha extends z.a{constructor(Ob,Gc){super(Ob,Gc);this.Wt=!0;this.title=""}io(Ob){super.io(Ob);Ka.c($a.a.F0i);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(w.a)(ha,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var cb=a(1118),Ia=a(80),ob=a(910),gb=a(968),Za=a(1190);class da{constructor(){this.DPc=new Za.a;this.BPc=new Za.a;this.APc=new Za.a;this.b$g(this.DPc);this.a$g(this.BPc);this.$9g(this.APc);this.HUc=
new Za.a;this.GUc=new Za.a;this.FUc=new Za.a;this.Bbh(this.HUc);this.Abh(this.GUc);this.zbh(this.FUc);this.WQc=new Za.a;this.u$g(this.WQc);this.qKa(this.WQc);this.qKa(this.APc);this.qKa(this.BPc);this.qKa(this.DPc);this.qKa(this.GUc);this.qKa(this.HUc);this.qKa(this.FUc)}Fii(Ob,Gc){switch(Ob){case 1:return this.Zli(Gc);case 2:return this.D2h(Gc)}return gb.a.L3d?this.WQc:null}b$g(Ob){Ob.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
Ob.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}a$g(Ob){Ob.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ob.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}$9g(Ob){Ob.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ob.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Bbh(Ob){Ob.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ob.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Ob.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ob.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);Ob.add("OverlayBig","Get the Word app");Ob.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Ob.add("OverlaySmallSplit1",
"Discover Word");Ob.add("OverlaySmallSplit2","designed for the iPad.");Ob.add("SkipButton","Skip for now")}u$g(Ob){Ob.add("Headline","Get the Office Online extension for Chrome");Ob.add("UseAppButton","Get the extension");Ob.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Abh(Ob){Ob.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ob.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
Ob.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ob.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);Ob.add("OverlayBig","Get the PowerPoint app");Ob.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Ob.add("OverlaySmallSplit1","Discover PowerPoint");Ob.add("OverlaySmallSplit2","designed for the iPad.");Ob.add("SkipButton","Skip for now")}zbh(Ob){Ob.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
Ob.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Ob.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Ob.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Ob.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}qKa(Ob){Ob.add("Corporation","Microsoft Corporation")}Zli(Ob){switch(Ob){case 3:return this.HUc;case 2:return this.GUc;case 1:return this.FUc}return null}D2h(Ob){switch(Ob){case 3:return this.DPc;case 2:return this.BPc;
case 1:return this.APc}return null}static get instance(){da.La||(da.La=new da);return da.La}}da.La=null;Object(w.a)(da,"WildFireStringFactory",null,[]);var ya=a(6),ib=a(42);class vb{constructor(Ob,Gc,Va,Jb,ub,Qa){this.cZc=null;this._id=Ob;this.LZc=Gc;this.kKg=void 0===ub?null:ub;this.ppb=Jb;this.Frb=void 0===Qa?null:Qa;this.aHa=null;this.n2a=Va;this.hsb=da.instance.Fii(Gc,Ob)}DSe(){this.aHa=new ob.a(this.title,this.message,null);this.aHa.addButton(this.nKe,Object(Ia.a)(this,this.fMf,"onButtonOneClick"),
"");this.n2a&&this.aHa.uXg(this.pKe,Object(Ia.a)(this,this.iMf,"onButtonTwoClick"));this.aHa.Cda=Object(Ia.a)(this,this.dYe,"dismissBar");this.aHa.image=3;this.aHa.id=16;this.aHa.closeable=!0}get title(){return this.hsb.ma("Headline")}get message(){return this.hsb.ma("CallToAction")}get tlk(){return this.n2a}get nKe(){return this.n2a?this.hsb.ma("InstallButton"):this.hsb.ma("UseAppButton")}get pKe(){return this.n2a?this.hsb.ma("OpenAppButton"):""}fMf(){this.n2a?this.xzi():this.jlk()}iMf(){this.n2a&&
this.Zhj()}get openUrl(){this.cZc||(this.cZc=this.kKg());return this.cZc}xzi(){b.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.ppb&&this.Frb&&this.Frb();gb.a.p4f(this._id,this.LZc)}Zhj(){this.openUrl&&(b.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.ppb&&this.Frb&&this.Frb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(gb.a.nFe(this._id),this.openUrl,0,!1))}jlk(){gb.a.L3d?this.Gbh():(b.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),gb.a.I1d("BizBarClicked"),1!==this.LZc&&2!==this.LZc||gb.a.oih(this.openUrl,this.ppb,this._id,this.Frb))}Gbh(){this.ppb?b.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):b.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");ib.a.mT(ya.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}jBh(){this.ppb?b.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):b.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");gb.a.I1d(gb.a.$gh)}dYe(){gb.a.L3d?
this.jBh():(gb.a.I1d(gb.a.Iaf(this._id)),b.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Hvh(){const Ob=ya.AFrameworkApplication.sa.Sa,Gc=new vb(Ob.Xi,gb.a.Cjf(),8<n.a.AFb,1===Ob.HCa,()=>Ob.Gv,Ob.lKj());b.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Gc}}Object(w.a)(vb,"WildFireBusinessBar",null,[]);class eb extends z.a{constructor(Ob,Gc){super(Ob,Gc);this.IGa=vb.Hvh();this.Wt=!0;this.pY=this.IGa.tlk;this.title=this.IGa.title;this.message=this.IGa.message}get actionButton(){return this.IGa.nKe}get UKa(){return this.IGa.pKe}io(Ob){super.io(Ob);
this.IGa.fMf(null)}YY(Ob){super.YY(Ob);this.IGa.iMf(null)}aG(Ob){super.aG(Ob);this.IGa.dYe(null)}}Object(w.a)(eb,"WildFireMobileAppBusinessBarEntry",z.a,[]);var Ta=a(260),La=a(24),fb=a(194),Pb=a(174),Sa=a(50),Wa=a(2),pb=a(178),wa=a(1126),hb=a(73),Sb=a(142);class Bc extends z.a{constructor(Ob,Gc,Va,Jb){super(Ob,Gc);this.officeScriptsCommandManager=Va.ea.Ba(519);b.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=pb.a.create();this.$=Va;this.title=W.a.instance.ia(2282);this.message=
"";this.n6d=W.a.instance.ia(2278);this.dzg=W.a.instance.ia(2279);this.bzg=W.a.instance.ia(2280);this.UQe=W.a.instance.ia(2281);this.update(Jb)}update(Ob){this.scriptLink=Ob.scriptLink;this.runStatus=Ob.runStatus;this.buttonText=Ob.buttonText||"";this.oSi(Ob.clickId);this.DGj();"preparing"===this.runStatus?(this.Ira(0),this.message=String.format(W.a.instance.gd(208),this.buttonText),this.Wt=!0,this.bwa=this.n6d,this.jxb=this.pka=this.Seb):"running"===this.runStatus?(this.Ira(0),this.message=String.format(W.a.instance.gd(207),
this.buttonText),this.Wt=!0,this.bwa=this.n6d,this.jxb=this.pka=this.Seb):"succeeded"===this.runStatus?(this.Ira(0),this.message=String.format(W.a.instance.gd(210),this.buttonText),"true"===Ob.hasLogs?(this.Wt=!0,this.bwa=this.bzg,this.pka=this.bWf,this.pY=!0,this.x6c=this.dzg,this.y6c=this.cWf):(this.Wt=!0,this.bwa=this.dzg,this.pka=this.cWf)):"runFailed"===this.runStatus?(this.Ira(1),this.message=String.format(W.a.instance.gd(209),this.buttonText),this.A$a=Wb.yma,"true"===Ob.hasLogs?(this.Wt=!0,
this.bwa=this.bzg,this.pka=this.bWf,"false"===Ob.isOwner&&(this.pY=!0,this.x6c=this.UQe,this.y6c=this.nNf)):"false"===Ob.isOwner&&(this.Wt=!0,this.bwa=this.UQe,this.pka=this.nNf)):"fetchFailed"===this.runStatus?(this.Ira(1),this.A$a=Wb.yma,this.message=W.a.instance.ia(2284)):"canceled"===this.runStatus?(this.Ira(0),this.A$a=Wb.ky,this.message=String.format(W.a.instance.gd(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.Ira(5),this.A$a=Wb.ky,this.message=String.format(W.a.instance.gd(211),
this.buttonText),this.Wt=!0,this.bwa=this.n6d,this.jxb=this.pka=this.Seb):"initializing"===this.runStatus&&(this.Ira(0),this.A$a=Wb.lk,this.message=W.a.instance.ia(2283))}get Cm(){return this.A$a}get actionButton(){return this.bwa}get UKa(){return this.x6c}io(Ob){super.io(Ob);this.pka&&this.pka()}YY(Ob){super.YY(Ob);this.UKa&&this.y6c()}aG(Ob){super.aG(Ob);this.jxb&&this.jxb()}DGj(){this.message="";this.A$a=Wb.lk;this.Wt=!1;this.bwa="";this.pka=void 0;this.pY=!1;this.x6c="";this.y6c=void 0;this.hideCloseButton=
!1;this.jxb=void 0}Seb(){const Ob=pb.a.create().toString();this.officeScriptsCommandManager.kni(Ob);this.buc(-2186799,Ob)}bWf(){const Ob=pb.a.create().toString();this.officeScriptsCommandManager.jni(Ob);this.buc(1036446140,Ob)}cWf(){const Ob=pb.a.create();if(this.scriptLink){const Gc=new wa.b(this.scriptLink);this.officeScriptsCommandManager.Jlf(this.id.toString(),JSON.stringify(Gc),Ob)}this.buc(-585097204,Ob.toString())}nNf(){const Ob=pb.a.create().toString();this.officeScriptsCommandManager.ini(Ob);
this.buc(-639858579,Ob)}oSi(Ob){const Gc=[];Gc.push(Object(Wa.a)(new hb.a,{name:"id",string:this.id.toString()}));Gc.push(Object(Wa.a)(new hb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Gc.push(Object(Wa.a)(new hb.a,{name:"runStatus",string:this.runStatus}));Gc.push(Object(Wa.a)(new hb.a,{name:"clickId",string:Ob}));Gc.push(Object(Wa.a)(new hb.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));Ka.a(Sb.a.k3i,void 0,void 0,Gc)}buc(Ob,Gc){const Va=[];Va.push(Object(Wa.a)(new hb.a,
{name:"id",string:this.id.toString()}));Va.push(Object(Wa.a)(new hb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Va.push(Object(Wa.a)(new hb.a,{name:"runStatus",string:this.runStatus}));Va.push(Object(Wa.a)(new hb.a,{name:"clickId",string:Gc}));Ka.d(Ob,void 0,void 0,void 0,void 0,void 0,Va)}}Object(w.a)(Bc,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var ab=a(151),qb=a(19),mc=a(52),yb=a(1);class vc extends C.a{constructor(Ob,Gc,Va,Jb,ub,Qa){super(Ob,Gc,Va);mc.a.instance.create(()=>{this.showCallout(Gc,
Jb)},ub,Qa,!0,!0)}showCallout(Ob,Gc){if(this.businessBar&&this.businessBar.Foa(Ob.D4a)&&this.kEe()){Ob=new L.a(-847286761,0,this.businessBar.$.ee,0,null);var Va={};Va.CalloutName=Gc;yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Va.Target=this.TM():Va.Target=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.PR.domElement;this.businessBar.$.Ha.kd(Ob,Va)}}kEe(){return!0}}
Object(w.a)(vc,"CalloutBusinessBarEntry",C.a,[]);class Db extends vc{constructor(Ob,Gc,Va,Jb,ub,Qa){super(Ob,Gc,Va,Jb,ub,Qa)}kEe(){if(!yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Ob=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?ab.a.Ph(qb.Sb):this.businessBar.$.ea.Ba(465);return Ob&&Ob.QEc?!1:!0}}Object(w.a)(Db,"OptimizeWorkbookCalloutBusinessBarEntry",
vc,[]);var Ga=a(18),Eb=a(118);class Zb extends z.a{constructor(Ob,Gc,Va){super(Ob,Gc);this.update(Va)}update(Ob){this.title=Ob.title?Ob.title:"";this.message=Ob.message?Ob.message:"";const Gc=this.Jnh(Ob.businessBarType);this.Ira(Gc);this.hideCloseButton=!!Ob.hideCloseButton;if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const Va=[];Va.push(Eb.a.Mg("Reason",Ob.reason,2));Va.push(Eb.a.Mg("Type",Gc.toString(),2));Ka.a("MsFormsDataSyncBizBarShown",void 0,void 0,
Va)}}Jnh(Ob){switch(Ob){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(w.a)(Zb,"MsFormsDataSyncStatusBusinessBarEntry",z.a,[]);class ic extends z.a{constructor(Ob,Gc,Va,Jb){super(Ob,Gc);this.pY=this.Wt=!0;this.tpj=Va;this.h3g=Jb}io(Ob){super.io(Ob);this.businessBar.$.Ha.kd(new L.a(this.tpj,Ob,this.businessBar.$.ee,10,null))}YY(Ob){super.io(Ob);this.businessBar.$.Ha.kd(new L.a(this.h3g,Ob,this.businessBar.$.ee,
10,null))}}Object(w.a)(ic,"DualCommandActionsBusinessBarEntry",z.a,[]);class mb extends z.a{constructor(Ob,Gc,Va,Jb){super(Ob,Gc);this.host=Va.xa.HostName;this.gti="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(Jb,!1):(this.tKi=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",!1)||yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",
!1))&&this.gti&&appChrome.renderSaveACopyToOneDriveCallout(Jb,!1)}}Object(w.a)(mb,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",z.a,[]);var Hb=a(1122);a.d(D,"BusinessBarControl",function(){return Wb});class Wb extends v.a{constructor(Ob,Gc){super(Gc);this.$8e=u.DOMElementExtensions.Us+",div";this.iX=Array(74);this.So=!1;this.$Y=Va=>{if(Va.Ca.keyCode===c.a.gB){var Jb=this.de.querySelectorAll(this.$8e);const ub=u.DOMElementExtensions.Jn(Jb);Jb=u.DOMElementExtensions.BD(Jb);return u.DOMElementExtensions.TEa(Va.Ca,
ub,Jb)}return!1};this.dd=Ob;this.set_visible(!1);this.addCssClass(x.a.vIh);yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.FIh);e.KeyInputManager.instance.ta(f.a.Rd,this.de,this.$Y);m.a(Ob).Wj(this)}get Tf(){return Ta.a.u9c}get de(){return this.domElement}get Vh(){return this.get_visible()}get $(){return this.dd}$h(Ob,Gc){yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Gc||u.DOMElementExtensions.setFocus(u.DOMElementExtensions.Jn(this.de.querySelectorAll(this.$8e))):
Gc||u.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Gc}nj(Ob){return u.DOMElementExtensions.Eh(this.de,Ob)}Vk(){}yl(){}dispose(){this.So||(e.KeyInputManager.instance.Aa(f.a.Rd,this.de,this.$Y),d.a.te(this.iX),this.iX=Array(74),this.dd=null,super.dispose(),this.So=!0)}Foa(Ob){if(!this.get_visible())return!1;Ob=this.iX[Ob];return!!Ob&&Ob.isVisible}Dod(Ob){return this.Foa(Ob)?this.iX[Ob].TM():null}jH(Ob){return!!this.iX[Ob]}qXb(Ob,Gc){if(Ob=this.iX[Ob])Ob.update(Gc),Ob.hhk()}gD(Ob,
Gc,Va,Jb){Va=void 0===Va?null:Va;Jb=void 0===Jb?null:Jb;let ub=!1;if(this.jH(Ob))Va=this.iX[Ob].get_visible();else{this.set_visible(!0);const Qa=Wb.Jjf()[Ob];this.iX[Ob]=this.e1(Ob,Gc,Va,Jb);Va=!1;ub=!0;Jb="";let P=0;Gc&&(Jb=Gc.MessageIdName,P=Gc.MessageId);const ta=Qa.RNa,Z=Sa.PageLoadTrackingInfo.instance.Qza(new Date);b.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Ob}, time from app interactive: ${Z}`);yb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&
4===Qa.businessBarType||Pb.a(this.$).eXd(Qa.hash,Jb,P,h.a.yLc,!0,1,Gc,ta)}Va||!y.BusinessBarManager.Qlc().includes(Ob)&&!ub||(this.iX[Ob].set_visible(!0),this.$.eL())}removeEntry(Ob){return this.Lzj(Ob)}$Ud(){d.a.te(this.iX);this.iX=Array(74);this.set_visible(!1)}Lzj(Ob){if(!this.jH(Ob))return!1;d.a.Ma(this.iX[Ob]);this.iX[Ob]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.eL();return!0}e1(Ob,Gc,Va,Jb){Va=void 0===Va?null:Va;Jb=void 0===Jb?null:Jb;const ub=Wb.Jjf()[Ob],Qa=!!(this.$.sf&
64);switch(Ob){case 23:Ob=new mb(this,ub,this.dd,this.de);break;case 2:case 4:case 25:case 26:case 36:case 35:Ob=new z.a(this,ub);break;case 12:case 29:case 30:case 31:case 32:case 57:Ob=Qa?new C.a(this,ub,-8805455):new z.a(this,ub);break;case 34:Ob=Qa?new ic(this,ub,-8805455,-104572626):new z.a(this,ub);break;case 22:Ob=new J(this,ub,-8805455);break;case 46:case 45:Ob=Qa?new S(this,ub,Gc,0,-8805455):new K(this,ub,Gc,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:case 73:Ob=new K(this,
ub,Gc,0);break;case 19:Ob=new z.a(this,ub);break;case 47:Ob=new K(this,ub,Gc,0);break;case 6:case 14:Ob=new V(this,ub,Gc.HelpTopicId);break;case 67:case 65:Ob=new sa(this,ub,Gc.HelpTopicId);break;case 72:Ob=new J(this,ub,-1698025133);break;case 37:Ob=new sa(this,ub,k.a.Mwh);break;case 38:Ob=new z.a(this,ub);break;case 71:Ob=new z.a(this,ub);break;case 68:Ob=new J(this,ub,924877417);break;case 16:Ob=new z.a(this,ub);Ob.title=r.a.am(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Ob.message=
r.a.am(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Ob=new C.a(this,ub,-1762562205);Ob.hideCloseButton=!0;break;case 20:Ob=new eb(this,ub);break;case 21:case 56:Ob=new z.a(this,ub);break;case 28:Ob=new z.a(this,ub);break;case 24:Ob=new ha(this,ub);break;case 27:Ob=new qa(this,ub);break;case 39:Ob=new cb.a(this,ub);break;case 40:Ob=new t.a(this,ub);break;case 41:Ob=new Ba.a(this,ub);break;case 42:Ob=new Da.a(this,ub);break;case 48:Ob=new z.a(this,ub);break;case 49:Ob=
new z.a(this,ub);break;case 50:Ob=new z.a(this,ub);break;case 51:Ob=new z.a(this,ub);break;case 52:Ob=new z.a(this,ub);break;case 53:Ob=new pa.a(this,ub);break;case 54:Ob=new ua.a(this,ub);break;case 55:Ob=new I(this,ub);break;case 5:Ob=new N(this,ub);break;case 58:Ob=new C.a(this,ub,-1753056834);Gc?(Gc=Gc.Directive,La.a.ds(Gc)||"&nbsp;"===Gc||(Ob.message=Gc)):Va&&(Ob.message=Va);break;case 59:Ob=new ja(this,ub);break;case 60:Ob=new z.a(this,ub);break;case 63:Ob=new sa(this,ub,k.a.l2i);break;case 61:Ob=
new ka(this,ub,k.a.P7g,-8805455);break;case 66:Ob=new ka(this,ub,k.a.Tuj,1461300262);break;case 62:Ob=new Db(this,ub,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Ob.message=Va;break;case 70:Ob=new Hb.a(this,ub,-1190551534);break;case 64:Ob=new Bc(this,ub,this.$,Jb);break;case 69:Ob=new Zb(this,ub,Jb);break;default:Ob=new K(this,ub,Gc,7)}Ob.DSe();return Ob}static Jjf(){let Ob;Ob=fb.a.Koa()?261:260;return Wb.cKe||(Wb.cKe=[new G(0,276,277,278,0,0,Wb.yma,1,"BB_UnableToRefreshLock"),
new G(1,276,277,278,0,0,Wb.yma,1,"BB_UnableToRefreshLockExpected"),new G(2,268,269,0,0,0,Wb.ky,5,"BB_WorkbookAlmostTooLarge"),new G(3,270,271,272,0,0,Wb.yma,1,"BB_WorkbookTooLarge"),new G(4,259,Ob,0,0,0,Wb.ky,5,"BB_ExternalWorkbookLinksDisabled"),new G(5,263,262,264,0,0,Wb.yma,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new G(6,265,266,267,0,0,Wb.lk,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new G(7,251,252,253,0,0,Wb.lk,5,"BB_UnsupportedFeatures"),new G(8,0,0,0,0,0,Wb.lk,0,
"BB_CollabDataAndDataStringsLocaleMismatch"),new G(9,0,0,0,0,0,Wb.lk,0,"BB_CollabDataStringsLocaleMismatch"),new G(10,0,0,0,0,0,Wb.lk,0,"BB_CollabDataLocaleMismatch"),new G(11,279,280,281,0,0,Wb.yma,1,"BB_LastGenericStatusError"),new G(12,282,283,284,0,0,Wb.ky,5,"BB_ScratchPadWarning"),new G(13,285,286,287,0,0,Wb.yma,1,"BB_AuthenticationLost"),new G(14,288,289,290,0,0,Wb.ky,5,"BB_OdfCompatibilityIssues"),new G(15,0,575,0,0,0,Wb.ky,5,"BB_PivotChartInteractivityMissingWarning"),new G(16,0,0,0,0,0,Wb.lk,
2,"BB_WorkbookIsIrmProtected"),new G(17,0,0,0,0,0,Wb.lk,0,"BB_BIFeatureNotAvailable"),new G(18,291,292,287,0,0,Wb.ky,5,"BB_AnonymousCreateMode"),new G(19,254,255,0,0,0,Wb.ky,5,"BB_UnsupportedInteractiveReportEditing"),new G(20,0,0,0,0,0,Wb.lk,0,"BB_MobileAppCampaignBizBar"),new G(21,297,298,0,0,0,Wb.lk,0,"BB_TransientServerCommunicationFailures"),new G(22,1643,1654,1655,0,0,Wb.lk,5,"BB_EditAttemptInReadOnly"),new G(23,1643,1654,0,0,0,Wb.lk,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new G(24,0,
R.HelperMethods.Cgk(),1632,0,0,Wb.lk,3,"BB_UnsupportedBrowser"),new G(25,300,301,0,0,0,Wb.lk,2,"BB_ReadOnlyPermissions"),new G(26,302,303,0,0,0,Wb.lk,2,"BB_DocumentIsIrmProtectedWarning"),new G(27,0,0,0,0,0,Wb.ky,5,"BB_PolicyWarningMessage"),new G(28,1285,299,0,0,0,Wb.lk,0,"BB_WorkingOnIt"),new G(29,1643,1641,1642,0,0,Wb.lk,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new G(30,1656,1657,1658,0,0,Wb.lk,5,"BB_WorkbookIsReadOnlyRecommended"),new G(31,1643,1659,1660,0,0,Wb.lk,5,"BB_WorkbookHasPasswordToModify"),
new G(32,1643,1661,1664,0,0,Wb.lk,3,"BB_LegacySharedWorkbookEditWarning"),new G(33,1651,1662,253,0,0,Wb.lk,5,"BB_LegacyConnectionsWarning"),new G(34,1643,1960,1961,1962,0,Wb.lk,0,"BB_TooManyLoadBlockingFloatingObjects"),new G(35,1652,1653,0,0,0,Wb.lk,2,"BB_GroupedSlicers"),new G(36,313,314,0,0,0,Wb.ky,5,"BB_ThirdPartyAddinDisabled"),new G(37,1789,1790,0,0,1791,Wb.lk,5,"BB_FinanceLinkedEntityDisclaimerBar"),new G(38,1818,1819,0,0,0,Wb.ky,5,"BB_WolframDeprecationAlertBar"),new G(39,0,0,0,0,0,Wb.lk,
0,"BB_WacGdprNotice"),new G(40,0,0,0,0,0,Wb.lk,0,"BB_AutomaticSensitivityLabel"),new G(41,0,0,0,0,0,Wb.lk,0,"BB_RecommendedSensitivityLabel"),new G(42,0,0,0,0,0,Wb.lk,0,"BB_MandatorySensitivityLabel"),new G(43,315,316,317,0,0,Wb.lk,0,"BB_LocalStorageDisabled"),new G(44,632,633,0,0,0,Wb.lk,0,"BB_AutoRefreshDisabled"),new G(45,1014,1012,1016,1314,0,Wb.lk,4,"BB_CorruptedFileRepaired"),new G(46,1015,1013,1016,1314,0,Wb.lk,5,"CorruptedOdsFileRepaired"),new G(47,273,274,275,0,0,Wb.ky,5,"BB_MinorVersionLimitReached"),
new G(48,304,305,0,0,0,Wb.ky,5,"BB_SensitivityApplicationGenericError"),new G(49,306,308,0,0,0,Wb.ky,5,"BB_SensitivityApplicationTooLargeFileError"),new G(50,307,308,0,0,0,Wb.ky,5,"BB_SensitivityApplicationLabelNotSupportedError"),new G(51,309,310,0,0,0,Wb.ky,5,"BB_SensitivityApplicationLabelDisabledError"),new G(52,311,312,0,0,0,Wb.ky,5,"BB_SensitivityApplicationMandatoryConflictError"),new G(53,0,0,0,0,0,Wb.ky,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new G(54,0,0,0,0,0,Wb.ky,
5,"BB_SensitivityApplicationSetLabelError"),new G(55,2119,2120,2121,2124,0,Wb.lk,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new G(56,297,298,0,0,0,Wb.lk,0,"BB_NetworkDown"),new G(57,318,319,320,0,0,Wb.lk,2,"BB_DefaultToViewDueToCogs"),new G(58,1815,1816,1817,0,0,Wb.lk,1,"BB_RefreshLinkedEntityErrorBar"),new G(59,1792,1793,1794,1795,0,Wb.lk,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new O(60,250,0,0,0,Wb.lk,5,"BB_CanvasHealth"),new G(61,1017,1018,1314,0,1019,Wb.lk,
5,"BB_MismatchedFileFormatConverted"),new G(62,2238,0,2240,0,0,Wb.lk,5,"BB_OptimizeWorkbook"),new G(63,321,322,0,0,323,Wb.lk,0,"BB_NovModePostDepreciation"),new G(64,0,0,0,0,0,Wb.lk,0,"BB_OfficeScriptsRunning"),new G(65,2214,2215,0,0,2217,Wb.lk,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new G(66,324,325,0,0,326,Wb.lk,5,"BB_ReadOnlyPivotTable"),new G(67,2214,2216,0,0,2217,Wb.lk,0,"BB_PowerQueryRefreshHostNotSupported"),new G(68,1057,n.a.Uqc?1059:1058,1056,0,0,Wb.lk,4,"BB_RefreshPageAfterEnablingTheExtension"),
new G(69,0,0,0,0,0,Wb.lk,0,"BB_MsFormsDataSyncStatus"),new G(70,0,0,0,0,0,Wb.ky,5,"BB_DataCleansingSuggestions"),new O(71,2324,0,0,0,Wb.lk,4,"BB_EditInMiniWAC","EditExcel_16"),new G(72,2326,2327,2325,0,0,Wb.ky,5,"BB_PowerQueryUnsupportedTeams"),new G(73,2326,2328,2217,0,0,Wb.ky,5,"BB_PowerQueryEnableThirdPartyCookies")])}}Wb.yma=Ga.a.PLh;Wb.ky=Ga.a.RLh;Wb.lk=Ga.a.QLh;Wb.cKe=null;Object(w.a)(Wb,"BusinessBarControl",v.a,[33])},1198:function(w,D,a){w=a(0);var b=a(2),c=a(15),e=a(33),f=a(96),d=a(14),h=
a(139),r=a(357),n=a(87),u=a(9),v=a(70),x=a(19),k=a(151),m=a(471);class t{constructor(Ba,ua){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ua;this.parentElement=Ba}tph(){const Ba=this.uph();m.a(this.$,243,242,0,ua=>{this.cardViewManager=ua;ua.e0j(this.parentElement,Ba)})}tnf(){this.cardViewManager&&this.cardViewManager.q$a(-1,-1,this.parentElement)}uph(){const Ba={layoutId:"AutoDetectTooltip"};Ba.description=
this.longDescription;Ba.convertToDomainName=this.convertToDomainName;Ba.longDescription=this.longDescription;Ba.urlValue=this.urlValue;Ba.imageAltText=this.imageAltText;Ba.helpText=this.helpText;Ba.helpId=this.helpId;return Ba}}Object(w.a)(t,"AutoDetectCardManager",null,[]);var z=a(36),y=a(222),C=a(32),J=a(235),F=a(18),K=a(57);class L extends n.a{constructor(Ba,ua,pa){super();this.We=Ka=>{if(Ka.Nd.id===this.wNa.firstChild.id){Ka=this.UHe;const $a={};$a.Id=Ka.qvb;this.convertToLinkedEntityManager.cdd($a,
!0,Ka);this.wNa.removeChild(this.wNa.firstChild);return!0}return!1};this.UHe=Ba;this.convertToLinkedEntityManager=ua;this.wNa=document.createElement("div");this.wNa.className="clip16x16";this.yAa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',C.a.am("autodetectid"+this.UHe.left),F.a.qkd,K.a.di(11));pa.Ij(this.wNa,this.yAa);Ba=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");J.a.instance.ta(d.a.click,Ba,
this.We)}get domElement(){return this.wNa}dispose(){if(this.wNa){const Ba=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");J.a.instance.Aa(d.a.click,Ba,this.We)}super.dispose()}static get Ibh(){return"clip16x16"}}Object(w.a)(L,"AutoDetectColumnHeaderButton",n.a,[]);var S=a(1),W=a(1127),G=a(12),O=a(21),T=a(214);class I extends n.a{constructor(Ba,ua,pa){super();this.Od=null;this.$=Ba;this.gridView=O.h(Ba);this.convertToLinkedEntityManager=ua;this.Od=pa;this.Gbd=new T.a}dispose(){super.dispose()}ABh(Ba){for(let ua of this.gridView.Hla)for(let pa of ua){const Ka=
pa,$a=Ka.Qw,ha=W.a(Ka.C8);this.mVg(Ba,ha,$a);Ka.V0d(ha)}}mVg(Ba,ua,pa){if(ua.length){var Ka=pa.length;pa[Ka-1]<Ba.left||(pa=G.HelperMethods.Rz(new y.a(pa),0,Ka,Ba.left,G.HelperMethods.mI),0>pa||!(ua=ua[pa]))||(this.gridView.rtl?ua.classList.add(z.a.QPh):ua.classList.add(z.a.PPh),this.Gbd.Wc(Ba.left)||this.Gbd.add(Ba.left,new L(Ba,this.convertToLinkedEntityManager,this.Od)),Ba=this.Gbd.ma(Ba.left).domElement,!ua.getElementsByClassName(L.Ibh).length&&this.o4j(ua)&&ua.appendChild(Ba))}}o4j(Ba){const ua=
parseInt(Ba.style.width,10);var pa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";pa=I.grh(pa);Ba=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Od.Pgi(Ba.firstChild.innerHTML),pa,!0,S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ua-(ua/2+Ba/2)?!0:!1}static grh(Ba){return`${"normal"} ${"normal"} ${Ba} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(w.a)(I,"AutoDetectColumnHeaderManager",
n.a,[]);var N=a(437),R=a(27),V=a(74),sa=a(160),U=a(13),ka=a(16),ja=a(112),Da=a(73);a.d(D,"a",function(){return qa});class qa extends n.a{constructor(Ba,ua,pa,Ka,$a){super();this.isMac=e.a.isMac;this.y2a=-1;this.idc=null;this.Mxa=-1;this.zSa=this.Ksc=this.N4d=this.GBa=this.VHe=!1;this.JW=null;this.dh=()=>{this.IAa&&this.gridView&&this.ZZ()};this.oe=()=>{this.Sy()};this.We=()=>{this.HMa();O.h(this.$).$h(!0,!1)};this.VCa=(cb,Ia)=>{Ia?(this.evg(this.idc),this.Llg()):(cb=[29],this.gridView.zd.Sl(cb),this.gridView.zd.sm(null,
cb),this.JW&&this.JW.tnf())};this.Lk=()=>{this.gbb()&&this.ml.hide();1===this.gridView.ha.ng&&this.ZZ()};this.fz=()=>{const cb=this.gridView.ha.ng;this.gridView.ha.ra.activeCell&&1===cb&&this.ZZ()};this.onKeyUp=cb=>this.ytc?this.GBa?!1:17===cb.Ca.keyCode&&this.N4d?(this.zSa?(this.Llg(),this.Ohb()):this.ggg(),!0):!1:this.GBa=!1;this.onKeyDown=cb=>{if(!this.ytc)return this.GBa=!1;this.N4d=!1;this.GBa=cb.ctrlKey;switch(cb.Ca.keyCode){case 27:return this.zSa?(this.VCa(null,!1),this.Ohb()):this.JW&&(this.JW.tnf(),
this.ggg()),!0;case 13:if(this.zSa)return this.zSa=!1,this.HMa(),!0;break;case 17:return this.N4d=!0}return!1};const {AutoDetectActionButton:ha}=a(1262);this.$=Ba;this.rvb=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ua||c.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=Ka;Ka.gPb();this.ml=new ha(Ba,ua,this.We,pa,"");this.f7g=new I(this.$,Ka,$a);this.gridView=
O.h(this.$);this.gridView.ha.YG(this.dh);this.gridView.Vd.Rtb(this.dh);this.gridView.tu(this.fz);Ba.sk(this.oe);Ba.tB(this.Lk);this.gridBlockManager=Object(h.a)(957,this.gridView.za);this.Hq=Ba.frame.dB;this.ZZ()}get de(){return this.ml.domElement(1)}get ytc(){const Ba=this.ml.domElement(qa.xia);return Ba?U.DOMElementExtensions.isVisible(Ba):!1}get IAa(){return this.$.isEditMode&&S.EwaSettings.Da(128)&&S.EwaSettings.Da(131)&&(new sa.a(this.$.va)).Ej?!1:-1!==this.Mxa}dispose(){this.gridView&&this.gridView.ha.lG(this.dh);
if(this.$){const Ba=this.$;Ba.Ym(this.oe);Ba.iE(this.Lk);O.h(Ba).hx(this.fz)}f.a.Ma(this.ml);this.Hq=this.$=this.gridView=this.ml=null;super.dispose()}Sy(){this.VCa(null,!1);this.y2a=-1;this.ml.hide();this.lfk();this.zSa=!1}Ohb(){this.ml.getButton(qa.xia).GRb();this.zSa=!1}ggg(){this.ml.getButton(qa.xia).Qfb();this.evg(this.idc);this.zSa=!0;S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?void k.a.resolve(x.f).then(Ba=>{Ba.bha(ka.a.instance.ia(1751))}):this.$.ea.Zc(211,
Ba=>{Ba.bha(ka.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.IAa&&-1!==this.y2a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}g7g(Ba){var ua=new R.Range(1===Ba.top?1:Ba.top-1,Ba.left,Ba.bottom,Ba.right,!0,!1);ua=this.gridView.getRangeInformation(ua);for(const pa of ua)if(Object(r.a)(N.AutoDetectRange,pa)&&this.npc(Ba,!1,pa))return!0;return!1}HMa(){if(this.IAa&&-1!==this.y2a){this.ml.getButton(qa.xia).Qfb();var Ba={};Ba.Id=this.Mxa;Ba.StringId=null;this.convertToLinkedEntityManager.cdd(Ba,
!0,this.idc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Ba=[Object(b.a)(new Da.a,{name:"Domain",int64:this.Mxa})];ja.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,Ba);this.Mxa=-1}}Y3h(){let Ba=ka.a.instance.ia(1747);if(-1!==this.Mxa){Ba+=" ";try{Ba+=this.convertToLinkedEntityManager.DJb(this.Mxa.toString())}catch(ua){c.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Mxa}`)}}Ba+=
" ";return Ba=this.rvb?Ba+ka.a.instance.ia(1750):Ba+ka.a.instance.ia(this.isMac?1749:1748)}Llg(){this.rvb&&(this.JW||(this.JW=new t(this.de,this.$),this.JW.convertToDomainName=ka.a.instance.ia(1752),this.JW.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.JW.imageAltText=ka.a.instance.ia(1754),this.JW.helpId="HID_DataTypes_Wolfram",this.JW.helpText=ka.a.instance.ia(1753)),this.JW.longDescription=this.convertToLinkedEntityManager.I8d(this.y2a.toString()),
this.JW.tph())}npc(Ba,ua,pa){if((new R.Range(pa.top,pa.left,pa.bottom===u.a.qh?pa.bottom:pa.bottom+1,pa.right,!0,!1)).Te(Ba)){if(ua){if(pa&&pa.qvb!==this.y2a){this.y2a=pa.qvb;Ba=pa.qvb.toString();ua=this.rvb?"":this.convertToLinkedEntityManager.I8d(Ba);const Ka=this.convertToLinkedEntityManager.Kti(Ba);this.ml.Mlb(this.convertToLinkedEntityManager.DJb(Ba),ua,Ka,qa.xia)}this.Mxa=pa.qvb;this.idc=pa}return!0}return!1}ZZ(){if(this.convertToLinkedEntityManager){var Ba=this.gridView.ha.ng;if(this.gridBlockManager&&
this.gridBlockManager.Zud){var ua=this.gridView.ha.ra.activeCell,pa=!this.gridBlockManager.Tt(ua),Ka=this.gridView.getRangeInformation(this.gridView.Yk);for(const $a of Ka)if(Object(r.a)(N.AutoDetectRange,$a))switch(Ka=$a,Ka.hhh){case 3:if(this.npc(ua,!0,Ka)){if(1!==Ba||pa){this.Sy();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.KUd();this.ml.Rha(ua,this.VCa);this.VHe||(this.VHe=!0,this.onAutoDetectUIShown());return}break;
case 2:case 1:(S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.f7g.ABh(Ka);break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Sy()}}evg(Ba){const ua=[29];this.gridView.zd.sm(Ba,ua);this.gridView.zd.tt(ua)}gbb(){return this.$.da.isNamedObjectViewMode&&V.f(this.$.na)}KUd(){this.rvb&&
!this.Ksc&&this.Hq&&(this.Hq.fw(d.a.Rd,this.$.domElement,this.onKeyDown,!0),this.Hq.fw(d.a.Hf,this.$.domElement,this.onKeyUp,!0),this.Ksc=!0)}lfk(){this.rvb&&this.Ksc&&this.Hq&&(this.Hq.kw(d.a.Rd,this.$.domElement,this.onKeyDown,!0),this.Hq.kw(d.a.Hf,this.$.domElement,this.onKeyUp,!0),this.Ksc=!1)}static get xia(){return 1}static Z5h(Ba){return ka.a.instance.ia(1808)+v.a.space+Ba}}Object(w.a)(qa,"AutoDetectManager",n.a,[])},1219:function(w,D,a){w=a(0);var b=a(15),c=a(264);class e{constructor(h,r){this.testName=
null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=r;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(w.a)(e,"NetworkTestResult",null,[]);var f=a(596);a.d(D,"a",function(){return d});class d{constructor(h,r,n,u,v){this.url="";this.K$a=
!1;this.Fkb=-1;this.testIteration=0;this.baseUrl=n;this.cNf=u;this.nwd=r;this.result=new e(r,v)}runTest(){try{if(this.K$a)return b.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.nwd} is already mid way, not starting a new one.`),!1;this.reset();this.K$a=!0;this.result.startTimeMs=Date.now();const h=new c.QueryStringBuilder(this.baseUrl);h.q6("tid",this.result.startTimeMs.toString());this.url=h.toString();this.lNj();this.testIteration++;this.result.testIteration=
this.testIteration;return!0}catch(h){return this.nBb("Exeption: "+h.message),!1}}reset(){this.url="";this.result.reset();this.K$a=!1;this.Fkb=-1}clearTimeout(){-1!==this.Fkb&&(window.clearTimeout(this.Fkb),this.Fkb=-1)}lNj(){try{const h=new XMLHttpRequest;h.onreadystatechange=()=>{4===h.readyState&&(200===h.status?this.JWh():this.nBb(`Error when downloading resource. status code: ${h.status}, status text: ${h.statusText}`,h.status.toString()))};h.onerror=()=>{this.nBb(`Client error when attempting to download resource. status code: ${h.status}, response: ${h.statusText}`)};
this.Fkb=window.setTimeout(()=>{this.Fkb=-1;this.nBb("Request timeout")},1E4);h.open("GET",this.url,!0);h.send(null)}catch(h){this.nBb("Exeption: "+h.message)}}JWh(){this.K$a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.wbc())}nBb(h,r){r=void 0===r?null:r;this.K$a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=r,this.wbc())}wbc(){this.K$a=
!1;this.cNf&&this.cNf(this.result,this.nwd)}}Object(w.a)(d,"NetworkTestReq",null,[])},1262:function(w,D,a){a.r(D);a.d(D,"AutoDetectActionButton",function(){return d});w=a(0);D=a(87);var b=a(1198),c=a(57),e=a(16),f=a(21);class d extends D.a{constructor(h,r,n,u,v){super();this.$=h;this.dF=u.nyb(h,r,n,"",c.a.di(11),v,"AutoDetectPointerDown",e.a.instance.ia(1808)+"...")}get Qx(){return this.dF.Qx}dispose(){this.dF.dispose();this.$=null;super.dispose()}domElement(h){return this.dF.domElement(h)}getButton(h){return this.dF.getButton(h,
!1)}Mlb(h,r,n,u){this.dF.fZa(b.a.Z5h(h),r,u);this.dF.S$d(n,r,u)}Rha(h,r){const n=f.h(this.$),u=n.Tc.Rj(h);h=n.Bi(h,u);const v=n.Ih(u).Qn;if(h&&0<=h.x&&0<=h.y&&v.width>h.width+160){let x=h.bottomRight.x+this.Qx,k=h.topLeft.y+this.Qx,m=!1;x+160>v.bottomRight.x&&(x=h.topLeft.x-this.Qx,m=!0);if(k<v.topLeft.y+this.Qx){if(n.Tc.UFa){this.hide();return}k=v.topLeft.y+this.Qx}this.dF.Jid(r,u);this.Mo(x,k,n.rtl,u,m)}else this.hide()}Mo(h,r,n,u,v){this.dF.Mo(h,r,n,u,!1,v)}hide(){this.dF.hide()}}Object(w.a)(d,
"AutoDetectActionButton",D.a,[])},1332:function(w,D,a){function b(E,ma){return Io(function*(){if(Object(Jf.m)(E.na)){const Ya=E.na.sheetProcessedData;Object(Nh.a)(Ya);return ma.map(Ub=>ff(Ub,!0)).filter(Ub=>Ya.value.jbb(Ub))}return[]})}function c(E,ma,Ya){Ya=void 0===Ya?new Map:Ya;return E.reduce((Ub,Hc)=>{Hc=ma(Hc);const Gd=Ub.get(Hc);Gd?Ub.set(Hc,Gd+1):Ub.set(Hc,1);return Ub},Ya)}function e(E){const ma=[];E.forEach(Ya=>ma.push(...Ya));return ma}function f(E){return Array.from(E).reduce((ma,Ya)=>
{var [Ub,Hc]=Ya;return Object.assign({},ma,{[Ub]:Hc})},{})}function d(E){return E.reduce((ma,Ya)=>{var Ub=Ya.tableRange;Ya=Ya.suggestions;Ub&&Ya&&(Ub=ff(Ub,!1).sA(!1),ma[Ub]=h(ma[Ub],Ya));return ma},{})}function h(E,ma){return ma.reduce((Ya,Ub)=>{({type:Ub}=Ub);Ub in Ya?Ya[Ub]++:Ub&&(Ya[Ub]=1);return Ya},null!==E&&void 0!==E?E:{})}function r(E){E=e(E.map(ma=>ma.suggestions.filter(n)));return c(E,ma=>ma.variationsType)}function n(E){return"NumberFormattingInconsistency"===E.type}function u(E,ma,Ya){return Io(function*(){try{switch(null===
ma||void 0===ma?void 0:ma.type){case 0:return v(E,ma,Ya);case 2:return k(E,ma,Ya);case 1:return x(E,ma,Ya);default:R.ULS.sendTraceTag(509617686,0,10,`applySuggestion: Unknown suggestion type ${null===ma||void 0===ma?void 0:ma.type}`)}}catch(Ub){R.ULS.sendTraceTag(509617685,0,10,`applySuggestion: ${Ub}`)}return null})}function v(E,ma,Ya){return Io(function*(){const Ub=ma.variations.filter(af=>af.isSelected&&af.value!==ma.replacementValue).map(af=>af.value),Hc={["SheetName"]:E.na.sheetName,["MatchCase"]:!1,
["MatchEntireCell"]:!0,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:Ub},{UNd:Gd,TNd:he,jPd:Ke}=m(ma);Object(Gh.a)(E.userOperationManager,(af,xf,wg)=>Sh.z(E.pa.ua,Hc,Object(Md.u)(E.na.sheetName,null,Ya),ma.replacementValue,Object(te.b)(af,Gd),Object(te.a)(xf,he),wg,null),af=>new Eh.a(258,0,af),null);yield Ke;return Ub.length})}function x(E,ma,Ya){return Io(function*(){if(null===Ya||void 0===Ya||!Ya.length)return R.ULS.sendTraceTag(509617684,0,10,"applyNumberFormatInconsistencySuggestion: empty changeRanges."),
0;const Ub=Object(Md.u)(E.na.sheetName,null,Ya),Hc={},Gd=ma.formats.find(Ig=>{({key:Ig}=Ig);return Ig===ma.replacementFormat}).format;Hc.NumberFormatOptions=Object(zd.a)(new Zg.a,{NumberFormatCategory:-1,CustomFormatString:Gd});Hc.ValidMembers=32;Hc.NumberFormat=15;const he=Object(Md.o)(ub.h(E).ha.ra.activeCell,E),Ke=E.pa.ua.Ud({Cpa:!0,ooa:1}),{UNd:af,TNd:xf,jPd:wg}=m(ma);Object(Gh.a)(E.userOperationManager,(Ig,Jh,Bh)=>Yc.l(E.pa.ua,Ub,he,Hc,!1,null,null,!0,!1,Object(te.b)(Ig,af),Object(te.a)(Jh,xf),
Bh,null,Ke,null),Ig=>new Eh.a(11,0,Ig),null);yield wg;return-1})}function k(E,ma,Ya){return Io(function*(){const {UNd:Ub,TNd:Hc,jPd:Gd}=m(ma);Object(Gh.a)(E.userOperationManager,(he,Ke,af)=>{var xf=E.pa.ua,wg=Object(Md.u)(E.activeItemName,null,Ya);a:{var Ig=ma.extraSpacesType;switch(Ig){case 0:Ig=1;break a;case 2:Ig=2;break a;case 1:Ig=4;break a;default:throw R.ULS.sendTraceTag(509617683,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${Ig}`),Error.argument("illegal ExtraSpacesPaddingType");
}}he=Object(te.b)(he,Ub);Ke=Object(te.a)(Ke,Hc);const Jh=xf.Ra(9,null);Jh.ranges=wg;Jh.trimWhitespaceType=Ig;return Yc.g(xf,"TrimWhitespace",Jh,he,Ke,af,null,0)},he=>new Eh.a(253,0,he),null);return(yield Gd).Result})}function m(E){const ma=new Mc.a;return{UNd(Ya){if(Ya&&$g.a.Bh(Ya.Errors))R.ULS.sendTraceTag(509617682,0,10,`DataCleansing onOperationSuccess: Ewa result contains error messages after applying type [${E.type}]`),ma.setResult(null);else{var Ub=R.ULS,Hc=Ub.sendTraceTag,Gd=E.type;var he=
(he=E.tableName)?he.includes(":")?"Range":"Ctrl-T":"";Hc.call(Ub,537163359,0,20,`DataCleansing onOperationSuccess: Suggestion of type [${Gd}] applied successfully in tableType [${he}]`);ma.setResult(Ya)}},TNd(Ya){R.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages for type [${E.type}], HttpStatus [${Ya.data.httpStatus}]`);ma.setResult(null)},jPd:hf.e(ma.task)}}function t(E,ma){this.ID=E;this.type=ma}function z(E,ma){this.value=E;this.contextId=ma}
function y(E,ma,Ya,Ub,Hc,Gd,he,Ke){this.type=E;this.startTime=null==Ya||void 0==Ya.value?new z(Ya,null):Ya;this.endTime=null==Ub||void 0==Ub.value?new z(Ub,null):Ub;null!=Hc&&void 0!=Hc.value||new z(Hc,null);null!=Gd&&void 0!=Gd.value||new z(Gd,null);this.operationType=Ke}function C(E){this.ID=E}function J(){this.Wg=[];this.Cub=[];this.G6c=0;this.duration=this.startTime=null;this.Nfc={};this.RId=this.uJd=this.n8c=-1}function F(E){const ma=new Ne.StandardDialog;ma.Fd=4;E=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,E)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;ma.bV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,E,Wj)}a.r(D);var K={};a.r(K);a.d(K,"NetworkConnectionStateManager",function(){return Oc});var L={};a.r(L);a.d(L,"DataCleansingHostManager",function(){return jf});var S={};a.r(S);a.d(S,"DataCleansingAnnotationsManager",function(){return Dc});var W={};a.r(W);a.d(W,"ProactiveSuggestionManager",function(){return be});
var G={};a.r(G);a.d(G,"CalcManager",function(){return gi});var O={};a.r(O);a.d(O,"UnifiedConsentAdapter",function(){return Mj});var T={};a.r(T);a.d(T,"ExtendedTooltipsManager",function(){return Nj});var I={};a.r(I);a.d(I,"SharedUIControlsFactory",function(){return Fh});var N=a(0),R=a(15),V=a(6),sa=a(122),U=a(408);class ka extends U.a{constructor(E){super(E)}get Txb(){return!1}createElement(){const E=document.createElement("link");E.setAttribute("rel","stylesheet");E.setAttribute("type","text/css");
E.setAttribute("href",this.ix);return E}ied(){return null}iCc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.vC.ix)}}Object(N.a)(ka,"CssResource",U.a,[]);var ja=a(470),Da=a(269),qa=a(32),Ba=a(62);class ua{constructor(){this.q3b=this.x0b=null}cRi(){this.x0b||(R.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.x0b=Ba.Task.WAA(ua.jRi(),ua.ZQi()),this.x0b.continueWith(E=>{R.ULS.sendTraceTag(21030599,324,10,"{0}",qa.a.Qpd(E.exception))},5));
return this.x0b}eRi(){if(!this.q3b)try{R.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.q3b=Ba.Task.WAA(ua.Vid(Da.a.create(V.AFrameworkApplication.fa.Ta("DimeUrl"),null,null))),this.q3b.continueWith(E=>{R.ULS.sendTraceTag(39978391,324,10,"{0}",qa.a.Qpd(E.exception))},5)}catch(E){R.ULS.sendTraceTag(594874951,324,10,"{0}",qa.a.Qpd(E))}return this.q3b}static jRi(){var E=ua.Glc("inproductmessaging.js");E=Da.a.create(E,null,null);return ua.Vid(E)}static ZQi(){var E=
ua.Glc("inproductmessaging.css");E=new ka(E);return ua.Vid(E)}static Glc(E){return sa.a.wxb(String.format("ipm/{0}",E))}static Vid(E){ja.a.Aya(E);return E.Scb}}Object(N.a)(ua,"DependencyDownloader",null,[732]);class pa{}pa.jjj="inProductMessagingOverlayDiv";pa.kmj="PlayButtonImage";pa.NEj="ReplayButtonImage";Object(N.a)(pa,"Constants",null,[]);class Ka{constructor(){this.Mve=this.fqe=this.pfe=!0;this.OEj=this.lmj=null;this.G_i=!1;this.locale=null;this.Ptg={}}get bIe(){return this.pfe}set bIe(E){this.pfe=
E}get QHf(){return this.fqe}set QHf(E){this.fqe=E}get glg(){return this.Mve}set glg(E){(this.Mve=E)&&this.fTj()}fTj(){this.yBe(pa.kmj,this.lmj);this.yBe(pa.NEj,this.OEj)}yBe(E,ma){ma&&(this.Ptg[E]=ma)}}Object(N.a)(Ka,"FirstRunExperienceUISettings",null,[643]);class $a{constructor(){this.completed=this.fzj=!1}}Object(N.a)($a,"FirstRunExperienceViewData",null,[642]);var ha=a(80),cb=a(189),Ia=a(116),ob=a(28);class gb{constructor(E,ma,Ya){this.Oa=E;this.Xg=ma;this.d1b=Ya}Mi(){this.Oa.pg(ob.a.jXh,Ia.a.frame,
Object(ha.a)(this,this.hXh,"firstRunExperienceHandler"),64);this.Oa.Pd(ob.a.j8e,Ia.a.frame,Object(ha.a)(this,this.xui,"inProductMessagingTabHandler"));this.Oa.Pd(ob.a.i8e,Ia.a.frame,Object(ha.a)(this,this.wui,"inProductMessagingShiftTabHandler"));this.Oa.Pd(ob.a.JAh,Ia.a.frame,Object(ha.a)(this,this.KAh,"dimeLaunchHandler"));this.Oa.Pd(ob.a.b9f,Ia.a.frame,cb.ActionManager.li);this.Oa.Pd(ob.a.oFj,Ia.a.frame,cb.ActionManager.li);this.Oa.Pd(ob.a.pFj,Ia.a.frame,cb.ActionManager.li);this.Xg&&this.Xg.updateCommandUI()}hXh(E,
ma,Ya,Ub,Hc){2===Ya&&this.d1b.APi(Hc);return 32}KAh(E,ma,Ya,Ub,Hc){2===Ya&&this.d1b.xPi(Hc);return 32}xui(E,ma,Ya){return 2===Ya?this.d1b.KJd():32}wui(E,ma,Ya){return 2===Ya?this.d1b.HJd():32}}Object(N.a)(gb,"InProductMessagingActor",null,[]);var Za=a(139);class da{constructor(){this.I5f=this.K$f=this.Tpg=this.ztc=this.instance=null}}Object(N.a)(da,"DimeExperienceUISettings",null,[]);var ya=a(147),ib=a(477);class vb{constructor(E,ma,Ya,Ub,Hc){this.Pic=!1;this.uzb=null;this.Oa=E;this.SJa=ma;this.T3b=
Ya;this.g5=Ub;this.GPc=Hc}sxi(E){ya.b("getHeaderApi")?E.isFeatureEnabled("MsoPremiumBadge",!0).then(ma=>{const Ya=E.isFreemiumUpsellEnabled();Ya&&(appChrome.getHeaderApi().then(Ub=>{Ub.updatePremiumStatus(ma,Ya);return null}),E.AVa("MsoPremiumBadge",Ub=>{appChrome.getHeaderApi().then(Hc=>{Hc.updatePremiumStatus(Ub.isEnabled,Ya);return null})}));return null}):R.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}APi(E){this.T3b.cRi().continueWith(()=>{this.SJa.u2j(E)})}xPi(E){let ma="gopremium",
Ya=null,Ub=()=>{};E?(E.experience&&""!==Object(Za.a)(String,E.experience)&&(ma=Object(Za.a)(String,E.experience)),E.onTaskComplete&&(Ub=E.onTaskComplete),E.campaignId&&""!==Object(Za.a)(String,E.campaignId)&&(Ya=Object(Za.a)(String,E.campaignId))):R.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.bBf(ma,Ub,Ya)}bBf(E,ma,Ya){Ya=void 0===Ya?null:Ya;if(this.Pic&&this.uzb){const Ub={};Ub.experience=E||"gopremium";Ub.campaignId=Ya||ib.b(this.g5,this.GPc,Object(Za.a)(String,
Ub.experience),!0);this.Oa.processAction(ob.a.b9f,2);R.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ub.experience);try{const Hc=Object.assign(new da,{instance:this.uzb,ztc:Ub,Tpg:ma||(()=>{}),K$f:Gd=>{R.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Gd.status)},I5f:()=>{R.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.Pic=!1;this.uzb=null}});this.SJa.H0j(Hc)}catch(Hc){R.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Hc.message),this.Pic=!1,this.uzb=
null,this.Oa.Sf(ob.a.Qic,2,{["experience"]:Ub.experience})}}else R.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Oa.Sf(ob.a.Qic,2,{["experience"]:E})}YBf(){this.T3b.eRi().continueWith(()=>{try{var E=qa.a.Im(V.AFrameworkApplication.uiCulture);const Ub=ib.c(this.g5);if(Ub){var ma={};ma.partnerId=Ub;ma.language=E;ma.sessionId=V.AFrameworkApplication.userSessionId;ma.authHint=V.AFrameworkApplication.fa.Ta("UserPrincipalName");var Ya=V.AFrameworkApplication.fa.Ta("Puid")||
"";""!==Ya&&(E={},E.puid=Ya,ma.userInfo=E);this.uzb=new Dime(ma);this.Pic=!0;R.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else R.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ub){R.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Ub.message)}},3)}KJd(){return this.SJa.KJd()}HJd(){return this.SJa.HJd()}}Object(N.a)(vb,"InProductMessagingUIManager",null,[641]);class eb{constructor(){this.mxe=0;this.S0a=Array(5);this.S0a[0]=10;this.S0a[1]=15;this.S0a[2]=
50;this.S0a[3]=100;this.S0a[4]=200}Init(E){this.mxe=E}SendTrace(E,ma){R.ULS.sendTraceTag(34182235,this.mxe,this.S0a[E],"{0}",ma)}}Object(N.a)(eb,"DefaultNetworkingManager",null,[658]);var Ta=a(276),La=a(327),fb=a(104);class Pb{constructor(E){this.Xd=E}u2j(E){E&&(InProductMessaging.Networking.NetworkingMgr=new eb,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(E.glg,E.QHf,E.bIe,E.G_i,E.locale,Object(ha.a)(this,this.p7i,"onDismissFirstRunExperience"),E.Ptg),this.aXa(pa.jjj,
!0))}H0j(E){if(E&&E.instance&&E.ztc){let ma=document.getElementById("wacDimeContainer");ma||(ma=document.createElement("div"),ma.id="wacDimeContainer",document.body.appendChild(ma));V.AFrameworkApplication.fa.qa("DimeFocusManagerIsEnabled")&&this.aXa("wacDimeContainer",!1);E.ztc.parentElementId="wacDimeContainer";E.instance.launch(E.ztc,E.Tpg).then(Ya=>{this.IQb();document.body.removeChild(ma);E.K$f(Ya)}).catch(Ya=>{this.IQb();document.body.removeChild(ma);E.I5f(Ya)})}else throw Error.argument("DimeExperienceUISettings");
}aXa(E,ma){if(this.Xd&&E&&(E=document.getElementById(E),this.kxi(E),E=this.Xd.JP("InProductMessagingFocusId"))){const Ya=this.Xd.Zj;Ya&&"InProductMessagingFocusId"===Ya.name||this.Xd.EU("InProductMessagingFocusId",!1);ma&&this.J3f(E.scope)}}kxi(E){var ma=!1;ma=void 0===ma?!0:ma;const Ya=this.Xd.vk("InProductMessagingFocusId");Ya.parent=Ta.AFrame.FW;const Ub=new La.DOMFocusListing(()=>E);Ub.ihb=ma;Ub.xq(3);Ub.xq(2);Ub.xq(4);ma=this.Xd.Ywa(()=>E,Ya,Ub);ma.CQb();ma.e3=!0;ma.yMa=!0}J3f(E){E.um(fb.FocusManager.instance().a6);
E.um(fb.FocusManager.instance().b6);E.bindAction(fb.FocusManager.instance().a6,ob.a.j8e);E.bindAction(fb.FocusManager.instance().b6,ob.a.i8e)}IQb(){this.Xd&&(this.Xd.F$("InProductMessagingFocusId"),this.Xd.LVa("InProductMessagingFocusId"))}p7i(E,ma){this.IQb();E=Object.assign(new $a,{completed:E,fzj:ma});V.AFrameworkApplication.jd.Sf(ob.a.gXh,2,E)}KJd(){const E=document.activeElement,ma=this.Xd.uT();return E&&ma&&ma.ah&&E===ma.ah.Yy?(ma.ah.Sn(E),ma.tCa()?32:8):4}HJd(){const E=document.activeElement,
ma=this.Xd.uT();return E&&ma&&ma.ah&&E===ma.ah.firstElement?(ma.ah.Sn(E),ma.qTa()?32:8):4}}Object(N.a)(Pb,"InProductMessagingUIWrapper",null,[636]);var Sa=a(144),Wa=a(261),pb=a(33);class wa{constructor(){this.Rc=null}get name(){return"Common.App.InProductMessaging"}Oj(E){E.register(ua,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").se().Ae(()=>new ua);E.register(Pb,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").se().Ae(()=>
new Pb(fb.FocusManager.instance()));E.register(vb,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").se().Ae(()=>new vb(V.AFrameworkApplication.jd,E.resolve("Common.IInProductMessagingUIWrapper"),E.resolve("Common.App.InProductMessaging.IDependencyDownloader"),V.AFrameworkApplication.sa.Sa.Xi,V.AFrameworkApplication.sa.Sa.HCa));E.register(gb,"Common.App.InProductMessaging.InProductMessagingActor").se().Ae(()=>new gb(V.AFrameworkApplication.jd,V.AFrameworkApplication.sa,
E.resolve("Common.IInProductMessagingUIManager")));E.register(Ka,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").se().Ae(()=>new Ka);E.register($a,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").se().Ae(()=>new $a);this.Rc=E}init(){this.Rc.resolve("Common.App.InProductMessaging.InProductMessagingActor").Mi();V.AFrameworkApplication.fa.Xw(()=>{V.AFrameworkApplication.sa.Sa.Yv&&Sa.a.get_instance().$j(15,
()=>{this.Rc.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(E=>{this.Rc.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").sxi(E)})});V.AFrameworkApplication.fa.qa("FreemiumUpsellShowDialogIsEnabled")&&ib.a()&&!pb.a.bBa&&1!==V.AFrameworkApplication.sa.Sa.Xi&&this.Rc.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(E=>{E.isFeatureEnabled("MsoPremiumBadge",!0).then(ma=>{!ma&&E.isFreemiumUpsellEnabled()&&this.Rc.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").YBf();
return null})})})}dispose(){}static main(){Wa.a.instance.Mk(new wa)}}Object(N.a)(wa,"InProductMessagingPackage",null,[3,4]);var hb=a(200),Sb=a(43);class Bc{constructor(E,ma,Ya,Ub,Hc){this.sy=E;this.qIa=ma;this.Nob=Ya;this.Fse=void 0===Ub?null:Ub;this.drb=void 0===Hc?null:Hc}Wkd(E){const ma=new Sys.StringBuilder(this.sy.gSb);ma.append("RoamingServiceHandler.ashx?action=");ma.append("getFirstRunExperienceSettings");ma.append("&");ma.append(this.Xrd(E));ma.append("&");ma.append(V.AFrameworkApplication.tk);
V.AFrameworkApplication.mf.Vo(ma.toString(),1,null,null,!0,2,Object(ha.a)(this,this.Hna,"getRequestSuccessCallback"),Object(ha.a)(this,this.gY,"getRequestFailureCallback"),null)}dhc(E){var ma=new Sys.StringBuilder(this.sy.gSb);ma.append("RoamingServiceHandler.ashx?action=");ma.append("saveFirstRunExperienceSettings");ma.append("&");ma.append(V.AFrameworkApplication.tk);ma=ma.toString();E=Sb.c(E);V.AFrameworkApplication.mf.Vo(ma,2,E,null,!0,4,Object(ha.a)(this,this.Onj,"postRequestSuccessCallback"),
Object(ha.a)(this,this.G$,"postRequestFailureCallback"),null)}Hna(E){let ma=!1,Ya=null;try{if(0<E.data.Lf.length){const Ub=Object(Za.a)(Object,Sb.a(E.data.Lf)),Hc=Ub?Ub[this.sy.N6c]:null;Hc&&(Ya=Object(Za.a)(Object,Sb.a(Hc.toString())))}ma=!0}catch(Ub){this.gY(null)}ma&&this.qIa&&this.qIa(E.data,Ya)}gY(E){this.Nob&&this.Nob(E?E.data:null)}Onj(E){this.Fse&&this.Fse(E?E.data:null)}G$(E){this.drb&&this.drb(E?E.data:null)}Xrd(E){const ma=new Sys.StringBuilder("requestedsettings=");for(let Ya=0;Ya<E.count;Ya++)ma.append(E.ma(Ya)),
Ya<E.count-1&&ma.append(";");return ma.toString()}}Object(N.a)(Bc,"FirstRunExperienceRequestHandler",null,[]);var ab=a(230),qb=a(84);class mc{constructor(){this.Fob=this.y0b=this.sy=null}f4d(E){E?(this.sy=E,this.BHi()&&(R.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),E=new hb.a,E.add(this.sy.N6c),this.y0b=new Bc(this.sy,Object(ha.a)(this,this.Hna,"getRequestSuccessCallback"),Object(ha.a)(this,this.gY,"getRequestFailureCallback"),
null,Object(ha.a)(this,this.G$,"postRequestFailureCallback")),this.y0b.Wkd(E)),(this.sy.Ubb||V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.g4d()):R.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}BHi(){try{if(this.sy.Ubb)return!0;if(!V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||V.AFrameworkApplication.fa.qa("IsAnonymousUser"))return!1;if(this.sy.TDi||
this.sy.Wbb||V.AFrameworkApplication.fa.qa("IsO365ConsumerHost"))return!0;const E=V.AFrameworkApplication.fa.Ta("FlightId");return-1!==(E?E.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(E){R.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",E?E.toString():null)}return!1}fcg(E){const ma={},Ya={};Ya.FREDisplayedDate=(new Date).toUTCString();Ya.VersionDisplayed=E;Ya.RemindMeLater=!1;ma[this.sy.N6c]=Sb.c(Ya);R.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.y0b&&this.y0b.dhc(ma)}Hna(E,ma){E=E?+E.a7-+E.YH:-1;E>this.sy.Sag?R.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",E,this.sy.Sag):ma?this.r_j(ma)?(R.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.sy.KHf),this.g4d()):(this.fhd(!1),
R.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(R.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.g4d())}gY(E){this.fhd(!1);R.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",E?E.httpStatus:-1)}G$(E){R.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
E?E.httpStatus:-1)}g4d(){this.fhd(!0);var E=qb.a.instance.ai("Common.ISystemInitiatedFeedback");E?this.Vkg(E):(R.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((E=qb.a.instance.Ed("Common.ISystemInitiatedFeedback"))?E.execute(ma=>{this.Vkg(ma)}):R.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Vkg(E){if(E){var ma=
this.sy.uXh;ma&&V.AFrameworkApplication.pN(ma);R.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ma);E.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Fob=Object(ha.a)(this,this.s8i,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Fob,!0),window.addEventListener("FRELaunchedEvent",this.Fob,!0)):(R.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.fcg(this.sy.currentVersion))}else R.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}s8i(E){if(E){var ma=E.detail;E=E.type;var Ya=this.sy&&this.sy.campaignId?this.sy.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===E||Ya&&ma&&ma.id&&-1!==ma.id.indexOf(Ya)){if("FRELaunchedEvent"===E||ma&&ma.success)R.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.fcg(this.sy.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",
this.Fob,!0),window.removeEventListener("FRELaunchedEvent",this.Fob,!0))}}}r_j(E){if("RemindMeLater"in E&&"FREDisplayedDate"in E){if("true"===E.RemindMeLater.toString()&&(+new Date-+new Date(E.FREDisplayedDate.toString()))/36E5>this.sy.KHf)return!0}else if(V.AFrameworkApplication.fa.qa("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in E&&E.VersionDisplayed<this.sy.currentVersion)return R.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),
!0;return!1}fhd(E){V.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&ab.a.dispatch("FREDecisionEvent",{["show"]:E})}}Object(N.a)(mc,"FirstRunExperienceLauncher",null,[862]);class yb{constructor(){this.Rc=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Oj(E){this.Rc=E;this.Rc.register(862,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").se().Ae(()=>new mc)}init(){}dispose(){}static main(){Wa.a.instance.Mk(new yb)}}
Object(N.a)(yb,"FirstRunExperienceLauncherPackage",null,[3,4]);var vc=a(10),Db=a(234),Ga=a(1);class Eb{constructor(E){this.$=E}get N6c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get TDi(){return this.isEnabled()&&Ga.EwaSettings.Da(295)}get Wbb(){return this.isEnabled()&&Ga.EwaSettings.Da(297)}get Ubb(){return Ga.EwaSettings.Da(296)}get uXh(){return null}get KHf(){return 24}get Sag(){return 4E3}get gSb(){return this.$.xa.WebServiceBase||
""}isEnabled(){if(V.AFrameworkApplication.fa?V.AFrameworkApplication.fa.qa("IsAnonymousUser"):1)return!1;const E=V.AFrameworkApplication.fe?Object(Za.a)(String,V.AFrameworkApplication.fe.AudienceGroup):"";return"Unknown"!==E&&"Automation"!==E}}Object(N.a)(Eb,"FirstRunExperienceLauncherSettings",null,[895]);class Zb{constructor(E,ma){this.k8e=E;this.iXh=ma}f4d(){this.k8e&&this.k8e.f4d(this.iXh)}}Object(N.a)(Zb,"FirstRunExperienceManager",null,[894]);var ic=a(737);class mb extends Db.a{constructor(E){super();
this.$=E;this.Md()}create(){const E=Object(ic.a)(this.$.ea,311,()=>this.$qh());this.qd(E)}$qh(){var E=new Eb(this.$);E=new Zb(qb.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),E);E.f4d();return E}static la(E){E.ea.Ja(312,new mb(E))}}Object(N.a)(mb,"FirstRunExperienceManagerFactory",Db.a,[]);var Hb=a(59);class Wb extends Db.a{constructor(E){super();this.hxd=null;this.$=E;this.Md()}create(){const E=Object(ic.a)(this.$.ea,361,()=>this.Lrh());this.qd(E)}Lrh(){this.hxd=
qb.a.instance.ai("Common.IInProductMessagingUIManager");Hb.a.mi.Yv?Sa.a.get_instance().$j(16,()=>{this.oqf()}):this.oqf();return this.hxd}oqf(){qb.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(E=>{E.isFeatureEnabled("MsoPremiumBadge",!0).then(ma=>{!ma&&E.isFreemiumUpsellEnabled()&&this.hxd.YBf();return null})})}static la(E){E.ea.Ja(362,new Wb(E))}}Object(N.a)(Wb,"InProductMessagingManagerFactory",Db.a,[]);var Ob=a(52),Gc=a(357),Va=a(87),Jb=a(542),ub=a(21),
Qa=a(588);class P extends Jb.a{constructor(E){super(1);this.lja=!1;this.qMf=()=>{this.refresh()};this.rMf=()=>{this.refresh()};this.gridView=ub.h(E);this.gridView.Vd.yp(this.rMf);this.gridView.Vd.yq(this.qMf);this.refresh()}get RK(){return this.vvc(this.lja)}T1d(E){this.lja!==E&&(this.lja=E,this.QPb())}get name(){return Qa.a.cellEdit}dispose(){this.gridView.Vd.lp(this.rMf);this.gridView.Vd.Pp(this.qMf);this.gridView=null;super.dispose()}QPb(){this.fTd(this.lja)}refresh(){this.T1d(!this.gridView.Xc)}}
Object(N.a)(P,"CellEditSafeStatePublisher",Jb.a,[]);var ta=a(39),Z=a(133);class aa{constructor(E,ma){this.handler=null;this.publisher=E;this.RK=ma}}Object(N.a)(aa,"SafeStatePublisherState",null,[]);var Ea=a(628);const za=E=>E?`${E.Current} / ${E.Pending} @${E.SuspensionStartTimestamp}`:null,bb=E=>(null===E||void 0===E?void 0:E.SuspensionStartTimestamp)&&E.Pending>E.Current;class Mb extends ta.a{constructor(E,ma){super();this.JAf=null;this.wcb=!1;this.ANb=(Ya,Ub)=>{3===Ub.vHf&&this.wcb&&R.ULS.sendTraceTag(520480204,
0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.wcb=!0;this.Bgb()};this.tWa=new hb.a;this.qCa=E;this.Aqa=ma;this.cHb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.Abb=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");this.cHb&&(this.Aqa.Z2a(this.XCa.bind(this)),this.Abb?this.qCa.CCe(this.ANb):this.qCa.O_g(this.mRf.bind(this)))}get ogk(){return Z.f(Z.c(this.tWa.toArray(),
E=>0!=E.RK),E=>E.publisher.name)}L7b(E){this.addHandler(Mb.sWa,E)}dDc(E){this.removeHandler(Mb.sWa,E)}cEa(E,ma){const Ya=new aa(E,ma);this.tWa.add(Ya);ma=(Ub,Hc)=>{Ya.RK=Hc.RK;this.Bgb()};E.L7b(ma);Ya.handler=ma;this.Bgb()}j$d(E){let ma=null;for(let Ya of this.tWa)if(Ya.publisher===E){this.Rug(Ya);ma=Ya;break}ma&&(this.tWa.remove(ma),this.Bgb())}dispose(){for(let E of this.tWa)this.Rug(E);this.tWa.clear();this.cHb&&(this.Aqa.uhb(this.XCa.bind(this)),this.Abb?this.qCa.M7f(this.ANb):this.qCa.CCj(this.mRf.bind(this)));
super.dispose()}njc(){let E=Kb.njc(this.tWa.toArray().map(ma=>ma.RK));return this.wcb&&1===E?2:E}Rug(E){E.publisher.dDc(E.handler)}Bgb(){const E=this.njc();E!==this.JAf&&(this.raiseEvent(Mb.sWa,new Ea.a(E)),this.JAf=E)}mRf(){this.wcb&&R.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.wcb=!0;this.Bgb()}XCa(E,ma){E=ma.gga;(ma=!bb(E))||(ma=this.ROi,ma=(null===E||void 0===E?void 0:E.SuspensionStartTimestamp)!==(null===ma||
void 0===ma?void 0:ma.SuspensionStartTimestamp));ma&&(this.wcb=!1);this.ROi=E;this.Bgb()}}Mb.sWa="SSC";Object(N.a)(Mb,"ClientStateMonitor",ta.a,[]);var zb=a(8),oa=a(78);class Xa extends Jb.a{constructor(E,ma){ma=void 0===ma?null:ma;super(1);this.lja=!1;this.yQ=()=>{this.refresh()};this.yNf=()=>{this.refresh()};this.$=E;this.vle=ma||oa.a(E).qT(zb.a.idle);oa.a(E).e5c(this.yNf);this.C$a.Ks(this.yQ);this.refresh()}get RK(){return this.vvc(this.lja)}T1d(E){E!==this.lja&&(this.lja=E,this.QPb())}get name(){return Qa.a.C$a}get C$a(){return this.vle}dispose(){oa.a(this.$).KCc(this.yNf);
this.C$a.ot(this.yQ);this.vle=null;super.dispose()}QPb(){this.fTd(this.lja)}refresh(){this.T1d(1===this.C$a.Ow||oa.a(this.$).Pj===this.C$a)}}Object(N.a)(Xa,"IdleActivitySafeStatePublisher",Jb.a,[]);var bc=a(329),Ac=a(5),Xc=a(24);class Ed extends Va.a{constructor(){super()}Ce(){return!1}executeCommand(){return Ba.Task.Wa(!0)}qe(E,ma){return 1905775613===ma.command}Ge(){return!1}}Object(N.a)(Ed,"ToggleMergeSuspensionSafeState",Va.a,[190]);class Qd extends ta.a{constructor(E,ma){super();this.statusBarManager=
null;this.LKd=!1;this.XCa=(Ya,Ub)=>{Ya=`${Ub.gga.Current===Ub.gga.Pending?"\u26ad":"\u26ae"}${Ub.gga.Current}`;Xc.a.equals(this.awc,Ya,!1)||(this.awc=Ya,this.fC())};this.ZTa=(Ya,Ub)=>{Ya=0==Ub.RK;this.LKd!==Ya&&(this.LKd=Ya,this.fC())};this.mergeSuspensionManager=ma;this.mergeSuspensionManager.Aqa.Z2a(this.XCa);this.awc="";bc.a.Gca(1905775613,Ac.a.ke,0,1);this.Ha=E.Ha;this.DWb=new Ed;E.ea.Zc(29,Ya=>{this.mergeSuspensionManager&&(this.statusBarManager=Ya,Ya.gM(this),this.mergeSuspensionManager.yla.L7b(this.ZTa))});
this.Ha.n6(this.DWb)}Ks(E){this.addHandler(Qd.mJd,E)}ot(E){this.removeHandler(Qd.mJd,E)}fC(){this.raiseEvent(Qd.mJd)}Jp(E){return E===Qd.nrj&&!!this.mergeSuspensionManager}Du(E,ma){if(!this.Jp(E))return!1;this.mergeSuspensionManager&&(ma.LabelText=this.awc,ma.On=this.LKd);return!0}dispose(){this.DWb&&(this.Ha.lhb(this.DWb),this.DWb.dispose(),this.DWb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Aqa.uhb(this.XCa),this.mergeSuspensionManager.yla.dDc(this.ZTa),this.mergeSuspensionManager=
null);this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null);this.awc=null;super.dispose()}}Qd.mJd="MSMSC";Qd.nrj="QueryMergeSuspensionStatus";Object(N.a)(Qd,"MergeSuspensionIndicatorManager",ta.a,[187,188,5]);var zd=a(2),fe=a(935);class jd extends Sys.EventArgs{constructor(E){super();this.gBa=E}}Object(N.a)(jd,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Xb{}Object(N.a)(Xb,"SuspensionState",null,[]);class Lc extends Xb{constructor(E){super();this.rEe=
!1;this.rEe=E}}Object(N.a)(Lc,"ReadyForPendingMergeState",Xb,[]);const Bd=new Xb,Nc=new Xb,rb=new Lc(!1),va=new Lc(!0);var yc=a(936);class Zc extends yc.a{constructor(E,ma,Ya){super(E);this.d3g=ma;this.e3j=Ya}}Object(N.a)(Zc,"ReadyForPendingMergesUpdatedEventArgs",yc.a,[]);class cc extends ta.a{constructor(E,ma,Ya){super();this.XCa=(Ub,Hc)=>{Ub=this.getState();const Gd=this.i3;this.i3=Hc.gga;Hc=this.getState();this.eUi(Ub,Hc,Gd);this.raiseEvent(cc.hJd);this.X7e(Ub,Hc)};this.ZTa=(Ub,Hc)=>{Ub=this.getState();
this.RK=Hc.RK;Hc=this.getState();this.X7e(Ub,Hc)};this.ANb=(Ub,Hc)=>{this.Abb&&4===Hc.vHf&&(R.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",za(this.i3),za(Hc.i3)),this.d2f(this.getState(),!0))};this.cHb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.Abb=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");
this.yla=E;this.yla.L7b(this.ZTa);this.Aqa=ma;this.Aqa.Z2a(this.XCa);this.Abb&&(this.qCa=Ya,this.qCa.CCe(this.ANb));this.i3=Object(zd.a)(new fe.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.RK=this.Gvi()}Gvi(){return Object(Gc.a)(Mb,this.yla)?Object(Za.a)(Mb,this.yla).njc():1}P7b(E){this.addHandler(cc.x8d,E)}iDc(E){this.removeHandler(cc.x8d,E)}B0g(E){this.addHandler(cc.OTd,E)}dDj(E){this.removeHandler(cc.OTd,E)}N_g(E){this.addHandler(cc.hJd,E)}BCj(E){this.removeHandler(cc.hJd,E)}mtj(){this.cTd(this.getState()===
Nc)}dispose(){this.yla.dDc(this.ZTa);this.yla=null;this.Aqa.uhb(this.XCa);this.Aqa=null;this.Abb&&(this.qCa.M7f(this.ANb),this.qCa=null);super.dispose()}ird(){return Object(zd.a)(new fe.a,{Current:this.i3.Current,Pending:this.i3.Pending,SuspensionStartTimestamp:this.i3.SuspensionStartTimestamp})}getState(){return bb(this.i3)?0==this.RK?va:this.cHb&&1==this.RK?rb:Nc:Bd}X7e(E,ma){E!==ma&&(ma===Nc?this.cTd(!0):E===Nc&&this.cTd(!1));this.d2f(ma)}d2f(E,ma){E instanceof Lc&&this.raiseEvent(cc.OTd,new Zc(this.i3,
E.rEe||!this.cHb,void 0===ma?!1:ma))}eUi(E,ma,Ya){E===Bd&&ma!==Bd?(E=ma===Nc,ma=ma===rb,R.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${ma} publisher: ${ma||E?this.yla.ogk.join(","):""} counter: ${za(this.i3)} isBlockingAllMerges: ${E}`)):E!==Bd&&ma===Bd&&R.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${za(Ya)}`)}cTd(E){this.raiseEvent(cc.x8d,
new jd(E))}}cc.x8d="TPMBBC";cc.OTd="RFPMU";cc.hJd="MCC";Object(N.a)(cc,"MergeSuspensionStateHandler",ta.a,[]);class Le extends ta.a{constructor(E){super();this.K5=null;this.dtc=0;this.zLb=(ma,Ya)=>{(null===Ya||void 0===Ya?0:Ya.gga)&&this.STa(Ya.gga,Le.pce)};this.RFc=()=>{this.x$f();this.S1f(this.K5,Le.OGj)};this.UMd=(ma,Ya)=>{Ya.committed&&this.K5.SuspensionStartTimestamp&&R.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${za(this.K5)}`)};this.x$f();this.$=
E;this.$.da.Pl(this.RFc);this.$.da.jM(this.RFc);ub.h(this.$).Vd.yq(this.UMd);this.$.ea.Zc(292,ma=>{ma.Z2a(this.zLb);R.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Z2a(E){this.addHandler("MCU",E)}uhb(E){this.removeHandler("MCU",E)}get i3(){return this.K5}STa(E,ma){ma=void 0===ma?"":ma;const Ya=this.K5.Current<E.Current||this.K5.Pending<E.Pending;if(E.SuspensionStartTimestamp&&this.dtc!==E.SuspensionStartTimestamp){if(this.dtc>E.SuspensionStartTimestamp){Ya&&R.ULS.sendTraceTag(553736149,
0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${ma}. S: ${Le.yLb(E)}, C: ${Le.yLb(this.K5)}`);return}Ya||R.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Le.yLb(E)}, C: ${Le.yLb(this.K5)}`)}else if(!Ya)return;this.K5=E;this.S1f(E,ma)}dispose(){this.$.da.Vl(this.RFc);this.$.da.XQ(this.RFc);ub.h(this.$).Vd.Pp(this.UMd);const E=this.$.ea.Ba(292);E&&E.uhb(this.zLb);
super.dispose()}S1f(E,ma){ma=void 0===ma?"":ma;bb(E)&&E.SuspensionStartTimestamp>this.dtc&&(R.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${za(E)}, Origin: ${ma}`),this.dtc=E.SuspensionStartTimestamp);this.raiseEvent("MCU",new yc.a(E))}x$f(){R.ULS.sendTraceTag(588276808,0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Le.yLb(this.K5)}`);this.K5=Object(zd.a)(new fe.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static yLb(E){return E?
`(${E.Current}/${E.Pending} @${E.SuspensionStartTimestamp})`:"null"}}Le.pce="PMM.RTC";Le.Efc="PMM.EwaResult";Le.OGj="PMM.resetMergeCounter";Object(N.a)(Le,"PendingMergeMonitor",ta.a,[]);class Re{}Object(N.a)(Re,"ClientRevisions",null,[]);var Ib=a(48),Yc=a(65);const Cb=(E,ma,Ya,Ub,Hc,Gd,he)=>{he=E.Ra(1,void 0===he?null:he);he.suspensionStartTimestamp=ma;return Yc.g(E,"KeepBlockingPendingMerges",he,Ya,Ub,Hc,Gd,0)};class pc extends ta.a{constructor(E,ma,Ya,Ub){super();this.sNa=null;this.yJb=0;this.zJb=
this.icb=null;this.YSf=(Hc,Gd)=>{this.sNa.Q6g(Gd.gga,Gd.d3g,Gd.e3j)};this.gOb=(Hc,Gd)=>{Gd.gBa?this.t5j():this.gJc()};this.lRf=()=>{this.yJb=0};this.Zdg=()=>{const Hc=this.V9.ird();Cb(this.ua,null!=Hc.SuspensionStartTimestamp?Hc.SuspensionStartTimestamp:0,null,()=>{this.$aj(Hc)},null,null,this.ua.Ud())};this.GGa=(Hc,Gd)=>{if(Gd){Gd.vub.MergeCount=this.V9.ird();let he;({min:Hc,max:he}=ub.h(this.$).lZi());Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Gd.vub.ClientRevisions=
Object(zd.a)(new Re,{Min:Hc,Max:he,MaxFromBlockCache:ub.h(this.$).za.VGf}):Gd.vub.ClientRevisions=Object(zd.a)(new Re,{Min:Hc,Max:he})}};this.$=E;this.P3a=Ya;this.V9=ma;this.V9.B0g(this.YSf);this.V9.P7b(this.gOb);this.V9.N_g(this.lRf);this.$.pa.Ika(this.GGa);this.ua=this.$.pa.ua;this.CXd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;this.lOi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.sNa=Ub;R.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.pa.cra(this.GGa);
this.gJc();this.V9.dDj(this.YSf);this.V9.iDc(this.gOb);this.V9.BCj(this.lRf);this.V9=null;super.dispose()}t5j(){this.gJc();if(this.EXe()){const E=this.V9.ird();R.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${za(E)} fail count: ${this.yJb}`)}else this.zJb=this.P3a.create(this.Zdg,this.CXd,Ib.a.zJb),this.icb=this.P3a.pF(this.Zdg,this.lOi,Ib.a.icb)}gJc(){this.icb&&
(this.zJb.cancel(),this.icb.cancel(),this.icb=this.zJb=null)}$aj(E){let ma;ma=" fail count: "+this.yJb;this.yJb++;this.EXe()&&this.gJc();R.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${za(E)}${ma}`)}EXe(){return this.yJb>pc.XXi}}pc.XXi=5;Object(N.a)(pc,"RequestController",ta.a,[]);var Mc=a(181),xd=a(209),Nd=a(34),te=a(295);class tb extends Sys.EventArgs{constructor(E,ma){super();this.vHf=E;this.i3=ma}}Object(N.a)(tb,"MergeDidntOccurEventArgs",
Sys.EventArgs,[]);var Gb=a(151),fd=a(19);class lc extends ta.a{get WQa(){return 0<this.XOd}constructor(E,ma,Ya,Ub,Hc){Ya=void 0===Ya?null:Ya;Ub=void 0===Ub?null:Ub;Hc=void 0===Hc?null:Hc;super();this.ctc=null;this.XOd=0;this.documentVisibilityObserver=null;this.Zzf=!1;this.tvc=null;this.ua=E;this.CXd=ma.xa.MergeSuspensionRequestThrottlingTimeInMs;const Gd=ma.xa.GetRangeContentPrefetchDelayForMergeInMs;this.VA=()=>{ma.Ncg(Gd)};this.oj=Ya||Nd.a.$a;this.Zxg=0;this.iO=Ub;this.HEa=Hc;Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Gb.a.resolve(fd.K).then(he=>{this.documentVisibilityObserver=he}):ma.ea.Zc(291,he=>{this.documentVisibilityObserver=he})}O_g(E){this.addHandler(lc.nJd,E)}CCj(E){this.removeHandler(lc.nJd,E)}CCe(E){this.addHandler(lc.iJd,E)}M7f(E){this.removeHandler(lc.iJd,E)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Ui}Q6g(E,ma,Ya){this.HUb(E,ma,void 0===Ya?!1:Ya)?(new Mc.a).setResult(!0):(ma=this.ilj(E,ma),this.ctc=E,this.XOd++,ma.continueWith(()=>{this.t7i()},
0,xd.a.none,this.iO))}ilj(E,ma){this.Zxg=this.oj.Aia;this.Zzf=ma;R.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${E.Current} / ${E.Pending} @${E.SuspensionStartTimestamp}. allowSelectionAdjustment: ${ma}`);this.isDocumentHidden||this.VA();return this.tNj(ma,E)}HUb(E,ma,Ya){Ya=void 0===Ya?!1:Ya;if(this.HEa&&!ma&&!this.HEa.uLi())return R.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),
!0;if(!this.ctc||E.SuspensionStartTimestamp>this.ctc.SuspensionStartTimestamp)return this.WQa&&R.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${E.Current} / ${E.Pending} @${E.SuspensionStartTimestamp}`),!1;if(this.WQa)return!0;if(Ya)return!1;Ya=this.ctc;const Ub=this.oj.Aia-this.Zxg<this.CXd;ma=this.Zzf===ma;return(E||Ya?E&&Ya?E.Current===Ya.Current&&E.Pending===Ya.Pending&&E.SuspensionStartTimestamp===
Ya.SuspensionStartTimestamp:!1:!0)&&Ub&&ma}tNj(E,ma){const Ya=this.ua.Ud(),Ub=()=>{R.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${ma.Current} / ${ma.Pending} @${ma.SuspensionStartTimestamp}`)};return this.HEa?this.HEa.UJj(this.x7h(E,Ub,Ya)):this.$Ke(null,!0,void 0,Ub,Ya)}x7h(E,ma,Ya){return(Ub,Hc,Gd)=>{let he=void 0;R.ULS.shipAssertTag(523317955,0,null!=Ub||E,"!allowSelectionAdjustment requires a non-null initialViewportState.");he=this.u7i.bind(this);
Hc&&(he=te.b.call(null,Ke=>{const af=Ke.Result;let xf=null===af||void 0===af?void 0:af.AdjustedViewportState;3===(null===af||void 0===af?void 0:af.MergeResultState)&&(xf=void 0);Hc(xf,Ke.StateId)},he));Gd&&(ma=te.a.call(null,Gd,ma));return this.$Ke(Ub,E,he,ma,Ya)}}$Ke(E,ma,Ya,Ub,Hc){var Gd=this.ua;Hc=Gd.Ra(1,void 0===Hc?null:Hc);Hc.viewportState=E;Hc.allowViewAdjustment=ma;return Yc.g(Gd,"DoPendingMerge",Hc,Ya,Ub,null,null,0)}u7i(E){var ma=E.Result;void 0!=ma&&(ma=ma.MergeResultState,Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout")&&
2!==ma?this.tvc=[ma,E.MergeCount]:3===ma&&(R.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.Msj()))}Msj(){this.raiseEvent(lc.nJd,new Sys.EventArgs)}Lsj(E,ma){this.raiseEvent(lc.iJd,new tb(E,ma))}t7i(){this.XOd--;if(this.tvc){const E=this.tvc;this.tvc=null;this.Lsj(...E)}}}lc.nJd="MWA";lc.iJd="MDO";Object(N.a)(lc,"DoPendingMergeSender",ta.a,[952,953]);class $c{constructor(E){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=
this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.uui=void 0===E?!1:E}get reportName(){return this.uui?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(N.a)($c,"SelectionAdjustSessionEndsReport",null,[248]);var Md=a(46);class dd{constructor(E,ma,Ya,Ub,Hc,Gd){this.dd=E;this.YI=ma;this.tca=Ya;this.z4b=Ub;this.see=Hc;this.EO=Gd}get activeCell(){return this.YI}get selectedRanges(){return this.tca}get Ys(){let E=
!1;if(null===this.EO||void 0===this.EO)E=!0;else if(this.EO>=this.selectedRanges.length||!this.selectedRanges[this.EO].contains(this.activeCell))R.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.EO}, selectedRangesLength: ${this.selectedRanges.length}`),E=!0;E&&(this.EO=this.Zch());return this.EO}get activeRange(){return 0>this.Ys?this.activeCell:this.selectedRanges[this.Ys]}get sheetName(){return this.z4b}get activeItemName(){return this.see}get CCg(){return 1===
this.selectedRanges.length}hzg(E){let ma=this.selectedRanges.map(Ya=>this.Jdk(Ya,this.see));for(let Ya of ma)if(Ya)for(let Ub of Ya)if(Ub.il&&Ub.Pf.Revision<E)return!1;return!0}iak(){var E;return{SheetName:this.sheetName,ActiveCell:null===(E=this.activeCell)||void 0===E?void 0:E.toString(),TopLeft:void 0,SelectedRanges:Md.r(this.selectedRanges,this.dd)}}toString(){var E,ma;return`active cell: ${null!==(ma=null===(E=this.activeCell)||void 0===E?void 0:E.toString())&&void 0!==ma?ma:"null"} selection: ${Z.f(this.selectedRanges,
Ya=>{var Ub;return null!==(Ub=null===Ya||void 0===Ya?void 0:Ya.toString())&&void 0!==Ub?Ub:"null"}).join(",")}`}equals(E){return E?this.activeCell.equals(E.activeCell)&&Md.R(this.selectedRanges,E.selectedRanges)&&this.sheetName===E.sheetName:!1}Zch(){for(let E of this.selectedRanges.entries()){let [ma,Ya]=E;if(null===Ya||void 0===Ya?0:Ya.contains(this.activeCell))return ma}return-1}Jdk(E,ma){var Ya;const Ub=ub.h(this.dd).za.ZOa(E,ma);Ub||R.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==
(Ya=null===E||void 0===E?void 0:E.toString())&&void 0!==Ya?Ya:"null"} ; activeItemNameIsDefined: ${!!ma}`);return Ub}}Object(N.a)(dd,"SelectionState",null,[]);var ee=a(225),Tc=a(770);class wd{constructor(E){this.aJc=0;this.IJ=this.VH=null;this.Kee=new $c;this.Lee=new $c(!0);this.IK=0;this.s9j=!1;this.sZi=1E4;this.kf=()=>{this.rUe()};this.Uj=()=>{this.U7c(!0,!1)};this.keb=()=>{this.U7c(!1,!1)};this.$=E;this.gridView=ub.h(this.$);this.gridView.za.su(this.Uj);this.gridView.za.yw(this.keb);this.gridView.za.MBe(this.keb);
this.gridView.za.Lca(this.keb);this.$.Pm(this.kf);this.rUe()}UJj(E){let ma=null,Ya=null,Ub=()=>{this.R3i()};this.Jrf()?(this.rS.parallel++,R.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.IJ}`)):(ma=(Hc,Gd)=>{this.S3i(Hc,Gd)},Ya=this.kTj());return null===E||void 0===E?void 0:E(Ya,ma,Ub)}uLi(){return!this.Jrf()&&this.Fea().CCg}kTj(){var E;R.ULS.shipAssertTag(525135961,0,0===this.IK,"SelectionAdjustManager.setPreRequestState: unexpected state");
this.IJ&&(this.rS.errors++,R.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.IJ.toString()}`));this.IJ=null;this.VH=this.Fea();let ma=null;const Ya=null===(E=this.VH)||void 0===E?void 0:E.iak();Ya&&(ma={ActiveSheetName:this.VH.sheetName,SheetViewportStateChanges:[Ya]});this.IK=1;return ma}R3i(){R.ULS.shipAssertTag(525135960,0,1===this.IK,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.rS.errors++;
this.IK=2;this.Nt()}S3i(E,ma){try{R.ULS.shipAssertTag(525135959,0,1===this.IK,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.aJc=ma,ma=2,this.VH?E?(this.IJ=this.OWj(E))?(ma=7,this.VH.equals(this.IJ)?this.VH.equals(this.Fea())?(this.rS.adjustedDidntChange++,ma=4):(this.rS.adjustedDidntChangeWithDivergence++,ma=5):this.VH.sheetName!=this.IJ.sheetName?(this.rS.differentSheetAdjust++,ma=10):this.VH.equals(this.Fea())||(this.rS.divergenceOnResponse++,ma=6,this.X8f())):this.rS.errors++:
(this.rS.errors++,R.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.VH.toString()}`)):(this.rS.errors++,R.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===E||void 0===E?void 0:E.ActiveCell}`)),this.IK=ma}catch(Ya){this.IK=12,R.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${Ya}`)}finally{7!=
this.IK?this.Nt():this.U7c(!1,!0)}}dispose(){this.gridView.za.eu(this.Uj);this.gridView.za.Tu(this.keb);this.gridView.za.d7f(this.keb);this.gridView.za.OVa(this.keb);this.$.Rn(this.kf)}Jrf(){return 1===this.IK||7===this.IK}OWj(E){let ma;if(!(()=>{let Gd=Md.ab(E.ActiveCell,this.$.va);({range:ma}=Gd);return Gd})().returnValue)return R.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${E.ActiveCell}`),null;let Ya=[];const Ub=this.$.na,
Hc=!!Ub&&2===Ub.GI;if(E.SelectedRanges)Ya=Md.g(E.SelectedRanges.Ranges);else if(!Hc)return R.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Ub}`),null;return new dd(this.$,ma,Ya,E.SheetName,this.VH.activeItemName,this.VH.Ys)}Fea(){const E=this.$.na;if((null===E||void 0===E?0:E.activeCell)&&E.selectedRanges&&E.sheetName)return new dd(this.$,E.activeCell,E.selectedRanges,E.sheetName,this.$.activeItemName,E.Ys);
R.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!E}, activeCell null: ${!(null===E||void 0===E?0:E.activeCell)}, selectedRanges null: ${!(null===E||void 0===E?0:E.selectedRanges)}, sheetName null: ${!(null===E||void 0===E?0:E.sheetName)}`);return null}rUe(){this.$.ea.Zc(276,()=>{const E=ee.a(this.$);E.sW(this.Kee);E.sW(this.Lee)})}U7c(E,ma){var Ya;if(this.wJi(E))if(8===this.IK)R.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");
else{ma&&R.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{R.ULS.shipAssertTag(525135956,0,7===this.IK,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.VH.equals(this.Fea())?(null===(Ya=this.gridView)||void 0===Ya?0:Ya.Xc)?(this.rS.editBoxDivergence++,this.IK=11):(E=0,E=this.IJ.Ys,-1==E?(this.rS.errors++,R.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):
(this.rS.adjusted++,this.IK=8,this.gridView.ha.FI(this.IJ.selectedRanges,E,this.IJ.activeCell,0,void 0,"SelectionAdjust"))):(this.rS.divergenceOnViewportReady++,this.X8f(),this.IK=9)}catch(Ub){this.IK=12,R.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Ub}`)}finally{this.Nt()}}}wJi(E){if(!this.IJ)return!1;if(!this.VH)return R.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.IJ.toString()}`),
!1;if(ub.h(this.$).za.VGf<this.aJc)return!1;if(E||this.s9j)R.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.VH.hzg(this.aJc)||!this.IJ.hzg(this.aJc))return!1;return!0}Nt(){this.VH=this.IJ=null;this.IK=0}X8f(){const E=this.Fea();R.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.VH.toString()} current: ${E?E.toString():""} adjusted: ${this.IJ.toString()} sheetSameBetweenInitialAndAdjusted: ${this.VH.sheetName===
this.IJ.sheetName} sheetSameBetweenInitialAndCurrent: ${this.VH.sheetName===(E?E.sheetName:null)}`)}get rS(){return Tc.a.OF(this.sZi)?this.Lee:this.Kee}}Object(N.a)(wd,"SelectionAdjustManager",null,[916,5]);class Kb extends Va.a{constructor(E,ma,Ya){Ya=void 0===Ya?null:Ya;super();this.wHa=this.Xnc=this.D$a=this.Z4a=null;this.$=E;this.j1a=new Le(E);this.HEa=new wd(this.$);this.sNa=new lc(this.$.pa.ua,this.$,void 0,void 0,this.HEa);this.bwi(E,Ya);this.wja=new cc(this.wHa,this.j1a,this.sNa);this.wXd=
new pc(E,this.wja,ma,this.sNa);Ga.EwaSettings.Da(230)&&(this.Xnc=new Qd(E,this));R.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}P7b(E){this.wja.P7b(E)}iDc(E){this.wja&&this.wja.iDc(E)}get yla(){return this.wHa}get Aqa(){return this.j1a}get V9(){return this.wja}cEa(E,ma){this.wHa.cEa(E,ma)}j$d(E){this.wHa.j$d(E)}STa(E,ma){this.j1a.STa(E,void 0===ma?"":ma)}dispose(){this.Xnc&&(this.Xnc.dispose(),this.Xnc=null);this.HEa&&this.HEa.dispose();this.sNa.dispose();this.wXd&&(this.wXd.dispose(),
this.wXd=null);this.wja&&(this.wja.dispose(),this.wja=null);this.j1a.dispose();this.j1a=null;this.wHa.dispose();this.wHa=null;this.Z4a&&(this.Z4a.dispose(),this.Z4a=null);this.D$a&&(this.D$a.dispose(),this.D$a=null);this.$=null;super.dispose()}QPb(){this.wja.mtj()}static njc(E){let ma=0;for(let Ya of E){if(2==Ya)return 2;1==Ya&&(ma=1)}return ma}bwi(E,ma){this.wHa=new Mb(this.sNa,this.j1a);ma?Object(Gc.a)(Xa,ma)?this.cEa(ma,Object(Za.a)(Xa,ma).RK):Object(Gc.a)(P,ma)?this.cEa(ma,Object(Za.a)(P,ma).RK):
this.cEa(ma,0):(this.Z4a=new P(E),this.D$a=new Xa(E),this.cEa(this.Z4a,this.Z4a.RK),this.cEa(this.D$a,this.D$a.RK))}}Object(N.a)(Kb,"MergeSuspensionManager",Va.a,[892,5]);class Vc extends Db.a{constructor(E){super();this.$e=E;this.Md()}create(){R.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.qd(this.$e.ea.Ba(343)||this.$e.ea.Ja(343,new Kb(this.$e,Ob.a.instance)))}static la(E){R.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");E.ea.Ja(344,new Vc(E))}}Object(N.a)(Vc,
"MergeSuspensionFactory",Db.a,[]);var Hd=a(733),Xd=a(96),qe=a(105),$d=a(61),de=a(16);class le{}le.OQi=3;le.connected=0;Object(N.a)(le,"ConnectionStateConstants",null,[]);var $b=a(120),wc=a(135),gd=a(47);class Ud{constructor(E,ma,Ya){var Ub;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=
this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.XLf=(Hc,Gd)=>{this.blockedOperationsCount++;Hc=`${Gd.componentName}_${Gd.actionName}_${Gd.details})`;this.blockedActions[Hc]=this.blockedActions[Hc]?this.blockedActions[Hc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.ROd=Hc=>{this.durationUntilUserInactive=$b.getElapsedSeconds(this.startTime,Nd.a.$a.Wd);Hc.DWd(this.ROd)};this.pI=()=>{this.hasTabbedOut=
!0};this.Ega=(Hc,Gd)=>{Gd.PXf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=wc.a(Nd.a.$a,this.startTime),this.toastRaiser=Gd.toastRaiser,this.isToastShown=!0)};this.startTime=E;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Ya;if(null===(Ub=ma.da)||void 0===Ub?0:Ub.kh)this.wasUserActiveOnPIStart=ma.da.kh.fs;this.al(ma);this.isDialogShown=0<ma.hd.z3;E=ma.ea.Ba(183);this.isTaskPaneShown=!!E&&E.isVisible&&!E.isCollapsed;this.isTaskPaneCollapsed=!!E&&E.isVisible&&
E.isCollapsed}Ofg(){this.durationMs=wc.a(Nd.a.$a,this.startTime)}ZNd(E){var ma;this.Ofg();gd.a(E).bRb(this.XLf);gd.a(E).gi.bDc(this.Ega);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Gb.a.resolve(fd.K).then(Ya=>{Ya.QVa(this.pI)}):E.ea.Zc(291,Ya=>{Ya.QVa(this.pI)});if(null===(ma=E.da)||void 0===ma?0:ma.kh)E.da.kh.DWd(this.ROd),this.wasUserActiveOnPIEnd=E.da.kh.fs}al(E){gd.a(E).G7b(this.XLf);this.isToastShown?this.toastRaiser="Immediate":
gd.a(E).gi.D5c(this.Ega);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Gb.a.resolve(fd.K).then(ma=>{this.hasTabbedOut=ma.Ui;ma.A0(this.pI)}):E.ea.Zc(291,ma=>{this.hasTabbedOut=ma.Ui;ma.A0(this.pI)});this.wasUserActiveOnPIStart&&E.da.kh.kDe(this.ROd)}}Object(N.a)(Ud,"PartialInteractivityData",null,[]);var ne=a(1117);class rc extends Ud{constructor(E,ma,Ya,Ub,Hc,Gd){super(E,ma,Ub);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=
this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=Ya;this.disconnectionSource=Enum.toString(ne.a,Hc);this.triggeringRequest=Gd}n6i(E,ma){this.swappedByOffline=ma;this.ZNd(E)}XQj(E){this.errorDataDuringConnectivityIssuesMode=E}Gvj(E){10>this.failedRequests.length&&(E=E+"_"+$b.getElapsedSeconds(this.startTime,
Nd.a.$a.Wd).toString(),this.failedRequests.push(E))}}Object(N.a)(rc,"ConnectivityIssuesData",Ud,[]);var kd=a(174),qd=a(140),oe=a(121);class Yd{}Yd.WDh="DuringWork";Yd.connectivityIssues="ConnectivityIssues";Yd.offline="Offline";Object(N.a)(Yd,"UnavailabilityTypes",null,[]);var We=a(56);class He{constructor(E){this.Ysc=this.data=null;this.sld=0;this.SQe=null;this.mNf=(ma,Ya)=>{Ya.oS?(this.data=new rc(Nd.a.$a.Wd,this.$,5===Ya.vsa,0!==Ya.vsa,this.$.Ig.disconnectionSource,this.SQe),this.Ysc=this.$.Ig.RAf,
this.sld=1,this.$.pa.Ig.F1g(this.Jo),kd.a(this.$).f5c(this.dcg)):(this.data.n6i(this.$,5===Ya.vsa),this.$.pa.Ig.f8f(this.Jo),this.data.lastFailedRequestToOnlineTimeGapSec=$b.getElapsedSeconds(this.Ysc,Nd.a.$a.Wd),Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?We.b().gTb(557682689,0,50,Yd.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",$d.a.ye(this.data)):
R.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${$d.a.ye(this.data)}`),this.data&&this.data.isToastShown&&qe.Health.instance.recordQosError(qd.a.iih,[oe.a.Jtc],!0,!1,!1,!1,null),kd.a(this.$).TVd(this.dcg),this.data=null)};this.dcg=(ma,Ya)=>{this.data.XQj(Ya.GX)};this.Jo=(ma,Ya)=>{this.data.Gvj(Ya.context.methodName);ma=Nd.a.$a.Wd;Ya=$b.getElapsedSeconds(this.Ysc,ma);this.Ysc=ma;Ya>this.data.longestDurationBetweenFailedRequestsSec&&
(this.data.longestDurationBetweenFailedRequestsSec=Ya);this.sld++;this.data.averageDurationBetweenFailedRequestsSec=this.Ich(Ya)};this.jNf=(ma,Ya)=>{this.SQe=Ya.edk};this.$=E;gd.a(this.$).gi.WBe(this.mNf);this.$.Ig.VBe(this.jNf)}dispose(){this.$&&(gd.a(this.$).gi.n7f(this.mNf),this.$.Ig&&this.$.Ig.m7f(this.jNf));this.data&&this.$.pa.Ig.f8f(this.Jo);this.$=null}Ich(E){const ma=this.sld-1;return(this.data.averageDurationBetweenFailedRequestsSec*(ma-1)+E)/ma}}Object(N.a)(He,"ConnectivityIssuesTelemetryManager",
null,[5]);var bf=a(911),ef=a(9),nc=a(1116),id=a(1115);class Dd{constructor(E){this.ebg=null;this.XEd=this.vJd=this.AMb=this.BMb=0;this.m3d=!1;this.mcd=this.TXa=this.yIc=this.Ndb=null;this.Ccd=0;this.oNj=()=>{if(12E4>this.$.da.kh.Ckb)for(let ma of this.yIc)ma.runTest();else this.o6d("UserInactive")};this.OFj=ma=>{ma=Sys.Serialization.JavaScriptSerializer.serialize(ma);R.ULS.sendTraceTag(388821830,0,50,ma)};this.cFj=ma=>{if(ma){var Ya=this.mcd[ma.testIteration.toString()];Ya?Ya.push(ma):(Ya=[ma],this.mcd[ma.testIteration.toString()]=
Ya);if(Ya.length===this.ebg.length){Ya=Sys.Serialization.JavaScriptSerializer.serialize(Ya);if(this.$&&this.$.Ig){if(ma.EstimatedLatency=this.$.Ig.gIe,this.$.Ig.gIe>this.$.vB.ExcelRountripThresholdMs){R.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${Ya}, consequtive slow ping iteration #: ${this.Ccd++}`);return}}else R.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");R.ULS.sendTraceTag(570712142,
0,50,`Periodic ping tests results: ${Ya}`);this.Ccd=1}}};this.lj=(ma,Ya)=>{ma=Ya.context.methodName;if(ma===ef.a.PDb||ma===ef.a.Oza)this.AMb++,ma=Date.now(),this.vYj(ma)&&(this.AMb=0,this.XEd=ma,this.M5j())};this.Dga=()=>{this.S5d("OnThrottledUserActivity")};this.pI=()=>{this.o6d("OnDocumentHidden")};this.hC=()=>{this.S5d("OnDocumentUnhidden")};this.$=E;if(this.n3d=this.xgh())this.ebg=[id.a.mOc],this.Ccd=1,this.mcd={},this.$.da.kh.qwa(this.Dga),Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Gb.a.resolve(fd.K).then(ma=>{ma.A0(this.pI);ma.vW(this.hC)}):this.$.ea.Zc(291,ma=>{ma.A0(this.pI);ma.vW(this.hC)})}dispose(){this.$&&(this.m3d&&this.$.pa&&0<this.Ndb.count&&this.$.pa.Uu(this.lj),this.n3d&&(this.o6d("Dispose"),this.$.da.kh.jEa(this.Dga)))}Fvi(){Ga.EwaSettings.Da(199)&&this.moj();this.n3d&&this.noj()}cwi(){this.AMb=this.BMb;this.XEd=0;var E={};if(!this.Ndb){this.Ndb=new hb.a;const ma=nc.a.Znd(this.OFj,"InitSampleMeasurement",this.$);for(const Ya of ma)E[Ya.nwd]=Ya.baseUrl,
this.Ndb.add(Ya)}E=Sys.Serialization.JavaScriptSerializer.serialize(E);R.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.BMb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.AMb}, testParams: ${E} `);0<this.Ndb.count&&this.$.pa.Ht(this.lj)}M5j(){for(let E of this.Ndb)E.runTest()}S5d(E){this.TXa&&this.TXa.Go||(R.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${E}`),this.TXa=
Ob.a.instance.pF(this.oNj,5E3,Ib.a.J3j),this.TXa.WP())}o6d(E){this.TXa&&this.TXa.Go&&(R.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${E}`),this.TXa.cancel())}vYj(E){return this.AMb>=this.BMb&&E-this.XEd>this.vJd}xgh(){return Dd.Uag(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}moj(){this.BMb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.vJd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const E=this.$.xa.NetworkMeasurementsSamplePercentage;
0<this.BMb&&0<this.vJd&&(this.m3d=Dd.Uag(E))&&this.cwi()}noj(){if(!this.yIc){this.yIc=new hb.a;const E=nc.a.Znd(this.cFj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[id.a.mOc]);for(const ma of E)this.yIc.add(ma);this.$.da.kh.fs&&this.S5d("PrepareAndInitSlowNetworkTests")}}static Uag(E){return 100*Math.random()<E}}Object(N.a)(Dd,"NetworkMeasurement",null,[5]);var fc=a(40),Oa=a(148),Lb=a(834);class Fc{constructor(E){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=
null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=E}get count(){return this._count}get kX(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}Jhk(){this.kX&&this.kX.Ofg()}RWg(E){this.allOfflinePartialInteractivitiesDataInSession.push(E);this._count++}}Object(N.a)(Fc,"OfflinePartialInteractivitiesDataForLog",null,[]);class Wc extends Ud{constructor(E,ma,Ya){super(E,ma,Ya);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=
null;this.timeFromLastOffline=-1;this.type=5}BUj(E){this.timeFromLastOffline=E}YQj(E){this._errorDataDuringOfflineMode=E}}Object(N.a)(Wc,"OfflinePartialInteractivityData",Ud,[]);class td{constructor(E,ma){this.BTa=this.kX=null;this.RRd=-1;this.HBb=null;this.LAf=Ba.Task.delay(0);this.Ieb=(Ya,Ub)=>{Ub.oS?this.Gcj(Ub.vsa):this.Hcj()};this.Ega=(Ya,Ub)=>{5===Ub.PXf&&this.h8a()};this.ecg=(Ya,Ub)=>{this.kX.YQj(Ub.GX)};this.h8a=()=>{this.BTa.Jhk();this.MKj(td.RPd,Sys.Serialization.JavaScriptSerializer.serialize(this.BTa))};
this.EFj=Ya=>{if(Ya=Ya.result)this.zzg=!0,R.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${Ya}`)};this.Czj=()=>{this.zzg&&(this.$?fc.TaskExtensions.ya(this.indexedDB.Bgd(td.RPd),()=>{R.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ka):R.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.FTa=()=>{if(this.BTa&&0<this.BTa.count){const Ya=Sys.Serialization.JavaScriptSerializer.serialize(this.BTa);R.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${Ya}`)}};this.$=E;this.indexedDB=ma;this.zzg=!1;this.indexedDB.Rh()&&(this.indexedDB.initialize(td.XFb,td.YFb),this.XEj(),this.BTa=
new Fc(this.$.xa.UserSessionId),gd.a(this.$).gi.x5c(this.Ieb));this.No=Oa.a.instance.XJ();this.No.la("beforeunload",this.FTa)}dispose(){this.$&&gd.a(this.$)&&gd.a(this.$).gi.lWd(this.Ieb);Xd.a.Ma(this.HBb);this.$=this.HBb=null}Gcj(E){this.kX=new Wc(Nd.a.$a.Wd,this.$,0!==E);this.kX.BUj(-1!==this.RRd?window.performance.now()-this.RRd:-1);this.BTa.RWg(this.kX);gd.a(this.$).gi.D5c(this.Ega);this.h8a();this.HBb=Ob.a.instance.pF(this.h8a,td.RXh,Ib.a.h8a);kd.a(this.$).f5c(this.ecg)}Hcj(){this.kX.ZNd(this.$);
this.h8a();Xd.a.Ma(this.HBb);this.HBb=null;this.RRd=window.performance.now();gd.a(this.$).gi.bDc(this.Ega);kd.a(this.$).TVd(this.ecg);this.dFj()}MKj(E,ma){this.$?this.LAf=fc.TaskExtensions.ya(this.LAf,()=>{this.indexedDB.pib(new Lb.a(E,ma))},this.$.ka):R.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}XEj(){const E=this.$.ka;fc.TaskExtensions.ya(fc.TaskExtensions.ya(this.indexedDB.h9a(td.RPd),this.EFj,E),
this.Czj,E)}dFj(){if(this.kX){const E=Sys.Serialization.JavaScriptSerializer.serialize(this.kX);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?We.b().gTb(560791645,0,50,Yd.offline,this.kX.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",E):R.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${E}`)}this.kX&&
this.kX.isToastShown&&qe.Health.instance.recordQosError(qd.a.Ilk,[oe.a.Jtc],!0,!1,!1,!1,null)}}td.XFb="NetworkAvailability";td.YFb="NetworkAvailabilityData";td.RPd="partialInteractivityData";td.RXh=3E3;Object(N.a)(td,"OfflineModeTelemetryManager",null,[5]);var na=a(1219);const Pa=E=>{E.isSuccess||(E=Sys.Serialization.JavaScriptSerializer.serialize(E),R.ULS.sendTraceTag(509669840,0,10,E))};class lb{constructor(E,ma){this.Kpa=this.vKd=this.OKf=null;this.$=E;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
pb.a.hh||(this.OKf=new td(E,ma));Ga.EwaSettings.Da(199)&&(this.vKd=new Dd(this.$),this.vKd.Fvi());Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&pb.a.hh||(this.Kpa=new bf.NetworkConnectionHealthChecker(this.$));this.Xlh=new He(this.$);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(E=this.$,ma=Ga.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==ma&&(new na.a(E,"1CDN",ma,Pa,"runOneCdnNetworkTest")).runTest())}dispose(){Xd.a.Ma(this.OKf);
Xd.a.Ma(this.vKd);Xd.a.Ma(this.Kpa);Xd.a.Ma(this.Xlh);this.$=null}}Object(N.a)(lb,"NetworkConnectionTelemetryManager",null,[5]);class Nb extends Ud{constructor(E,ma,Ya,Ub){super(E,ma,Ya);this.wasInteruptedByOfflineMode=!1;this.type=Ub;this.wasInteruptedByOfflineMode=!1}Ieb(){this.wasInteruptedByOfflineMode=!0}}Object(N.a)(Nb,"SilentReopenData",Ud,[]);class xc{constructor(E){this.Maa=null;this.VUf=(ma,Ya)=>{this.TUf(Ya,3)};this.fRf=(ma,Ya)=>{this.TUf(Ya,2)};this.$=E;this.gi=gd.a(this.$).gi;this.gi.zCe(this.fRf);
this.gi.i1g(this.VUf)}dispose(){this.gi.K7f(this.fRf);this.gi.GDj(this.VUf);this.Maa=this.gi=this.$=null}TUf(E,ma){E.oS?this.Maa=new Nb(Nd.a.$a.Wd,this.$,0!==E.vsa,ma):(5===E.vsa&&(this.Maa.wasInteruptedByOfflineMode=!0),3!==E.vsa&&2!==E.vsa||R.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.Maa.ZNd(this.$),2===ma?Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
We.b().hTb(571289604,0,50,Yd.offline,this.Maa.durationMs,this.Maa):R.ULS.sendTraceTag(571289604,0,50,$d.a.ye(this.Maa)):Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?We.b().hTb(542782150,0,50,Yd.WDh,this.Maa.durationMs,this.Maa):R.ULS.sendTraceTag(542782150,0,50,$d.a.ye(this.Maa)),this.Maa=null)}}Object(N.a)(xc,"SilentReopenPartialInteractivityTelemetryManager",null,[5]);let Oc=class extends ta.a{constructor(E,ma,Ya){Ya=void 0===Ya?!0:Ya;super();
this.u4=this.Kbc=this.CTa=this.hsa=this.OXa=null;this.SIf=0;this.eCc=this.fhb=this.ghb=!1;this.UIf=this.documentVisibilityObserver=null;this.Iua=!1;this.ixd=this.Taa=0;this.DIb=!1;this.nmg=0;this.d3d=!1;this.J4=null;this.QRf=()=>{R.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.Dvc(1,!1)};this.hC=()=>{this.Coa||this.RKb?window.setTimeout(()=>{this.w8d()},this.SIf):this.w8d();this.documentVisibilityObserver.hEa(this.hC);this.DIb=!1};this.kj=
()=>{R.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.RKb}, IsInDuringWorkSilentReopenMode:${this.tuc&&!this.Iua}`);this.RKb&&this.aze();this.tuc&&!this.Iua&&this.Xye();ub.h(this.$).cellTextEditBox.Pp(this.kj);this.ghb=this.fhb=!1};this.RRf=()=>{R.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.Dvc(1,!0);this.fhb&&!this.ghb&&ub.h(this.$).cellTextEditBox.Pp(this.kj);this.fhb=
!1};this.Dga=(Ub,Hc)=>{this.ixd=this.Taa;this.Taa=Hc.zKc};this.UUf=()=>{this.$&&(this.eCc||(oa.a(this.$).qT(zb.a.kUa).EZg(this.$Rf),this.$.Pm(this.kf),this.eCc=!0),this.Iua=this.bCi(),this.Dvc(2,!1))};this.$Rf=()=>{var Ub=oa.a(this.$).Pj;const Hc=Ub.c5g();Ub=Z.f(Ub.hv.ef.errors,Gd=>Gd.MessageIdName);R.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Hc}, IsB2W:${this.Iua}, Errors: ${$d.a.ye(Ub)}`);Hc&&(this.OXa?(this.Iua=
!1,this.QVe(),this.FLc()):this.hsa&&(this.RVe(),this.FLc()))};this.kf=()=>{this.$?(R.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.Iua=!1,this.u4&&this.u4.Go&&(Xd.a.Ma(this.u4),this.u4=null),this.J4&&this.J4.Go&&(Xd.a.Ma(this.J4),this.J4=null),this.Dvc(2,!0),this.FLc()):R.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.kNf=()=>{this.RHf(!0)};this.lNf=()=>{this.RHf(!1)};
this.r4b=le.OQi;this.xcd=le.connected;this.$=E;this.Ig=E.pa.Ig;Ya&&(this.UIf=new lb(E,ma));Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Gb.a.resolve(fd.K).then(Ub=>{this.documentVisibilityObserver=Ub}):this.$.ea.Zc(291,Ub=>{this.documentVisibilityObserver=Ub});this.SIf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.Ig.FCe(this.QRf);this.Ig.Vtb(this.RRf);this.Ig.VBe(this.kNf);this.Ig.mZg(this.lNf);new xc(this.$,this);this.uEf=
this.$.xa.LongInactivityTimePeriodSeconds;this.$.da.eub(this.UUf);this.$.da.kh.qwa(this.Dga);this.nmg=this.$.xa.SilentReopenDuringWorkDelayMs}get jEi(){return this.Iua}get RKb(){return!(this.r4b&1)}get tuc(){return!(this.r4b&2)}get Coa(){return!!(this.xcd&2)}dispose(){this.Ig&&(this.Ig.P7f(this.QRf),this.Ig.aRb(this.RRf),this.Ig.m7f(this.kNf),this.Ig.nBj(this.lNf));this.DIb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.hEa(this.hC),this.DIb=!1);this.$&&(this.eCc&&this.FLc(),this.$.da&&
(this.$.da.gDc(this.UUf),this.$.da.kh&&this.$.da.kh.jEa(this.Dga)));this.J4&&(this.J4.dispose(),this.J4=null);Xd.a.Ma(this.UIf);this.$=null;super.dispose()}tGf(){this.d3d=!0}Xye(){this.hsa||(this.hsa=gd.a(this.$).gi.iKa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}bCi(){if(this.d3d)return this.d3d=!1,!0;const E=this.Taa>this.uEf||this.ixd>this.uEf&&10>this.Taa;R.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Taa}, Time gap between last two activities: ${this.ixd}. return value:${E}`);
return E}TFj(){this.J4=Ob.a.instance.create(()=>{qe.Health.instance.recordQosError(qd.a.O3j,[oe.a.Jtc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}mUg(){this.hsa||this.u4?R.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.u4=Ob.a.instance.create(()=>
{this.$?this.hsa?R.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):ub.h(this.$).Xc?(this.fhb||(ub.h(this.$).cellTextEditBox.yq(this.kj),R.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.ghb=!0,R.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Xye():R.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.nmg,Ib.a.J2j,void 0,!0)}RHf(E){this.xcd=this.HKe(2,E,!0);this.JDe()}Dvc(E,ma){this.r4b=this.HKe(E,ma,!1);this.JDe()}HKe(E,ma,Ya){Ya=Ya?this.xcd:this.r4b;
return ma?Ya|E:Ya&~E}w8d(){const E=!!this.CTa,ma=!!this.OXa,Ya=!!this.hsa,Ub=!!this.Kbc;this.RKb&&!E?this.lUg():!this.RKb&&E&&this.mxh();!this.tuc||ma||Ya?this.tuc||(ma?this.QVe():(Ya||this.u4&&this.u4.Go)&&this.RVe()):this.Iua?this.kUg():this.u4||this.mUg();this.Coa&&!Ub?this.urg(!0):!this.Coa&&Ub&&this.urg(!1)}lUg(){this.$?this.CTa?R.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
ub.h(this.$).Xc?(this.ghb||(ub.h(this.$).cellTextEditBox.yq(this.kj),R.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.fhb=!0,R.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.aze():R.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}aze(){this.CTa||
(this.CTa=gd.a(this.$).gi.iKa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}mxh(){this.CTa&&(Xd.a.Ma(this.CTa),this.CTa=null)}QVe(){this.OXa&&(Xd.a.Ma(this.OXa),this.OXa=null);this.J4&&this.J4.Go&&this.J4.cancel();this.J4=null}RVe(){this.hsa&&(Xd.a.Ma(this.hsa),this.hsa=null);this.u4&&(Xd.a.Ma(this.u4),this.u4=null);this.ghb&&!this.fhb&&ub.h(this.$).cellTextEditBox.Pp(this.kj);this.ghb=!1}kUg(){this.OXa||(this.OXa=gd.a(this.$).gi.iKa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,de.a.instance.ia(2190)));this.TFj()}urg(E){E?(this.Kbc=gd.a(this.$).gi.iKa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.orj()):(Xd.a.Ma(this.Kbc),this.Kbc=null)}orj(){if(this.$&&this.$.pa){const E=this.$.pa.ua.Ud();Yc.I(this.$.pa.ua,null,null,null,E)}}FLc(){oa.a(this.$).qT(zb.a.kUa).ot(this.$Rf);this.$.Rn(this.kf);this.eCc=!1}JDe(){this.documentVisibilityObserver||R.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.Ui?this.DIb||(this.documentVisibilityObserver.vW(this.hC),this.DIb=!0,R.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.w8d()}};Oc=Object(Hd.a)([Object(Gb.d)(fd.Jb),Object(Hd.b)(0,Object(fd.R)()),Object(Hd.b)(1,Object(fd.vb)())],Oc);Object(N.a)(Oc,"NetworkConnectionStateManager",
ta.a,[744,5]);class yd extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){void Gb.a.resolve(fd.vb,{Qa:this.Na}).then(E=>{let ma=Object(ic.a)(this.$.ea,400,()=>new Oc(this.$,E));this.qd(ma)})}static la(E){E.ea.Ja(401,new yd(E))}}Object(N.a)(yd,"NetworkConnectionStateManagerFactory",Db.a,[]);var Sd=a(523),ve=a(1004);class Ee extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){this.qd(this.$.ea.Ba(5)||new ve.BusinessBarManager(this.$,!this.$.r2))}static la(E){E.ea.Ja(4,new Ee(E))}}
Object(N.a)(Ee,"BusinessBarManagerFactory",Db.a,[]);var Ue=a(86);String(ve);window.___1688279119202_closurehack=ve;var hf=a(92),Rb=a(54);class ed{constructor(E){this.KXa=!0;ed.nsf()?ed.mCi()?this.KXa=!1:ed.zsf()?(R.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!E}`),this.KXa=E):this.KXa=!1:this.KXa=!0}Xab(){return!this.KXa}static zsf(){return ed.nsf()&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)}static nsf(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static mCi(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(N.a)(ed,"LineageCatchUpExperimentManager",null,[884]);class pd extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){ed.zsf()?fc.TaskExtensions.ya(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)?Object(hf.d)(Gb.a.resolve(fd.Bb,
{Qa:this.Na})):Rb.GetServiceTaskFactory.Vc(this.$.ea,456,457,this.Na),E=>{fc.TaskExtensions.ya(E.result.oZj(),ma=>{this.ZSe(ma.result)},this.$.ka,3)},this.$.ka,3):this.ZSe(!0)}ZSe(E){this.qd(this.$.ea.Ba(458)||this.$.ea.Ja(458,new ed(E)))}static la(E){E.ea.Ja(459,new pd(E))}}Object(N.a)(pd,"LineageCatchUpExperimentManagerFactory",Db.a,[]);var ie=a(7),Ce=a(76),Pe=a(94);class lf{constructor(E,ma){this.oCd=!1;this.vh=()=>{this.ysg()};this.$=E;this.$.da.Mcb&&!lf.VEb&&(ma&&!ma.KXa||this.znk(),lf.bmf?R.ULS.sendTraceTag(537155461,
0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):ma&&!ma.KXa||this.Gnk());R.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.qVd();this.$=null;R.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){lf.VEb||(lf.VEb=!0,R.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.qVd()}Gnk(){this.$.isAnonymousUser()||
Yc.i(this.$.pa.ua,E=>{this.$?(E=E.Result,R.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${E}.`),lf.bmf=!0,E&&this.msg(0)):R.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{R.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}znk(){this.ysg()||(this.$.da.zw(this.vh),this.oCd=!0)}ysg(){return this.$.da&&this.$.da.fp&&
this.$.da.fp.ShouldTriggerLineageCalloutOnMerge?(R.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.msg(1),!0):!1}msg(E){lf.VEb?R.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(lf.VEb=!0,R.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${E}.`),this.qVd(),Ga.EwaSettings.Da(418)&&
(E=new Pe.a(-847286761,Ce.a.ld,this.$.ee,0,ie.a.P3),this.$.Ha.kd(E,{["CalloutName"]:4})))}qVd(){this.oCd&&(this.oCd=!1,this.$.da.Zx(this.vh))}}lf.VEb=!1;lf.bmf=!1;Object(N.a)(lf,"LineageTeachingCalloutTriggerManager",null,[883,5]);class nf extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){fc.TaskExtensions.ya(Rb.GetServiceTaskFactory.Vc(this.$.ea,458,459,this.Na),E=>{const ma=E.result;E=Object(ic.a)(this.$.ea,403,()=>new lf(this.$,ma));this.qd(E)},this.$.ka,3)}static la(E){E.ea.Ja(402,
new nf(E))}}Object(N.a)(nf,"LineageTeachingCalloutTriggerManagerFactory",Db.a,[]);var If=a(804),Ff=a(428);class Mf extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){const E=Rb.GetServiceTaskFactory.create(this.$.ea,102,this.$.ka,this.Na),ma=Object(Ue.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(hf.d)(Gb.a.resolve(fd.l,{Qa:this.Na})):Rb.GetServiceTaskFactory.Vc(this.$.ea,5,4,this.Na),Ya=Rb.GetServiceTaskFactory.Vc(this.$.ea,388,387,this.Na),Ub=Object(hf.d)(Gb.a.resolve(fd.tb,
{Qa:this.Na})),Hc=Rb.GetServiceTaskFactory.Vc(this.$.ea,257,258,this.Na),Gd=Ff.a(this.$);fc.TaskExtensions.ya(fc.TaskExtensions.Bf([E,Hc,Gd,ma,Ya,Ub],this.ka),()=>{this.qd(Object(ic.a)(this.$.ea,271,()=>new If.ConvertToLinkedEntityManager(this.$,E.result,Ya.result,Hc.result,Gd.result,ma.result,Ub.result)))},this.$.ka,3)}static la(E){E.ea.Ja(272,new Mf(E))}}Object(N.a)(Mf,"ConvertToLinkedEntityManagerFactory",Db.a,[]);var dc=a(249),B=a(275),fa=a(31),Na=a(260),nb=a(13),gc=a(744),bd=a(18);const Ra=bd.a.yPh;
class Tb extends dc.a{constructor(E,ma,Ya){super(E);this.gy=0;this.fv=!1;this.oe=()=>{this.Zi(!1)};this.$=ma;this.taskPaneManager=Ya;B.a(ma).Wj(this);this.$.sk(this.oe);fa.a.ff()&&(this.isVisible=!1)}yW(E){this.get_events().addHandler("EnrichmentTaskPaneRemoved",E)}yZ(E){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",E)}ZG(E){this.addHandler("EnrichmentTaskPaneVilibilityChanged",E)}AI(E){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",E)}a0g(E){this.addHandler("EnrichmentTaskPaneOnFocus",
E)}KCj(E){this.removeHandler("EnrichmentTaskPaneOnFocus",E)}get isVisible(){return super.isVisible}set isVisible(E){super.isVisible=E;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Vh(){return this.isVisible}get Tf(){return Na.a.FGh}get Jj(){return 10}get Cm(){return Ra}get IT(){return this.titleText}get titleText(){return"Enrichment"}get ks(){return 300}get isResizable(){return!1}get de(){return this.domElement}get height(){return this.taskPaneManager.vR.offsetHeight}get KC(){return this.taskPaneManager.gza(this.de,
this.titleText,this.ks,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.ks)}$s(){return this.fv}Xv(){return this.fv}aZ(){}dispose(){this.$&&this.$.Ym(this.oe);this.taskPaneManager=this.$=null;super.dispose()}$h(E,ma){ma||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!ma}nj(E){return nb.DOMElementExtensions.Eh(this.de,E)}Vk(){}yl(){}Zi(E){this.fv=E;const ma=this.taskPaneManager;this.isVisible=E;fa.a.ff()?E?this.taskPaneManager.w$("EnrichmentTaskPane",
this.KC):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(E&&0<ma.sG.length&&(!ma.Dj||10!==ma.Dj.taskPane.Jj||ma.isCollapsed)&&ma.lL(this,!0),ma.tE());E||(ub.h(this.$).$h(!0,!1),this.$.fh())}nY(){return!1}static la(E,ma){var Ya=E.Ad;let Ub=document.getElementById(Ya+ie.a.v0e);Ub||(Ub=gc.a("div",E.Ad+ie.a.v0e,"cui-taskpane"),fa.a.ff()||(Ya=document.getElementById(Ya+ie.a.tU),void 0!==Ya&&null!==Ya?Ya.appendChild(Ub):R.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${E.xK}`)));
Ya=E.ea;return Ya.Ba(257)||Ya.Ja(257,new Tb(Ub,E,ma))}}Object(N.a)(Tb,"EnrichmentTaskPane",dc.a,[890,5,317,33]);class qc extends Db.a{constructor(E){super();this.mj=this.rk=null;this.$=E;this.Md()}get eG(){this.rk||(this.rk=fc.TaskExtensions.ya(Ff.a(this.$),E=>{this.mj=Tb.la(this.$,E.result)},this.ka,3));return this.rk}create(){const E=Rb.GetServiceTaskFactory.create(this.$.ea,203,this.ka,this.Na),ma=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(hf.d)(Gb.a.resolve(fd.w,
{Qa:this.Na})):Rb.GetServiceTaskFactory.create(this.$.ea,155,this.ka,this.Na);fc.TaskExtensions.ya(fc.TaskExtensions.ts(fc.TaskExtensions.Bf([E,ma],this.ka),()=>this.eG,this.ka),()=>{this.qd(this.mj)},this.ka,3)}dispose(){this.mj=this.rk=this.$=null;super.dispose()}static la(E){E.ea.Ja(258,new qc(E))}}Object(N.a)(qc,"EnrichmentTaskPaneFactory",Db.a,[]);var hd=a(1245),Vd=a(192);class Be{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=
this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(N.a)(Be,"TaskPaneGroupAppProps",null,[]);var Qe=a(226);class cf{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(N.a)(cf,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var wb=a(306),zc=a(23),rd=a(20),ce=a(12);class Me{constructor(E){this.width=E}}Object(N.a)(Me,"ActiveTaskPaneData",null,
[]);class ra extends ta.a{constructor(E,ma){super();this.isVisible=!1;this.B7d=this.gia=-1;this.GWe=40;this.Dj=this.wR=this.animationManager=this.RRc=null;this.dNd=()=>{this.q$f()};this.$Jc=new Set;this.$Jc.add("FieldListTaskPane");this.$Jc.add("PivotTableSettingsTaskPane");this.$Jc.add("SlicerSettingsTaskPane");this.dd=ma;B.a(this.$).Wj(this);this.JC=E;this.Adb=this.iah();fa.a.ll()||V.AFrameworkApplication.sa.Sa.$g||(this.JC.style.bottom=this.$.sf&4?ce.HelperMethods.De(this.$.cia):"0");this.uhc=
{};this.gWb={};this.vee={};this.y7d=Oa.a.instance.Zf(this.de);this.y7d.la("focusin",this.dNd);this.xyi()}get $(){return this.dd}get tka(){return this.vee}get sP(){return this.RRc}get isCollapsed(){return!this.sP}dispose(){B.a(this.$).TA(this);const E=this.uhc;for(let ma in E)({key:ma,value:E[ma]}).value();this.gWb=this.vee=this.uhc=null;this.y7d.zH();this.Adb=this.JC=this.y7d=null;super.dispose()}gza(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf,wg,Ig,Jh,Bh){af=void 0===af?ra.kQi:af;xf=void 0===xf?ra.jQi:xf;wg=void 0===
wg?null:wg;Ig=void 0===Ig?null:Ig;Jh=void 0===Jh?!1:Jh;Bh=void 0===Bh?!1:Bh;const Wh=Object(zd.a)(new cf,{getContent:()=>E});Wh.isSharedRuntime=Jh;return Object(zd.a)(new hd.a,{hideHeader:Bh||!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7858326_TaskPaneReactHeader"),contentProps:Wh,title:ma,width:Ya,location:2,onOpen:Hc,onClose:Gd,onShow:he,onHide:Ke,iconUrl:wg,iconId:Ig,enableResize:Ub,minResizeWidth:af,maxResizeWidth:xf})}w$(E,ma){Vd.UISurfaces.kl().then(Ya=>{E in this.tka?Ya.setSelectedTaskPane(E):
Ya.showTaskPane(E,ma);return null})}Ycc(E,ma){Vd.UISurfaces.kl().then(Ya=>{Ya.initializeHiddenSharedRuntimeTaskPane(E,ma);const Ub=this.$.domElement;Ub.addEventListener("scroll",function Gd(){0!=Ub.scrollLeft&&(Ub.scrollLeft=0,Ub.removeEventListener("scroll",Gd))})})}updateTaskPane(E,ma){Vd.UISurfaces.kl().then(Ya=>{Ya.updateTaskPane(E,ma);return null})}setSelectedTaskPane(E){Vd.UISurfaces.kl().then(ma=>{ma.setSelectedTaskPane(E);return null})}hideTaskPane(E){Vd.UISurfaces.kl().then(ma=>{ma.hideTaskPane(E,
ra.Y8j);return null})}get de(){return this.JC}get Vh(){return this.isVisible}get Tf(){return Na.a.YJc}$h(E,ma){return ma?!1:(this.Bdg(),!0)}nj(E){return nb.DOMElementExtensions.Eh(this.de,E)}Vk(){this.$.frame.Cg.gm(this.Tf)}yl(){}iah(){const E=document.createElement(Qe.a.div);E.style.height="0px";E.style.width="0px";E.tabIndex=-1;return E}O1h(){var E=nb.DOMElementExtensions.getElementById(this.JC,"tabStripFocusZone");if(E){E=E.getElementsByTagName("button");for(let ma=0;ma<E.length;ma++)if(Boolean.parse(E[ma].getAttribute("aria-selected")))return E[ma].getAttribute("aria-controls")}return null}ilh(E){return(E=
window.getComputedStyle(E,null).getPropertyValue("transition-duration"))?parseInt(E.endsWith("ms")?parseFloat(E):1E3*parseFloat(E),10):0}mxj(){const E=document.getElementById("tabbedTaskPaneContainer");E&&E.addEventListener("transitionend",()=>this.LLa(-1))}xyi(){Vd.UISurfaces.kl().then(E=>{let ma=new Be;ma.middleContainer=this.Adb;ma.onOpen=(Ya,Ub)=>{this.isVisible=!0;-1===this.gia&&(this.gia=this.ilh(Ub));fa.a.ll()||(this.tka[Ya]=new Me(nb.DOMElementExtensions.LS(nb.DOMElementExtensions.getElementById(Ub,
ra.Vpg))))};ma.onClose=Ya=>{this.isVisible=0<E.selectors.getTabbedTaskPaneCount();R.ULS.sendTraceTag(537014371,0,50,`Closing of ${Ya} TaskPane`);if(!this.isVisible)this.T8e(),fa.a.ll()||V.AFrameworkApplication.sa.Sa.$g||window.requestAnimationFrame(()=>{this.b8b(this.Adb)});else if(!fa.a.ll()&&this.sP&&this.sP!==Ya){const Ub=1<E.selectors.getTabbedTaskPaneCount()?this.Alc():0,Hc=1===E.selectors.getTabbedTaskPaneCount()?-1*this.Alc():0;this.EDe(Ya,this.sP,Ub,Hc)}fa.a.ll()?this.LLa(this.gia):(V.AFrameworkApplication.sa.Sa.$g&&
0>=this.gia&&this.LLa(this.gia),delete this.tka[Ya]);delete this.gWb[Ya]};ma.onShow=(Ya,Ub)=>{null!=this.Xj&&(this.Xj.stop(),this.Xj=null);this.RRc=Ya;this.q$f();1!==Ub&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.NJj()},0)});fa.a.ll()?window.requestAnimationFrame(()=>{this.LLa(this.gia)}):V.AFrameworkApplication.sa.Sa.$g&&0>=this.gia?window.requestAnimationFrame(()=>{this.LLa(this.gia)}):window.requestAnimationFrame(()=>{this.jLj(this.Adb,this.gia)})};ma.onHide=(Ya,Ub,Hc)=>{const Gd=
this.O1h();Gd!==Ya&&(this.Xj=this.$.Jd.Le("UserAction","TaskPaneToggle"),R.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Ya} to ${Gd}`));Hc?fa.a.ll()||this.b8b(this.Adb):!fa.a.ll()&&Gd&&(Ya=1===Object.keys(this.tka).length?this.Alc():0,this.EDe(this.sP,Gd,this.Alc(),Ya));this.RRc=null;Hc&&1!==Ub&&this.T8e();fa.a.ll()&&window.requestAnimationFrame(()=>{this.LLa(this.gia)})};ma.setFocusCallback=(Ya,Ub)=>{Ub&&(this.gWb[Ya]=Ub)};ma.onResizeStart=()=>{fa.a.ll()||this.j6c(ce.HelperMethods.De(0))};
ma.onResizeEnd=()=>{fa.a.ll()?this.LLa():(this.b8b(this.Adb),this.tka[this.sP]=this.atd(this.sP));R.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.sP} TaskPane`)};E.renderTaskPaneGroups(null,this.JC,ma);V.AFrameworkApplication.sa.Sa.$g&&!fa.a.ll()&&this.mxj();return null})}b8b(E){this.j6c(this.$.isChromeRtl?E.style.left:E.style.right)}j6c(E){R.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.sP}`);this.$.IGj(E)}LLa(E){E=void 0===E?0:E;-1<E?Ba.Task.delay(E+this.GWe).continueWith(()=>
{this.$.PDa(wb.a.W1("ResetContentAreaMargin"))}):this.$.PDa(wb.a.W1("ResetContentAreaMargin"))}EDe(E,ma,Ya,Ub){ma=ma.endsWith(ra.z7d)?ma.substring(0,ma.length-ra.z7d.length):ma;ma=this.Bjf(ma);Ub=ma+Ub;E=this.Bjf(E);Ub<E&&this.j6c(ce.HelperMethods.De(ma+Ya))}jLj(E,ma){window.setTimeout(()=>{this.b8b(E)},ma+this.GWe)}Alc(){return-1!==this.B7d?this.B7d:this.B7d=nb.DOMElementExtensions.LS(nb.DOMElementExtensions.getElementById(this.JC,"tabStripFocusZone"))}atd(E){return nb.DOMElementExtensions.LS(nb.DOMElementExtensions.getElementById(nb.DOMElementExtensions.getElementById(this.JC,
E+ra.z7d),ra.Vpg))}Bjf(E){if(E in this.tka){const ma=this.tka[E].width;return 0<ma?ma:this.atd(E)}return E?this.atd(E):0}T8e(){ub.h(this.$).setFocus()}NJj(){if(this.gWb[this.sP]){const E=this.gWb[this.sP];E&&E(null,null)}else this.$Jc.has(this.sP)||this.Bdg()}Bdg(){Vd.UISurfaces.kl().then(E=>{1<E.selectors.getTabbedTaskPaneCount()?E.focusTabbedTaskPaneArea():(E=nb.DOMElementExtensions.getElementById(this.de,"AgaveTaskpaneCloseButtonId"))?E.focus():(E=nb.DOMElementExtensions.Jn(this.de.querySelectorAll("button")))&&
E.focus();return null})}q$f(){this.$.domElement.scrollLeft=0;pb.a.rBa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}ZG(E){this.addHandler(ra.cmb,E)}AI(E){this.removeHandler(ra.cmb,E)}get vR(){return this.JC}get sG(){R.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}gyb(E,ma,Ya,Ub,Hc){let Gd=E.Ba(ma);Gd||(Gd=rd.a(zc.a,Ya,E,ma),Gd.SetScriptLoadFlavor(Hc));
Ub&&Gd.Z4c(Ub);const he=""+ma;let Ke=null;const af=()=>{Gd.create();Ke()};this.uhc[he]=Ke=()=>{Gd.MCc(af);delete this.uhc[he]};Gd.s7b(af)}initialize(){R.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}clg(){}KT(){R.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}lL(){R.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}qBe(){R.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}M9f(){R.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}H9a(){R.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Eod(){R.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}Gma(){R.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}tE(){R.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){R.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}N0d(){R.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(E){const ma=
ra.gbh(E.Ad,E.isChromeRtl);ra.H6g(E,ma);return new ra(ma,E)}static gbh(E,ma){const Ya=document.createElement("div");Ya.id=E+ie.a.ZJc;fa.a.ll()?Ya.classList.add(bd.a.rok):(Ya.classList.add(ma?bd.a.tok:bd.a.sok),V.AFrameworkApplication.sa.Sa.$g&&Ya.classList.add(bd.a.ZDa));return Ya}static H6g(E,ma){E.isMobileMode&&ma.setAttribute("aria-hidden","true");if(V.AFrameworkApplication.sa.Sa.$g){let Ya;(Ya=document.getElementById("FarPaneRegion"))?Ya.appendChild(ma):R.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||
fa.a.ll()&&ma.classList.add(bd.a.eJh),document.getElementById(E.Ad+ie.a.o5a).insertBefore(ma,E.sFa)}}ra.kQi=300;ra.jQi=950;ra.Y8j=2;ra.z7d="-panel";ra.Vpg="ExcelTaskPaneContentWrapper";ra.smg="rtpSizeChanged";ra.tPe="rtpCollapsed";ra.zXf="rtpAdded";ra.cmb="rtpVisibility";Object(N.a)(ra,"ReactTaskPaneManager",ta.a,[891,33,5]);var sb=a(175),uc=a(14),od=a(250),Ld=a(117),ue=a(235),Xe=a(103),re=a(775),Gf=a(568),Vf=a(57);class pf extends Sys.EventArgs{constructor(){super()}}Object(N.a)(pf,"TaskPaneVisibilityChangedEventArgs",
Sys.EventArgs,[]);var tf=a(49),ag=a(93);const Wf=re.a.eMh,vg=re.a.gMh,Nf=`<span class='${bd.a.Yac} ${re.a.hMh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class Rg extends dc.a{constructor(E){super(document.createElement("a"));this.Ua=new ta.a;this.Od=this.Pwe=null;this.We=()=>{this.enabled&&this.Ua.raiseEvent("tpButtonClicked",null,this);return!0};this.Od=E}UYg(E){this.Ua.addHandler("tpButtonClicked",E)}e7f(E){this.Ua.removeHandler("tpButtonClicked",E)}get F4a(){return this.domElement}get taskPane(){return this.Pwe}get enabled(){return super.enabled}set enabled(E){E!==
super.enabled&&(this.domElement.classList.toggle(re.a.gX),this.domElement.classList.toggle(vg),this.domElement.tabIndex=E?0:-1,super.enabled=E)}get nr(){return this.domElement.firstChild.firstChild}dispose(){Xd.a.te([this.Ua]);this.Ua=null;this.domElement&&tf.a.Xqa(this.domElement);super.dispose()}wyi(E){const ma=6===E.Jj;var Ya=ma&&!E.Cm;Ya=String.format(Nf,E.IT,E.Cm,Ya?Vf.a.current.gq(100):Vf.a.di(10),re.a.$la,Ya?String.format('style="width:24px;{0}:0px"',"left"):"");this.Od.Ij(this.domElement,
Ya);this.domElement.classList.add(Wf);this.domElement.classList.add(vg);this.domElement.title=E.IT;this.domElement.tabIndex=0;nb.DOMElementExtensions.wz(this.domElement,ie.a.zv,null,null);this.Pwe=E;ma&&(E=this.taskPane,null===E||void 0===E?void 0:E.Dvg());ue.a.instance.ta(uc.a.click,this.domElement,this.We);Ld.KeyInputManager.instance.ew(this.domElement,this.We,ag.a.Yj)}}Object(N.a)(Rg,"TaskPaneButton",dc.a,[963]);class Tf extends Xe.a{constructor(E,ma,Ya,Ub){super(E);this.animationManager=this.G9=
this.Dg=null;this.FO=this.h_a=!1;this.Ehe=0;this.dd=null;this.PVc=!1;this.Od=null;this.lC=()=>{this.fGi||(this.tE(),this.$.fh())};this.mMd=(Hc,Gd)=>{this.onButtonClick(Hc,Gd)};this.JCa=()=>{this.TLc()};this.$=ma;this.Od=Ub;B.a(this.$).Wj(this);this.$.Gd.Fi(this.JCa);this.configuration=Ya;this.baseName=ce.HelperMethods.Iza(this.domElement,this.configuration.Ypg||this.configuration.E4);this.thc={};this.pkb=[];this.xw=[];this.bwb={};this.Qwe=document.getElementById(this.baseName+this.configuration.x7d);
this.vR||R.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.x7d} not found`);this.URg=document.getElementById(this.baseName+this.configuration.E4);this.JC||R.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.E4} not found`);this.VRg=document.getElementById(this.baseName+this.configuration.D8d);this.wR||R.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+
this.configuration.D8d} not found`);E=String.format(Tf.Z8j,this.baseName+this.configuration.Krg,this.baseName+Tf.fWb);this.Od.Ij(this.wR,E);this.Sfe=document.getElementById(this.baseName+Tf.fWb);this.hKe||R.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Tf.fWb} not found`);(this.awb=document.getElementById(this.baseName+Tf.fWb))||R.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Tf.fWb} not found`);this.hHg=
this.uTe(this.configuration.rPe,this.oPe);this.gHg=this.JSe(this.configuration.pPe,de.a.instance.ia(1297),this.fmi,this.u5a,!0);this.iJg=this.uTe(this.configuration.e6e,this.gTh);this.hJg=this.JSe(this.configuration.c6e,de.a.instance.ia(1296),this.gmi,this.kOa,!1);nb.DOMElementExtensions.setVisible(this.kOa,!1);ue.a.instance.ta(uc.a.click,this.t5a,Object(ha.a)(this,this.Vwc,"onCollapseIconClicked"));ue.a.instance.ta(uc.a.click,this.jOa,Object(ha.a)(this,this.mxc,"onExpandIconClicked"));ue.a.instance.ta(uc.a.click,
this.u5a,Object(ha.a)(this,this.Vwc,"onCollapseIconClicked"));ue.a.instance.ta(uc.a.click,this.kOa,Object(ha.a)(this,this.mxc,"onExpandIconClicked"));Ld.KeyInputManager.instance.ta(uc.a.Rd,this.t5a,Object(ha.a)(this,this.SMf,"onCollapseIconKeyDown"));Ld.KeyInputManager.instance.ta(uc.a.Rd,this.jOa,Object(ha.a)(this,this.xOf,"onExpandIconKeyDown"))}ZG(E){this.addHandler(Tf.cmb,E);E(this,new pf(this.isVisible,nb.DOMElementExtensions.isVisible(this.wR)))}AI(E){this.removeHandler(Tf.cmb,E)}get wR(){return this.VRg}get de(){return this.wR}get Vh(){return this.h_a}set Vh(E){this.h_a=
E}get JC(){return this.URg}get Tf(){return Na.a.o2i}get vR(){return this.Qwe}get sG(){return this.xw}get Dj(){return this.Dg}get sP(){return null}get tka(){return null}get isCollapsed(){return this.FO}get sfd(){return this.Ehe}get $(){return this.dd}set $(E){this.dd=E}get hKe(){return this.Sfe}get t5a(){return this.gHg}get jOa(){return this.hJg}get u5a(){return this.hHg}get kOa(){return this.iJg}get fGi(){return this.PVc}get gmi(){return this.configuration.qPe}get fmi(){return this.configuration.d6e}gyb(E,
ma,Ya,Ub,Hc){let Gd=E.Ba(ma);Gd||(Gd=rd.a(zc.a,Ya,E,ma),Gd.SetScriptLoadFlavor(Hc));Ub&&Gd.Z4c(Ub);const he=""+ma;he in this.thc||Gd.M7b((xf,wg)=>{this.o$(wg)});let Ke=null;const af=()=>{Gd.create();Ke()};this.thc[he]=Ke=()=>{Gd.MCc(af);delete this.thc[he]};Gd.s7b(af)}dispose(){if(this.xw)for(let ma=0,Ya=this.xw.length;ma<Ya;ma++)this.xw[ma].e7f(this.mMd),this.xw[ma].dispose();const E=this.thc;for(let ma in E)({key:ma,value:E[ma]}).value();this.$.da&&this.$.Gd&&this.$.Gd.hj(this.JCa);this.awb=this.Sfe=
this.Qwe=this.Dg=this.bwb=this.pkb=this.xw=null;ue.a.instance.Aa(uc.a.click,this.t5a,Object(ha.a)(this,this.Vwc,"onCollapseIconClicked"));ue.a.instance.Aa(uc.a.click,this.jOa,Object(ha.a)(this,this.mxc,"onExpandIconClicked"));ue.a.instance.Aa(uc.a.click,this.u5a,Object(ha.a)(this,this.Vwc,"onCollapseIconClicked"));ue.a.instance.Aa(uc.a.click,this.kOa,Object(ha.a)(this,this.mxc,"onExpandIconClicked"));Ld.KeyInputManager.instance.Aa(uc.a.Rd,this.t5a,Object(ha.a)(this,this.SMf,"onCollapseIconKeyDown"));
Ld.KeyInputManager.instance.Aa(uc.a.Rd,this.jOa,Object(ha.a)(this,this.xOf,"onExpandIconKeyDown"));super.dispose()}$h(E,ma){if(ma)return!1;this.Dg&&!this.isCollapsed?(E=this.Dj.taskPane,E.Vh&&E.$h(!0,!1)||nb.DOMElementExtensions.setFocus(this.Dj.F4a)):nb.DOMElementExtensions.setFocus(this.jOa);return!0}nj(E){return this.isVisible?nb.DOMElementExtensions.Eh(this.domElement,E)||nb.DOMElementExtensions.Eh(this.domElement,nb.DOMElementExtensions.lDb(E)):!1}Vk(){}yl(){this.Dg&&this.Dg.taskPane.yl()}setFocusOnToolbarFirstElement(){this.isCollapsed?
nb.DOMElementExtensions.setFocus(this.jOa):nb.DOMElementExtensions.setFocus(this.t5a)}N0d(){for(let E=this.xw.length-1;0<=E;E--)if(this.xw[E].isVisible){nb.DOMElementExtensions.setFocus(this.xw[E].F4a);return}this.setFocusOnToolbarFirstElement()}H9a(E){const ma=[];for(let Ya=this.xw.length-1;0<=Ya;Ya--)this.xw[Ya].taskPane.Jj===E&&ma.push(this.xw[Ya].taskPane);return ma}Eod(E){const ma=[];for(let Ya=0;Ya<this.xw.length;Ya++)this.xw[Ya].taskPane.Jj===E&&ma.push(this.xw[Ya]);return ma}qBe(E){if(E){let ma;
const Ya=Object(Za.a)(281,E);Ya?(ma=new Rg(this.Od),ma.domElement.id=this.baseName+"bt_"+E.Jj.toString()+"_"+E.Lg.InstanceId,this.awb.appendChild(ma.domElement),this.bwb["6"]=ma,Ya.button=ma):ma=this.bwb[E.Jj.toString()];ma.wyi(E);ma.UYg(this.mMd);ma.isVisible=E.$s();ma.enabled=E.Xv();this.pkb.push(E);this.xw.push(ma);Tf.p_i(E,this.vR);this.VGh(ma);this.TLc()}}lL(E,ma){let Ya;for(const Ub of this.xw)Ya=Ub.taskPane,Ya.Jj===E.Jj&&Ya==E&&this.nac(Ub,ma)}gza(){R.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");
return null}w$(){R.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}Ycc(){R.ULS.shipAssertTag(512291712,11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){R.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){R.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){R.ULS.shipAssertTag(512291681,
11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}clg(E,ma){E?(this.PVc=!0,this.E1d(!1)):(this.PVc=!1,this.E1d(!0),ma&&(this.tE(),this.$.fh()))}KT(E){if(!this.pkb.includes(E)){let Ya=null;Ya=()=>{this.vAj(E);E.yZ(Ya)};E.yW(Ya);this.qBe(E);var ma=Object(Za.a)(776,E);ma&&(ma.ZG(this.lC),this.lC(ma,Sys.EventArgs.Empty));if(ma=Object(Za.a)(147,E))ma.ZG(this.lC),this.lC(ma,Sys.EventArgs.Empty);if(ma=Object(Za.a)(421,E))ma.ZG(this.lC),this.lC(ma,Sys.EventArgs.Empty);this.raiseEvent(Tf.zXf,
null,E);this.tE()}}nac(E,ma){if(E.taskPane.Xv()&&E.taskPane.$s()){if(this.Dg){this.Dg.domElement.classList.remove(Tf.atb);this.Dg.taskPane.isVisible=!1;if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Ya=Object(Za.a)(281,this.Dg.taskPane);Ya&&Ya.tl.AVd(Ya.Lg.InstanceId)}this.G9=this.Dg}this.Dg=E;this.Dg.taskPane.isVisible=!0;this.Dg.domElement.classList.add(Tf.atb);ma&&this.Gma(!1,!1);this.Llb()}}onButtonClick(E){let ma=!1;if(this.Dg!==E){ma=!0;const Ya=E.taskPane.de;
this.animationManager.Moj(Ya);if(this.Dg){if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Ub=Object(Za.a)(281,this.Dg.taskPane);Ub&&Ub.tl.AVd(Ub.Lg.InstanceId)}this.Dg.taskPane.isVisible=!1;this.Dg.domElement.classList.remove(Tf.atb)}this.G9=this.Dg;this.Dg=E;this.Dg.domElement.classList.add(Tf.atb);this.Dg.taskPane.isVisible=!0;this.Llb();this.animationManager.$Sh(Ya)}this.Gma(!(this.isCollapsed||ma),!1)}Llb(){const E=this.sfd;let ma=0;this.Dg&&(ma=this.Dg.taskPane.gy?
this.Dg.taskPane.gy:this.Dg.taskPane.ks);ma!==E&&(this.Ehe=ma,this.isCollapsed||(this.animationManager&&this.Dg?this.animationManager.u8b(this.JC,E,ma,this.Dj.taskPane):this.JC.style.width=ce.HelperMethods.De(ma)),this.ZVa(),this.raiseEvent(Tf.smg,null,this))}pP(E){const ma=new Rg(this.Od);ma.isVisible=!1;ma.domElement.id=this.baseName+"bt_"+E.toString();this.awb.appendChild(ma.domElement);this.bwb[E.toString()]=ma}TLc(){if(void 0!==this.xw&&null!==this.xw){void 0===this.Dg||null===this.Dg||this.Dg.taskPane.Xv()||
(this.Dg.domElement.classList.remove(Tf.atb),this.Dg.taskPane.isVisible=!1,this.Dg.taskPane.$s()&&(this.G9=this.Dg),this.Dg=null);var E=null;for(let ma=0;ma<this.xw.length;ma++)if(this.pkb[ma].$s()){const Ya=this.pkb[ma].Xv();(this.xw[ma].enabled=Ya)&&!E&&(E=this.xw[ma])}void 0!==this.Dg&&null!==this.Dg||!E||(void 0!==this.G9&&null!==this.G9&&this.G9.taskPane.Xv()&&this.G9.taskPane.$s()?this.nac(this.G9,!1):this.nac(E,!1));void 0!==Gf.a(this.$)&&null!==Gf.a(this.$)&&Gf.a(this.$).isVisible&&void 0!==
this.Dg&&null!==this.Dg&&1!==this.Dg.taskPane.Jj&&(Gf.a(this.$).isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&7!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(52),null===E||void 0===E?0:E.isVisible)&&(E.isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&8!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(233))&&(E.isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&9!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(248))&&(E.isVisible=!1);Ga.EwaSettings.Da(264)&&void 0!==this.Dg&&null!==this.Dg&&12!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(302))&&
(E.isVisible=!1);Ga.EwaSettings.Da(418)&&void 0!==this.Dg&&null!==this.Dg&&15!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(365))&&(E.isVisible=!1);fa.a.hEd(this.$)&&void 0!==this.Dg&&null!==this.Dg&&13!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(334))&&(E.isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&14!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(346))&&(E.isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&16!==this.Dg.taskPane.Jj&&(E=this.$.ea.Ba(371))&&(E.isVisible=!1);void 0!==this.Dg&&null!==this.Dg&&17!==this.Dg.taskPane.Jj&&
(E=this.$.ea.Ba(408))&&(E.isVisible=!1);this.Llb()}}GVh(E,ma){nb.DOMElementExtensions.setVisible(this.u5a,!E);nb.DOMElementExtensions.setVisible(this.kOa,E);E&&this.raiseEvent(Tf.tPe,null,this);this.Llb();ma&&nb.DOMElementExtensions.setFocus(E?this.jOa:this.t5a)}tmc(E,ma){this.$.Fe(E,ma,26,null)}o$(E){E.hR&&this.KT(E.hR)}vAj(E){if(E){const ma=this.xw.length;let Ya=!1;for(let Ub=0;Ub<ma;Ub++){const Hc=this.xw[Ub];if(Hc.taskPane===E){this.awb.removeChild(Hc.F4a);delete this.bwb[E.Jj.toString()];Array.remove(this.pkb,
E);Array.remove(this.xw,Hc);Hc.e7f(this.mMd);Hc.taskPane.de.parentNode.removeChild(Hc.taskPane.de);this.Dg&&this.Dg.taskPane===Hc.taskPane&&(this.Dg=null);this.G9&&this.G9.taskPane===Hc.taskPane&&(this.G9=null);Ya=!0;break}}Ya&&this.TLc()}}VGh(E){const ma=E.taskPane.Jj,Ya=!!this.Dg&&1===this.Dg.taskPane.Jj;(1===ma||!Ya&&2===ma)&&this.nac(E,!1)}static p_i(E,ma){const Ya=E.de;Ya.parentNode&&Ya.parentNode.removeChild(Ya);ma.appendChild(Ya);E.isVisible=!1}JSe(E,ma,Ya,Ub,Hc){const Gd=document.createElement("a");
Gd.setAttribute(ie.a.IW,Hc?ie.a.jm:ie.a.Jt);Gd.setAttribute(ie.a.wf,ie.a.zv);Gd.tabIndex=0;Gd.classList.add(bd.a.nH);Gd.classList.add(E);Gd.classList.add(re.a.dMh);E=String.format(Tf.Ygh,ma,Ya,Vf.a.di(10));this.Od.Ij(Gd,E);Ub.appendChild(Gd);return Gd}}Tf.cmb="tpVisibility";Tf.Z8j=`<div id='{0}' class='${re.a.jMh}'><div id='{1}' class='${re.a.iMh}'></div></div>`;Tf.Ygh="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Tf.fWb="novTaskpaneButtonGroup";Tf.atb=re.a.fMh;Tf.smg="tpSizeChanged";Tf.tPe=
"tpCollapsed";Tf.zXf="tpAdded";Object(N.a)(Tf,"TaskPaneControl",Xe.a,[891,33,5]);var yh=a(53),l=a(461),ba=a(751);class Fa{constructor(){this.d6e=this.qPe=this.c6e=this.pPe=this.e6e=this.rPe=this.Krg=this.D8d=this.x7d=this.E4=this.Ypg=null}}Object(N.a)(Fa,"Configuration",null,[]);a(442);var db=a(309);class Yb extends db.a{constructor(E){super(5,E)}}Object(N.a)(Yb,"ResizeAnimationEvent",db.a,[]);var Cc=a(484),ad=a(603),cd=a(106);class ae{constructor(E,ma){this.Zpg=null;this.$=ma;this.taskPane=E}PSh(){this.Zpg=
nb.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Ad+ie.a.pLd);const E=ae.Sed(this.taskPane),ma=ae.Sed(this.Zpg),Ya=ad.a(cd.a.Ln);Ya.animate(E,ie.a.XGc);Ya.animate(ma,ie.a.XGc)}Moj(E){E.style.opacity="0"}$Sh(E){ad.a(cd.a.Ln).animate(ae.Sed(E),ie.a.XGc)}u8b(E,ma,Ya,Ub){ma||(Ub.isVisible=!0);this.$.ZVa(Ya);ad.a(cd.a.Ln).animate(ae.duh(E,ma,Ya),ie.a.XGc,null,null,()=>{this.$.pEa();Ya||1===Ub.Jj||(Ub.isVisible=!1);Ub.aZ(Ya<ma)})}static duh(E,ma,Ya){E=new Yb(E);E.v3g(ma,Ya);return E}static Sed(E){E=
new Cc.a(E);E.XO(0,1);return E}}Object(N.a)(ae,"TaskPaneAnimationManager",null,[915]);const se=`<div id="{0}" class="${re.a.nMh}" runat="server"></div></div><div id="{1}" class="${re.a.mMh} ${re.a.Hy}" runat="server"></div>`,ze=`<button type="button" id="{0}" class="${re.a.kMh}"></button><span><div id="{1}" class="${re.a.lMh}"></div></span>`,of=re.a.YLh;class mf extends Tf{constructor(E,ma,Ya,Ub){super(E,Ya,mf.Yph(),Ub);this.xzc=null;this.ADd=!1;this.eV=null;this.Scj=Hc=>{var Gd=!1;if(9===Hc.Ca.keyCode){Gd=
this.Dj.taskPane.nY(Hc,this.wR);if(!Gd){Gd=this.$.ea.Ba(52);var he=this.domElement.querySelectorAll(this.Dj.taskPane===Gd?Gd.Us:l.a.Jjj);Gd=nb.DOMElementExtensions.Jn(he);he=nb.DOMElementExtensions.BD(he);Gd=nb.DOMElementExtensions.TEa(Hc.Ca,Gd,he)}return Gd}he=fb.FocusManager.instance().Zj;if(null===he||void 0===he?0:he.jQ)return Gd;27===Hc.Ca.keyCode&&this.Dj.taskPane.Zi(!1);return Gd};this.kf=()=>{this.wR.style.bottom=this.JC.style.bottom=this.$.sf&4&&!V.AFrameworkApplication.sa.Sa.$g?ce.HelperMethods.De(this.$.cia):
"0";this.tE()};this.mTf=Hc=>{Object(Gc.a)(281,this.Dj.taskPane)&&(this.Dj.taskPane.PKa.firstChild.style[ie.a.pointerEvents]="none");this.ADd=!0;this.eV=this.zDb(Hc.clientPoint);sb.a.instance.ta(uc.a.xi,this.domElement.ownerDocument.body,this.oyc);sb.a.instance.ta(uc.a.hg,this.domElement.ownerDocument.body,this.pyc);od.a.instance.ta(uc.a.vn,this.domElement.ownerDocument.body,this.oyc);od.a.instance.ta(uc.a.ri,this.domElement.ownerDocument.body,this.pyc);return!0};this.pyc=()=>{Object(Gc.a)(281,this.Dj.taskPane)&&
(this.Dj.taskPane.PKa.firstChild.style[ie.a.pointerEvents]="");this.ADd=!1;sb.a.instance.Aa(uc.a.xi,this.domElement.ownerDocument.body,this.oyc);sb.a.instance.Aa(uc.a.hg,this.domElement.ownerDocument.body,this.pyc);od.a.instance.Aa(uc.a.vn,this.domElement.ownerDocument.body,this.oyc);od.a.instance.Aa(uc.a.ri,this.domElement.ownerDocument.body,this.pyc);return!0};this.oyc=Hc=>{this.ADd&&(Hc=this.zDb(Hc.clientPoint),Hc=ba.a.yL(Hc,this.eV),this.JEe(Hc.x));return!0};this.Zdj=Hc=>{void 0!==Hc.Ca&&null!==
Hc.Ca&&(9===Hc.Ca.keyCode?Hc.Ca.shiftKey?(Hc=Object(Gc.a)(33,this.Dj.taskPane)?this.Dj.taskPane:null)&&Hc.$h(!1,!1):this.setFocusOnToolbarFirstElement():37!==Hc.Ca.keyCode&&39!==Hc.Ca.keyCode||this.JEe(37===Hc.Ca.keyCode?-20:20));return!0};this.$.domElement.classList.add(of);this.Wpg=ma;this.initialize();Ld.KeyInputManager.instance.ta(uc.a.Rd,this.domElement,this.Scj);this.hWb=nb.DOMElementExtensions.getElementById(ma.parentNode,this.$.Ad+ie.a.pwc);this.bKc=nb.DOMElementExtensions.getElementById(ma.parentNode,
this.$.Ad+ie.a.TJf);this.hWb.title=de.a.instance.ia(2233);sb.a.instance.ta(uc.a.lh,this.bKc,this.mTf);od.a.instance.ta(uc.a.pointerDown,this.bKc,this.mTf);Ld.KeyInputManager.instance.ta(uc.a.Rd,this.hWb,this.Zdj)}get Tf(){return Na.a.YJc}get oPe(){return this.wR}get gTh(){return this.oPe}Llb(){super.Llb();this.hWb&&(this.Dj&&this.Dj.taskPane.isResizable?(this.hWb.style.display="block",this.bKc.style.display="block"):(this.hWb.style.display="none",this.bKc.style.display="none"))}get QKc(){const E=
this.wR;return E&&nb.DOMElementExtensions.isVisible(E)?l.a.QKc:0}M9f(E){E&&(this.animationManager=E);this.$Fj();this.animationManager=E||new ae(this.JC,this.$);this.animationManager.PSh()}dispose(){this.xzc&&this.xzc.AI(this.lC);Gf.a(this.$)&&Gf.a(this.$).AI(this.lC);const E=this.$.ea.Ba(52);E&&E.AI(this.lC);this.$.Rn(this.kf);Xd.a.te([this.xzc]);this.xzc=null;super.dispose()}initialize(){this.M9f(null);this.pP(0);this.pP(1);this.pP(2);this.pP(7);this.pP(8);this.pP(9);this.pP(10);this.pP(17);Ga.EwaSettings.Da(264)&&
this.pP(12);Ga.EwaSettings.Da(418)&&this.pP(15);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.pP(13):fa.a.hEd(this.$)&&this.pP(13);this.pP(14);this.pP(16);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.pP(18);this.tE()}tE(){var E=0;let ma=0;for(let Ya=this.sG.length-1;0<=Ya;Ya--){const Ub=this.sG[Ya].taskPane.$s(),Hc=this.sG[Ya].taskPane;if(this.sG[Ya].isVisible=Ub)ma++,(1!==Hc.Jj&&(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||
7!==Hc.Jj)&&14!==Hc.Jj&&16!==Hc.Jj||Hc.Xv())&&E++}E=0<E;nb.DOMElementExtensions.setVisible(this.wR,E);this.E1d(E);nb.DOMElementExtensions.setVisible(this.kOa,E&&this.isCollapsed);nb.DOMElementExtensions.setVisible(this.u5a,E&&!this.isCollapsed);nb.DOMElementExtensions.setVisible(this.hKe,1<ma);this.TLc()}Gma(E,ma){if(this.isCollapsed!==E){E||(this.Wpg.style.display=V.AFrameworkApplication.sa.Sa.$g?"flex":"block");var Ya=this.sfd;this.FO=!this.isCollapsed;var Ub=E?Ya:0;Ya=E?0:Ya;this.Dj&&(this.animationManager.u8b(this.JC,
Ub,Ya,this.Dj.taskPane),this.ZVa());E&&(this.Wpg.style.display="none");this.GVh(E,ma)}}E1d(E){const ma=this.isVisible!==E;this.Vh=E;nb.DOMElementExtensions.setVisible(this.domElement,E);ma&&(V.AFrameworkApplication.sa.Sa.$g&&nb.DOMElementExtensions.toggleCssClass(this.domElement,re.a.LLh,E),this.ZVa(),this.raiseEvent(Tf.cmb,new pf(E,E),this))}Vwc(E){if(E.Nd===this.u5a&&3!==E.ud)return!1;this.tmc(296943390,E.ud);this.Gma(!0,!0);return!0}mxc(E){if(E.Nd===this.kOa&&3!==E.ud)return!1;this.tmc(-625072140,
E.ud);this.Gma(!1,!0);return!0}SMf(E){return 13===E.Ca.keyCode?(this.tmc(296943390,E.ud),this.Gma(!0,!0),!0):!1}xOf(E){return 13===E.Ca.keyCode?(this.tmc(-625072140,E.ud),this.Gma(!1,!0),!0):!1}ZVa(){let E=0;this.$.sf&262144&&(E+=this.QKc,nb.DOMElementExtensions.isVisible(this.JC)&&!this.isCollapsed&&(E+=this.sfd));this.$.ZVa(E)}uTe(E,ma){const Ya=document.createElement("div");Ya.classList.add(E);ma.insertBefore(Ya,ma.firstChild);return Ya}$Fj(){const E=this.domElement;let ma=document.getElementById(this.$.Ad+
ie.a.o5a);V.AFrameworkApplication.sa.Sa.$g&&(ma=document.getElementById("FarPaneRegion"));E.parentNode&&E.parentNode!==ma&&E.parentNode.removeChild(E);ma.appendChild(E);this.iqi()}iqi(){const E=this.JC,ma=this.wR,Ya=this.$.da;E.style.right="0";V.AFrameworkApplication.sa.Sa.$g||(E.style.marginRight=ce.HelperMethods.De(l.a.QKc));E.style.bottom=this.$.sf&4&&!V.AFrameworkApplication.sa.Sa.$g?ce.HelperMethods.De(this.$.cia):"0";this.vR.style.bottom="0";ma.style.right="0";this.$.Pm(this.kf);Ya.FK&&this.kf(null,
null)}zDb(E){const ma=new yh.a(0,0);return ba.a.hy(ma,this.JC,E,!1)}JEe(E){const ma=this.JC.offsetWidth;E=ma-E;E<this.Dj.taskPane.ks?E=this.Dj.taskPane.ks:950<E&&(E=950);this.Dj.taskPane.gy=E;const Ya=new ae(this.JC,this.$);Ya.u8b(this.JC,ma,E,this.Dj.taskPane);Object(Gc.a)(281,this.Dj.taskPane)||Ya.u8b(this.Dj.taskPane.de,ma,E,this.Dj.taskPane);this.$.ZVa(this.wR.offsetWidth+E);this.$.PDa(wb.a.W1("AnimateTaskpaneResize"))}static la(E,ma){let Ya=null;E.Jd&&(Ya=E.Jd.Yh("ComponentAttach","AttachTaskPanePickerControl"),
Ya.start());const Ub=mf.ibh(E.Ad),Hc=mf.hbh(E.Ad,ma),Gd=mf.jbh(E.Ad);Ub.appendChild(Gd);Ub.appendChild(Hc);mf.I6g(E,Ub);E=new mf(Ub,Hc,E,ma);Ya&&Ya.stop();return E}static ibh(E){const ma=document.createElement("div");ma.id=E+ie.a.ZJc;return ma}static hbh(E,ma){const Ya=document.createElement("div");Ya.id=E+ie.a.SJf;Ya.className=re.a.ZLh;let Ub=String.format(se,E+ie.a.m2i,E+ie.a.tU);Ub+=String.format(ze,E+ie.a.pwc,E+ie.a.TJf);ma.Ij(Ya,Ub);V.AFrameworkApplication.sa.Sa.$g&&nb.DOMElementExtensions.toggleCssClass(Ya,
re.a.ZDa,!0);return Ya}static jbh(E){const ma=document.createElement("div");ma.id=E+ie.a.pLd;ma.className=re.a.WNh;ma.style.zIndex="100";V.AFrameworkApplication.sa.Sa.$g&&nb.DOMElementExtensions.toggleCssClass(ma,re.a.ZDa,!0);return ma}static I6g(E,ma){(V.AFrameworkApplication.sa.Sa.$g?document.getElementById("FarPaneRegion"):document.getElementById(E.Ad+ie.a.o5a)).appendChild(ma)}static Yph(){const E=new Fa;E.Ypg=ie.a.ZJc;E.E4=ie.a.SJf;E.x7d=ie.a.tU;E.D8d=ie.a.pLd;E.Krg=ie.a.n2i;E.rPe=re.a.aMh;E.e6e=
re.a.cMh;E.pPe=re.a.$Lh;E.c6e=re.a.bMh;E.qPe=re.a.K4e;E.d6e=re.a.L4e;return E}}Object(N.a)(mf,"TaskPanePickerControl",Tf,[]);class Uf extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){if(fa.a.ff())this.V4f(()=>ra.la(this.$));else{const E=Object(hf.d)(Gb.a.resolve(fd.tb,{Qa:this.Na}));fc.TaskExtensions.ya(E,()=>{this.V4f(()=>mf.la(this.$,E.result))},this.ka,3)}}static la(E){E.ea.Ja(50,new Uf(E))}V4f(E){E=Object(ic.a)(this.$.ea,183,E);this.qd(E)}}Object(N.a)(Uf,"TaskPaneManagerFactory",
Db.a,[]);var Jf=a(74),Pf=a(358),Qf=a(27);const ff=(E,ma)=>{ma=void 0===ma?!1:ma;E=new Qf.Range(E.top,E.left,E.bottom,E.right,!1,ma);if(ma&&(1>E.top||E.top>E.maxRows||1>E.bottom||E.bottom>E.maxRows||E.top>E.bottom||1>E.left||E.left>E.maxColumns||1>E.right||E.right>E.maxColumns||E.left>E.right))throw R.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return E};var Ug=a(888),Zh=a(801),Nh=a(64);const Tg={[0]:[45],[1]:[46]};
class dh{constructor(E){this.$=E;this.sessionStorage=new Map;this.doUndo=()=>{const ma=this;return Io(function*(){yield Object(Ug.d)(ma.$)})};this.highlightRangesOnGrid=(ma,Ya,Ub)=>{const Hc=this;return Io(function*(){Hc.RB(ma,Ya,Tg[Ub])})};this.openCustomNumberFormat=()=>{const ma=this;return Io(function*(){return new Promise(Ya=>{Object(Ug.a)(ma.$,Ub=>{Ya(Ub);R.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Ub?"OK":"Cancel"}"`)})})})};this.openFeedback=
ma=>{const Ya=this;return Io(function*(){Object(Ug.e)(Ya.$,ma)})};this.sendOtelEvent=ma=>Io(function*(){Object(Zh.b)(ma)});this.containsHiddenCells=ma=>b(this.$,ma);this.getSessionStorageItem=(ma,Ya)=>{const Ub=this;return Io(function*(){var Hc;return null===(Hc=Ub.sessionStorage.get(ma))||void 0===Hc?void 0:Hc.get(Ya)})};this.setSessionStorageItem=(ma,Ya,Ub)=>{const Hc=this;return Io(function*(){var Gd;Hc.sessionStorage.has(ma)||Hc.sessionStorage.set(ma,new Map);null===(Gd=Hc.sessionStorage.get(ma))||
void 0===Gd?void 0:Gd.set(Ya,Ub)})}}get grid(){return ub.h(this.$)}RB(E,ma,Ya){Ya=void 0===Ya?[45]:Ya;const Ub=this.grid.zd;Ub.Sl(Ya,!1,!0);Ub.sm(null,Ya,!1);if(null===E||void 0===E?0:E.length){const Hc=Pf.a.PFa(Jf.d(this.$.na),E.map(Gd=>ff(Gd,!1)));Ub.AC(Hc,Ya,!0,void 0,!1);ma&&this.s_i(E)}Ub.update(!1)}s_i(E){if(null===E||void 0===E?0:E.length){const ma=this.grid;[E]=E.sort((Ya,Ub)=>Ya.top<Ub.top?-1:Ya.top>Ub.top?1:0);E=Qf.Range.xe(E.top,E.left);ma.DK(E)||(R.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),
ma.Oy(E,0,"DataCleansing"))}else R.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(N.a)(dh,"HostAppCallbacks",null,[837]);var Zg=a(815),$g=a(35),Gh=a(384),Eh=a(202),Sh=a(324),rh;(function(E){E[E.textInconsistency=0]="textInconsistency";E[E.numberFormatInconsistency=1]="numberFormatInconsistency";E[E.extraSpaces=2]="extraSpaces"})(rh||(rh={}));Object(N.b)("SuggestionType",rh);class Lh{constructor(E){this.$=E;this.applySuggestion=(ma,
Ya)=>{Ya=void 0===Ya?[]:Ya;const Ub=this;return Io(function*(){const Hc=Ya.map(Gd=>ff(Gd,!1));return u(Ub.$,ma,Hc)})}}}Object(N.a)(Lh,"DataCleansingCallbacks",null,[836]);class Oh{constructor(){this.isInErrorState=!1;this.errorState=null;this.isFeedbackAllowed=this.isInCoauthoring=this.isInViewMode=!1}}Object(N.a)(Oh,"HostState",null,[]);class pg{constructor(){this.sheetName=this.sheetId=null;this.isProtected=this.isInNamedSheetView=!1}}Object(N.a)(pg,"WorksheetState",null,[]);class Zf{constructor(){this.annotations=
[];this.hostState=new Oh;this.worksheetState=new pg}}Object(N.a)(Zf,"DataCleansingHostState",null,[]);class Og{constructor(E){this.$=E;this.HXe=this.GXe=!1}get isEnabled(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)||Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)}show(E,ma){ma=void 0===ma?!1:ma;const Ya=!ma;if(this.isEnabled&&!(ma&&this.HXe||Ya&&this.GXe)){if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7813501_CalloutOneSuggestion")){if(1>
E){R.ULS.sendTraceTag(508913414,0,50,`DataCleansing.showCallout: suggestion count(${E}).`);return}if(2>E&&Ya){R.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${E}) is below threshold to show teaching callout`);return}}else if(2>E){R.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${E}) is below threshold to show teaching callout`);return}R.ULS.sendTraceTag(508887310,0,50,`DataCleansing.showCallout: dispatchShowCalloutCommand. coolDown:(${Ya}).`);
Object(Ug.b)(this.$,E,ma);ma?this.HXe=!0:this.GXe=!0}}}Object(N.a)(Og,"TeachingCallout",null,[]);class ig{constructor(E){ig.assign(ig,this,E)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static y8(E){return E&&E.H_?E.H_.T_:void 0}static rCb(E){return E&&E.H_&&E.H_.B_?E.H_.B_:[]}static iaf(E){const ma=ig.y8(E);return ma?[ma,...ig.rCb(E)]:[]}static WF(E,ma){if(!Array.isArray(ma)||0===ma.length)return!0;const Ya=ig.y8(E);E=ig.rCb(E);for(const Ub of ma)if(Ub===
Ya||0<=E.indexOf(Ub))return!0;return!1}static assign(E,ma,Ya){if(Ya)for(const Ub of Object.keys(Ya))ma[Ub]=Ya[Ub];ma.H_=E.H_;return ma}}ig.H_={T_:ig.getTypeName(),B_:ig.getBaseTypes()};class zg{constructor(E){ig.assign(zg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[zg.getTypeName()])}}zg.H_={T_:zg.getTypeName(),B_:zg.getBaseTypes()};
class Xg{constructor(E){ig.assign(Xg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[Xg.getTypeName()])}}Xg.H_={T_:Xg.getTypeName(),B_:Xg.getBaseTypes()};class Fg{constructor(E){ig.assign(Fg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[Fg.getTypeName()])}}Fg.H_={T_:Fg.getTypeName(),B_:Fg.getBaseTypes()};class Ph{constructor(E){ig.assign(Ph,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[Ph.getTypeName()])}}Ph.H_={T_:Ph.getTypeName(),B_:Ph.getBaseTypes()};
class bg{constructor(E){ig.assign(bg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[bg.getTypeName()])}}bg.H_={T_:bg.getTypeName(),B_:bg.getBaseTypes()};class xa{constructor(E){ig.assign(xa,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,
[xa.getTypeName()])}}xa.H_={T_:xa.getTypeName(),B_:xa.getBaseTypes()};class Ab{constructor(E){ig.assign(Ab,this,E)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(E){return ig.WF(E,[Ab.getTypeName()])}}Ab.H_={T_:Ab.getTypeName(),B_:Ab.getBaseTypes()};class sc{constructor(E){ig.assign(sc,this,E)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(E){return ig.WF(E,
[sc.getTypeName()])}}sc.H_={T_:sc.getTypeName(),B_:sc.getBaseTypes()};class X{constructor(E){ig.assign(X,this,E)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(E){return ig.WF(E,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ca{constructor(E){ig.assign(ca,this,E)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(E){return ig.WF(E,
[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};var Qb=a(887),Uc=a(188);class Od{constructor(E){this.$=E;this.FXe=!1}KUb(E){const ma=this;return Io(function*(){if(ma.FXe)R.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else{var Ya=String.format(de.a.instance.gd(213),E),Ub=Uc.a.ia(1952),Hc=Uc.a.ia(1954);ma.businessBarManager||(ma.businessBarManager=Object(Ue.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?
yield Gb.a.resolve(fd.l,{Qa:1}):yield Rb.GetServiceTaskFactory.t8(ma.$.ea,5,4,1));ma.businessBarManager.f0j(Ya,Hc,Ub,()=>{ma.l$a()});ma.FXe=!0;R.ULS.sendTraceTag(509089824,0,50,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${E} suggestions.`)}})}l$a(){this.businessBarManager&&this.businessBarManager.jH(70)&&this.businessBarManager.removeEntry(70)}}Object(N.a)(Od,"BusinessBar",null,[]);var me;const Oe=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDisableTaskPaneWhenALSessionClose",
!1);let jf=me=class extends ta.a{constructor(E,ma){super();this.$=E;this.zwa=ma;this.L6a=!1;this.eGb=-1;this.mZi=3;this.Q9=new Zf;this.GUf=(Ya,Ub)=>{const Hc=this;return Io(function*(){-1===Hc.eGb&&Hc.jwg();Hc.iUi(Ub.sheetId,Ub.annotations);Hc.stateChanged();yield Promise.all([Hc.Ikf(),Hc.Dni()])})};this.cm=(Ya,Ub)=>{const Hc=this;return Io(function*(){Hc.jwg();Hc.Pug(Ub.dE);Hc.Xog(Ub.na);Hc.stateChanged();Hc.businessBar.l$a();yield Hc.Ikf()})};this.dh=()=>{const Ya=this;return Io(function*(){Ya.gridView.inRangePicker||
Ya.gridView.Jk||Ya.ha.ng&470||(yield Ya.Eni())})};this.kqa=()=>{this.stateChanged()};this.XD=()=>{this.stateChanged()};this.f$=()=>{this.stateChanged()};this.NVf=(Ya,Ub)=>{var [Hc,Gd]=Ub;R.ULS.sendTraceTag(509613389,0,50,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Qb.a[Hc],["errorCode"]:Gd})}`);Oe&&(this.Q9.hostState.errorState=Gd,this.stateChanged())};this.r$=(Ya,Ub)=>{Jf.m(Ub.item)&&Ub.item.Ej!==this.Q9.worksheetState.isProtected&&
(R.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Ub.item.Ej}.`),this.stateChanged())};this.callbacks=new Lh(this.$);this.K3g=new dh(this.$);this.dKc=new Og(this.$);this.businessBar=new Od(this.$);ma.d1g(this.GUf);ma.r1g(this.NVf);void ma.y3c();E.cn.Fi(this.cm);E.da.Nca(this.XD);E.da.y0(this.f$);this.gridView=ub.h(this.$);this.ha=this.gridView.ha;this.ha.YG(this.dh);this.Xog(this.$.na);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&
this.$.iad(()=>{this.stateChanged()})}T5c(E){this.addHandler(me.g6d,E)}c8f(E){this.removeHandler(me.g6d,E)}dispose(){this.zwa.DDj(this.GUf);this.zwa.ODj(this.NVf);this.$.cn.hj(this.cm);this.$.da.faa(this.XD);this.$.da.X3(this.f$);this.Pug(this.$.na);this.ha.lG(this.dh);super.dispose()}get state(){this.Q9.annotations=this.zwa.N2g();if(Jf.m(this.$.na)){const E=this.$.na.Ej,ma=this.$.na.sheetId,Ya=this.$.na.sheetName;this.Q9.worksheetState.isInNamedSheetView=this.$.na.dg.KD;this.Q9.worksheetState.isProtected=
E;this.Q9.worksheetState.sheetId=ma;this.Q9.worksheetState.sheetName=Ya}this.Q9.hostState.isInViewMode=!this.$.da.isEditMode;this.Q9.hostState.isInCoauthoring=this.isInCoauthoring();Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&(this.Q9.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled);return this.Q9}P6d(E){return this.C2a(E)}Q6d(E){return this.BVh(E)}Jpg(E){if(Jf.m(this.$.na)){var ma=this.zwa.ijb(this.$.na.sheetId);if(ma.find(xa.typeGuard)&&(ma=ma.filter(Fg.typeGuard).filter(Ya=>
E.Xf(ff(Ya.tableRange))),0<ma.length))return ma=ff(ma[0].tableRange),R.ULS.sendTraceTag(509219845,0,50,`DataCleansingHostManager.getTableRange: Table range is ${ma}, selected cell range is ${E}.`),ma}}t7d(){if(!Jf.m(this.$.na))return 0;var E=this.zwa.ijb(this.$.na.sheetId);if(!E.find(xa.typeGuard))return 0;E=new Set(E.filter(Fg.typeGuard).map(ma=>ma.tableName));R.ULS.sendTraceTag(509211032,0,50,`DataCleansingHostManager.tablesWithSuggestionsCount: ${E.size} tables with suggestions found.`);return E.size}jwg(){Jf.m(this.$.na)&&
(this.zwa.ijb(this.$.na.sheetId).find(xa.typeGuard)?this.eGb=this.C2a():this.eGb=-1)}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(me.g6d,this.state)}Xog(E){Jf.m(E)&&(E.dg.$2a(this.kqa),E.c3a(this.r$))}Pug(E){Jf.m(E)&&(E.dg.vhb(this.kqa),E.fDc(this.r$))}h9d(){if(this.dKc.isEnabled){const E=this.C2a();0<E&&(this.dKc.show(E,!0),R.ULS.sendTraceTag(508957346,0,20,`DataCleansingHostManager:triggerCallout show callout on discoverability mode ${this.xzb}. with: ${E} suggestions.`))}}C2a(E){if(!Jf.m(this.$.na))return 0;
const ma=this.zwa.ijb(this.$.na.sheetId),Ya=ma.find(xa.typeGuard);if(!Ya)return 0;const Ub=this.woh(ma);Ub!==Ya.suggestionsCount&&R.ULS.sendTraceTag(509613387,0,50,`DataCleansingHostManager.activeSheetSuggestionsCount: suggestionsCount is ${Ya.suggestionsCount}, but we have ${Ub} suggestions.`);return E?this.xoh(ma,E):Ub}woh(E){return E.filter(Fg.typeGuard).reduce((ma,Ya)=>{var Ub,Hc;return ma+(null!==(Hc=null===(Ub=null===Ya||void 0===Ya?void 0:Ya.suggestions)||void 0===Ub?void 0:Ub.length)&&void 0!==
Hc?Hc:0)},0)}xoh(E,ma){E=E.filter(Fg.typeGuard).map(Ya=>{var Ub;return null===(Ub=null===Ya||void 0===Ya?void 0:Ya.suggestions)||void 0===Ub?void 0:Ub.filter(Hc=>!(null===ma||void 0===ma||!ma.Xf(ff(Hc.suggestionRange))))}).reduce((Ya,Ub)=>Ya+Ub.length,0);R.ULS.sendTraceTag(509219844,0,50,`DataCleansingHostManager.countSuggestionsForRange: ${E} suggestions found for range: ${ma}`);return E}BVh(E){if(!Jf.m(this.$.na))return[];const ma=this.zwa.ijb(this.$.na.sheetId);return ma.find(xa.typeGuard)?ma.filter(Fg.typeGuard).filter(Ya=>
{var Ub;return 0<(null===(Ub=null===Ya||void 0===Ya?void 0:Ya.suggestions)||void 0===Ub?void 0:Ub.filter(Hc=>!(null===E||void 0===E||!E.Xf(ff(Hc.suggestionRange)))).length)}).map(Ya=>Ya.tableName):[]}iUi(E,ma){ma=ma.filter(Fg.typeGuard);const Ya=d(ma);R.ULS.sendTraceTag(509698241,0,50,`DataCleansingHostManager.logPotentialSuggestionsInfo: ${JSON.stringify({["sheetId"]:E,["suggestionsInfo"]:Ya,["numberFormatTypes"]:f(r(ma).entries())})}`)}Yyc(E,ma){if(this.xzb===E){const Ya=new Pe.a(-1190551534,Ce.a.ld,
this.$.ee,0,null),Ub={type:E};ma&&(Ub.range=ma);this.$.Ha.kd(Ya,{["discoverabilityOptions"]:Ub});R.ULS.sendTraceTag(508933121,0,20,`DataCleansingHostManager:openDataCleansingTaskPane discoverability type: ${E}. with active range: ${null!==ma&&void 0!==ma?ma:"no range"}.`)}}get xzb(){return Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverability",0)}get Ygd(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)}get Xgd(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",!1)}Eni(){const E=this;return Io(function*(){if(!E.L6a&&2===E.xzb){const [Ya]=E.ha.ra.selectedRanges;if(Ya){var ma=E.Jpg(Ya);ma&&(ma=E.P6d(ma),E.I3d(ma)&&(E.Ygd?(ma="Trigger callout",E.h9d()):E.Xgd?(ma="Show business bar",yield E.g9d()):(ma="Open task pane",E.Yyc(2,Ya)),E.L6a=!0,R.ULS.sendTraceTag(508933120,0,20,`DataCleansingHostManager:handleDiscoverabilityOnSelect ${ma}.`)))}}})}Ikf(){const E=
this;return Io(function*(){const ma=E.C2a();0===ma&&E.businessBar.l$a();E.I3d(ma)&&(0===E.xzb?E.Ygd?(E.h9d(),E.L6a=!0):E.Xgd&&(yield E.g9d(),E.L6a=!0):E.nck(ma))})}nck(E){Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.dKc.isEnabled&&this.dKc.show(E,!1)}Dni(){const E=this;return Io(function*(){if(-1!==E.eGb){var ma=E.C2a();E.I3d(ma)&&3===E.xzb&&ma>=E.eGb+E.mZi&&(E.Ygd?(R.ULS.sendTraceTag(508924481,0,20,`DataCleansingHostManager:handleDiscoverabilityOnNewSuggestions show callout on load with: ${ma} suggestions.`),
E.h9d()):E.Xgd?yield E.g9d():E.Yyc(3),E.L6a=!0)}})}g9d(){const E=this;return Io(function*(){const ma=E.C2a();yield E.businessBar.KUb(ma)})}SCg(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityMultipleTables",!1)}Vhj(){return 1===this.t7d()}I3d(E){return!(this.L6a||Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)&&0<E&&(this.SCg()||this.Vhj())?!0:!1}};jf.g6d="scek";jf=me=Object(Hd.a)([Object(Gb.d)(fd.E),
Object(Hd.b)(0,Object(fd.R)()),Object(Hd.b)(1,Object(fd.C)())],jf);Object(N.a)(jf,"DataCleansingHostManager",ta.a,[]);class kf{constructor(E){ig.assign(kf,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[kf.getTypeName()])}}kf.H_={T_:kf.getTypeName(),B_:kf.getBaseTypes()};class Kf{constructor(E){ig.assign(Kf,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=
E}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[Kf.getTypeName()])}}Kf.H_={T_:Kf.getTypeName(),B_:Kf.getBaseTypes()};class cg{constructor(E){ig.assign(cg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,
[cg.getTypeName()])}}cg.H_={T_:cg.getTypeName(),B_:cg.getBaseTypes()};class jg{constructor(E){ig.assign(jg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[jg.getTypeName()])}}jg.H_={T_:jg.getTypeName(),B_:jg.getBaseTypes()};class $f{constructor(E){ig.assign($f,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=
E}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[$f.getTypeName()])}}$f.H_={T_:$f.getTypeName(),B_:$f.getBaseTypes()};class Jg{constructor(E){ig.assign(Jg,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,
[Jg.getTypeName()])}}Jg.H_={T_:Jg.getTypeName(),B_:Jg.getBaseTypes()};class Aa{constructor(E){ig.assign(Aa,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return ig.WF(E,[Aa.getTypeName()])}}Aa.H_={T_:Aa.getTypeName(),B_:Aa.getBaseTypes()};class Fb extends ta.a{constructor(E,ma){super();this.Rka=!1;this.B8j=(Ya,Ub)=>{if(Ya=Ub.annotation)switch(Ub.operationType){case 1:case 2:this.raiseEvent("carek",
Ya);break;case 3:this.raiseEvent("caiek",Ya);break;default:R.ULS.sendTraceTag(537163396,306,15,`TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:${Ub.operationType}`)}else R.ULS.sendTraceTag(537163397,306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotation is null.")};this.D8j=(Ya,Ub)=>{if(Ub.annotation)switch(Ub.operationType){case 1:case 2:this.raiseEvent("aarek",Ub.annotation);break;case 3:break;default:R.ULS.sendTraceTag(537163394,
306,15,`TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:${Ub.operationType}`)}else R.ULS.sendTraceTag(537163395,306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};this.C8j=(Ya,Ub)=>{R.ULS.sendTraceTag(537163393,306,50,`TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: ${Ya}->${Ub}`)};this.augmentationLoopManager=E;this.u4i=ma}y3c(){this.Rka?R.ULS.sendTraceTag(537163398,
0,50,"TableLintManager.ActivateEvents: Events are already registered"):(this.xyj(),this.Rka=!0)}dispose(){this.Rka&&(this.fgk(),this.Rka=!1)}gZg(E){this.addHandler("carek",E)}iBj(E){this.removeHandler("carek",E)}FYg(E){this.addHandler("aarek",E)}NAj(E){this.removeHandler("aarek",E)}xyj(){R.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations");const E=this.augmentationLoopManager.YX().TZ("DataCleansing").RZ(this.u4i).activateAnnotation({annotationType:Fg.getTypeName(),
Yt:!0,PEe:this.C8j,Tlb:this.B8j}).activateAnnotation({annotationType:xa.getTypeName(),Yt:!0,Tlb:this.D8j}).activateAnnotation({annotationType:Ph.getTypeName(),Yt:!0}).activateAnnotation({annotationType:bg.getTypeName(),Yt:!0});Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&E.activateAnnotation({annotationType:Kf.getTypeName(),Yt:!0});Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&E.activateAnnotation({annotationType:jg.getTypeName(),
Yt:!0});(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_CombinedExtraSpacesSuggestions",!1)||Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_UseNewExtraSpacesLinter",!1))&&E.activateAnnotation({annotationType:Jg.getTypeName(),Yt:!0});Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&E.activateAnnotation({annotationType:Aa.getTypeName(),Yt:!0});this.augmentationLoopManager.register(E.build())}fgk(){this.augmentationLoopManager.unregister("DataCleansing")}}
Object(N.a)(Fb,"TableLintManager",ta.a,[5]);var kc;let Dc=kc=class extends ta.a{constructor(E){super();this.$=E;this.ZGc=new Map;this.Cbd=new Map;this.Bbd=new Map;this.Kwc=(ma,Ya)=>{ma=void 0===ma?"Unknown":ma;R.ULS.sendTraceTag(520987272,0,50,`DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Qb.a[ma],["errorCode"]:Ya})}`);this.raiseEvent(kc.Z9d,[ma,Ya])};this.VMf=(ma,Ya)=>{this.Cbd.set(Ya.id,Ya);R.ULS.sendTraceTag(512354457,
0,100,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${Ya.id}`)};this.oLf=(ma,Ya)=>{ma=this.ZGc.get(Ya.worksheetId);R.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:Ya.id,["sheetId"]:Ya.worksheetId,["previous"]:null===ma||void 0===ma?void 0:ma.id,["errorCount"]:Ya.errorCount,["suggestionsCount"]:Ya.suggestionsCount})}`);(null===ma||void 0===ma?void 0:ma.id)===Ya.id&&R.ULS.sendTraceTag(512354455,
0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${Ya.id}`);this.ZGc.set(Ya.worksheetId,Ya);ma=this.Ofi(Ya);ma.forEach(Ub=>{this.Cbd.delete(Ub.id)});this.Bbd.set(Ya.id,ma);this.B3g(Ya.worksheetId)}}d1g(E){this.addHandler(kc.v2d,E)}DDj(E){this.removeHandler(kc.v2d,E)}r1g(E){this.addHandler(kc.Z9d,E)}ODj(E){this.removeHandler(kc.Z9d,E)}dispose(){this.rYa&&(this.rYa.iBj(this.VMf),this.rYa.NAj(this.oLf),this.rYa.dispose());super.dispose()}y3c(){const E=this;return Io(function*(){const ma=
Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateAugmentationLoopToNewServiceInfra",!1)?yield Gb.a.resolve(fd.i,{Qa:1}):yield Rb.GetServiceTaskFactory.t8(E.$.ea,328,327,1);ma?(E.rYa=new Fb(ma,E.Kwc),E.rYa.gZg(E.VMf),E.rYa.FYg(E.oLf),E.rYa.y3c(),R.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):R.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}ijb(E){var ma;if(E=this.ZGc.get(E)){const Ya=
null!==(ma=this.Bbd.get(E.id))&&void 0!==ma?ma:[];return[E,...Ya]}return[]}N2g(){const E=[];this.ZGc.forEach(ma=>{var Ya;const Ub=null!==(Ya=this.Bbd.get(ma.id))&&void 0!==Ya?Ya:[];E.push(ma,...Ub)});return E}B3g(E){E={sheetId:E,annotations:this.ijb(E)};this.raiseEvent(kc.v2d,E)}Ofi(E){var ma=Array.from(this.Cbd.values()).filter(Hc=>Hc.worksheetId===E.worksheetId);if(!ma.length)return R.ULS.sendTraceTag(509682374,0,50,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),
[];if(!Array.isArray(E.aggregatedAnnotations))return R.ULS.sendTraceTag(509682373,0,20,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No aggregated annotations IDs"),ma;const Ya=new Set(E.aggregatedAnnotations),Ub=ma.filter(Hc=>Ya.has(Hc.id));ma=ma.filter(Hc=>!Ya.has(Hc.id));ma.length&&R.ULS.sendTraceTag(509682372,0,50,`DataCleansingAnnotationsManager.getRelatedPendingAnnotations: Found ${ma.length} unrelated annotations`);return Ub}};Dc.v2d="sacek";Dc.Z9d="ueoek";Dc=kc=Object(Hd.a)([Object(Gb.d)(fd.C),
Object(Hd.b)(0,Object(fd.R)())],Dc);Object(N.a)(Dc,"DataCleansingAnnotationsManager",ta.a,[]);class Fd extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){const E=Object(ic.a)(this.$.ea,494,()=>{const ma=new Dc(this.$);return new jf(this.$,ma)});this.qd(E)}static la(E){E.ea.Ja(495,new Fd(E))}}Object(N.a)(Fd,"DataCleansingHostManagerFactory",Db.a,[]);let be=class extends ta.a{constructor(){super()}m9d(E,ma){R.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${E}, TriggerType: ${ma}`);
if(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(ma){case 0:this.raiseEvent("pssort",void 0,E);break;case 1:this.raiseEvent("psfilter",void 0,E);break;case 2:this.raiseEvent("pscrttbl",void 0,E)}}};be=Object(Hd.a)([Object(Gb.d)(fd.fc)],be);Object(N.a)(be,"ProactiveSuggestionManager",ta.a,[750]);class Wd extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){let E=Object(ic.a)(this.$.ea,476,()=>new be);this.qd(E)}static la(E){E.ea.Ja(475,
new Wd(E))}}Object(N.a)(Wd,"ProactiveSuggestionManagerFactory",Db.a,[]);var Je=a(564),Ne=a(154);class Lf{constructor(E,ma,Ya){this.r4d=this.s4d=this.t4d=!1;this.G4d=!E&&!ma;this.H4d=!E&&!Ya;this.G4d||this.H4d||(this.t4d=!E,this.s4d=!ma,this.r4d=!Ya)}}Object(N.a)(Lf,"RenameDisabledDialogInfo",null,[]);class Ef extends Ne.StandardDialog{constructor(E,ma,Ya,Ub,Hc){super();this.O7d=[];this.E5=new Lf(E,ma,Ya);this.Uva=Ub;this.Lua=Hc;this.kg="RenameDisabledDialog";this.Fd=0;this.$d(1,CommonUIStrings.l_DialogClose);
this.AUj();this.hEj()}AUj(){this.E5.G4d?this.bVb(this.Uva?this.Lua?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.E5.H4d?this.bVb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.oWg();this.xka(this.O7d)}bVb(E){Array.add(this.O7d,E)}oWg(){const E=[];this.E5.t4d||Array.add(E,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.E5.s4d||Array.add(E,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.E5.r4d||Array.add(E,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<E.length&&Array.add(this.O7d,E)}}Object(N.a)(Ef,"ReactRenameDisabledDialogBase",Ne.StandardDialog,[]);class ia extends Ef{constructor(E,ma,Ya,Ub,Hc){super(E,ma,Ya,Ub,Hc)}hEj(){this.BLb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(N.a)(ia,"ReactRenameDisabledDialog",Ef,[]);var jb=a(153);class oc{static get Oh(){return jb.a.fq(oc.hn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}oc.hn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(N.a)(oc,"RenameDisabledDialogHtml",null,[]);class Ec extends jb.a{constructor(E,ma,Ya,Ub,Hc){super();this.E5=new Lf(E,ma,Ya);this.Uva=Ub;this.Lua=Hc;this.kg="RenameDisabledDialog";this.Fd=0;this.$d(1,CommonUIStrings.l_DialogClose);this.Oh=oc.Oh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.SZ("RenameRow")}veb(){if(this.E5.G4d){let E;E=this.Uva?this.Lua?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Ec.bVb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),E)}else this.E5.H4d?Ec.bVb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Jsi()}Jsi(){this.E5.t4d&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.E5.s4d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.E5.r4d&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static bVb(E,ma,Ya){E.style.display="none";ma.innerText=Ya}}Object(N.a)(Ec,"RenameDisabledDialog",jb.a,[]);class ge{constructor(E,ma){this.SIa=0;this.Oa=E;this.Iba=ma}initialize(E){if(!this.Oa||!this.Iba)return!1;this.SIa=E;this.Mi();return!0}Mi(){this.Oa.Pd(ob.a.Lla,Ia.a.frame,Object(ha.a)(this,this.Lla,"commitNewDocumentTitle"))}Lla(E,ma,Ya,Ub,Hc){if(1===Ya)return this.Oa.processAction(ob.a.renameFile,
1);E=qa.a.Ur(this.Iba.zp);Hc=(0,Hc.getNewDocumentTitle)();Hc.length>this.SIa&&(Hc=Hc.substr(0,this.SIa));if(32!==this.Oa.Sf(ob.a.renameFile,2,Hc))return this.n_(E),8;this.n_(Hc);return 32}n_(E){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(E))}static Tqd(){return new ge(V.AFrameworkApplication.jd,V.AFrameworkApplication.Bo)}}Object(N.a)(ge,"ReactRenameUIHandler",null,[926]);var Ae=a(99),Ze=a(533),Y=a(566),Ua=a(97),ac=a(42);class Kc{constructor(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf,wg,Ig){this._initialized=
!1;this._element=null;this.SIa=0;this.t0c=this.MUc=!1;this.Oa=E;this.cQc=ma;this.Yf=Ya;this.$C=Ub;this.Iba=Hc;this.Due=Gd;this.j4b=he;this.ZQc=Ke;this.Vba=af;this.bne=xf;this.y0a=wg;this.HVc=Ig}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(E,ma,Ya){if(!(this.Oa&&this.Iba&&this.Due&&this.j4b&&this.ZQc&&ma)||0>=E)return!1;this._element=ma;this._element.title=Ya;this._element.setAttribute(Ua.a.wf,Ua.a.zv);this._element.setAttribute("Unselectable","on");this.SIa=
E;this.gw();return this._initialized=!0}gw(){this.cQc&&(this.cQc.ta(uc.a.blur,this._element,Object(ha.a)(this,this.onBlur,"onBlur")),this.cQc.ta(uc.a.paste,this._element,Object(ha.a)(this,this.onPaste,"onPaste")));this.Yf.ta(uc.a.Rd,this._element,Object(ha.a)(this,this.onKeyDown,"onKeyDown"));this.$C.ta(uc.a.pointerDown,this._element,Object(ha.a)(this,this.onPointerDown,"onPointerDown"));this.$C.ta(uc.a.ri,this._element,Object(ha.a)(this,this.Li,"onPointerUp"))}onBlur(){this.isActive&&!this.MUc&&
(this.bne||this.ZQc(this._element),this.cQe(),this.dgd(!1));return this.MUc=!1}onPaste(){R.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(E){return this.isActive?this.dbj(E):this.ebj(E)}dbj(E){let ma=!1;switch(E.Ca.keyCode){case Sys.UI.Key.enter:this.cQe();this.dgd(this.y0a||this.HVc);ma=!0;break;case Sys.UI.Key.tab:this.bne&&this.ZQc(this._element);break;case Sys.UI.Key.esc:this.tYd(),this.dgd(this.y0a||this.HVc),ma=!0}return ma}ebj(E){let ma=!1;
switch(E.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Hsg(this.HVc),this.isActive&&this.j4b(this._element),ma=!0}return ma}onPointerDown(){this.isActive||(this.Hsg(!1),this.isActive&&(this._element.focus(),this.j4b(this._element),this.t0c=!0));return!1}Li(){return this.t0c?(this.j4b(this._element),this.t0c=!1,!0):!1}xbb(){return 32===this.Oa.processAction(ob.a.renameFile,1)}cQe(){const E=qa.a.Ur(this.Iba.zp);let ma=this._element.innerText.trim();ma.length>this.SIa&&(ma=ma.substr(0,
this.SIa));ma!==E&&""!==ma?32!==this.Oa.Sf(ob.a.renameFile,2,ma)?this.tYd():this.n_(ma):this.tYd()}tYd(){this.n_(qa.a.Ur(this.Iba.zp))}n_(E){this._initialized&&(this._element.innerText=E,this.Due())}Hsg(E){this.xbb()?this.isActive||(E&&(this.MUc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ua.a.wf,Ua.a.B7c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Ae.CuiHelper.YZe),
this.Vba&&this.Vba.execute(ma=>{ma.f2f(!0)}),E&&this._element.focus(),R.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Oa.processAction(ob.a.Jjb,2)}dgd(E){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ua.a.wf,Ua.a.zv);Sys.UI.DomElement.removeCssClass(this._element,Ae.CuiHelper.YZe);this.Vba&&this.Vba.execute(ma=>{ma.f2f(!1)});E&&(this._element.blur(),this._element.focus())}static yC(){Ze.a.yC(V.AFrameworkApplication.isRtl)}static Tqd(){return new Kc(V.AFrameworkApplication.jd,
Y.a.instance,Ld.KeyInputManager.instance,od.a.instance,V.AFrameworkApplication.Bo,Kc.yC,ac.a.zMj,ac.a.Xhh,qb.a.instance.Ed("Common.App.Header.HeaderEventSource"),pb.a.Toa,pb.a.Ki,pb.a.hh)}}Object(N.a)(Kc,"RenameUIHandler",null,[926]);class Td{static get instance(){return V.AFrameworkApplication.sa.Sa.Yv?Td.La||(Td.La=ge.Tqd()):Td.La||(Td.La=Kc.Tqd())}}Td.La=null;Object(N.a)(Td,"RenameUIHandlerFactory",null,[]);var Ie=a(145);class df{constructor(){this.L0i=this.H0i=this.dwh=null}}Object(N.a)(df,"RenameMruEntryProperties",
null,[]);var gf=a(386),uf=a(183),fg=a(666),Ag;(function(E){E[E.unknown=-1]="unknown";E[E.success=0]="success";E[E.renameInvalidFileName=1]="renameInvalidFileName";E[E.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";E[E.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";E[E.permissionDenied=4]="permissionDenied";E[E.serverCommunicationFailure=5]="serverCommunicationFailure";E[E.fileNameTooLong=6]="fileNameTooLong"})(Ag||(Ag={}));Object(N.b)("CommonOperationResult",Ag);class og{constructor(E,
ma,Ya,Ub,Hc,Gd,he,Ke,af,xf,wg,Ig){this.qne=E;this.Oa=ma;this.iRc=Ya;this.ny=Ub;this.MIa=Hc;this.$Sg=Gd;this.Uva=he;this.Dxe=Ke;this.yPg=af;this.Lua=xf;this.Pa=wg;this.xPg=Ig}Mi(){V.AFrameworkApplication.sa&&V.AFrameworkApplication.sa.Sa.Yv||this.Nj.Pd(ob.a.kGb,Ia.a.frame,Object(ha.a)(this,this.kGb,"initializeRenameUIHandler"));this.Nj.Pd(ob.a.Jjb,Ia.a.frame,Object(ha.a)(this,this.Jjb,"showRenameDisabledDialog"));this.Nj.Pd(ob.a.renameFile,Ia.a.frame,Object(ha.a)(this,this.renameFile,"renameFile"));
this.Nj.pg(ob.a.fileNameUpdate,Ia.a.frame,Object(ha.a)(this,this.vwj,"refreshFilename"),64);this.Nj.pg(ob.a.Mvc,Ia.a.frame,Object(ha.a)(this,this.Mvc,"moveToFolderCompleteByHost"),64);this.Nj.Pd(ob.a.rTa,Ia.a.frame,Object(ha.a)(this,this.rTa,"moveToFolder"));(V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||V.AFrameworkApplication.sa&&(V.AFrameworkApplication.fa.qa("PostMessageEmbedded")||V.AFrameworkApplication.fa.qa("IsJsApi"))&&
V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&V.AFrameworkApplication.BT().execute(E=>{E.Vn(uf.a.eIf);E.em(uf.a.eIf,og.kvj);E.Vn(uf.a.Kld);E.em(uf.a.Kld,og.ivj)})}xbb(){return 0===this.xPg.Vgf()?32:8}zlk(){return this.Dy?this.Uva?this.Dy.VYe:this.Dy.K8a:!0}kGb(){return Td.instance.initialize(V.AFrameworkApplication.Ohc,V.AFrameworkApplication.S6a,V.AFrameworkApplication.KWd||CommonUIStrings.l_RenameFileTooltip)?32:8}Jjb(){const E=this.zlk(),
ma=this.$Sg();R.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.MIa,ma,E,this.Uva);V.AFrameworkApplication.sa&&V.AFrameworkApplication.sa.Sa.Tx&&V.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new ia(this.MIa,!ma,!E,this.Uva,this.Lua()):new Ec(this.MIa,!ma,!E,this.Uva,this.Lua());return 32}renameFile(E,ma,Ya,Ub,Hc){if(1===Ya)return this.xbb();
if(!V.AFrameworkApplication.fhc)return 8;if(8===this.xbb())return this.Nj.processAction(ob.a.Jjb,2),8;R.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");V.AFrameworkApplication.fhc(Hc,Object(ha.a)(this,this.QNb,"onRenameFileSuccess"),Object(ha.a)(this,this.Sdj,"onRenameFileFailure"));V.AFrameworkApplication.YDj=!0;return 32}QNb(E,ma){E?0!==E.OperationResult?this.Ukf(E.OperationResult):(this.RNj(ma,E.NewName),this.Ugk(E,Object(ha.a)(V.AFrameworkApplication.sa.Sa,V.AFrameworkApplication.sa.Sa.Bwg,
"updateOpenInClientDocumentUrl")),V.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&V.AFrameworkApplication.sa.updateCommandUI(),this.yPg.Wug()):this.Ukf(5)}RNj(E,ma){const Ya={};Ya[gf.a.UUh]=ma;E.sendMessage(uf.a.Kld,Ya)}Ugk(E,ma){this.ghk(E);V.AFrameworkApplication.Gec=E.DirectInvokeDavUrl;ma=ma(E.EditDocInClientUrl);const Ya=new df;Ya.L0i=this.ny.zp;Ya.dwh=ma;Ya.H0i=E.EditDocInClientUrl;this.Nj.Sf(ob.a.renameMostRecentlyUsedFileEntry,2,Ya)}Ukf(E){switch(E){case 1:E=new Ne.StandardDialog,
E.Fd=0,E.bV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.aag()}}ghk(E){this.ny.zp=og.d4g(this.ny.zp,E.NewName);E.BreadcrumbFolderName&&(this.ny.breadcrumbFolderName=E.BreadcrumbFolderName);E.BreadcrumbFolderUrl&&(this.ny.breadcrumbFolderUrl=E.BreadcrumbFolderUrl);this.Dxe(E.NewName)}Sdj(E){const ma=new Ne.StandardDialog;ma.Fd=0;switch(E){case 1:R.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ma.esa(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:R.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ma.esa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:R.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:E}),ma.esa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}V.AFrameworkApplication.BT().execute(Ya=>{Ya.sendMessage(uf.a.TUh,{["FailureMessage"]:Ag[E]})});
this.aag()}vwj(E,ma,Ya){if(1===Ya)return this.xbb();if(!V.AFrameworkApplication.hOa)return 8;V.AFrameworkApplication.hOa(Object(ha.a)(this,this.myc,"onRefreshFilenameSuccess"),Object(ha.a)(this,this.lyc,"onRefreshFilenameFailure"),!1);return 32}rTa(E,ma,Ya,Ub,Hc){if(1===Ya)return V.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Ya){const Gd={};E=V.AFrameworkApplication.Ffa;ma=V.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");E=(!E||E&&ma)&&V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);Gd[gf.a.A7j]=E;Hc&&Hc.MoveButtonClickedTime&&(Gd[gf.a.g_i]=Hc.MoveButtonClickedTime.getTime());V.AFrameworkApplication.BT().execute(he=>{he.sendMessage(uf.a.rTa,Gd)});if(Hc&&Hc.MoveButtonClickedTime){if(E=Ie.a.Pt())Hc=(new Date).getTime()-Hc.MoveButtonClickedTime.getTime(),E.set("MovePostDuration",Hc.toString());qe.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",E)}return 32}return 8}Mvc(E,ma,Ya,Ub,Hc){if(1===Ya)return V.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.xbb():
8;if(2===Ya){if(!V.AFrameworkApplication.Xdg)return qe.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Hc)return qe.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Hc[gf.a.GDi])if(Hc[gf.a.wxg])if(E=Hc[gf.a.wxg].toLowerCase(),ma=V.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Ya=V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ma&&
V.AFrameworkApplication.Ffa&&Ya){const Gd={};Gd[gf.a.nVa]="1";Gd[gf.a.documentUrl]=E;Gd[gf.a.reason]=fg.a.saveAs;qe.Health.instance.recordKpiSuccess("MoveToFolder",null);V.AFrameworkApplication.BT().execute(he=>{he.sendMessage(uf.a.s1,Gd)})}else if(!V.AFrameworkApplication.Ffa&&Ya)qe.Health.instance.recordKpiSuccess("MoveToFolder",null),ac.a.Gg(E,ac.a.r_(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return qe.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,
null),8;else qe.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else V.AFrameworkApplication.hOa(Object(ha.a)(this,this.myc,"onRefreshFilenameSuccess"),Object(ha.a)(this,this.lyc,"onRefreshFilenameFailure"),!1),V.AFrameworkApplication.Xdg(),qe.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}i_j(E,ma){return E&&ma?E!==this.ny.breadcrumbFolderName||ma!==this.ny.breadcrumbFolderUrl:!1}myc(E,ma){E&&(E.NewName!==qa.a.Ur(this.ny.zp)||this.i_j(E.BreadcrumbFolderName,
E.BreadcrumbFolderUrl))&&this.QNb(E,ma)}lyc(){}aag(){this.Dxe(qa.a.Ur(this.ny.zp))}get Nj(){return this.Oa.value}get Dy(){return this.iRc.value}static get instance(){return og.La||(og.La=og.jna())}static jna(){return new og(V.AFrameworkApplication.ybb,new Je.a(()=>V.AFrameworkApplication.jd),new Je.a(()=>V.AFrameworkApplication.Dy),V.AFrameworkApplication.Bo,V.AFrameworkApplication.limitedEdit,()=>V.AFrameworkApplication.userCanRename,V.AFrameworkApplication.kDc,Object(ha.a)(Td.instance,Td.instance.n_,
"updateTitle"),qb.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>V.AFrameworkApplication.isReadOnlyRecommended,V.AFrameworkApplication.fa,qb.a.instance.resolve("Common.IRenameProps"))}static d4g(E,ma){E=qa.a.o8(E);return ma+E}static kvj(E){const ma=E.Values[gf.a.NHi];R.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ma);ma?V.AFrameworkApplication.jd.Sf(ob.a.Mvc,2,E.Values):qe.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",
!1,!1,null)}static ivj(E){V.AFrameworkApplication.jd.Sf(ob.a.renameFile,2,E.Values.NewName)}}og.La=null;Object(N.a)(og,"RenameActor",null,[]);a(581);class Eg{}Object(N.a)(Eg,"ActivityEventName",null,[]);class eh{}eh.compatMode="CompatMode";eh.noSelection="NoSelection";Object(N.a)(eh,"ActivityEventReason",null,[]);var rg=a(664);class ah{constructor(E,ma){this.Oa=E;this.D_a=ma}Mi(){this.Oa.Pd(ob.a.Jlg,Ia.a.frame,Object(ha.a)(this,this.U1j,"showRenameDialogAction"))}U1j(E,ma,Ya){E=32;if(1===Ya)return rg.SessionStatusManager.instance.a$a||
V.AFrameworkApplication.i9?8:32;2===Ya&&(32!==this.Oa.processAction(ob.a.renameFile,1)?(this.Oa.processAction(ob.a.Jjb,2),E=8):32===this.Oa.processAction(ob.a.aVb,1)?this.Oa.processAction(ob.a.aVb,2):this.D_a.value.create().NHc());return E}}Object(N.a)(ah,"RenameDialogActor",null,[914]);class gh{constructor(E,ma,Ya){this.dialog=null;this.Oa=E;this.ny=ma;this.xua=Ya}Vfi(){const E={};E.nameInputProps={["type"]:"AppInputProps",["id"]:gh.R6a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:qa.a.Ur(this.ny.zp),
["maxLength"]:this.xua};return E}NHc(){const E={["id"]:"RenameDialog",["bodyControls"]:this.Vfi()};this.dialog=new jb.a(!1,!1,!0);this.dialog.Fd=1;this.dialog.kg="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(ha.a)(this,this.IWd,"renameDialogHandler"),E)}IWd(E,ma){ma&&1===E&&ma[gh.R6a]&&(E=qa.a.Ur(this.ny.zp),ma=(ma[gh.R6a]||"").trim(),ma!==E&&""!==ma&&this.Oa.Sf(ob.a.renameFile,2,ma))}}gh.R6a="txtDocumentName";Object(N.a)(gh,"ReactRenameDialog",null,[928]);
class Bg{static get Oh(){return jb.a.fq(Bg.hn,CommonUIStrings.l_RenameDialogLabel)}}Bg.hn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(N.a)(Bg,"RenameDialogHtml",null,[]);class wh extends jb.a{constructor(E,ma,Ya){super();this.Oa=E;this.ny=ma;this.xua=Ya;this.kg="RenameDialog";this.Oh=Bg.Oh}NHc(){var E={["txtDocumentName"]:qa.a.Ur(this.ny.zp)};
this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(ha.a)(this,this.IWd,"renameDialogHandler"),E);E=document.getElementById(wh.R6a);0<this.xua&&(E.maxLength=this.xua);E.focus()}IWd(E,ma){1===E&&(E=qa.a.Ur(this.ny.zp),ma=(ma[wh.R6a]||"").trim(),ma!==E&&""!==ma&&this.Oa.Sf(ob.a.renameFile,2,ma))}}wh.R6a="txtDocumentName";Object(N.a)(wh,"RenameDialog",jb.a,[928]);class ti{constructor(E){this.Iba=null;this.xua=0;this.Oa=E;this._initialized=!1}initialize(E,ma){this.Iba=E;this.xua=ma;this._initialized=
!0}create(){return this._initialized?V.AFrameworkApplication.sa&&V.AFrameworkApplication.sa.Sa.Tx&&V.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new gh(this.Oa,this.Iba,this.xua):new wh(this.Oa,this.Iba,this.xua):null}}Object(N.a)(ti,"RenameDialogFactory",null,[913]);var tg=a(112),Yh=a(114),Vi=a(110);class ki{constructor(E,ma){this.Oa=E;this.Xd=ma}Mi(){this.Oa.Pd(ob.a.aVb,Ia.a.frame,Object(ha.a)(this,this.V1j,"showRenameFlyoutAction"))}Zdh(){return ya.d("setDocumentTitleFlyoutOpened")&&
V.AFrameworkApplication.sa.Sa.Yv}V1j(E,ma,Ya){if(1===Ya)return this.Zdh()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}BXg(){ki.YKi&&V.AFrameworkApplication.ERa&&Vi.a.instance.Ah(new Yh.a(5,1,5E3,()=>{32===this.Oa.processAction(ob.a.aVb,1)&&this.Xd&&this.Xd.Zj.name===Ta.AFrame.y7&&(tg.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Oa.processAction(ob.a.aVb,2))}))}static get YKi(){ki.I1b&&null!=ki.I1b||(V.AFrameworkApplication.lU("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),
ki.I1b=V.AFrameworkApplication.fa?V.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ki.I1b}}ki.I1b=null;Object(N.a)(ki,"RenameFlyoutActor",null,[912]);class zh{constructor(E,ma,Ya,Ub,Hc){this.iRc=Hc;this.rne=Ya;this.qne=Ub;this.dTg=E;this.Lua=ma}get Dy(){return this.iRc.value}Vgf(){if(!this.qne())return 5;if(this.Lua())return 1;if(this.Dy){if(this.rne&&!this.Dy.VYe)return 3;if(!this.rne&&!this.Dy.K8a)return 4}return this.dTg()?
0:2}}Object(N.a)(zh,"RenameProps",null,[910]);var zi=a(108);class Sg{constructor(E,ma,Ya,Ub,Hc,Gd){this.ry=!1;this.eXc=new zi.a;this.K_a=ma;this.wO=Ya;this.dHg=Ub;this.Pa=Hc;this.lwe=Gd}enable(){this.ry||(this.Wug(),this.c6d(),this.ry=!0)}generateKey(E,ma,Ya){return String.format("{0}/{1}/{2}",Ya,E,ma)}Bai(){const E=qa.a.Ur(this.K_a().zp);return this.generateKey(this.K_a().breadcrumbFolderName,this.K_a().breadcrumbFolderUrl,E)}Cai(E,ma,Ya){return E&&ma?this.generateKey(E,ma,Ya):Ya}FAh(E,ma,Ya){return E&&
E!==this.K_a().breadcrumbFolderName||ma&&ma!==this.K_a().breadcrumbFolderUrl?!0:Ya!==qa.a.Ur(this.K_a().zp)}Wug(){const E=this.Bai();this.eXc.ga(E,new Date)}lQd(E){this.HYj(E)&&this.Rye(E)}HYj(E){const ma=this.dHg();return ma?this.lwe&&this.lwe.VHb||!ma.Xtf||!V.AFrameworkApplication.hOa?(this.iog(E),this.ry=!1):!0:!1}ZUf(E,ma,Ya,Ub){const Hc=this.FAh(E,ma,Ya),Gd=this.Cai(E,ma,Ya);E=(()=>this.eXc.Ve(Gd))().returnValue;Hc&&!E&&(this.Vkf(Ub),R.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",
this.TGd));Hc||this.eXc.ga(Gd,this.wO())}}Object(N.a)(Sg,"ARenamedFileChecker",null,[889]);class Ni extends Sg{constructor(E,ma,Ya,Ub,Hc,Gd,he,Ke){super(E,ma,Ya,Ub,Hc,Gd);this.vte=Hc;this.wPg=he;this.PKg=Ke}get TGd(){return"RenamedFileCheckerUsingSettingsRefresh"}c6d(){this.vte.C5c(Object(ha.a)(this,this.Ilf,"handleSettingsRefresh"))}Ilf(E,ma){ma&&ma.jMb&&ma.C3i&&(ma.Hbb("BreadcrumbDocName")||ma.Hbb("BreadcrumbFolderName")||ma.Hbb("BreadcrumbFolderUrl")||ma.Hbb("DirectInvokeDAVUrl")||ma.Hbb("EditDocInClientUrl"))&&
(R.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.TGd),this.lQd(ma))}iog(){this.vte.R7f(Object(ha.a)(this,this.Ilf,"handleSettingsRefresh"))}Rye(E){if(E&&E.jMb){const ma=E.jMb;this.ZUf(ma.Ta("BreadcrumbFolderName"),ma.Ta("BreadcrumbFolderUrl"),ma.Ta("BreadcrumbDocName"),E)}}Vkf(E){const ma={OperationResult:0,classId:1};E=E.jMb;ma.BreadcrumbFolderName=E.Ta("BreadcrumbFolderName");ma.BreadcrumbFolderUrl=E.Ta("BreadcrumbFolderUrl");ma.DirectInvokeDavUrl=E.Ta("DirectInvokeDAVUrl");
ma.EditDocInClientUrl=E.Ta("EditDocInClientUrl");E=E.Ta("BreadcrumbDocName");ma.NewName=V.AFrameworkApplication.kya?E:qa.a.Ur(E);this.PKg.execute(Ya=>{this.PAi(ma,Ya)})}PAi(E,ma){this.wPg().QNb(E,ma)}}Object(N.a)(Ni,"RenamedFileCheckerUsingSettingsRefresh",Sg,[]);class ui extends Sg{constructor(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf){super(E,Ya,Ub,Hc,Gd,af);this.urb=this.S5b=null;this.EOg=ma;this.Oa=he;this.Uf=Ke;xf&&xf.execute(wg=>{this.Qyj(wg)})}get TGd(){return"RenamedFileCheckerUsingTask"}Qyj(E){this.S5b=
E;this.S5b.SCe(Object(ha.a)(this,this.EEb,"handleVisibilityChange"))}EEb(E,ma){!this.ry||0!==ma.newState&&1!==ma.newState||this.urb||(this.c6d(),this.lQd(this.urb))}c6d(){this.urb=new Yh.a(3,2,this.EOg(),Object(ha.a)(this,this.lQd,"performRenameFileCheckTick"),89);this.Uf.Ah(this.urb)}iog(E){this.Uf.hr(E)}Rye(E){this.S5b&&2===this.S5b.prk?this.Vzj(E):V.AFrameworkApplication.hOa(Object(ha.a)(this,this.myc,"onRefreshFilenameSuccess"),Object(ha.a)(this,this.lyc,"onRefreshFilenameFailure"),!0)}Vzj(E){this.Uf.hr(E);
this.urb=null}myc(E){E&&this.ZUf(E.BreadcrumbFolderName,E.BreadcrumbFolderUrl,E.NewName,null)}Vkf(){this.Oa.processAction(ob.a.fileNameUpdate,2)}lyc(){}}Object(N.a)(ui,"RenamedFileCheckerUsingTask",Sg,[]);class Wi{constructor(){this.Pa=this.Rc=null}get name(){return"Common.App.RenameFile"}Oj(E){this.Rc=E;this.Pa=V.AFrameworkApplication.fa;this.Rc.register(ah,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ae(()=>new ah(V.AFrameworkApplication.jd,this.Rc.nYd("Common.App.Rename.IRenameDialogFactory"))).se();
this.Rc.register(ti,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ae(()=>new ti(V.AFrameworkApplication.jd)).se();this.Rc.register(889,"Common.App.Rename.IRenamedFileChecker").Ae(()=>this.Xth()).se();this.Rc.register(ki,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ae(()=>new ki(V.AFrameworkApplication.jd,fb.FocusManager.instance())).se()}Xth(){if(this.Pa.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const E=this.Rc.ai("Common.IRefreshableAppSettings");
if(E&&E.Nwf)return new Ni(()=>E.Af("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>V.AFrameworkApplication.Bo,()=>new Date,()=>V.AFrameworkApplication.Dy,E,this.Rc.ai("Common.ISessionStatus"),()=>og.instance,this.Rc.Ed("Postmessage.IHostPostmessenger"))}return new ui(()=>this.Pa.Af("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Pa.Af("RenamedFileCheckerPingIntervalInMs",12E4),()=>V.AFrameworkApplication.Bo,()=>new Date,()=>V.AFrameworkApplication.Dy,V.AFrameworkApplication.fa,V.AFrameworkApplication.jd,
V.AFrameworkApplication.Lj,this.Rc.ai("Common.ISessionStatus"),this.Rc.Ed("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Pa.Xw(Object(ha.a)(this,this.VD,"onFullAppSettingsReady"))}VD(){const E=V.AFrameworkApplication.sa.Sa.Yv;V.AFrameworkApplication.ybb()&&Td.instance.initialize(V.AFrameworkApplication.Ohc,E?null:V.AFrameworkApplication.S6a,E?null:V.AFrameworkApplication.KWd||CommonUIStrings.l_RenameFileTooltip)&&(this.Rc.register(zh,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ae(()=>
new zh(()=>V.AFrameworkApplication.userCanRename,()=>V.AFrameworkApplication.isReadOnlyRecommended,V.AFrameworkApplication.kDc,V.AFrameworkApplication.ybb,new Je.a(()=>V.AFrameworkApplication.Dy))).se(),og.instance.Mi(),this.Pa.qa("RenameDialogIsEnabled")&&(this.Rc.resolve("Common.App.Rename.RenameDialogFactory").initialize(V.AFrameworkApplication.Bo,V.AFrameworkApplication.Ohc),this.Rc.resolve("Common.App.Rename.IRenameDialogActor").Mi()),this.Rc.resolve("Common.App.Rename.IRenameFlyoutActor").Mi(),
V.AFrameworkApplication.kDc&&this.Rc.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Rc.resolve("Common.App.Rename.IRenameFlyoutActor").BXg())}dispose(){}}Object(N.a)(Wi,"PackageManager",null,[3,4]);var xh=a(239),Th=a(391),Ch=a(248);class $h{constructor(E){this.$=E}get Xtf(){return this.$.workbookContext.FileCoauthorable}get VHb(){return!1}get K8a(){return this.$.da.amIAlone}get VYe(){if(this.K8a)return!0;for(const E of this.$.da.Kp)if(!E.SupportsRename)return!1;return!0}}Object(N.a)($h,
"EwaCoauthManager",null,[955]);class Ai extends Va.a{constructor(E,ma){super();this.gha=this.JWd=this.i8f=this.kgd=null;this.Yna=()=>{var Ya=this.$.da.fp;if(Ya&&Ya.WorkbookFileName){var Ub=qa.a.Ur(Ya.WorkbookFileName),Hc=!!Xc.a.compare(this.$.workbookContext.WorkbookFileName,Ya.WorkbookFileName,!1),Gd=Ga.EwaSettings.Da(465)&&!!Ya.BreadcrumbFolderUrl&&!!Xc.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Ya.BreadcrumbFolderUrl,!1);if(Hc||Gd)this.gha={},this.gha.NewFileName=Ub,
this.gha.EditDocInClientUrl=Ya.EditDocInClientUrl,this.gha.DirectInvokeDAVUrl=Ya.DirectInvokeDAVUrl,this.gha.DownloadACopyUrl=Ya.DownloadACopyUrl,Ga.EwaSettings.Da(465)&&Ya.BreadcrumbFolderUrl&&(this.gha.BreadcrumbFolderName=Ya.BreadcrumbFolderName,this.gha.BreadcrumbFolderUrl=Ya.BreadcrumbFolderUrl),Ya=V.AFrameworkApplication.jd.Sf(ob.a.fileNameUpdate,2,Ub),this.gha=null,R.ULS.shipAssertTag(537154064,0,32===Ya,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.$7i=
(Ya,Ub,Hc)=>{this.i8f=Ub;this.JWd=Hc;this.$.Ha.kd(new Pe.a(1897077126,Ce.a.ld,2,3,null),{["newFileName"]:Ya})};this.Z7i=Ya=>{this.gha&&Ya(this.Wgf(this.gha),this.Yr)};this.QNb=Ya=>{Ch.a(Ya)||!Ya.Result?(Ya=Ai.S0h(Ya),oa.a(this.$).ef.VO([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.JWd(Ya)):this.i8f(this.Wgf(Ya.Result),this.Yr)};this.Rdj=()=>{this.JWd(5)};this.$=E;this.Yr=ma;this.$.da.zw(this.Yna)}initialize(){V.AFrameworkApplication.fhc=this.$7i;V.AFrameworkApplication.hOa=
this.Z7i;this.kgd=V.AFrameworkApplication.Dy;V.AFrameworkApplication.Dy=new $h(this.$)}dispose(){V.AFrameworkApplication.fhc=null;V.AFrameworkApplication.hOa=null;this.$.da.Zx(this.Yna);V.AFrameworkApplication.Dy=this.kgd;this.$=this.kgd=null;super.dispose()}renameFile(E,ma){const Ya=E.newFileName;if(Ya&&(E=qa.a.Ur(this.$.workbookContext.WorkbookFileName),Xc.a.compare(E,Ya,!1))){const Ub=this.$.pa.ua.Ud();Gh.a(this.$.userOperationManager,(Hc,Gd,he)=>{var Ke=this.$.pa.ua;Hc=te.b(Hc,this.QNb);Gd=te.a(Gd,
this.Rdj);const af=Ke.Ra(9,Ub);af.newFileName=Ya;return Yc.g(Ke,"RenameFile",af,Hc,Gd,he,null,0)},Hc=>new Eh.a(134,0,Hc),ma)}}oDi(){return 32===V.AFrameworkApplication.jd.processAction(ob.a.Lla,1)}Wgf(E){var ma=this.$.workbookContext;V.AFrameworkApplication.t1=E.DownloadACopyUrl;const Ya=Ga.EwaSettings.Da(465)&&!!E.BreadcrumbFolderUrl;Ya&&(V.AFrameworkApplication.Bo.breadcrumbFolderName=E.BreadcrumbFolderName,V.AFrameworkApplication.Bo.breadcrumbFolderUrl=E.BreadcrumbFolderUrl,ma.FullDocumentInfo.BreadcrumbFolderUrl=
E.BreadcrumbFolderUrl,ma.FullDocumentInfo.BreadcrumbFolderName=E.BreadcrumbFolderName);ma.FullDocumentInfo.BreadcrumbDocName=E.NewFileName;Th.d(ma,E.NewFileName);ma={};ma.NewName=E.NewFileName;ma.DirectInvokeDavUrl=E.DirectInvokeDAVUrl;ma.EditDocInClientUrl=E.EditDocInClientUrl;Ya&&(ma.BreadcrumbFolderName=E.BreadcrumbFolderName,ma.BreadcrumbFolderUrl=E.BreadcrumbFolderUrl);ma.OperationResult=0;return ma}static S0h(E){switch(E.Errors[0].MessageId){case -414480287:E=2;break;case 650565124:E=1;break;
case 1636785843:E=6;break;case -782844485:E=4;break;default:E=5}return E}}Object(N.a)(Ai,"RenameFileManager",Va.a,[888,5]);class Xf extends Db.a{constructor(E){super();this.g1=this.renameFileManager=null;this.$=E;this.Md()}create(){if(!this.g1){const E=xh.a.c6a(We.b(),this.ka,"Task","IRenameFileManager");this.g1=E.task;const ma=Rb.GetServiceTaskFactory.create(this.$.ea,137,this.ka,this.Na),Ya=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(hf.d)(Gb.a.resolve(fd.w,
{Qa:this.Na})):Rb.GetServiceTaskFactory.create(this.$.ea,155,this.ka,this.Na);fc.TaskExtensions.ya(fc.TaskExtensions.Bf([Ya,ma],this.ka),()=>{const Ub=new Ai(this.$,ma.result);this.$.ea.Ja(120,Ub);E.setResult(Ub)},this.ka,3)}this.g1.continueWith(E=>{this.qd(E.result)})}dispose(){Xd.a.Ma(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(E){E.ea.Ja(119,new Xf(E))}}Object(N.a)(Xf,"RenameFileManagerServiceFactory",Db.a,[]);var Hg=a(37),Te=a(556),H=a(182),la=a(142),Ha=
a(113),Bb=a(320),jc=a(143),Rc=a(385);class Sc{constructor(E){this.O$a=this.joc=0;this.gac=null;this.euf=!1;this.$=E;this.euf=E.ysc}PFi(){return ub.h(this.$).Xc?(R.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.hd.FA?(R.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}Z8i(E){this.gac=new Sys.UI.Point(Math.round(E.hza.center.x),Math.round(E.hza.center.y));
this.joc=Hg.a(this.$).zoom;this.O$a=E.hza.scale;let ma={["InitialZoom"]:this.joc,["Location"]:"canvas",["InputMethod"]:E.ud};jc.b(this.$).Xe(la.a.Mlj,ma);R.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.gac.x},${this.gac.y}), initial zoom ${this.joc}, initial scale ${this.O$a}`);this.ndb(E,"onGestureStart");return!0}Y8i(E){if(!this.O$a)return R.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),
this.ndb(E,"OnGestureEvent"),!0;if(!isFinite(this.O$a))return R.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.O$a}`),this.ndb(E,"OnGestureEvent"),!0;const ma=E.hza.scale/this.O$a*this.joc;Hg.a(this.$).xAg(ma,this.gac);R.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ma}. Current scale ${E.hza.scale}`);this.ndb(E,"OnGestureEvent");return!0}X8i(E){Hg.a(this.$).yAg();
R.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.ndb(E,"OnGestureEnd")}W8i(E){R.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.ndb(E,"OnGestureCancel")}ndb(E,ma){var Ya,Ub,Hc;this.euf&&(R.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ma},        eventArgs non-null: ${isNullOrUndefined(E)}, gestureData non-null: ${isNullOrUndefined(null===E||void 0===E?void 0:E.hza)},        srcEvent non-null: ${isNullOrUndefined(null===
(Ya=null===E||void 0===E?void 0:E.hza)||void 0===Ya?void 0:Ya.srcEvent)}`),null===(Hc=null===(Ub=null===E||void 0===E?void 0:E.hza)||void 0===Ub?void 0:Ub.srcEvent)||void 0===Hc?void 0:Hc.preventDefault())}}Object(N.a)(Sc,"PinchToZoomAdapter",null,[959]);class Cd extends ta.a{constructor(){super()}nDe(E){this.addHandler("ZCIEK",E)}h8f(E){this.removeHandler("ZCIEK",E)}Z5c(E){this.addHandler("ZCUIK",E)}HWd(E){this.removeHandler("ZCUIK",E)}wtj(){this.raiseEvent("ZCIEK")}vtj(){this.raiseEvent("ZCUIK")}xtj(){this.raiseEvent("ZCEK")}}
Object(N.a)(Cd,"ZoomEventManager",ta.a,[905]);var vd=a(91);class Jd extends ta.a{constructor(E){super();this.statusBarManager=null;this.J9e=!1;this.$=E;this.$.ea.Zc(29,ma=>{this.statusBarManager=ma;ma.gM(this)})}Ks(E){this.addHandler("Zoom",E)}ot(E){this.removeHandler("Zoom",E)}fC(){this.Jp("QueryZoomStatus")&&this.raiseEvent("Zoom")}Du(E,ma){return"QueryZoomStatus"!==E?!1:this.qpi(ma)}Jp(){return Hg.a(this.$).tV()}dispose(){this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=
null);this.$=null;super.dispose()}Fjf(E){E=this.vli(E);if(!E)return null;E=E.getElementsByClassName("cui-ctl-mediumlabel");return 1!==E.length?(R.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):E[0]}qpi(E){if(!this.$)return!1;const ma=Hg.a(this.$).LYb;let Ya=!1;if(fa.a.Fo())Xc.a.equals(appChrome.selectors.getControlLabel(vd.a.zoomStatusBarMenuOpen),ma,!1)||(Ya=!0);else{const Ub=this.Fjf("HandleQueryZoomStatusCommand");Ub?Xc.a.equals(E.LabelText.toString(),
ma,!1)||(Ub.innerText="",Ya=!0):Ya=!0}Ya&&this.iSj(E,ma);return!0}iSj(E,ma){E.LabelText=ma;fa.a.Fo()&&(E.Visible=!0)}vli(E){var ma=nb.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ma)return ma=(ma=this.$.da.ae)?ma.inEmbedView:!1,pb.a.rr||ma||R.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${E}`),null;this.J9e||(this.J9e=!0,R.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${E}`));
return ma}}Object(N.a)(Jd,"ZoomStatusBarManager",ta.a,[5,187,188]);class pe extends Te.a{constructor(E){super(E);this.zoomEventManager=this.IBa=this.VJb=null;this.bKb=-1;this.duf=!1;this.df=()=>{this.bKb=-1};R.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.mmb=new Jd(E);this.Nlj()&&(R.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.q6g());this.Uyj()}dispose(){this.mmb&&(Xd.a.Ma(this.mmb),this.mmb=null);this.zoomEventManager&&(this.$.ea.sX(419),
this.zoomEventManager=null);this.duf&&this.bAh();super.dispose()}tV(){return!0}xAg(E,ma){E=this.yOa(E);if(ub.h(this.$).rtl){const Ya=Math.round(nb.DOMElementExtensions.getBounds(this.$.oh).width*Hg.a(this.$).zoom);this.VJb=new Sys.UI.Point(Ya-ma.x,ma.y)}else this.VJb=ma;this.eXa(E,!1,"ZoomWithPinch")}hOc(){return!0}gOc(E,ma){var Ya=pb.a.isMac?.07:.15;E=this.zoom+(E?Ya:-Ya);E=this.yOa(E);ub.h(this.$).rtl?(Ya=Math.round(nb.DOMElementExtensions.getBounds(this.$.oh).width*Hg.a(this.$).zoom),this.IBa=
new Sys.UI.Point(Ya-ma.x,ma.y)):this.IBa=ma;ma=this.zoom;this.eXa(E,!0,"ZoomWithMouse");ma={["InitialZoom"]:ma,["FinalZoom"]:E,["Location"]:"canvas"};jc.b(this.$).Xe(la.a.lqk,ma)}yAg(){this.VJb=null}iOc(E,ma){this.eXa(this.yOa(E),!1,ma?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}zAg(E){isNaN(E)?R.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.eXa(this.yOa(E),!1,"ZoomToLevelInExcelLive")}jOc(E,ma){this.eXa(this.yOa(E),
!0,ma?"ZoomWithShortcuts":"ZoomWithButtons")}yhf(E,ma){const Ya=ub.h(this.$).rtl,[Ub,Hc]=this.Ird(Ya),[Gd,he]=this.Btd(E,Hc);return this.IBa?(E=this.ord(this.IBa,E,ma,Hc,Ub,"ZoomWithMouse"),this.IBa=null,E):this.VJb?this.ord(this.VJb,E,ma,Hc,Ub,"ZoomWithPinch"):ub.h(this.$).ha.Va.TT?this.kqk(E,ma,Hc,Ub,Gd,he,ub.h(this.$).rtl):this.mqk(E,ma,Hc,Ub,Gd,he,ub.h(this.$).rtl)}kdg(E,ma,Ya){if(E){R.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${E.x} ${E.y}) (new top-left) from zoom:${ma} to zoom:${Ya}`);E=new yh.a(E.x,
E.y);Ya=ub.h(this.$).rtl;[,Ya]=this.Ird(Ya);const [Ub,Hc]=this.Btd(ma,Ya);ub.h(this.$).SDe(E,Ub,Hc,"ApplicationZoom")}else R.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ma} to zoom:${Ya}`)}zoomFitToScreen(){const E=this.zoom;var ma=ub.h(this.$).rtl;const [Ya,Ub]=this.Ird(ma),[Hc,Gd]=this.Btd(E,Ub);var he=ub.h(this.$).ha.Va.TT;(ma=he?this.ldf(this.ffb,Hc,Gd,!1):this.Hhf(this.ffb,Ub,Ya,Hc,Gd,ma,!1))?(ma=Math.min(Hc/(ma.width+100),Gd/(ma.height+100)),ma=this.rXh(ma),this.eXa(ma,!0,
"ZoomWithFitToScreen"),he?ub.h(this.$).ha.Va.aMa(ub.h(this.$).ha.Va.Yd,!1):(he=Md.v(ub.h(this.$).ha.ra.activeRange,this.$),ub.h(this.$).qj(he,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.bKb=E,this.duf||this.k6g()):R.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${he}`)}zoomFitToScreenUndo(){this.eXa(this.bKb,!1,"ZoomWithFitToScreen")}D3d(){return-1!==this.bKb}k6g(){const E=ub.h(this.$);E&&(E.ha.cr(this.df),E.XG(this.df))}bAh(){const E=
ub.h(this.$);E&&(E.ha.vr(this.df),E.zI(this.df))}rXh(E){E=Math.min(E,ef.a.AYi);E=Math.max(E,ef.a.tZi);return Math.round(100*E)/100}eXa(E,ma,Ya){if(this.eOc()){var Ub=ub.h(this.$).view.visibleArea.toString();E=this.yOa(E);var Hc=Jf.d(this.$.va.na);Hc||(Hc=Te.a.uJf);ub.h(this.$).Ri.w4(5,Bb.a.dOc,Ya);ub.h(this.$).Ri.Dpa(Bb.a.dOc,this.$.da.mg);R.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${E} to sheet ${Hc} origin ${Ya} prevZoom ${this.zoom}`);this.$Uj(Hc,E);this.zoomEventManager.xtj();
this.yck(Ya);this.Kck(ma);this.bKb=-1;Rc.b(this.$,Ya);E=ub.h(this.$).view.visibleArea.toString();R.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Ub}, NewGridVisibleArea: ${E}, IsShyRibbonActive: ${this.$.T2}`)}}J5h(E){return(E=ce.HelperMethods.EF(this.$.oh,this.$.domElement,E))?E:new Sys.UI.Point(0,0)}Ird(E){const ma=this.J5h(E);E=this.x$h(ma,E);return[ma,E]}Btd(E,ma){const Ya=nb.DOMElementExtensions.getBounds(this.$.oh);return[Math.round((Ya.width-ma.x)*E),Math.round((Ya.height-
ma.y)*E)]}x$h(E,ma){ma=ce.HelperMethods.EF(ub.h(this.$).domElement,this.$.domElement,ma);return ma?(E=new Sys.UI.Point(Math.round(ma.x-E.x),Math.round(ma.y-E.y)),E):new Sys.UI.Point(0,0)}mqk(E,ma,Ya,Ub,Hc,Gd,he){return(he=this.Hhf(E,Ya,Ub,Hc,Gd,he))?this.rgf(he,E,ma,Ya,Ub,Hc,Gd):null}Hhf(E,ma,Ya,Ub,Hc,Gd,he){he=void 0===he?!0:he;var Ke=Md.G(ub.h(this.$).ha.ra.selectedRanges);if(he&&(Ke=Ke.Xf(Md.G(ub.h(this.$).Nlc())),!Ke))return R.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;const af=ub.h(this.$).yd(Ke.topLeft);Ke=ub.h(this.$).yd(Ke.bottomRight);if(!af||!Ke)return R.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;E=af.cell.UH===Ke.cell.UH&&af.cell.TH===Ke.cell.TH?this.D4h(E,Ke,ma,Ya,Ub,Gd):this.eki(E,af,Ke,ma,Ya,Ub,Gd);return E?he?this.r8e(E,Ub,Hc):E:(R.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}r8e(E,
ma,Ya){if(0>E.x||E.x>ma)E.x=0;if(0>E.y||E.y>Ya)E.y=0;E.x+E.width>ma&&(E.width=ma-E.x);E.y+E.height>Ya&&(E.height=Ya-E.y);return E}eki(E,ma,Ya,Ub,Hc,Gd,he){ma=ub.h(this.$).getCellBounds(ma.cell);if(!ma)return null;const Ke=ub.h(this.$).getCellBounds(Ya.cell);if(!Ke)return null;let af=Hc.x;he&&(af=0,ma.x=Math.round(Gd/E)-ma.x-Math.round(ma.width),Ke.x=Math.round(Gd/E)-Ke.x-Math.round(Ke.width));E=new Sys.UI.Bounds(Math.round((ma.x-Ub.x)*E)-af,Math.round((ma.y-Ub.y)*E-Hc.y),Math.round((Ke.x+Ke.width-
ma.x)*E),Math.round((Ke.y+Ke.height-ma.y)*E));Ya=Ya.cell.getRange();R.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Ya.top}, b:${Ya.bottom}, r:${Ya.right}, l:${Ya.left}) in bounds (${E.x}, ${E.y}, ${E.width}, ${E.height})`);return E}D4h(E,ma,Ya,Ub,Hc,Gd){const he=ub.h(this.$).getCellBounds(ma.cell);if(!he)return null;let Ke=Ub.x;Gd&&(Ke=0,he.x=Math.round(Hc/E)-he.x-Math.round(he.width));E=new Sys.UI.Bounds(Math.round((he.x-
Ya.x)*E)-Ke,Math.round((he.y-Ya.y)*E-Ub.y),Math.round(he.width*E),Math.round(he.height*E));ma=ma.cell.getRange();R.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ma.top}, l:${ma.left}) in bounds (${E.x}, ${E.y}, ${E.width}, ${E.height})`);return E}kqk(E,ma,Ya,Ub,Hc,Gd){const he=this.ldf(E,Hc,Gd);return he?this.rgf(he,E,ma,Ya,Ub,Hc,Gd):null}rgf(E,ma,Ya,Ub,Hc,Gd,he){E=new Sys.UI.Point(this.Ugf(Gd,E.x,E.width),this.Ugf(he,E.y,E.height));
return this.ord(E,ma,Ya,Ub,Hc)}Ugf(E,ma,Ya){return E===Ya?(R.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),E/2):E*ma/(E-Ya)}ldf(E,ma,Ya,Ub){Ub=void 0===Ub?!0:Ub;const Hc=ub.h(this.$).ha.Va.Yd.domElement;var Gd=ce.HelperMethods.EF(Hc,ub.h(this.$).domElement,ub.h(this.$).rtl);if(!Gd)return R.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const he=
ub.h(this.$).jEb();Gd=new Sys.UI.Point(Math.round((Gd.x-he.topLeft.x)*E),Math.round((Gd.y-he.topLeft.y)*E));E=new Sys.UI.Bounds(Gd.x,Gd.y,Math.round(Hc.offsetWidth*E),Math.round(Hc.offsetHeight*E));return Ub?this.r8e(E,ma,Ya):E}RJf(){this.mmb.fC()}j2i(E){"ZoomToLevelInExcelLive"===E?this.zoomEventManager.wtj():this.zoomEventManager.vtj()}Uyj(){this.zoomEventManager=this.$.ea.Ja(419,new Cd)}ord(E,ma,Ya,Ub,Hc,Gd){Gd=void 0===Gd?"":Gd;var he=ub.h(this.$).rtl?0:Hc.x;Hc="ZoomWithPinch"===Gd||"ZoomWithMouse"===
Gd?new Sys.UI.Point(E.x-he-Math.round(Ub.x*ma),E.y-Hc.y-Math.round(Ub.y*ma)):E;Hc=new Sys.UI.Point(Math.round(Hc.x/ma),Math.round(Hc.y/ma));R.ULS.shipAssertTag(537149770,0,!!ma,"Original zoom level must be different than 0");he=Ya/ma;Hc=new Sys.UI.Point(Math.round(Hc.x*(1-1/he)),Math.round(Hc.y*(1-1/he)));"ZoomWithMouse"===Gd||"ZoomWithPinch"===Gd?(Hc.x+=Math.round((Ub.x-ub.h(this.$).gu)*(he-1)),Hc.y+=Math.round((Ub.y-ub.h(this.$).uM)*(he-1))):(he=Math.round(Ub.x*(Ya-ma)),0<he&&Hc.x>he&&(Hc.x+=he),
ma=Math.round(Ub.y*(Ya-ma)),0<ma&&Hc.y>ma&&(Hc.y+=ma));"ZoomWithMouse"===Gd&&(E.x||(Hc.x=0),E.y||(Hc.y=0));E=ub.h(this.$).jEb();return new Sys.UI.Point(Hc.x+E.topLeft.x,Hc.y+E.topLeft.y)}q6g(){const E=[];qb.a.instance.Ed("Common.IGestureInputManager").execute(ma=>{0===ma.U9h()&&ma.qxj(document.body,new Sc(this.$),E)})}Nlj(){return this.eOc()&&(pb.a.Eo&&pb.a.KAa(67)||this.$.ysc)}$Uj(E,ma){Rc.a(this.$)?this.setZoomLevel(E,ma,this.Nce,ef.a.i_f):this.setZoomLevel(E,ma,this.zoomPerSheetId,this.ffb)}setZoomLevel(E,
ma,Ya,Ub){Ya.remove(E);ma!==Ub&&Ya.add(E,ma)}yck(E){this.qhg();this.$.PDa(wb.a.W1("TriggerImmediateZoomOperations"));this.Vkk();this.j2i(E)}Vkk(){this.XJi()?this.$.fh():this.mmb.fC();const E=this.mmb.Fjf("UpdateZoomStatusBar");E&&(E.innerText=this.LYb)}XJi(){const E=H.a(this.$);return E?E.xr.WA===(fa.a.MRa(this.$)?ie.a.uBc:this.$.Ad+ie.a.Kag):!1}Kck(E){ub.h(this.$).jqk(E);this.o2g()}o2g(){const E=Ha.a(this.$);if(E)for(const ma of ub.h(this.$).za.Ky()){if(!ma){R.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");
continue}if(!ma.il)continue;const Ya=ma.ak;if(Ya)for(let Ub=0;Ub<Ya.count;Ub++)if(2===Ya.Xh(Ub).type){const Hc=E.Ws(Ya.Xh(Ub).Ji());Hc?(Hc.ria(!1),R.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):R.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else R.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(N.a)(pe,
"ZoomManager",Te.a,[]);class Ge extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){const E=new pe(this.$);this.Xkk(E);this.$.ea.Ja(368,E);this.qd(E)}Xkk(E){const ma=Hg.a(this.$);if(ma){var Ya=ma.Gtd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");E.O1d(Ya);E.OEc(ma.LLc)}else R.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(E){E.ea.Ja(369,
new Ge(E))}}Object(N.a)(Ge,"ZoomManagerFactory",Db.a,[]);var $e=a(838);class Bf extends Db.a{constructor(){super();this.Md()}create(){this.qd(new $e.a)}}Object(N.a)(Bf,"CommonUIJsServiceFactory",Db.a,[]);var yf=a(1008);class wf{}Object(N.a)(wf,"LokiTokenResult",null,[]);class sg{constructor(E){this.M2b=E}drd(){const E=this.obi();return E?sg.DBd?new Promise((ma,Ya)=>{this.M2b.continueWith(()=>{this.M2b.jj||this.M2b.Gh?Ya(Error.create("Error downloading auth library")):this.M2b.result.rE("Loki",E).then(Ub=>
{Ub=V.AFrameworkApplication.fa.qa("ForceLokiFallbackToACLPTokenIsEnabled")?this.rbi():Ub.IsSuccess&&Ub.Token?Object.assign(new wf,{isSuccess:!0,token:Ub.Token,errorMessage:null}):Object.assign(new wf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ub)});ma(Ub);return Ub})})}):Promise.resolve(Object.assign(new wf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new wf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",
yf.a.zaf())}))}rbi(){const E=V.AFrameworkApplication.fa.Ta("LokiUserDataSignature")||"";return Object.assign(new wf,{isSuccess:!0,token:E,errorMessage:null})}obi(){let E=null;const ma=yf.a.tjc();2===ma?E=V.AFrameworkApplication.fa.Ta("LokiAADAppId"):1===ma&&(E=V.AFrameworkApplication.fa.Ta("LokiMSAAppId"));return E}static get DBd(){return V.AFrameworkApplication.fa.qa("IsO365CommercialHost")||V.AFrameworkApplication.fa.qa("IsO365ConsumerHost")}}Object(N.a)(sg,"LokiTokenManager",null,[875]);var Sf=
a(530);class eg{get name(){return"Common.App.LivePersonaUtils"}init(){qb.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Oj(E){E.register(sg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").se().Ae(()=>new sg(Sf.a.Tq(E.Ed("Common.App.OAuth.IOAuthManager"))))}static main(){Wa.a.instance.Mk(new eg)}}Object(N.a)(eg,"LivePersonaUtilsPackage",null,[3,4]);class xg{constructor(E){this.Pja=this.Ija=this.Uja=this.Tja=null;this.Oke=this.xie=this.Pke=this.ooe=this.Hz=
this.GO=!1;this.u_c=this.Goe=null;this.woe=0;this.Pa=this.Doe=null;this.u5=E;this.Ez=3;this.t0a=!0}initialize(E,ma,Ya){this.Tja=this.nsd(E,ma);this.Uja=CommonUIStrings.l_SavingStatus;this.Ija=CommonUIStrings.l_ReadOnlyStatus;this.Pja=CommonUIStrings.l_ReviewModeStatus;this.u5&&this.u5.execute(Ub=>{Ub.y5c(Object(ha.a)(this,this.IXb,"updateToSavingStatus"))});this.Hz=!0;this.Pa=Ya;this.xie=this.Pa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}wia(E,
ma){this.GO=E;this.Ez=ma;this.mV(this.t0a)}mV(E){!this.t0a&&E&&(this.Doe=new Date);this.t0a=E;this.Oke=!1;E=null;3===this.Ez&&(E=this.t0a?this.Tja:this.Uja);this.wBh(E)}nsd(E,ma){return E?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):ma&&ma.length?String.format(CommonUIStrings.l_SavedToStatus,ma):CommonUIStrings.l_SavedStatus}IXb(){this.mV(!1)}Obi(){switch(this.Ez){case 1:return this.Ija;case 2:return this.Pja;default:return null}}getMode(){if(3!==this.Ez)switch(this.Ez){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.Oke?"FailedToSave":this.t0a?"Saved":"Saving"}cEi(E){return this.ooe===this.GO&&this.woe===this.Ez&&this.Goe===E}ehd(E){appChrome.getHeaderApi().then(ma=>{ma.updateDocumentTitleStatus(this.GO,E,this.Obi(),this.Doe,this.t0a,this.xie?ma.getHeaderSaveStatusIconProps(this.getMode()):null);this.Pke=!0;return null});this.u_c=null}wBh(E){this.Hz&&ya.c()&&!this.cEi(E)&&(!this.Pke&&this.Pa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.ehd(E):ac.a.yXd()?(this.u_c&&R.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.u_c=window.requestIdleCallback(()=>{this.ehd(E)})):window.requestAnimationFrame(()=>{this.ehd(E)}),this.ooe=this.GO,this.Goe=E,this.woe=this.Ez)}}Object(N.a)(xg,"ReactSaveStatusUIHandler",null,[904]);class mg{constructor(E,ma){this.Yr=null;this.Tja=CommonUIStrings.l_SavedStatus;this.Uja=CommonUIStrings.l_SavingStatus;this.Ija=CommonUIStrings.l_ReadOnlyStatus;
this.Pja=CommonUIStrings.l_ReviewModeStatus;this.U0b=ma;this.u5=E;this.Ez=3;this.Ava=!0}gw(){this.u5&&this.u5.execute(E=>{E.y5c(Object(ha.a)(this,this.IXb,"updateToSavingStatus"))});this.U0b.execute(E=>{this.Yr=E})}wia(E,ma){this.Ez=ma;3===ma?this.mV(this.Ava):2===ma?this.O9d(this.Pja):this.O9d(this.Ija)}IXb(){this.mV(!1)}mV(E){this.Ava=E;this.O9d(this.Ava?this.Tja:this.Uja)}O9d(E){this.Yr&&this.Yr.sendMessage(uf.a.Mek,this.emh(E))}emh(E){const ma={};ma.StatusText=E;return ma}}Object(N.a)(mg,"SaveStatusPostMessageHandler",
null,[904]);var nd=a(138),je=a(60);class ug{constructor(E,ma,Ya,Ub){this.Pja=this.Ija=this.Uja=this.Tja=null;this.RIa=0;this.QG=this.i0c=this.bHa=this.HPc=this.PJa=null;this.If=E;this.Vba=ma;this.u5=Ya;this.Kl=Ub;this.Eme=!0;this.GO=!1;this.Ez=3;this.Ava=!0}initialize(E,ma){if(!this.If)return!1;this.Tja=this.nsd(E,ma);this.Uja=CommonUIStrings.l_SavingStatus;this.Ija=CommonUIStrings.l_ReadOnlyStatus;this.Pja=CommonUIStrings.l_ReviewModeStatus;this.gw();return!0}nsd(E,ma){return E?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):ma&&ma.length?String.format(CommonUIStrings.l_SavedToStatus,ma):CommonUIStrings.l_SavedStatus}gw(){this.Vba&&this.Vba.execute(E=>{E.p0g(Object(ha.a)(this,this.BUe,"createStatusAndModeElements"));E.i0g(Object(ha.a)(this,this.P0j,"showHideSaveStatusElement"));E.jbk&&this.BUe(null,null)});this.u5&&this.u5.execute(E=>{E.y5c(Object(ha.a)(this,this.IXb,"updateToSavingStatus"))})}jy(){this.QG&&this.If&&this.If.WI(this.QG)}P0j(E,ma){this.wia("true"===ma,this.Ez)}wia(E,ma){this.GO=
E;this.Ez=ma;this.HPc&&(this.HPc.style.display=this.GO||3===this.Ez||!this.PJa?"none":"");this.bHa&&(this.bHa.style.display=this.GO||3===this.Ez?"none":"",this.bHa.innerText=1===this.Ez?this.Ija:this.Pja,this.bHa.title=1===this.Ez?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.i0c&&(this.i0c.style.display=this.GO||1===this.Ez||!this.PJa&&!this.bHa?"none":"");this.QG&&(this.QG.style.display=this.GO||1===this.Ez?"none":"",this.mV(this.Ava),this.QG.title=CommonUIStrings.l_SaveStatusTooltip)}BUe(E,
ma){E=document.getElementById(Ae.CuiHelper.$mf);ma&&ma.Xok||!E||""===this.Tja||""===this.Uja||""===this.Ija||""===this.Pja||(this.PJa=document.getElementById(Ae.CuiHelper.X9b),this.HPc=Ae.CuiHelper.Bxa(E,"BreadcrumbAppModeDash","-",null,!1),this.bHa=Ae.CuiHelper.Bxa(E,"BreadcrumbAppModeStatus",1===this.Ez?this.Ija:this.Pja,null,!1),this.Nvg(this.bHa),this.i0c=Ae.CuiHelper.Bxa(E,"BreadcrumbSaveStatusDash","-",null,!1),this.QG=Ae.CuiHelper.Bxa(E,"BreadcrumbSaveStatus",this.Tja,null,!1),this.Nvg(this.QG),
this.wia(this.GO,this.Ez))}IXb(){this.mV(!1)}mV(E){this.Ava=E;this.Yjk(this.Ava?this.Tja:this.Uja)}Yjk(E){!this.QG||3!==this.Ez&&2!==this.Ez||(this.Eme&&!this.Ava?(this.RIa=this.QG.offsetWidth<this.RIa?this.RIa:this.QG.offsetWidth,this.Tgk(this.Uja),this.Eme=!1):this.QG.innerText=E)}Nvg(E){E.style.direction=this.Kl?"rtl":"ltr";E.style.width="auto";E.style.textAlign=this.Kl?"right":"left";E.style.display=this.GO?"none":"";E.setAttribute("Unselectable","on")}Tgk(E){this.QG&&(this.QG.style.width="",
this.QG.innerText=E,this.RIa=this.QG.offsetWidth<this.RIa?this.RIa:this.QG.offsetWidth,E=nd.a.OB(this.QG),this.QG.style.width=this.RIa-je.a.fG(E.paddingLeft)-je.a.fG(E.paddingRight)+1+"px")}}Object(N.a)(ug,"SaveStatusUIHandler",null,[904]);var kh=a(102);class qh{constructor(){this.j0c=this.g_c=this.Hrb=this.Rc=null}get name(){return"Common.App.SaveStatus"}Oj(E){this.Rc=E;V.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&V.AFrameworkApplication.hideHeaderEmbedded?this.Rc.register(mg,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").se().Ae(()=>
new mg(this.Rc.Ed("Common.App.HostNotification.EditNotificationEventSource"),this.Rc.Ed("Postmessage.IHostPostmessenger"))):V.AFrameworkApplication.sa.Sa.ayf||(V.AFrameworkApplication.sa.Sa.Yv?this.Rc.register(xg,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").se().Ae(()=>new xg(this.Rc.Ed("Common.App.HostNotification.EditNotificationEventSource"))):this.Rc.register(ug,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").se().Ae(()=>
new ug(kh.EventHandlerManager.instance,this.Rc.Ed("Common.App.Header.HeaderEventSource"),this.Rc.Ed("Common.App.HostNotification.EditNotificationEventSource"),V.AFrameworkApplication.isRtl)))}init(){V.AFrameworkApplication.fa.Xw(Object(ha.a)(this,this.VD,"onFullAppSettingsReady"))}VD(){const E=V.AFrameworkApplication.fa,ma=!!V.AFrameworkApplication.sa.Sa&&4===V.AFrameworkApplication.sa.Sa.Xi;if(E.qa("WordEditorAutoSaveImprovementIsEnabled")||E.qa("PptEditorSaveStatusInHeaderEnabled")||ma&&E.qa("SimplifiedReactRibbonUxIsEnabled")||
E.qa("ExcelSaveStatusInHeaderEnabled")||E.qa("VisioSaveStatusInHeaderEnabled"))V.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&V.AFrameworkApplication.hideHeaderEmbedded?(this.j0c=this.Rc.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.j0c.gw():V.AFrameworkApplication.sa.Sa.ayf||V.AFrameworkApplication.hideHeader||(V.AFrameworkApplication.sa.Sa.Yv?(this.g_c=this.Rc.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.g_c.initialize(E.qa("IsSkyDrive"),E.Ta("HostNameToIncludeInSavedStatus"),
V.AFrameworkApplication.fa):(this.Hrb=this.Rc.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Hrb.initialize(E.qa("IsSkyDrive"),E.Ta("HostNameToIncludeInSavedStatus")))}dispose(){this.Hrb&&this.Hrb.jy()}}Object(N.a)(qh,"PackageManager",null,[3,4]);var Xh=a(237);class oh{constructor(E,ma){this.Aue=this.pVc=!1;this.kDa=(Ya,Ub)=>{(null===Ub||void 0===Ub?0:Ub.aK)&&$g.a.s5g([Ub.aK])&&(this.BSb=!0)};this.kp=()=>{this.BSb=!1};this.Qe=(Ya,Ub)=>{Xh.b(Ub)&&this.wia(!0);this.BSb=!1};this.kf=()=>
{this.OT=this.$.OT;this.wia()};this.HTf=()=>{this.mV()};this.KSf=()=>{this.OT=this.$.OT};this.nMd=()=>{ub.h(this.$).za.eu(this.nMd);this.OT=this.$.OT};this.scg=ma;this.$=E;this.$.userOperationManager.Gt(this.KSf);this.$.Pm(this.kf);this.$.da.R0g(this.HTf);this.$.da.Pl(this.Qe);this.$.E7b(this.kDa);this.$.da.jM(this.kp);this.wia()}get VOi(){return this.$.da?this.$.da.MAf:!1}get OT(){return this.pVc}set OT(E){E?this.pVc=!0:ub.h(this.$)&&ub.h(this.$).za&&(ub.h(this.$).za.S8()?this.pVc=!1:ub.h(this.$).za.su(this.nMd));
this.mV()}get BSb(){return this.Aue}set BSb(E){this.Aue=E;this.mV()}dispose(){this.$&&(this.$.Rn(this.kf),this.$.$Cc(this.kDa),this.$.userOperationManager&&this.$.userOperationManager.mq(this.KSf),this.$.da&&(this.$.da.rDj(this.HTf),this.$.da.Vl(this.Qe),this.$.da.XQ(this.kp)),ub.h(this.$)&&ub.h(this.$).za&&ub.h(this.$).za.eu(this.nMd))}wia(E){E=!this.$.isEditMode||(void 0===E?!1:E);this.scg.wia(E,this.$.isEditMode?3:1);this.mV()}mV(){this.$.isEditMode&&this.scg.mV(!this.OT&&!this.VOi&&!this.BSb)}}
Object(N.a)(oh,"SaveStatusManager",null,[5]);class pi extends Db.a{constructor(E){super();this.$e=E;this.Md()}create(){const E=qb.a.instance;E.Ed("Common.App.SaveStatus.ISaveStatusUIHandler").execute(ma=>{const Ya=new oh(this.$e,ma);E.register(oh,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").se().Ae(()=>Ya);ma=Object(ic.a)(this.$e.ea,300,()=>E.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.qd(ma)})}static la(E){E.ea.Ja(299,new pi(E))}}Object(N.a)(pi,
"SaveStatusFactory",Db.a,[]);var ji=a(955),Qi=a(931);class Kh extends Sys.EventArgs{constructor(){super()}}Object(N.a)(Kh,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var Hi=a(41),lj=a(631),Yi=a(166);class ij{constructor(E){this.data=E}}Object(N.a)(ij,"NumberFormatDataHolder",null,[]);var Di=a(214),th=a(279);class Wg extends ta.a{constructor(E,ma){super();this.iFd=ef.a.$f;this.Q9c=null;this.hmb=this.$sc=!1;this.YKf=(Ya,Ub)=>{var Hc;(Ya=ub.h(this.$))&&(Ub=null!==(Hc=Ub.cell)&&void 0!==Hc?Hc:Ya.yd(null))&&
this.Vsa(Ub.cell.Di,!0)};this.f9i=Ya=>{this.isActive()&&($g.a.Jr(Ya.Errors)||!Ya.Result?(Ya=Ya.Errors?Ya.Errors.map(Ub=>JSON.stringify(Ub)).join(","):"None",R.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${Ya}`)):(Ya=Ya.Result,R.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${Ya.Index}, category = ${Ya.Category}`),this.KSj(Ya.Index,Ya.Category),this.raiseEvent(Wg.D$c,new ji.a(Ya.Index,Ya.Category),this)))};this.refresh=
()=>{R.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.T$b();this.isActive()&&this.da.ae.allowEdits&&(this.hmb||this.Jq&&!(this.da.gU>this.iFd)?this.LNc():(R.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Uqd=Qi.a(this.$.pa.ua,this.Jq?this.Jq.Digest:"",this.P9i,this.O9i,null,null)),R.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),
this.Ddf())};this.wPf=Ya=>{R.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${Ya.data.status}, HTTP status = ${Ya.data.httpStatus}.`);this.qPa=null};this.t3=()=>{this.hmb=!1;this.da.kG(this.t3);this.zWa(this.$sc?Wg.K2d:Wg.XKd)};this.Qe=(Ya,Ub)=>{R.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");Xh.a(Ub)&&this.zWa(Wg.K2d)};this.vh=()=>{R.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");
3!==this.$.workbookContext.CalcMode&&this.hLd(0===this.$.workbookContext.CalcMode)};this.kf=()=>{R.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.zWa(Wg.K2d);Ga.EwaSettings.Da(269)&&3!==this.$.workbookContext.CalcMode&&this.hLd(0===this.$.workbookContext.CalcMode)};this.H9i=(Ya,Ub,Hc)=>{R.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.qPa=null;this.isActive()?Ya.StateId===ef.a.$f?
(R.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.LNc()):!Ya.Result||this.R_&&this.R_.length?this.zWa(Wg.XKd):this.eTf(Ya,Ub,Hc):R.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.eTf=Ya=>{this.R_=Ya.Result;R.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.R_?
this.R_.length:-1} functions.`);Ya=!1;if(this.R_){for(const Ub of this.R_)Ub&&(this.X9e[Ub.NameUI.toLocaleUpperCase()]=Ub.FunctionIndex.toString(),Ub.NameUI!==Ub.NameDataStrings&&(this.X9e[Ub.NameDataStrings.toLocaleUpperCase()]=Ub.FunctionIndex.toString(),Ya=!0),this.YZh.ga(Ub.FunctionIndex,Ub.NameUI));this.raiseEvent(Wg.Nnd,Sys.EventArgs.Empty,this)}Ya&&R.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};
this.P9i=Ya=>{if(this.isActive())if(R.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.$sc=!1,this.iFd=Ya.StateId,this.iFd===ef.a.$f)this.$sc=!0,this.LNc();else{if(Ya.Result){var Ub=this.Jq;this.Jq=Ya.Result;R.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Jq.Digest}.`);Ya=[];if(Ub)Ya=Wg.Rbi(Ub.NumberFormats,this.Jq.NumberFormats);else for(Ub=0;Ub<this.Jq.NumberFormats.length;Ub++)this.uwc.ga(Ub,this.Jq.NumberFormats[Ub].NumberFormatCategory);
for(const Hc of Ya)this.uwc.ga(Hc,this.Jq.NumberFormats[Hc].NumberFormatCategory);this.raiseEvent(Wg.yLd,new Kh(Ya),this);this.raiseEvent(Wg.yCf)}this.zWa(Wg.XKd)}};this.O9i=Ya=>{this.isActive()&&(10===Ya.data.status?R.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(R.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${Ya.data.status}, HTTP status = ${Ya.data.httpStatus}.`),this.$sc=!0,this.LNc()))};R.ULS.sendTraceTag(537155737,
0,50,"InstantaneousSupportInformationManager ctor start");this.da=E;this.$=ma;this.Jq=this.qPa=this.Uqd=this.mQb=null;this.uwc=new Di.a;this.yCb=new Di.a;this.R_=[];this.YZh=new Di.a;this.X9e={};this.da.Pl(this.Qe);this.$.Pm(this.kf);ub.h(this.$).ha.mwa(this.YKf);this.da.zw(this.vh);this.zWa(Wg.apf);R.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}GCe(E){this.addHandler(Wg.yLd,E)}kWd(E){this.removeHandler(Wg.yLd,E)}YYg(E){this.addHandler(Wg.D$c,E)}aBj(E){this.removeHandler(Wg.D$c,
E)}nCe(E){this.addHandler(Wg.Nnd,E)}XVd(E){this.removeHandler(Wg.Nnd,E)}I_g(E){this.addHandler(Wg.yCf,E)}get Vg(){return this.Jq?this.Jq.LocaleInformation:null}get ECa(){return this.Jq?this.Jq.NumberFormats:[]}get hna(){this.R_&&this.R_.length||this.Ddf();return this.R_}get Bzi(){return this.Jq&&void 0!==this.Jq.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Jq.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Jq.InstantaneousCalcWebWorkerPrecisionSamplingRate:Wg.Oxh}get Ezi(){return this.Jq&&
void 0!==this.Jq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Jq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Jq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Wg.Sxh}get Dzi(){return this.Jq&&void 0!==this.Jq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Jq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Jq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Wg.Rxh}get Czi(){return this.Jq&&void 0!==this.Jq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&
null!==this.Jq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Jq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Wg.Qxh}get lyd(){return this.Jq?this.Jq.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Wg.Pxh}get zoc(){return null!==this.Q9c?this.Q9c:!1}Qdk(E){let ma;if(!E)return{returnValue:!0,category:"General"};let Ya;ma="";if(!(()=>{let Ub=this.Vsa(E,!1);({category:Ya}=Ub);return Ub})().returnValue)return{returnValue:!1,category:ma};ma=this.tnh(Ya);return{returnValue:!0,
category:ma}}tnh(E){let ma="";switch(E){case 0:ma="General";break;case 1:ma="Number";break;case 2:ma="Currency";break;case 3:ma="Accounting";break;case 4:ma="Date";break;case 5:ma="Time";break;case 6:ma="Percentage";break;case 7:ma="Fraction";break;case 8:ma="Scientific";break;case 9:ma="Text";break;case 10:ma="Special";break;case 11:ma="Custom"}return ma}Vsa(E,ma){let Ya,Ub=(()=>{let Hc=this.uwc.Ve(E,0);({value:Ya}=Hc);return Hc})().returnValue;!Ub&&0<E&&this.$&&(R.ULS.sendTraceTag(537155735,0,50,
`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${E}`),this.z4h(E),ma&&(Ya=this.y4h(E),Ub=!0),lj.a(E,this.$.vG)&&(Ya=6));return{returnValue:Ub,category:Ya}}xFi(E){let ma=0;if((()=>{let Ya=this.Vsa(E,!0);({category:ma}=Ya);return Ya})().returnValue)return 6===ma;R.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${E}`);return!1}EYh(E){R.ULS.sendTraceTag(537155730,
0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.qPa=Yc.o(this.$.pa.ua,{FilterType:0},te.b(this.eTf,E),this.wPf,null,null,null)}i9e(){this.zWa(Wg.apf)}Oqh(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LocalizedErrorNames",!1)?Object(th.c)(this.Vg.ErrorNames)?(R.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.ncf()):this.Vg.ErrorNames.map((E,ma)=>excelOnlineCalc.calc.errorTypeName(ma+1,E)):this.ncf()}ncf(){const E=
[],ma=Object.keys(ef.a.errorNames);for(let Ya=0;Ya<ma.length;Ya++){const Ub=excelOnlineCalc.calc.errorTypeName(Ya+1,ma[Ya]);Ub&&E.push(Ub)}return E}hLd(E){this.Q9c=E}z4h(E){if(this.yCb&&this.$){var ma;if(!(()=>{let Ub=this.yCb.Ve(E);({value:ma}=Ub);return Ub})().returnValue||ma.isCompleted){R.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${E}`);var Ya=Qi.c(this.$.pa.ua,E,this.f9i,null,null,null);Ya&&this.yCb.ga(E,Ya)}}else R.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}y4h(E){return 1<=
E&&8>=E?1:9<=E&&12>=E?2:13===E||14===E?6:15===E?8:17===E|18===E?7:19===E?4:16===E||20<=E&&29>=E||31===E?11:30===E?9:32<=E&&35>=E?3:0}isActive(){const E=void 0===this.da||null===this.da,ma=!E&&this.da.Zd;R.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${ma} - sessionStateManager IsNullOrUndefined: ${E}`);return ma}KSj(E,ma){this.uwc.ga(E,ma)}dispose(){Xd.a.Ma(this.mQb);this.mQb=null;this.T$b();for(let E of this.yCb){const ma=
E.value;ma&&!ma.isCompleted&&V.AFrameworkApplication.mf.nx(ma.Bw)}this.yCb=null;this.da&&(this.da.Vl(this.Qe),this.hmb&&this.da.kG(this.t3),this.hmb=!1,this.da.Zx(this.vh));this.da=null;this.$&&ub.h(this.$)&&ub.h(this.$).ha&&(ub.h(this.$).ha.Zqa(this.YKf),this.$.Rn(this.kf));this.$=null;super.dispose()}isFeatureEnabled(E){try{switch(E){case "LocaleLongDateFormat":return Ga.EwaSettings.Da(184);case "GetLocaleDayNames":return Ga.EwaSettings.Da(185);case "CalculateTextWidthIgnoreLetterSpacing":return Ga.EwaSettings.Da(255);
case "OfficeVSO:3657744_CalcFixForDateFormat":return Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");
case "CalcDynamicArrayOperators":return Ga.EwaSettings.Da(101);default:return E.startsWith("OfficeVSO:")?Ga.EwaSettings.isChangeGateEnabled(E):!1}}catch(ma){return R.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${E}): feature parsing failed, returning false. Exception: ${ma.toString()}.`),!1}}zWa(E){this.isActive()&&this.da.ae.allowEdits?(Xd.a.Ma(this.mQb),this.mQb=null,this.mQb=Ob.a.instance.create(this.refresh,E,Ib.a.Fzi)):R.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.da&&null!==this.da&&void 0!==this.da.ae&&null!==this.da.ae?this.da.ae.allowEdits:!1}, IsEditMode ${void 0===this.da||null===this.da?!1:this.$.da.isEditMode}`)}Ddf(){R.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.qPa?R.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.R_&&this.R_.length||(this.qPa=Yc.o(this.$.pa.ua,{FilterType:0},this.H9i,
this.wPf,null,null,null)):R.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}LNc(){this.hmb||(this.hmb=!0,this.da.YE(this.t3))}T$b(){this.nx(this.Uqd);this.nx(this.qPa);this.qPa=this.Uqd=null}nx(E){E&&!E.isCompleted&&this.$.pa.ua.glb(E.Bw)}static Rbi(E,ma){if(!E||!E.length)return[];if(!ma||!ma.length){var Ya=Array(E.length);for(var Ub=0;Ub<E.length;++Ub)Ya[Ub]=E[Ub].IfmtIndex;return Ya}Ya=new Di.a;for(var Hc of E)Ya.ga(Hc.IfmtIndex,
new ij(Hc));E=new hb.a;for(Ub of ma)Hc=Ya.Ve(Ub.IfmtIndex),{value:ma}=Hc,Hc.returnValue&&ma.data.FormatString===Ub.FormatString||E.add(Ub.IfmtIndex);return E.toArray()}}Wg.yLd="isim0";Wg.D$c="isim1";Wg.Nnd="isim2";Wg.yCf="isim3";Wg.apf=100;Wg.K2d=1E3;Wg.XKd=3E5;Wg.Oxh=.001;Wg.Sxh=.1;Wg.Rxh=.2;Wg.Qxh=.001;Wg.Pxh=50;Object(N.a)(Wg,"InstantaneousSupportInformationManager",ta.a,[869,5]);class mj extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){if(this.$){R.ULS.sendTraceTag(537155672,0,
50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var E=Object(ic.a)(this.$.ea,268,()=>new Wg(this.$.da,this.$));this.qd(E)}}static la(E){if(!E)throw Error.argumentNull("ewaControl");E.ea.Ja(246,new mj(E))}}Object(N.a)(mj,"InstantaneousSupportInformationManagerFactory",Db.a,[]);var Vh=a(119);class cj{}cj.local="Local";cj.R9j="Thread";Object(N.a)(cj,"RecalcServiceCreateMode",null,[]);var uh=a(191);class ci{constructor(E){this.Qge=null;this.init(E)}get Dda(){return this.Qge}init(E){this.Qge=
new Di.a;if(void 0!==E&&null!==E&&void 0!==E.HeadersList&&null!==E.HeadersList&&0<E.HeadersList.length)for(const ma of E.HeadersList)this.Dda.ga(ma.Index,ma.Name)}}Object(N.a)(ci,"ColHeadersListData",null,[]);var dj=a(109);class kg{constructor(E,ma){this.GKe=E;this.sheetName=ma;this.jTb=!1}}Object(N.a)(kg,"CalcBlockInformation",null,[]);class Ji{constructor(E,ma,Ya,Ub,Hc){this.type=E;this.fullName=ma;this.range=Ya;this.sheetId=Ub;this.attributes=Hc;this.oH=null}}Object(N.a)(Ji,"CalcNamedObject",null,
[]);class mi{get hm(){return this.zve}constructor(E){this.Mxg=E;this.zve=[];this.s$d=[];this.O4a={};this.z2d=new Map}vhg(E,ma){this.zve[E]=ma;this.Mxg&&ma.Faa&&this.z2d.set(ma.Faa.sheetName,E)}getSheetIndex(E){if(this.Mxg){if(this.z2d.has(E))return this.z2d.get(E)}else for(let ma=1;ma<this.hm.length;ma++)if(Xc.a.equals(this.hm[ma].Faa.sheetName,E,!1))return ma;return-1}}Object(N.a)(mi,"GridCache",null,[]);var bh=a(713),ch=a(565);class nj{constructor(E){this.Faa=E;this.X9=new bh.a(ch.a.Qh());this.Xvc=
!1}}Object(N.a)(nj,"SheetInformation",null,[]);var Qh=a(1002),Zi;(function(E){E[E.initialization=0]="initialization";E[E.contentReady=1]="contentReady";E[E.cellEdit=2]="cellEdit"})(Zi||(Zi={}));Object(N.b)("UpdateDataTrigger",Zi);class ih{constructor(E){this.STd=null;this.rGd=this.RTd=this.jOd=!1;this.QRd=0;this.IRd=this.KRd=this.LRd=this.JRd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.zr=null;this.Ku=this.currentStateId=-1;this.Nxa="";this.Vda=
null;this.getNameLoc=(ma,Ya)=>this.Jqc()?this.Ug.ma(this.currentStateId).hm[0].X9.Wc(Ya)?(ma=excelOnlineCalc.location.nameLoc(ma,Ya),excelOnlineCalc.util.success(ma)):excelOnlineCalc.util.success(null):(ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma));this.getContainingTable=ma=>{if(!this.Jqc())return ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma);const Ya=ma.range.col,Ub=ma.range.row;var Hc=this.Ug.ma(this.currentStateId).hm[0].X9,Gd=null;for(let he of Hc)if(Hc=
he.value,2===Hc.type&&Xc.a.equals(ma.sheet.index.toString(),Hc.sheetId,!0)){const Ke=Hc.range;Ya>=Ke.left-1&&Ya<=Ke.right-1&&Ub<=Ke.bottom-1&&Ub>=Ke.top-1&&(Gd=excelOnlineCalc.location.nameScope(this.documentLoc,Hc.sheetId),Gd=excelOnlineCalc.location.nameLoc(Gd,Hc.fullName))}return Gd?excelOnlineCalc.util.success(Gd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ma,Ya)=>{if(!this.Jqc()){var Ub=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Ub)}Ub=ma.name;
var Hc=this.Ug.ma(this.currentStateId).hm[0].X9;if(Hc.Wc(Ub)){Hc=Hc.ma(Ub);const he=Hc.range;if(2!==Hc.type)return excelOnlineCalc.util.failure(this.ned(5));const Ke=Hc.oH?Hc.oH.Dda:null;if(!Ke)return excelOnlineCalc.util.success(null);for(var Gd of Ke)if(Xc.a.equals(Gd.value,Ya,!0))return ma=excelOnlineCalc.location.documentLoc(ma.scope.document.path,ma.scope.document.name),ma=excelOnlineCalc.location.sheetIndex(ma,Hc.sheetId),Gd=excelOnlineCalc.location.gridRange(he.top-1,Gd.key,he.bottom-he.top+
1,1),Gd=excelOnlineCalc.location.sheetGridRange(ma,Gd),Ub=excelOnlineCalc.location.structRefColumnLoc(Ub,Gd,!!(Hc.attributes&16),!!(Hc.attributes&8)),excelOnlineCalc.util.success(Ub);return he.right-he.left+1!==Ke.count?(Ub=excelOnlineCalc.util.unavailable([17,ma,Ya]),excelOnlineCalc.util.failure(Ub)):excelOnlineCalc.util.failure(this.ned(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ma,Ya)=>{if(!this.Jqc())return Ya=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);
var Ub=this.Ug.ma(this.currentStateId).hm[0].X9;if(Ub.Wc(ma.name)){var Hc=Ub.ma(ma.name);if(2!==Hc.type)return excelOnlineCalc.util.failure(this.ned(5));Ub=!!(Hc.attributes&16);const Gd=!!(Hc.attributes&8),he=Ub?1:0,Ke=Gd?1:0;ma=excelOnlineCalc.location.documentLoc(ma.scope.document.path,ma.scope.document.name);ma=excelOnlineCalc.location.sheetIndex(ma,Hc.sheetId);Hc=Hc.range;let af={};if(1===Ya)af=excelOnlineCalc.location.gridRange(Hc.top-he-1,Hc.left-1,Hc.bottom+Ke-Hc.top+he+1,Hc.right-Hc.left+
1);else if(2===Ya)af=excelOnlineCalc.location.gridRange(Hc.top-1,Hc.left-1,Hc.bottom-Hc.top+1,Hc.right-Hc.left+1);else if(3===Ya)if(Ub)af=excelOnlineCalc.location.gridRange(Hc.top-2,Hc.left-1,1,Hc.right-Hc.left+1);else return excelOnlineCalc.util.success(null);else if(4===Ya)if(Gd)af=excelOnlineCalc.location.gridRange(Hc.bottom,Hc.left-1,1,Hc.right-Hc.left+1);else return excelOnlineCalc.util.success(null);Ya=excelOnlineCalc.location.sheetGridRange(ma,af);return excelOnlineCalc.util.success(Ya)}return excelOnlineCalc.util.success(null)};
this.getDocumentLoc=(ma,Ya)=>{if((Xc.a.equals(ma,this.documentLoc.path,!0)||!ma)&&Xc.a.equals(Ya,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ma=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ma,Ya)]);return excelOnlineCalc.util.failure(ma)};this.getSheetIndex=(ma,Ya)=>{if(!this.Ug.Wc(this.currentStateId)||!this.Ug.ma(this.currentStateId).hm)return Ya=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);ma=this.Ug.ma(this.currentStateId).hm;
for(let Ub=1;Ub<ma.length;Ub++)if(Xc.a.equals(ma[Ub].Faa.sheetName,Ya,!0))return excelOnlineCalc.util.success(ma[Ub].Faa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ma,Ya)=>{if(!this.Ug.Wc(this.currentStateId)||!this.Ug.ma(this.currentStateId).hm)return Ya=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);ma=this.Ug.ma(this.currentStateId).hm;for(let Ub=1;Ub<ma.length;Ub++)if(Xc.a.equals(ma[Ub].Faa.sheetId,Ya,!0))return excelOnlineCalc.util.success(ma[Ub].Faa.sheetName);
return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.XRf=()=>{this.setNumberFormats()};this.kf=()=>{R.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ug=new Di.a;this.currentStateId=this.Ku=-1;this.Nxa=
"";this.m6a=null;this.RTd=!1;this.zr&&this.clearCache()};this.$e=E;this.Ug=new Di.a;this.m6a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$e.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Wsa();this.HAd=fa.a.HAd();this.r9=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1)}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.kWd(this.XRf);this.$e&&this.$e.Rn(this.kf);this.close()}oXb(E){if(!this.zr)return!1;
if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.$e.ea.Ba(268),!this.instantaneousSupportInformationManager))return R.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==E&&(this.currentStateId=this.$e.da.gU,this.currentStateId===ef.a.$f&&(this.currentStateId=this.$e.da.mg));if(1===E&&this.currentStateId<this.Ku)return R.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Ku} - ignoring update`),
!1;this.wQj();0!==E&&this.RTd||(this.XUj(),this.$Rj(),this.PSj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.GCe(this.XRf),this.$e.Pm(this.kf),this.RTd=!0);this.svj();let ma=!1;0===E&&(ma=this.nxi());if(0!==E||ma)this.jUj()?(this.KUj(E),this.JUj(),this.Ku=this.currentStateId,this.mhh()):R.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==E&&this.resumeRecalc();return!0}evalFormula(E,ma,Ya,
Ub){if(!this.zr)return R.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ma=excelOnlineCalc.calc.sheetCellLocation(null!==Ya&&void 0!==Ya?Ya:Jf.d(this.$e.va.na),ma.top-1,ma.left-1);E=this.zr.evalFormula(this.$e.da.mg,E,ma,Ub);this.resumeRecalc();return E}Sch(E,ma,Ya,Ub){Ub=void 0===Ub?null:Ub;const Hc=Jf.d(this.$e.va.na);let Gd=E.cell.UH-1,he=E.cell.TH-1;var Ke=Gd,af=he;let xf=null;Ub&&(xf=excelOnlineCalc.calc.cellLocation(Gd,he),Gd=Ub.top-
1,he=Ub.left-1,Ke=Ub.bottom-1,af=Ub.right-1);Ya=this.iNc(E,Ya,"SetCell");0>Ya||(af=ih.j7("CalculateFormula.cell",Hc,Gd,he,Ke,af),Ke=[],Ub=this.Llc(Hc),ma=excelOnlineCalc.calc.inferredRangeFormulaEdit(af,ma,xf,Ub),Ke.push(ma),E=(ma=this.Ctd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Hc,Gd,he,Xc.a.LEe(E.cell.text),Ya,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Hc,Gd,he,Xc.a.LEe(E.cell.text),Ya,"","","",""),R.ULS.sendTraceTag(537170180,0,50,E),this.zr.editRangeFormulas(Ya,Ke),this.resumeRecalc())}Tch(E,ma){const Ya=[];var Ub=Jf.d(this.$e.va.na),Hc=this.Llc(Ub);ma=this.iNc(E[0].Yda,ma,"SetCellBatched");if(0>ma)return!1;for(var Gd of E){var he=Gd.Yda.cell.UH-1,Ke=Gd.Yda.cell.TH-1;he=ih.j7("CalculateFormulaBatched.cell",Ub,he,Ke,he,Ke);he=excelOnlineCalc.calc.inferredRangeFormulaEdit(he,Gd.editText,null,Hc);Ya.push(he)}Hc=this.Ctd();Gd=E[0].Yda.cell.UH-1;he=
E[0].Yda.cell.TH-1;Ke=E[E.length-1].Yda.cell.UH-1;E=E[E.length-1].Yda.cell.TH-1;Ub=Hc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Ub,Gd,he,Ke,E,ma,Hc.top-1,Hc.left-1,Hc.bottom-1,Hc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Ub,Gd,he,Ke,E,ma,"","","","");R.ULS.sendTraceTag(508932947,0,50,Ub);this.zr.editRangeFormulas(ma,
Ya);this.resumeRecalc();return!0}R7(E,ma,Ya,Ub,Hc){if(!this.zr)return R.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!Ya||!ma)return R.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!Ya}, outputColumnRange null: ${!ma}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");R.ULS.shipAssertTag(537170178,0,Ya.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Gd=Jf.d(this.$e.va.na),he=this.Llc(Gd);let Ke=null;if(E){Ke=[];for(const wg of E)if(wg.column!==Ya.left){E=wg.row-1;var af=wg.column-1;E=ih.j7("EvalFormulaRangeOnClone.cell",Gd,E,af,E,af);af=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?oj(wg.sl,wg.formulaBarText,wg.Di):excelOnlineCalc.calc.valueCellData(wg.text,wg.text,wg.Di,null);Ke.push(excelOnlineCalc.calc.rangeWrite(E,af))}}Ya=excelOnlineCalc.calc.cellLocation(Ya.top-1,Ya.left-1);ma=ih.j7("EvalFormulaRangeOnClone.outputColumnRange",
Gd,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1);let xf;Hc?this.r9&&(Ub=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ma,Ub,Ya,he)],xf=this.zr.evalOnClonedModel(Ke,Ub,Hc)):(Hc=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ma,Ub,Ya,he)],xf=this.zr.evalOnClonedModel(Ke,Hc));this.resumeRecalc();return xf}OUe(E){let ma=null;try{if(E)if(this.Nxa=ub.h(this.$e).za.lna(E),this.currentStateId=E.xFa,this.currentStateId<this.Ku||this.currentStateId===ef.a.$f)R.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Nxa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Ku}`);
else{if(this.txi(),1===E.wy.PaneType&&this.Okk(E.na),!this.N8g())if(ma=this.$e.Jd.Le("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Nxa} StateId:${this.currentStateId}`),this.m6a=this.C9a(E.na.sheetName))if(ub.h(this.$e).za.Qq.T6a(E.af)){var Ya=E.gh;if(Ya){var Ub=Ya.getCalcBlockModel();if(Ub)if(this.F8g(Ub)){this.Ug.ma(this.currentStateId).O4a[this.Nxa]=new kg(Ub,E.na.sheetName);var Hc=E.Jf;Hc?this.BWg(Hc.NamedObjects):R.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else R.ULS.sendTraceTag(509117971,
0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else R.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else R.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Nxa}`)}else R.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");
else{const Gd=!!(this.$e.sf&32),he=this.Ug.Wc(this.currentStateId)&&this.Ug.ma(this.currentStateId).hm?this.Ug.ma(this.currentStateId).hm.length:0;R.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${he}, scratchPad:${Gd}, sheetNameLength:${E.na.sheetName?E.na.sheetName.length:-1} Hash:${E.na.hash}`)}}else R.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ma&&
ma.stop()}}F9a(E){var ma;if(!this.Ug.Wc(this.currentStateId))return R.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const Ya=null===(ma=this.Ug.ma(this.currentStateId))||void 0===ma?void 0:ma.hm;if(!Ya||!Ya[0])return null;ma=Ya[0].X9;if(!ma||!ma.Wc(E.name))return R.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==
ma}`),null;E=ma.ma(E.name);if(!E||!E.oH)return null;ma=new hb.a;for(let Ub of E.oH.Dda)ma.add(Ub.value);return ma}Uch(E,ma,Ya){var Ub=ub.h(this.$e),Hc=Ub.yd(ma);Hc=this.iNc(Hc,null,"CopyPaste");Ya=this.iNc(Ub.yd(E),Ya,"CopyPaste");if(0>Hc||0>Ya||Hc!==Ya)R.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${Ya}, targetRevision:${Hc}.`);else{Ya=[];Ub=Jf.d(this.$e.va.na);var Gd=this.Llc(Ub);E=ih.j7("CalculateFormulaForCopyPaste.srcRange",
Ub,E.top-1,E.left-1,E.bottom-1,E.right-1);ma=ih.j7("CalculateFormulaForCopyPaste.targetRange",Ub,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1);ma=excelOnlineCalc.calc.copyPasteRangePasteEdit(ma,E,Gd);Ya.push(ma);ma=Gd?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Ub,Hc,Gd.row,Gd.column,Gd.lastRow,Gd.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
Ub,Hc,"","","","");R.ULS.sendTraceTag(537170142,0,50,ma);this.zr.editRangePaste(Hc,Ya);this.resumeRecalc()}}Llc(E){const ma=this.Ctd();let Ya=null;ma?Ya=ih.j7("GetViewport.viewport",E,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1):R.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return Ya}Ctd(){const E=ub.h(this.$e);let ma=E.Yk;if(ub.h(this.$e).Tc.kk){ma=E.Ih(1).Yk;if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!ma)return R.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ma.Iha(1,1);ma.Iha(3,1)}return ma}iNc(E,ma,Ya){let Ub;if(!this.zr||!E)return R.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.zr}, modifiedCell is null:${!E}, operation:${Ya}`),-1;const Hc=E.cell.UH-1,Gd=E.cell.TH-1;if(E.cell.Px){if(Ub=E.cell.Px.K9b,Ub===ef.a.$f)return R.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${E.cell.Px.af}, operation:${Ya}`),
-1}else return R.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${E.cell.UH},${E.cell.TH}), operation:${Ya}`),-1;if(Ub<this.Ku)return R.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Hc},${Gd}) - blockRevision:${Ub} < lastUpdatedStateId:${this.Ku}, operation:${Ya}`),-1;if(Ub<this.currentStateId)return R.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Hc},${Gd}) - blockRevision:${Ub} < currentStateId:${this.currentStateId}, operation:${Ya}`),
-1;ma&&!this.jOd&&(this.zr.setOnRecalcResults(ma),this.jOd=!0);return this.qgk()&&!this.oXb(2)?(R.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${Ya}`),-1):Ub}getFormulaBarText(E,ma,Ya){return ma&&ma.startsWith("'")?ma:E.cell.formulaBarText||Ya.toString()}Kth(E,ma,Ya){let Ub=null;this.m6a=this.C9a(Ya);if(this.qLe()&&this.Ug.ma(this.Ku).O4a){const Ke=this.Ug.ma(this.Ku).O4a[E];if(null===Ke||void 0===Ke?0:Ke.jTb)Ub=Ke.GKe}Ya=this.jCi(Ub,
ma,Ya);const {R2i:Hc,numberOfNonEmptyCells:Gd,P2i:he}=this.Gkh(Ub,ma,Ya);R.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${E} StateId:${this.currentStateId} number of formulas ${Hc}, number of non-empty cells ${Gd}, number of cells ${he}`)}jCi(E,ma,Ya){let Ub=!1;const Hc=ih.Zaf(ma);if(E){const Gd=ih.Zaf(E);Xc.a.equals(Gd,Hc,!1)&&(Ub=!0)}Ub?this.eXg(E,this.Ku,Ya):this.gXg(ma,Ya);return Ub}qLe(){let E=!1;this.zr&&-1!==this.Ku&&(E=this.zr.stateIdAvailable(this.Ku));
return E&&this.Ug.Wc(this.Ku)&&this.Ku<this.currentStateId}Gkh(E,ma,Ya){let Ub=0,Hc=0,Gd=0,he,Ke;for(ma.reset();he=ma.getNextCell();)Gd++,(he.value||he.formula)&&Hc++,Yi.f(he.formula)&&Ub++,(Ke=Ya?E.getCell(he.row,he.col):null)?this.Ckh(ma,he,Ke):this.fXg(ma,he);if(Ya)for(E.reset();Ke=E.getNextCell();)(he=ma.getCell(Ke.row,Ke.col))||this.VAe(E,Ke);return{R2i:Ub,numberOfNonEmptyCells:Hc,P2i:Gd}}PSj(){this.zr.setOnUpdateRequest(()=>{})}OSj(){this.zr.setOnUnresponsive((E,ma,Ya,Ub)=>{this.Ugj(E,ma,Ya,
Ub)})}Ugj(E,ma,Ya,Ub){R.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${E}, waitTime:${ma}, timeoutCount:${Ya}, hasBeenClosed:${Ub}.`);Ub&&(this.iHj(),this.Wsa())}iHj(){this.kf(null,null);this.rGd=this.jOd=!1;this.QRd=0;this.IRd=this.KRd=this.LRd=this.JRd=-1}close(){this.zr.close()}clearCache(){this.zr.clearCache()}resumeRecalc(){this.zr.resumeRecalc()}$Rj(){this.zr.setA1ReferenceStyle(!0)}svj(){if(this.instantaneousSupportInformationManager){var E=
this.instantaneousSupportInformationManager.Bzi;const Ya=this.instantaneousSupportInformationManager.Ezi,Ub=this.instantaneousSupportInformationManager.Dzi,Hc=this.instantaneousSupportInformationManager.Czi;var ma=!1;E!==this.JRd&&(ma=!0,this.JRd=E);Ya!==this.LRd&&(ma=!0,this.LRd=Ya);Ub!==this.KRd&&(ma=!0,this.KRd=Ub);Hc!==this.IRd&&(ma=!0,this.IRd=Hc);const Gd=[];Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ma=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Gd.push(ma),ma=!0);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ma=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Gd.push(ma),ma=!0);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ma=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Gd.push(ma),ma=!0);ma&&(E=excelOnlineCalc.calc.recalcServiceConfig(null,E,null,Ya,null,null,null,Ub,Gd,Hc),this.zr.reconfigure(E))}}KUj(E){let ma=
null;if(this.Ug.Wc(this.currentStateId))try{this.Vda=[],ma=this.$e.Jd.Le("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${Zi[E]}`),Vh.a.forEach(this.Ug.ma(this.currentStateId).O4a,(Ya,Ub)=>{Ub.jTb||(this.Kth(Ya,Ub.GKe,Ub.sheetName),Ub.jTb=!0)},null),this.zr.updateRanges(this.currentStateId,this.Vda)}finally{ma&&ma.stop()}else R.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}JUj(){const E=
[],ma=this.qLe();var Ya=ma&&this.Ug.ma(this.Ku).hm&&this.Ug.ma(this.Ku).hm[0]&&this.Ug.ma(this.Ku).hm[0].Xvc?this.Ug.ma(this.Ku).hm[0].X9:null;this.mQe(Ya,this.Ug.ma(this.currentStateId).hm[0].X9,null,this.Ku,E);this.Ug.ma(this.currentStateId).hm[0].Xvc=!0;for(let Ub=1;Ub<this.Ug.ma(this.currentStateId).hm.length;Ub++)Ya=-1,ma&&this.Ug.ma(this.Ku).hm&&(Ya=this.Dsd(this.Ug.ma(this.currentStateId).hm[Ub].Faa.sheetName,this.Ku)),Ya=-1!==Ya&&this.Ug.ma(this.Ku).hm[Ya].Xvc?this.Ug.ma(this.Ku).hm[Ya].X9:
null,this.mQe(Ya,this.Ug.ma(this.currentStateId).hm[Ub].X9,this.Ug.ma(this.currentStateId).hm[Ub].Faa.sheetId,this.Ku,E),this.Ug.ma(this.currentStateId).hm[Ub].Xvc=!0;this.zr.updateNamedObjects(this.currentStateId,E)}mQe(E,ma,Ya,Ub,Hc){if(void 0!==Ya&&null!==Ya){var Gd=excelOnlineCalc.calc.undefinedNamesWrite(Ya);Hc.push(Gd)}if(E){var he=!1;Gd=[];var Ke=[];if(ma)for(let xf of ma){const wg=xf.value;if(E.Wc(xf.key)){var af=E.ma(xf.key);ih.b1i(af,wg)?he=!0:(af=excelOnlineCalc.calc.namedObject(xf.key,
null),Gd.push(af),ih.y4c(xf.key,wg,Ke))}else ih.y4c(xf.key,wg,Ke)}for(let xf of E)ma&&ma.Wc(xf.key)||(E=excelOnlineCalc.calc.namedObject(xf.key,null),Gd.push(E));he&&(ma=excelOnlineCalc.calc.namedObjectsPromote(Ya,Ub),Hc.push(ma));0<Gd.length&&(ma=excelOnlineCalc.calc.namedObjectsWrite(Ya,Gd),Hc.push(ma));0<Ke.length&&(Ya=excelOnlineCalc.calc.namedObjectsWrite(Ya,Ke),Hc.push(Ya))}else if(ma){Ub=[];for(Ke of ma)ih.y4c(Ke.key,Ke.value,Ub);0<Ub.length&&(Ya=excelOnlineCalc.calc.namedObjectsWrite(Ya,Ub),
Hc.push(Ya))}}N8g(){const E=this.Ug.ma(this.currentStateId).O4a[this.Nxa];return E?(R.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Nxa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Ku}. sentToRecalcEngine: ${null===E||void 0===E?void 0:E.jTb}`),!0):!1}F8g(E){return 1===E.getColumnNumbers().length&&E.getColumnNumbers()[0]===ih.SId+1?!1:!0}nxi(){let E=!1;ub.h(this.$e).za.l8a(ma=>{ma.state&1&&this.$e.da.mg===ma.Pf.Revision&&
(this.OUe(ma),E=!0)});return E}ASe(E,ma){var Ya=E.getRowNumbers(),Ub=E.getColumnNumbers();E=Ya[0]-1;Ya=Ya[Ya.length-1]-1;const Hc=Ub[0]-1;Ub=Ub[Ub.length-1]-1;ma=this.C9a(ma);if(!ma){const Gd=this.Ug.Wc(this.currentStateId)&&this.Ug.ma(this.currentStateId).hm?this.Ug.ma(this.currentStateId).hm.length:0;R.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Gd}`)}return ih.j7("CreateBlockRangeLocation",ma,E,Hc,Ya,Ub)}eXg(E,ma,Ya){if(Ya=
this.ASe(E,Ya)){var Ub=ih.Kcc(E.getRowNumbers());E=ih.Kcc(E.getColumnNumbers());ma=excelOnlineCalc.calc.rangePromote(Ya,ma,Ub,E);this.Vda[this.Vda.length]=ma}}gXg(E,ma){if(ma=this.ASe(E,ma)){var Ya=ih.Kcc(E.getRowNumbers());E=ih.Kcc(E.getColumnNumbers());E=excelOnlineCalc.calc.rangeWrite(ma,null,Ya,E);this.Vda[this.Vda.length]=E}}Ckh(E,ma,Ya){let Ub=null,Hc=0,Gd=0;switch(ma.valueType){case 2:Ub=this.xtd(ma);var he=this.xtd(Ya);he=Xc.a.equals(he,Ub,!1);break;case 1:null===ma.value&&null===Ya.value?
he=!0:(Hc=parseFloat(ma.value),he=parseFloat(Ya.value)===Hc);break;default:null===ma.value&&null===Ya.value?he=!0:(Gd=parseFloat(ma.value),he=Gd===parseFloat(Ya.value))}he&&ma.valueType===Ya.valueType&&ma.ifmt===Ya.ifmt&&ma.formulaType===Ya.formulaType&&Xc.a.equals(Ya.formula,ma.formula,!1)||(void 0!==ma.formula&&null!==ma.formula||void 0!==ma.value&&null!==ma.value||void 0!==ma.text&&null!==ma.text||0!==ma.valueType?this.d7b(E,ma,Ub,Hc,Gd):this.VAe(E,ma))}BWg(E){if(this.$e.Gd&&this.$e.Gd.items)for(let Gd=
0;Gd<this.$e.Gd.count;Gd++){var ma=this.$e.Gd.items[Gd];if(2!==ma.type&&3!==ma.type)continue;var Ya=0,Ub=ma.name,Hc=Ub.lastIndexOf("!");if(0<Hc){Ya=Ub.substr(0,Hc);"'"===Ya.charAt(0)&&(Ya=Ya.substr(1,Ya.length-2));Ya=this.Dsd(Ya,this.currentStateId);if(-1===Ya){Ub=this.Ug.Wc(this.currentStateId)&&this.Ug.ma(this.currentStateId).hm?this.Ug.ma(this.currentStateId).hm.length:0;R.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Ub}`);
continue}Ub=Ub.substr(Hc+1)}Hc=this.Ug.ma(this.currentStateId).hm[Ya].X9;let he=ma.usedRange;2===ma.type&&(he=uh.a(ma));if(Hc.Wc(Ub)){if(Ya=Hc.ma(Ub),Ya.range=he,Ya.attributes=ma.attributes,2===Ya.type)if(Ub=ma.ZVb,!Ya.oH)Ya.oH=new ci(Ub);else if(Ub)for(const Ke of Ub.HeadersList)Ya.oH.Dda.ga(Ke.Index,Ke.Name)}else if(Ya=this.C9a(ma.sheetName)){Ya=new Ji(ma.type,ma.name,he,Ya,ma.attributes);if(2===Ya.type)if(ma.ZVb)Ya.oH=new ci(ma.ZVb);else if(ma=ih.oWh(ma.name,E))Ya.oH=new ci(ma.ColHeadersList);
Hc.ga(Ub,Ya)}else Ub=this.Ug.Wc(this.currentStateId)&&this.Ug.ma(this.currentStateId).hm?this.Ug.ma(this.currentStateId).hm.length:0,R.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Ub}`)}}d7b(E,ma,Ya,Ub,Hc){var Gd=E.getRowNumbers()[ma.row]-1;E=E.getColumnNumbers()[ma.col]-1;Gd=ih.j7("AddRangeUpdateCommand",this.m6a,Gd,E,Gd,E);E=null;let he=ma.formula||ma.text;const Ke=excelOnlineCalc.calc.blankValue;let af=null;void 0!==ma.text&&
null!==ma.text||void 0!==ma.value&&null!==ma.value||(Ya="",af="This cell contains blanks only",0===ma.formulaType&&(he=""));switch(ma.valueType){case 2:null!==Ya&&(0===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData(he,Ya,ma.ifmt,af)),1===ma.formulaType&&(E=excelOnlineCalc.calc.cellFormulaCellData(he,Ya,ma.ifmt,af)),2===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 1:isNaN(Ub)?R.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid numeric value`):
(0===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData(he,Ub,ma.ifmt,null)),1===ma.formulaType&&(E=excelOnlineCalc.calc.cellFormulaCellData(he,Ub,ma.ifmt,null)),2===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 3:isNaN(Hc)?R.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid boolean value`):(Ya=1===Hc?!0:!1,0===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData(he,Ya,ma.ifmt,
null)),1===ma.formulaType&&(E=excelOnlineCalc.calc.cellFormulaCellData(he,Ya,ma.ifmt,null)),2===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 4:isNaN(Hc)?R.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid error value`):(Ya=excelOnlineCalc.calc.errorValue(Hc),0===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData(he,Ya,ma.ifmt,null)),1===ma.formulaType&&(E=excelOnlineCalc.calc.cellFormulaCellData(he,
Ya,ma.ifmt,null)),2===ma.formulaType&&(E=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;default:E=excelOnlineCalc.calc.valueCellData("",Ke,ma.ifmt,null)}E&&(ma=excelOnlineCalc.calc.rangeWrite(Gd,E,null,null),this.Vda[this.Vda.length]=ma)}fXg(E,ma){switch(ma.valueType){case 2:this.d7b(E,ma,this.xtd(ma),null,0);break;case 1:this.d7b(E,ma,null,parseFloat(ma.value),0);break;default:this.d7b(E,ma,null,null,parseFloat(ma.value))}}VAe(E,ma){var Ya=E.getRowNumbers()[ma.row]-
1;E=E.getColumnNumbers()[ma.col]-1;Ya=ih.j7("AddRangeUpdateCommandEmptyCell",this.m6a,Ya,E,Ya,E);ma=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ma.ifmt,null);ma=excelOnlineCalc.calc.rangeWrite(Ya,ma,null,null);this.Vda[this.Vda.length]=ma}C9a(E){E=this.Dsd(E,this.currentStateId);return 0<E?this.Ug.ma(this.currentStateId).hm[E].Faa.sheetId:null}Dsd(E,ma){if(!this.Ug.Wc(ma))return R.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ma} does not exist in GridCache`),
-1;const Ya=this.Ug.ma(ma);return Ya.hm?Ya.getSheetIndex(E):(R.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ma}`),-1)}jUj(){if(!this.Ug.Wc(this.currentStateId)||!this.Ug.ma(this.currentStateId).hm.length)return R.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const E=[];for(let ma=1;ma<this.Ug.ma(this.currentStateId).hm.length;ma++){const Ya=
this.Ug.ma(this.currentStateId).hm[ma];Ya&&E.push(Ya.Faa)}this.zr.updateSheetNames(this.currentStateId,E);this.zr.updateUnusedCells(this.currentStateId,this.Ug.ma(this.currentStateId).s$d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var E=[];for(const ma of this.instantaneousSupportInformationManager.ECa){const Ya=excelOnlineCalc.calc.numberFormat(ma.IfmtIndex,ma.FormatString,ma.Builtin);E.push(Ya)}this.zr.setNumberFormats(E,!0)}}wQj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Vg){var E=this.rxi();if(!this.rGd||E)this.instantaneousSupportInformationManager.Vg.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Vg.TrueValueString),this.instantaneousSupportInformationManager.Vg.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Vg.FalseValueString),E=Qh.CalcHelper.CTe(this.instantaneousSupportInformationManager,E),this.zr.setLocale(E),this.rGd=!0}}XUj(){var E=null;if(void 0!==this.$e.workbookContext.TimeZoneInformation&&
null!==this.$e.workbookContext.TimeZoneInformation){E=null;this.$e.workbookContext.TimeZoneInformation.StandardDate.Month&&(E=excelOnlineCalc.date.dateTime(this.$e.workbookContext.TimeZoneInformation.StandardDate.Year,this.$e.workbookContext.TimeZoneInformation.StandardDate.Month,this.$e.workbookContext.TimeZoneInformation.StandardDate.Day,this.$e.workbookContext.TimeZoneInformation.StandardDate.Hour,this.$e.workbookContext.TimeZoneInformation.StandardDate.Minute,this.$e.workbookContext.TimeZoneInformation.StandardDate.Second,
this.$e.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.$e.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ma=null;this.$e.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ma=excelOnlineCalc.date.dateTime(this.$e.workbookContext.TimeZoneInformation.DaylightDate.Year,this.$e.workbookContext.TimeZoneInformation.DaylightDate.Month,this.$e.workbookContext.TimeZoneInformation.DaylightDate.Day,this.$e.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.$e.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.$e.workbookContext.TimeZoneInformation.DaylightDate.Second,this.$e.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.$e.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));E=excelOnlineCalc.date.tzData(this.$e.workbookContext.TimeZoneInformation.Bias,E,this.$e.workbookContext.TimeZoneInformation.StandardBias,ma,this.$e.workbookContext.TimeZoneInformation.DaylightBias)}else R.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");E=excelOnlineCalc.calc.workbookProps(this.$e.workbookContext.F1904,this.$e.workbookContext.FDateCompatibility,E);this.zr.setWorkbookProps(E)}Wsa(){const E=Ga.EwaSettings.Da(570)?cj.local:cj.R9j,[ma,Ya]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.STd=hf.d(excelOnlineCalc.calc.createRecalcService(E,ma,Ya));this.STd.continueWith(Ub=>{Ub.exception?R.ULS.sendTraceTag(537170075,
0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Ub.exception.toString()}`):(R.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.zr=this.STd.result)?this.oXb(0)?this.OSj():R.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):R.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}rxi(){const E=this.instantaneousSupportInformationManager.hna;
if(!E||this.QRd===E.length)return null;this.QRd=E.length;return Qh.CalcHelper.mTe(E)}txi(){if(!(this.Ug.Wc(this.currentStateId)&&0<this.Ug.ma(this.currentStateId).hm.length)){this.Ug.ga(this.currentStateId,new mi(this.HAd));this.Ug.ma(this.currentStateId).vhg(0,new nj(null));var E=this.$e.va;for(let Ub=0;Ub<E.count;Ub++){var ma=Object(Za.a)(dj.a,E.getItem(Ub));if(ma){void 0!==ma.sheetId&&null!==ma.sheetId&&void 0!==ma.name&&null!==ma.name&&ma.sheetId.length&&ma.sheetName.length||R.ULS.sendTraceTag(537170074,
0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Ub} Id:${ma.sheetId} Hash:${ma.hash} NameLength:${ma.name?ma.name.length:-1}`);var Ya=void 0;Ya=excelOnlineCalc.calc.sheetName(ma.sheetId,ma.name);this.Ug.ma(this.currentStateId).vhg(Ub+1,new nj(Ya));Ya=ma.usedRange.CR();Ya=excelOnlineCalc.calc.rangeLocation(0,0,Ya.LastRow,Ya.LastColumn);ma=excelOnlineCalc.calc.unusedCellsUpdate(ma.sheetId,Ya);this.Ug.ma(this.currentStateId).s$d.push(ma)}else R.ULS.sendTraceTag(537170073,0,
15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Ub}`)}}}Okk(E){if(E instanceof dj.a){var ma=E.usedRange.CR();ma=excelOnlineCalc.calc.rangeLocation(0,0,ma.LastRow,ma.LastColumn);ma=excelOnlineCalc.calc.unusedCellsUpdate(E.sheetId,ma);this.Ug.ma(this.currentStateId).s$d[E.index]=ma}}mhh(){for(let E of this.Ug)E.key<this.Ku&&this.Ug.remove(E.key)}xtd(E){E=E.value||E.text;if(void 0===E||null===E)E="";return E}qgk(){if(!this.Ug.Wc(this.currentStateId))return!1;
let E=!1;Vh.a.forEach(this.Ug.ma(this.currentStateId).O4a,(ma,Ya)=>{Ya.jTb||(E=!0)},null);return E}ned(E){const ma={};ma.reason=E;ma.kind=1;return ma}Jqc(){return this.Ug.Wc(this.currentStateId)&&this.Ug.ma(this.currentStateId).hm&&this.Ug.ma(this.currentStateId).hm[0]&&this.Ug.ma(this.currentStateId).hm[0].X9?!0:!1}static Pph(E){const ma=[];if(null===E||void 0===E?0:E.Dda)for(let Ya of E.Dda)E=excelOnlineCalc.calc.columnData(Ya.key,Ya.value),ma.push(E);return ma}static b1i(E,ma){if(E.type!==ma.type||
E.attributes!==ma.attributes||!Xc.a.equals(E.fullName,ma.fullName,!1)||!E.range.equals(ma.range))return!1;if(!E.oH&&!ma.oH)return!0;if(!E.oH||!ma.oH||E.oH.Dda.count!==ma.oH.Dda.count)return!1;for(let Ya of E.oH.Dda){let Ub;if(E=Ya.value)E=ma.oH.Dda.Ve(Ya.key),{value:Ub}=E,E=E.returnValue;if(!(E&&Ub&&Xc.a.equals(Ya.value,Ub,!1)))return!1}return!0}static y4c(E,ma,Ya){var Ub=ih.j7("NamedObject",ma.sheetId,ma.range.top-1,ma.range.left-1,ma.range.bottom-1,ma.range.right-1);if(2===ma.type){const Hc=!!(ma.attributes&
16),Gd=!!(ma.attributes&8);ma=ih.Pph(ma.oH);Ub=excelOnlineCalc.calc.namedTableData(Ub,Hc,Gd,ma);E=excelOnlineCalc.calc.namedObject(E,Ub)}else Ub=excelOnlineCalc.calc.namedRangeData(Ub),E=excelOnlineCalc.calc.namedObject(E,Ub);Ya.push(E)}static Zaf(E){const ma=Sys.Serialization.JavaScriptSerializer.serialize(E.getRowNumbers());E=Sys.Serialization.JavaScriptSerializer.serialize(E.getColumnNumbers());return ma+E}static Kcc(E){let ma=null;if(1<E.length)for(let Ya=1;Ya<E.length;Ya++){let Ub=0;for(;E[Ya-
1]+1+Ub<E[Ya];)ma=ma||[],ma.push(E[Ya-1]+Ub),Ub++}return ma}static oWh(E,ma){if(!ma)return null;for(let Ya=0,Ub=ma.length;Ya<Ub;++Ya)if(Xc.a.equals(E,ma[Ya].Name,!1))return ma[Ya];return null}static j7(E,ma,Ya,Ub,Hc,Gd){const he=(Ke,af,xf,wg)=>{(0>xf||xf>=wg)&&R.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Ke} invalid ${af}:${xf}`)};void 0!==ma&&null!==ma||R.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${E} sheetId is null`);
he(E,"top",Ya,ih.YGf);he(E,"left",Ub,ih.SId);he(E,"bottom",Hc,ih.YGf);he(E,"right",Gd,ih.SId);return excelOnlineCalc.calc.sheetRangeLocation(ma,Ya,Ub,Hc,Gd)}}ih.YGf=1048576;ih.SId=16384;Object(N.a)(ih,"CalcAsyncEngine",null,[5]);const oj=(E,ma,Ya)=>{switch(E.type){case 2:return excelOnlineCalc.calc.valueCellData(ma,E.value,Ya,null);case 1:return excelOnlineCalc.calc.valueCellData(ma,parseFloat(E.value),Ya,null);case 3:return excelOnlineCalc.calc.valueCellData(ma,1===parseFloat(E.value),Ya,null);case 4:return excelOnlineCalc.calc.valueCellData(ma,
excelOnlineCalc.calc.errorValue(parseFloat(E.value)),Ya,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,Ya,null)}};class pj{constructor(){this.gN=this.hN=this.ZH=this.$H=this.P2=!1}}Object(N.a)(pj,"AbsoluteRelativeReferenceInfo",null,[]);class ej{}ej.BZf="#";Object(N.a)(ej,"Operators",null,[]);var ni=a(1128);class Yg{}Yg.sheet="Sheet";Yg.sheetRange="SheetRange";Yg.document="Document";Yg.Uti="Ident";Object(N.a)(Yg,"TraverseFormulaQualifierTypes",null,[]);
var fj=a(1129),Cj=a(969),Ki=a(851),Dj=a(79),fh=a(298);class jj extends Sys.EventArgs{constructor(E){super();this.Zl=E}}Object(N.a)(jj,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Ei=a(328);class Gg{constructor(E,ma){this.oOf=(Ya,Ub)=>{Ya=this.gridView.ha.ra.activeCell;const Hc=this.gridView.yd(Ya);null!=Hc&&this.Znj(Ya,Ub.text,Hc.cell.Di,Hc.cell.Px.K9b,this.gridView.$.activeItemName)};this.hDa=()=>{this.KBa=Object(fh.a)({message:"PrefetchNotStarted"})};this.calcManager=E;this.gridView=
ma;this.KBa=Object(fh.a)({message:"Ctor"});E=Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.Znj=Ei.a((Ya,Ub,Hc,Gd,he)=>this.prefetch({text:Ub,range:Ya,ifmt:Hc,stateId:Gd,sheetName:he}),E);this.gridView.Vd.yp(this.hDa);this.gridView.Fk.hCe(this.oOf)}dispose(){this.gridView.Fk.v7f(this.oOf);this.gridView.Vd.lp(this.hDa);this.$Ne()}hbf(E){if(Object(fh.b)(this.KBa))return Object(fh.a)(this.KBa.reason.message);if(Gg.n5g(E,this.KBa.value.key)){for(const ma of this.KBa.value.results.results)if(Object(fh.c)(ma)&&
Gg.SJi(E,ma))return ma;return Object(fh.a)("RangeNotFoundInPrefetchResult")}return Object(fh.a)("ResultUnavailable")}$Ne(){this.KBa=Object(fh.a)({message:"PrefetchResultCleared"})}prefetch(E){this.KBa=Object(fh.a)({message:"EvalInProgress",key:E});this.calcManager.R7([],E.range,E.range,E.text,!0).then(ma=>{this.KBa=Object(fh.d)({key:E,results:ma})}).catch(ma=>{R.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${ma}`)})}static n5g(E,
ma){return E.text===ma.text&&E.range.toString()===ma.range.toString()&&E.ifmt===ma.ifmt&&E.stateId===ma.stateId&&E.sheetName===ma.sheetName}static SJi(E,ma){return E.range.top-1===ma.value.cell.row&&E.range.left-1===ma.value.cell.col}}Object(N.a)(Gg,"SetCellEstimationPrefetcher",null,[871,5]);var Fi;let gi=Fi=class extends ta.a{constructor(E){super();this.vu=null;this.Bzg=!1;this.pYd=this.instantaneousSupportInformationManager=this.MOb=null;this.vLd=new Map;this.Rqe=null;this.Oxc=ma=>{R.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");ma.kWd(this.Oxc);ma.hna.length?this.txc(ma,Sys.EventArgs.Empty):(R.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ma.nCe(this.txc))};this.txc=ma=>{R.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ma.XVd(this.txc);this.Ydk(ma)};this.onContentReady=()=>{this.vu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.zoc||
Ba.Task.delay(0).continueWith(()=>{this.vu.oXb(1)},0,null,Dj.a.current))};this.WLf=(ma,Ya)=>{this.vu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.zoc||this.vu.OUe(Ya.Re.block))};R.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.jpc=!1;this.dd=E;this.pv=ub.h(E);this.HQc=null;this.gridView.tu(this.onContentReady);this.gridView.za.$4c(this.WLf);this.$.ea.Zc(268,ma=>{ma.Vg?(R.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
this.Oxc(ma,Sys.EventArgs.Empty)):(R.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ma.GCe(this.Oxc))});if(this.r9=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.lve=new Gg(this,this.pv)}gCe(E){this.addHandler(Fi.ZZe,E)}IJf(E){this.raiseEvent(Fi.ZZe,new jj(E))}yYg(E){this.addHandler(Fi.G3c,E)}GAj(E){this.removeHandler(Fi.G3c,E)}lwc(E){this.raiseEvent(Fi.G3c,E)}get bGc(){return this.lve}get P0(){return this.HQc}get gridView(){return this.pv}get $(){return this.dd}get nI(){return this.Rqe}get localeInfo(){return this.P0?
this.P0.config.localeInfo:null}get config(){return this.P0.config}dispose(){R.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.ea.Zc(268,E=>{E.kWd(this.Oxc);E.XVd(this.txc)});this.gridView&&(this.gridView.hx(this.onContentReady),this.gridView.za&&this.gridView.za.c7f(this.WLf),this.pv=null);this.HQc=null;this.jpc=!1;this.r9&&(Xd.a.Ma(this.bGc),this.lve=null)}Vch(E,ma,Ya,Ub){this.vu&&this.vu.Sch(E,ma,Ya,void 0===Ub?null:Ub)}Wch(E,ma){return this.vu?this.vu.Tch(E,ma):!1}evalFormula(E,
ma,Ya,Ub){return this.vu?this.vu.evalFormula(E,ma,Ya,Ub):Promise.reject("calc engine not initialized")}R7(E,ma,Ya,Ub,Hc){return this.vu?this.vu.R7(E,ma,Ya,Ub,Hc):Promise.reject("CalcEngine is null")}F9a(E){if(!E)return R.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.vu)return null;R.ULS.shipAssertTag(537170059,0,2===E.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.vu.F9a(E)}hEe(E,ma){if(!ma||2!==E.type)return!1;E=uh.a(E);
return E.right-E.left+1===ma.count}x6e(E,ma){if(!this.MOb)return this.Bzg||R.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var Ya=this.fdd(Qf.Range.xe(1,1));Ya=this.MOb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Ya.range),E);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Ya))return R.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let Ub;const Hc=null!==ma&&void 0!==ma?ma:this.gridView.ha.ra.activeCell,
Gd=excelOnlineCalc.location.gridCell(Hc.top-1,Hc.left-1),he=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Ke=excelOnlineCalc.location.sheetIndex(he,this.$.va.na.sheetId),af=this.guh(Gd,Ke);this.pYd||(this.pYd=excelOnlineCalc.util.createResolver(this.fuh()));Ub=excelOnlineCalc.parse.parseResultHelper.extractReferences(Ya,this.P0.config.localeInfo,Ga.EwaSettings.Da(512),af,this.pYd);Ga.EwaSettings.Da(101)&&this.Kjk(Ub,E);return Ub}catch(Ub){return R.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Ub.message}`),null}}extractLetVariables(E,ma){if(!this.MOb)return this.Bzg||R.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const Ya=this.fdd(Qf.Range.xe(1,1));E=this.MOb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Ya.range),E);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(E))return R.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;
try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(E,ma,this.P0.config.localeInfo)}catch(Ub){return R.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Ub.message}`),null}}extractReferences(E,ma,Ya,Ub,Hc){if(!ma)return R.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!Ya)return R.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const Gd=this.x6e(E,Hc);if(!Gd)return R.ULS.sendTraceTag(537170049,
0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.ath(Gd,ma,Ya,E,Ub,Hc)}catch(he){return R.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${he.message}`),null}}fdd(E,ma){ma=void 0===ma?!0:ma;return E&&this.P0?this.P0.Buh(this.P0.iwh(),E.top-1,E.left-1,ma):null}aqc(E,ma){E=this.Cna(E);if(!Object(fh.c)(E))return null;ma=this.nI.parseEdit(ma,E.value);return excelOnlineCalc.util.isSuccess(ma)?ma.value.kind===Cj.a.formula:null}vyf(E){E=
this.Cna(E);return Object(fh.c)(E)?"Text"===E.value.valueType:null}etf(E){E=this.Cna(E);return Object(fh.c)(E)?"Date"===E.value.valueType&&!E.value.hasTime:null}Cna(E){if(null==this.nI)return Object(fh.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(fh.a)("Instantaneous manager is null");if(this.vLd.has(E))return Object(fh.d)(this.vLd.get(E));if("number"===typeof E){var ma=this.Lff(E);if(null==ma)return Object(fh.a)(`Invalid ifmt=${E}`);var Ya=ma.FormatString;
ma=ma.Builtin}else Ya=E,ma=!1;Ya=this.nI.createFormat(Ya,ma);return excelOnlineCalc.util.isSuccess(Ya)?(this.vLd.set(E,Ya.value),Object(fh.d)(Ya.value)):Object(fh.a)("Could not create number format")}getWorksheetFuncId(E){return this.localeInfo.getWorksheetFuncId(E)}ath(E,ma,Ya,Ub,Hc,Gd){const he={Items:[]};for(let wg=0;wg<E.length;wg++){var Ke=E[wg];const Ig={};Ig.Start=Ke.span.start;Ig.End=Ke.span.end;if(Hc||Ke.kind!==ni.a.func)if(Hc||Ke.kind!==ni.a.NQi){if(!this.bDh(Ke,ma,Ya))continue;var af=new pj;
const Jh=this.rfi(Ke,ma,af,Ub,Gd);if(Ga.EwaSettings.Da(512)){var xf=this.abi(Ke);const Bh=this.$ai(Ke);if(Jh||Bh&&0<=xf){let Wh={};Wh.Span=Ig;Wh.LetNumber=xf;Wh.LetName=Bh;Wh.Range=Jh;Wh.IsRangeRef=af.P2;Wh.IsAbsoluteFirstRow=af.$H;Wh.IsAbsoluteFirstColumn=af.ZH;Wh.IsAbsoluteSecondRow=af.hN;Wh.IsAbsoluteSecondColumn=af.gN;Wh.IsStructRef=Ke.kind===ni.a.C6d;he.Items.push(Wh)}}else Jh&&(xf={},xf.Span=Ig,xf.Range=Jh,xf.IsRangeRef=af.P2,xf.IsAbsoluteFirstRow=af.$H,xf.IsAbsoluteFirstColumn=af.ZH,xf.IsAbsoluteSecondRow=
af.hN,xf.IsAbsoluteSecondColumn=af.gN,xf.IsStructRef=Ke.kind===ni.a.C6d,he.Items.push(xf))}else Ke=Ke.ref.value.oper.kind,af={},af.Span=Ig,af.IsString=2===Ke,af.IsBoolean=4===Ke,af.IsNumber=1===Ke,he.Items.push(af);else Ig.End=Ke.span.start+Ke.ref.name.length,Ke={},Ke.Span=Ig,Ke.IsFunction=!0,Ke.FunctionId=this.getWorksheetFuncId(Ub.substring(Ig.Start,Ig.End)),he.Items.push(Ke)}he.Items.sort((wg,Ig)=>wg.Span.Start-Ig.Span.Start);return he}abi(E){return E.kind===ni.a.uBf?E.ref.number:-1}$ai(E){return E.kind===
ni.a.uBf?E.ref.name:null}rfi(E,ma,Ya,Ub,Hc){if(E.kind===ni.a.range)return Ya.P2=!0,this.vRe(E,ma,Ya,Ub);if(E.kind===ni.a.namedRange){Ya=E.ref;(E=this.$.Gd.getItemByName(Ya.name))||(E=this.$.Gd.getItemByName(ma+"!"+Ya.name));if(!(E&&E.sheetName&&E.usedRange&&Xc.a.equals(E.sheetName,ma,!0)))return null;ma=2===E.type?uh.a(E):E.usedRange;return Md.m(ma,E)}if(E.kind===ni.a.C6d){let Gd=E.ref;Gd.name?(Hc=this.$.Gd.getItemByName(Gd.name))||(Hc=this.$.Gd.getItemByName(ma+"!"+Gd.name)):Hc=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&
Hc?this.gridView.ed.Dh(Hc):this.gridView.ed.Dh(this.gridView.ha.ra.activeCell);if(!(Hc&&Hc.sheetName&&Hc.usedRange&&Xc.a.equals(Hc.sheetName,ma,!0)))return null;Ya.P2=!1;return this.vRe(E,ma,Ya,Ub)}return null}vRe(E,ma,Ya,Ub){E=E.ref;if(E.type){if(E.type===fj.a.column){var Hc=E.startIndex;E=E.endIndex;Ya.ZH=Hc.kind===Ki.a.abs;Ya.gN=E.kind===Ki.a.abs;return this.createRange(0,Hc.index,ef.a.qh,E.index,ma)}if(E.type===fj.a.row)return Hc=E.endIndex,Ya.$H=E.startIndex.kind===Ki.a.abs,Ya.hN=Hc.kind===Ki.a.abs,
this.createRange(E.startIndex.index,0,E.endIndex.index,ef.a.ph,ma);if(E.type===fj.a.cell){Hc=E.row;var Gd=E.col;Ya.$H=Ya.hN=Hc.kind===Ki.a.abs;Ya.ZH=Ya.gN=Gd.kind===Ki.a.abs;return this.eac(E.span.end,Ub)&&(Ya=Qf.Range.xe(Hc.index+1,Gd.index+1),Ya=this.gridView.ed.kif(Ya))?Md.n(Ya,ma):this.createRange(Hc.index,Gd.index,Hc.index,Gd.index,ma)}if(E.type===fj.a.range){Hc=E.top;Gd=E.left;Ub=E.bottom;E=E.right;const he=Math.min(Hc.index,Ub.index),Ke=Math.min(Gd.index,E.index),af=Math.max(Hc.index,Ub.index),
xf=Math.max(Gd.index,E.index);Ya.$H=Hc.kind===Ki.a.abs;Ya.hN=Ub.kind===Ki.a.abs;Ya.ZH=Gd.kind===Ki.a.abs;Ya.gN=E.kind===Ki.a.abs;return this.createRange(he,Ke,af,xf,ma)}R.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${E.type}'`);return null}R.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}eac(E,ma){return ma.length>=E&&0<E&&ma.charAt(E-1)===ej.BZf}Mch(E,ma,Ya){this.vu&&this.vu.Uch(E,
ma,Ya)}Lff(E){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.ECa&&this.instantaneousSupportInformationManager.ECa[E]&&this.nI?this.instantaneousSupportInformationManager.ECa[E]:null}Roi(E){var ma;"number"!==typeof E&&"string"!==typeof E?this.lwc(null):(E=this.Cna(E),Object(fh.c)(E)?(E=E.value,Object(th.c)(E)||Object(th.c)(E.formatString)?this.lwc(null):this.lwc({formatString:E.formatString,builtIn:null!==(ma=E.isBuiltIn)&&void 0!==ma?ma:!1})):this.lwc(null))}toXLNumber(E){if(!this.nI)return null;
E=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.nI,E);return excelOnlineCalc.util.isSuccess(E)?E.value:null}Kjk(E,ma){if(E)for(const Ya of E)Ya.ref.type&&Ya.ref.type===fj.a.cell&&(E=Ya.ref,Fi.Pnj(E,ma)&&(E.span.end+=1,Ya.span.end+=1))}createRange(E,ma,Ya,Ub,Hc){const Gd={};Gd.FirstRow=E;Gd.FirstColumn=ma;Gd.LastRow=Ya;Gd.LastColumn=Ub;Gd.SheetName=Hc;return Gd}bDh(E,ma,Ya){var Ub=E.ref.qualifier;if(!Ub)return!0;switch(E.ref.qualifier.type){case Yg.sheet:return E=Ub.document,Xc.a.equals(Ub.sheet,
ma,!0)&&(!E||Xc.a.equals(E.document,Ya,!0));case Yg.sheetRange:return ma=this.$.va.getItemByName(ma),Ya=this.$.va.getItemByName(Ub.sheet1),Ub=this.$.va.getItemByName(Ub.sheet2),!!ma&&!!Ya&&!!Ub&&(Ya.index<=ma.index&&ma.index<=Ub.index||Ub.index<=ma.index&&ma.index<=Ya.index);case Yg.document:return Xc.a.equals(Ub.document,Ya,!0);case Yg.Uti:return Ub=Ub.name,Xc.a.equals(Ub,ma,!0)||Xc.a.equals(Ub,Ya,!0);default:return R.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Ub.type}'`),
!1}}Ydk(E){this.instantaneousSupportInformationManager=E;E.ECa.length&&E.hna.length?(this.HQc=new Qh.CalcHelper(this.gridView.$),this.MOb=this.P0.createParser(),this.Rqe=this.P0.createNumberFormatter(),this.jpc=!0,R.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.vu||(R.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.vu=new ih(this.$))):R.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${E.ECa.length}, functions info count = ${E.hna.length}`)}guh(E,
ma){const Ya={allowUnqualifiedCell:!0,wrapCellReferences:!0};Ya.config=this.P0.config;Ya.originGridCell=excelOnlineCalc.util.success(E);Ya.originSheet=excelOnlineCalc.util.success(ma);return Ya}fuh(){const E={};E.config=this.P0.config;E.getNameLoc=this.vu.getNameLoc;E.getContainingTable=this.vu.getContainingTable;E.getStructRefColumn=this.vu.getStructRefColumn;E.getStructRefSpecialRef=this.vu.getStructRefSpecialRef;E.getDocumentLoc=this.vu.getDocumentLoc;E.getSheetIndex=this.vu.getSheetIndex;E.getSheetName=
this.vu.getSheetName;E.getUserDefinedFuncLoc=this.vu.getUserDefinedFuncLoc;E.getSheetRangeIndexes=this.vu.getSheetRangeIndexes;return E}static Pnj(E,ma){return ma.length>E.span.end&&ma.charAt(E.span.end)===ej.BZf}};gi.ZZe="ECRC";gi.G3c="ActiveCellNumberFormatChanged";gi=Fi=Object(Hd.a)([Object(Gb.d)(fd.m),Object(Hd.b)(0,Object(fd.R)()),Object(Hd.b)(1,Object(fd.U)())],gi);Object(N.a)(gi,"CalcManager",ta.a,[858,5]);class Gi extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){if(this.$){R.ULS.sendTraceTag(537169993,
0,50,"CalcManagerFactory.Create: Start loading script");if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var E=75;var ma="Current"}else E=78,ma="Stable";R.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ma} JS was loaded`);fc.TaskExtensions.ya(Vf.a.loadScript(E,4,this.Na,void 0,void 0,265),()=>{R.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let Ya=this.$.ea.Ba(266,!1);Ya||(R.ULS.sendTraceTag(537169990,
0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),Ya=new gi(this.$),this.$.ea.Ja(266,Ya));this.qd(Ya)},this.ka,3)}else R.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(E){E&&E.ea&&E.ea.Ja(265,new Gi(E))}}Object(N.a)(Gi,"CalcManagerFactory",Db.a,[]);String(G);window.___1688279119237_closurehack=G;var sj=a(578),zj=a(573),Ti=a(570),$i=a(1054);class lh{Dth(E,ma){if(E&&!(1>E.length)&&ma){var Ya=
Object.assign(new Ti.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.crh(E,Ya.ControlList);ma.push(Ya)}}crh(E,ma){const Ya=Object.assign(new sj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new zj.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(ma,Ya);ma=Object.assign(new Ti.a,{Title:"",ControlList:[]});Array.add(Ya.Menu.MenuSectionList,ma);this.gth(E,ma.ControlList)}gth(E,ma){for(let Ya=
0;Ya<E.length;Ya++){const Ub=Object.assign(new $i.a,{ExternalId:String.format("CoauthorPersona_{0}",Ya),Command:"336231556",DisplayName:E[Ya].userName,LabelText:E[Ya].userName,ImageBackColor:E[Ya].color,PersonaId:E[Ya].email,IsAnonymous:E[Ya].isAnonymous});Array.add(ma,Ub)}}}Object(N.a)(lh,"PresenceContextMenuSectionBuilder",null,[876]);var oi=a(572);class hi{constructor(E,ma,Ya,Ub){this.Pfe=this.j5=this.Sk=this.GG=this.uba=null;this.P4b=E;this.NQg=Ub;this.P4b.cRa&&(this.Sk=new Yh.a(3,2,5E3,Object(ha.a)(this,
this.b7g,"authenticationCheckTask"),2),V.AFrameworkApplication.Lj.Ah(this.Sk),this.Mi(ma,Ya));this.P4b.Ntb(()=>{this.GLf()});this.P4b.S2a(()=>{this.HLf()})}get businessBar(){return this.j5||(this.j5=qb.a.instance.ai("CommonUI.IBusinessBar"))}get dKe(){return this.Pfe||(this.Pfe=qb.a.instance.ai("CommonUI.IBusinessBarEntryFactory"))}Mi(E,ma){const Ya=V.AFrameworkApplication.jd;Ya.pg(ob.a.authenticationLost,Ia.a.frame,E,96);Ya.pg(ob.a.RHe,Ia.a.frame,ma,96);Ya.Pd(ob.a.XLe,Ia.a.frame,cb.ActionManager.shd);
Ya.Pd(ob.a.YLe,Ia.a.frame,cb.ActionManager.shd);Ya.Pd(ob.a.CFd,Ia.a.frame,cb.ActionManager.shd)}GLf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);V.AFrameworkApplication.jd.processAction(ob.a.authenticationLost,2)}HLf(){this.d9j();V.AFrameworkApplication.jd.processAction(ob.a.RHe,2)}b7g(){this.P4b.authenticationCheck()}d9j(){this.GG&&(this.GG.hide(),this.GG.dispose(),this.GG=null);this.uba&&this.businessBar&&(V.AFrameworkApplication.fi||this.businessBar.removeEntry(this.uba),this.uba.dispose(),
this.uba=null)}showDialog(E){Xd.a.Ma(this.GG);this.GG=new Ne.StandardDialog;this.NQg||(this.GG.Uv=!1,this.GG.Fd=0);this.GG.$d(1,CommonUIStrings.l_SignIn);this.GG.bV(CommonUIStrings.l_DefaultDialogTitle,E,Object(ha.a)(this,this.Lw,"dialogHandler"))}Lw(E){1===E?(oi.a.D$(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),V.AFrameworkApplication.jd.processAction(ob.a.CFd,2)):(this.KUb(),V.AFrameworkApplication.jd.processAction(ob.a.YLe,2))}KUb(){this.businessBar&&this.dKe&&
(this.uba=this.dKe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.uba.closeable=!0,this.uba.addButton(CommonUIStrings.l_SignIn,hi.Cbh,""),this.uba.Cda=Object(ha.a)(this,this.Ebh,"businessBarEntryCloseHandler"),this.businessBar.gD(this.uba,!1))}Ebh(){this.bBh();V.AFrameworkApplication.jd.processAction(ob.a.XLe,2)}bBh(){this.Sk&&(V.AFrameworkApplication.Lj.hr(this.Sk),this.Sk=null)}dispose(){this.Sk=this.GG=this.uba=null}static Cbh(){oi.a.D$();
V.AFrameworkApplication.jd.processAction(ob.a.CFd,2)}}Object(N.a)(hi,"SignOutResponseUI",null,[5]);class Li{get name(){return"Common.App.UI"}Oj(E){E.register(lh,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").se()}init(){}dispose(){Xd.a.Ma(Li.X5);Li.X5=null}static main(){Wa.a.instance.Mk(new Li)}}Li.X5=null;Object(N.a)(Li,"CommonAppUIPackage",null,[3,4]);var ii=a(36),wi=a(222),tj=a(1127),Mh=a(184),Oi=a(167),kj=a(70),qj=a(98),Rh=a(160);class aj{constructor(E,
ma,Ya){this.xSa=1;this.Bca=[];this.active=!1;this.Od=null;this.onPointerDown=Ub=>{Ga.EwaSettings.cI()?this.gridView.setLastInputMethod(Ub.Ca.rawEvent):Oi.a.slim(Ub.Ca.rawEvent);return!1};this.jz=()=>{const Ub=this.gridView.otd();if(!(0>=Ub||Ub===this.xSa||this.gridView.rt)){var Hc=!1,Gd=[],he=[];for(var Ke=this.Bca.length-1;0<=Ke;Ke--){var af=this.Bca[Ke];if(this.ntd(af)>Ub||af.bottom<Ub)Gd.push(af),this.Bca.splice(Ke,1),Hc=!0}for(Ke=this.tableManager.rangeList.length-1;0<=Ke;Ke--){af=this.tableManager.rangeList[Ke];
const xf=this.ntd(af);xf<=Ub&&af.bottom>=Ub&&!(xf<=this.xSa&&af.bottom>=this.xSa)&&af.$na&&(he.push(af),Hc=!0)}if(Hc){af=this.gridView.rzc;for(let xf of af)for(let wg of xf)for(let Ig of wg)this.lqc?this.Ggh(Ig,Gd,he):this.Hgh(Ig,Gd,he,Hc)}else R.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.xSa=Ub}};this.$Pf=(Ub,Hc)=>{Hc.isRow||Hc.W5c(this.Umc)};this.aQf=(Ub,Hc)=>{Hc.isRow||(this.tableManager.rangeList.length||this.deactivate(),
Hc.CWd(this.Umc))};this.Umc=(Ub,Hc)=>{if(this.Gf())this.activate();else if(Ub=this.active,this.deactivate(),!Ub){R.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Hc=Hc.Rw)&&this.Pmg(Hc.C8,Hc)};this.LSf=(Ub,Hc)=>{!this.gridView.rt&&(this.Gf()?this.activate():(Ub=this.active,this.deactivate(),Ub||R.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),
Hc=Hc.Rw)&&(Ub=tj.a(Hc.C8),this.Pmg(Ub,Hc)&&Hc.V0d(Ub))};this.Vf=()=>{this.gridView.Tc.qY?this.deactivate():this.activate()};this.tableManager=E;this.gridView=ma;this.$=ma.$;this.Od=Ya;E.H5c(this.LSf);ma.a_g(this.$Pf);ma.b_g(this.aQf);this.$.va.Fi(this.Vf);this.$.Gd.Fi(this.Vf);this.rGe(Ub=>{Ub.W5c(this.Umc)});this.Gf()&&(this.activate(),this.jz(this,null));this.$.ea.Ja(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.rWd(this.LSf),this.gridView.WBj(this.$Pf),this.gridView.XBj(this.aQf),
this.$.va.hj(this.Vf),this.$.Gd.hj(this.Vf),this.rGe(E=>{E.CWd(this.Umc)}));this.gridView=this.tableManager=this.Bca=null}get lqc(){return this.gridView.HD}JKc(E,ma,Ya){if(!Jf.b(this.$.na)||this.$.da.isNamedObjectViewMode||this.gridView.Tc.UFa)return ma&&R.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Ub=Ya.gjf();var Hc=Ub.length;if(Ub[Hc-1]<E.left)return!1;var Gd=ce.HelperMethods.Rz(new wi.a(Ub),
0,Hc,E.left,ce.HelperMethods.mI);if(0>Gd)return!1;const he=E.l8d,Ke=E.YHe;Hc=Math.min(he.length+Gd,Hc);let af=0;if(!Ke)return R.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;Gd<Hc;Gd++){const xf=Ub[Gd];ma?(Ya.updateCellText(Gd,he[af]),Ya.updateCellAlignment(Gd,!0),Ya.activateCellAutoFilter(Gd,Ke[af]),this.IAe(E,af,xf)):(Ya.updateCellText(Gd,Qf.Range.lP(xf)),Ya.updateCellAlignment(Gd,!1),Ya.deactivateCellAutoFilter(Gd),
this.EZe(xf));ma&&Ya.HRj();af++}Ya.ns("HeaderSnappingFeature::toggleHeaderSnapping");E.nFa=ma;return!0}KKc(E,ma,Ya,Ub){if(!Jf.b(this.$.na)||this.$.da.isNamedObjectViewMode||this.gridView.Tc.UFa)return!0;if(!Ya.length)return!1;var Hc=Ub.length;if(Ub[Hc-1]<E.left)return!1;var Gd=ce.HelperMethods.Rz(new wi.a(Ub),0,Hc,E.left,ce.HelperMethods.mI);if(0>Gd)return!1;const he=E.l8d,Ke=!!E.G4a&&0<E.G4a.length,af=!!E.menuModel&&0<E.menuModel.length;for(let Ig=Gd,Jh=0,Bh=Math.min(he.length+Gd,Hc);Ig<Bh;Ig++,
Jh++)if(Hc=Ya[Ig]){var xf=null;(Gd=Hc.getElementsByClassName(ii.a.Hkd))&&(xf=Gd[0]);if(xf&&xf.innerText){if(Gd=Hc.getElementsByClassName(ii.a.YDe))for(var wg=Gd.length-1;0<=wg;wg--)Hc.removeChild(Gd[wg]);Gd=Ub[Ig];ma?(xf.innerText=he[Jh],Hc.classList.add(ii.a.X4e),Ke&&E.G4a[Jh]&&(xf=document.createElement("div"),this.Od.Ij(xf,E.G4a[Jh]),wg=E.G4a[Jh].split(kj.a.J3g),3===wg.length?(wg=qj.a.Zg(wg[1]),this.eAe(xf.firstChild,wg),sb.a.instance.ta(uc.a.lh,xf.firstChild,this.onPointerDown),Mh.a.instance.ta(uc.a.ur,
xf.firstChild,this.onPointerDown)):(wg=new Rh.a(this.$.va),(wg.Gf(2048)||wg.Gf(4096))&&R.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.eAe(xf.firstChild,null)),af&&E.menuModel[Jh]&&this.IAe(E,Jh,Gd),Hc.appendChild(xf.firstChild))):(Hc.classList.remove(ii.a.X4e),xf.textContent=Qf.Range.lP(Gd),this.EZe(Gd))}}E.nFa=ma;return!0}eAe(E,ma){ue.a.instance.ta(uc.a.click,E,Ya=>{if(ma)if(Ga.EwaSettings.cI()){const {row:Ub,
col:Hc}=ce.HelperMethods.nhf(ma);this.gridView.KYd(Ya.Ca.rawEvent,966232027,ma,this.$.get_id(),Ub,Hc)}else Oi.a.hrc(Ya.Ca.rawEvent,966232027,ma,this.$.get_id());return!0})}IAe(E,ma,Ya){this.$.ea.Zc(8,Ub=>{Ub.Shc.baj(E,ma,Ya)})}EZe(E){this.$.ea.Zc(8,ma=>{ma.Shc.caj(E)})}Hgh(E,ma,Ya,Ub){const Hc=E.Qw,Gd=tj.a(E.C8);let he;for(let Ke=ma.length-1;0<=Ke;Ke--)he=ma[Ke],this.KKc(he,!1,Gd,Hc)&&ma.splice(Ke,1);for(ma=Ya.length-1;0<=ma;ma--)he=Ya[ma],this.KKc(he,!0,Gd,Hc)&&this.Bca.push(he);Ub&&E.V0d(Gd)}Ggh(E,
ma,Ya){if(E.Kdh()){for(var Ub=ma.length-1;0<=Ub;Ub--)this.JKc(ma[Ub],!1,E)&&(R.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),ma.splice(Ub,1));for(ma=Ya.length-1;0<=ma;ma--)Ub=Ya[ma],this.JKc(Ub,!0,E)&&(R.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.Bca.push(Ub))}else R.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}Pmg(E,
ma){const Ya=this.lqc?ma.gjf():ma.Qw;var Ub=Ya[0];const Hc=Ya[Ya.length-1],Gd=this.nki(Ub,Hc);let he=!1;for(let Ke=this.Bca.length-1;0<=Ke;Ke--){const af=this.Bca[Ke];Hc>=af.left&&Ub<=af.right&&(this.lqc?this.JKc(af,!1,ma):this.KKc(af,!1,E,Ya),this.Bca.splice(Ke,1),he=!0)}for(let Ke=0,af=Gd.length;Ke<af;Ke++)if(Ub=Gd[Ke],this.lqc?this.JKc(Ub,!0,ma):this.KKc(Ub,!0,E,Ya))this.Bca.push(Gd[Ke]),he=!0;return he}activate(){this.Gf()&&!this.active&&(this.gridView.view.uu(this.jz),this.active=!0)}deactivate(){this.active&&
(this.gridView.view.pt(this.jz),this.active=!1)}Gf(){return Jf.b(this.$.na)&&!this.$.da.isNamedObjectViewMode&&0>=this.gridView.Tc.KR&&0<this.tableManager.rangeList.length}rGe(E){const ma=this.gridView.rzc;for(let Ya of ma)for(let Ub of Ya)for(let Hc of Ub)E(Hc)}nki(E,ma){const Ya=[];if(!this.active)return Ya;this.xSa=this.gridView.otd();for(let Ub=this.tableManager.rangeList.length-1;0<=Ub;Ub--){const Hc=this.tableManager.rangeList[Ub];Hc.bottom>=this.xSa&&this.ntd(Hc)<=this.xSa&&Hc.left>=E&&Hc.right<=
ma&&Hc.$na&&Ya.push(Hc)}return Ya}ntd(E){const ma=this.gridView.ed.Dh(E);return ma&&this.tableManager.zuf(E,ma.usedRange.topLeft)?E.top+1:E.top}}Object(N.a)(aj,"HeaderSnappingFeature",null,[5]);class bj extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){const E=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(hf.d)(Gb.a.resolve(fd.Gc,{Qa:this.Na})):Rb.GetServiceTaskFactory.create(this.$.ea,134,this.ka,this.Na),ma=Object(hf.d)(Gb.a.resolve(fd.tb,
{Qa:this.Na}));fc.TaskExtensions.ya(fc.TaskExtensions.Bf([ma],this.ka),()=>{fc.TaskExtensions.ya(fc.TaskExtensions.Bf([E],this.ka),()=>{this.qd(this.$.ea.Ba(68)||new aj(E.result,ub.h(this.$),ma.result))},this.ka,11)},this.ka,3)}static la(E){E.ea.Ja(67,new bj(E))}}Object(N.a)(bj,"HeaderSnappingFactory",Db.a,[]);var A=a(165),ea=a(617);class Ma extends ea.a{constructor(){super()}dispose(){A.WacAirSpace.Oyd()&&A.WacAirSpace.HKc()}animate(E,ma,Ya,Ub,Hc){ma&&A.WacAirSpace.ZN(E.element,ma);A.WacAirSpace.animate(E,
Ub,Hc);Ya&&A.WacAirSpace.ozj(E.element,Ya)}}Object(N.a)(Ma,"AnimationManager",ea.a,[5]);new t(0,0,0,0,0,0);new t(1,1,0,0,0,0);new t(2,2,0,0,0,0);new t(3,3,0,0,0,1);new t(4,3,1,0,1,1);new t(5,3,0,0,.42,1);new t(6,3,.83,0,1,1);new t(7,3,0,0,.58,1);new t(8,3,.42,0,.58,1);new t(9,3,.1,.25,.75,.9);new t(10,3,.1,.9,.2,1);new t(11,3,.1,.9,.2,1);new t(12,3,.9,.1,.2,1);new t(13,3,.4,0,0,1);new t(14,3,.13,.21,.1,.7);new t(15,3,.02,.33,.38,.77);new t(16,3,.57,.17,.95,.75);new t(17,3,0,.19,.07,.72);new t(18,
3,0,0,.95,.37);new t(19,3,.66,0,.34,1);new t(20,3,.8,0,.2,1);new t(21,3,.8,0,.2,1);y.prototype={type:0,startTime:new z(0,null),endTime:new z(0,null),Csk:new z(0,null),Erk:new z(0,null),operationType:0};var Vb=Array(1);Vb[0]=new z(0,0);new C(0,[new y(5,0,0,0,null,1,1,0)]);new C(1,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,50,null,1,1,0)]);new C(2,[new y(1,3,0,167,null,0,1,1),new y(2,3,0,167,null,0,1,1)]);new C(3,[new y(3,3,0,167,null,0,1,1),new y(4,3,0,167,null,0,1,1)]);new C(4,[new y(5,2,0,0,null,0,2,
0),new y(5,2,0,167,null,1,1,0)]);new C(5,[new y(5,2,0,167,null,0,1,0)]);new C(6,[new y(1,3,0,100,null,0,1,1),new y(2,3,0,100,null,0,1,1)]);new C(7,[new y(3,3,0,100,null,0,1,1),new y(4,3,0,100,null,0,1,1)]);new C(8,[new y(5,2,0,100,null,1,1,0)]);new C(9,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,100,null,1,1,0)]);new C(10,[new y(5,2,0,100,null,0,1,0)]);new C(11,[new y(1,3,0,267,null,0,1,1),new y(2,3,0,267,null,0,1,1)]);new C(12,[new y(3,3,0,267,null,0,1,1),new y(4,3,0,267,null,0,1,1)]);new C(13,[new y(5,
2,0,267,null,1,1,0)]);new C(14,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,267,null,1,1,0)]);new C(15,[new y(5,2,0,267,null,0,1,0)]);new C(16,[new y(6,3,0,267,null,0,1,1),new y(7,3,0,267,null,0,1,1)]);new C(17,[new y(1,3,0,750,null,0,1,1),new y(2,3,0,750,null,0,1,1)]);new C(18,[new y(3,3,0,750,null,0,1,1),new y(4,3,0,750,null,0,1,1)]);new C(19,[new y(5,2,0,750,null,1,1,0)]);new C(20,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,750,null,1,1,0)]);new C(21,[new y(6,3,0,1E3,null,0,1,1),new y(7,3,0,1E3,null,0,1,
1)]);new C(22,[new y(1,3,0,367,null,0,1,1),new y(2,3,0,367,null,0,1,1)]);new C(23,[new y(3,3,0,367,null,0,1,1),new y(4,3,0,367,null,0,1,1)]);new C(24,[new y(5,2,0,367,null,1,1,0)]);new C(25,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,367,null,1,1,0)]);new C(26,[new y(5,2,0,367,null,0,1,0)]);new C(27,[new y(6,2,0,Vb[0],null,0,1,1),new y(7,2,0,Vb[0],null,0,1,1)]);new C(28,[new y(5,2,0,0,null,1,1,0),new y(5,2,0,50,null,0,1,0)]);new C(29,[new y(1,3,0,433,null,0,1,1),new y(2,3,0,433,null,0,1,1)]);new C(30,
[new y(5,2,0,0,null,0,2,0),new y(5,2,0,50,null,1,1,0),new y(2,3,0,0,null,40,1,1),new y(2,3,0,100,null,0,1,1)]);new C(31,[new y(2,0,0,0,null,32,1,1),new y(2,0,0,100,null,32,1,1),new y(2,3,101,350,null,0,1,1),new y(3,0,0,0,null,0,2,1),new y(3,0,0,100,null,0,2,1),new y(3,3,101,350,null,0,1,1),new y(5,0,0,0,null,0,2,0),new y(5,0,0,100,null,1,1,0)]);new C(32,[new y(2,3,0,267,null,32,1,1),new y(3,3,0,267,null,0,2,1),new y(5,2,0,0,null,1,0,0),new y(5,2,0,267,null,0,2,0)]);new C(33,[new y(5,2,0,0,null,0,
2,0),new y(5,2,0,100,null,0,2,0),new y(5,2,101,267,null,1,1,0)]);new C(34,[new y(1,10,0,300,null,0,1,1),new y(2,10,0,300,null,0,1,1)]);new C(35,[new y(3,10,0,300,null,0,1,1),new y(4,10,0,300,null,0,1,1)]);new C(36,[new y(1,8,0,750,null,0,1,1),new y(2,8,0,750,null,0,1,1)]);new C(37,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,200,null,0,2,0),new y(5,3,201,500,null,1,1,0)]);new C(38,[new y(1,2,0,0,null,0,2,1),new y(2,2,0,0,null,0,2,1),new y(1,2,0,200,null,0,2,1),new y(2,2,0,200,null,0,2,1),new y(1,3,201,
267,null,0,1,1),new y(2,3,201,267,null,0,1,1)]);new C(39,[new y(1,3,0,267,null,0,1,1),new y(2,3,0,267,null,0,1,1)]);new C(40,[new y(5,2,0,0,null,0,2,0),new y(5,2,0,267,null,1,1,0)]);new C(41,[new y(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(E){window.setTimeout(E,
16)}}();J.prototype={Wg:null,z3g:5,Cub:null,G6c:0,startTime:null,duration:null,Nfc:null,n8c:-1,uJd:-1,RId:-1};J.prototype.Start=function(){this.startTime=new Date;this.Nfc={}};J.prototype.GetRecentAnimationStats=function(){for(var E=[],ma=0,Ya=tc.G6c;Ya<tc.z3g;Ya++)null!=tc.Cub[Ya]&&(E[ma]=tc.Cub[Ya],ma++);for(Ya=0;Ya<tc.G6c;Ya++)null!=tc.Cub[Ya]&&(E[ma]=tc.Cub[Ya],ma++);return E};J.prototype.GetAnimationSqmStats=function(){var E=[];E[0]=0>tc.n8c?0:tc.n8c;E[1]=0>tc.uJd?0:tc.uJd;E[2]=0>tc.RId?0:tc.RId;
return E};var tc=new J,Jc=a(58),ld=a(198);class Zd{constructor(){this.hve=this.z0c=!1;const E=V.AFrameworkApplication.accessTokenTtl;0>=E||(this.accessTokenTtl=E,R.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:V.AFrameworkApplication.gla}),ld.a.instance.P5c(Object(ha.a)(this,this.$Ta,"onSessionExpiredDetected")),ld.a.instance.N5c(Object(ha.a)(this,this.rUf,"onSessionExpiringDetected")))}$Ta(){ld.a.instance.xWd(Object(ha.a)(this,
this.$Ta,"onSessionExpiredDetected"));R.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Mpi()}rUf(){ld.a.instance.wWd(Object(ha.a)(this,this.rUf,"onSessionExpiringDetected"));this.hve||this.z0c||(R.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.hve=!0,this.$1j())}Mpi(){this.z0c||(V.AFrameworkApplication.fu(Jc.a.MFc),this.z0c=!0,this.Z1j())}}Object(N.a)(Zd,"ASessionExpirationManager",null,[]);var De=a(262),Ve=a(89),Se=a(266);class sf extends Zd{constructor(E){super();
this.Ua=new ta.a;this.DH=this.xsb=!1;this.$=E}RCe(E){this.Ua.addHandler("SessionExpired",E)}Ytb(E){this.Ua.addHandler("TokenRefreshed",E)}ZCc(E){this.Ua.removeHandler("TokenRefreshed",E)}get accessTokenExpiringMessage(){const E=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(de.a.instance.gd(78),E)}get tokenExpired(){return this.xsb}get qjb(){return!1}get Gfa(){return!1}get vUd(){return!1}get B9(){return!1}Pmc(){return ld.a.instance.cQ(V.AFrameworkApplication.accessTokenTtl)}dispose(){Xd.a.Ma(this.Ua);
this.$=null}$1j(){this.$.isEditMode&&this.jmc(!1)}Z1j(){this.xsb=!0;this.jmc(!0);this.Ua.raiseEvent("SessionExpired")}jmc(E){R.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${E}, GotDeploymentOrTimedOutError ${this.$.da.f2}`);const ma=this.$.hd.gr;E&&ma&&ma.isVisible&&1299163859===ma.error.MessageId&&this.$.hd.gr.Cx();const Ya=this.Ze(E);gd.a(this.$).mt(new De.a(zb.a.Hx,5,()=>{const Ub=oa.a(this.$),Hc=Ub.ef.activityState;Hc[Ve.a.k6]=
this.$.Rvb(this.$.isEditMode);Hc[Ve.a.UO]=Ve.a.Kdb;Hc[Se.a.$q]=zb.a.accessTokenExpiringWarning;Ub.ef.Et([Ya])}))}Ze(E){return E?$g.a.tUe():this.zuh()}zuh(){const E=$g.a.Ze(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");E.Description=this.accessTokenExpiringMessage;return E}}Object(N.a)(sf,"EwaAccessTokenExpirationManager",Zd,[870,197,5]);var Of=a(178),qg=a(63),yg=a(663);class lg{constructor(E,ma){this.nQb=!1;this.correlationID=E;this.cfd=ma;this.PKc=!1;this.creationTime=Nd.a.$a.Wd}}Object(N.a)(lg,
"RefreshAccessTokenContext",null,[]);var Cg=a(162),ri=a(163),xi=a(38),Q=a(132);class Ja{}Object(N.a)(Ja,"Error",null,[]);class kb{}Object(N.a)(kb,"NamedResult",null,[]);class ec extends kb{}Object(N.a)(ec,"ErrorInfo",kb,[]);class Ic{constructor(E,ma){this.y5b=E;this.gJ=ma}get tokens(){return this.y5b}get errors(){return this.gJ}}Object(N.a)(Ic,"TokenRefreshArgs",null,[873]);class Ad{constructor(E,ma){this.documentVisibilityObserver=null;this.Ua=new ta.a;this.Vz=null;this.akb=this.rrb=!1;this.SBc=
null;this.vQb=!1;this.sHd=!0;this.moe=this.Kne=this.DH=this.xsb=!1;this.BV=null;this.slf=()=>{if(this.$.da.Zd)this.Qlf(!1);else if(this.sHd){this.sHd=!1;const Ya=oa.a(this.$);R.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Ya.Pj?Ya.Pj.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.crg()}]`)}};this.Qe=(Ya,Ub)=>{this.context&&(Ya=this.$.da,Ub.aI&&this.context.nQb&&!this.context.PKc?
(this.context.PKc=!0,Ub={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Ub.IsUserActive=Ya.kh.fs,Ub.RefreshAccessTokenCorrelationID=this.context.correlationID,Ub=$d.a.ye(Ub),R.ULS.sendTraceTag(537170708,0,50,Ub)):!this.rrb||Ya.Zd||this.context.cfd||(Ub={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Vz&&(this.Vz.cancel(),Ub.Aborted=!0,Ub.ResetStopRefreshRetriesUntilTokenExpired=!0,this.akb=!1),Ub.TimeUntilTokenExpirationInMin=
this.crg(),Ub.RefreshAccessTokenCorrelationID=this.context.correlationID,Ub=$d.a.ye(Ub),R.ULS.sendTraceTag(572019856,0,50,Ub)))};this.bDa=()=>{if(this.context&&this.context.nQb&&!this.context.PKc){var Ya={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Ya.CreatedForExpired=this.context.cfd;Ya.RefreshAccessTokenCorrelationID=this.context.correlationID;Ya.OpenWorkbookErrors=$g.a.me(this.$.da.rI);Ya.ExecutionContextErrors=$g.a.me(oa.a(this.$).ef.errors);Ya.accesstokenTTL=V.AFrameworkApplication.accessTokenTtl;
Ya=$d.a.ye(Ya);R.ULS.sendTraceTag(537170707,0,15,Ya)}};this.Plf=()=>{this.akb=!1;this.Qlf(!0)};this.OOd=()=>{this.vQb&&(this.$.da.kh.jEa(this.OOd),this.vQb=!1);this.Hng()};this.$=E;this.A8d=ma;this.sUd=E.Jd.Yh("WebServiceCall","refreshToken");ld.a.instance.P5c(this.Plf);ld.a.instance.N5c(this.slf);ma=this.$.da;ma.Pl(this.Qe);ma.F7b(this.bDa);this.rZi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.Tig=this.$.xa.ShortAccessTokenExpirationPromptSeconds;this.u4f=this.$.xa.RefreshAccessTokenDurationLimitInSec;
this.kxg(E.da.uXf,V.AFrameworkApplication.accessTokenTtl);E=JSON.stringify({["AccessTokenTtl"]:V.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:V.AFrameworkApplication.gla,["WopiTokenExpiresAfterMinutes"]:V.AFrameworkApplication.uce,["WopiTokenTaskItemPriority"]:V.AFrameworkApplication.wce});R.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${E}`);Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Gb.a.resolve(fd.K).then(Ya=>{this.documentVisibilityObserver=Ya}):this.$.ea.Zc(291,Ya=>{this.documentVisibilityObserver=Ya})}RCe(E){this.Ua.addHandler("SessionExpired",E)}Ytb(E){this.Ua.addHandler("TokenRefreshed",E)}ZCc(E){this.Ua.removeHandler("TokenRefreshed",E)}get tokenExpired(){return this.xsb}get Gfa(){return this.Kne}get B9(){return this.moe}get context(){return this.BV}get qjb(){return this.B9?!1:this.$.da.kh.fs?1>Q.a.a$:6>Q.a.b$}get vUd(){return this.rrb}Pmc(){return ld.a.instance.cQ(V.AFrameworkApplication.accessTokenTtl)}dispose(){ld.a.instance.xWd(this.Plf);
ld.a.instance.wWd(this.slf);const E=this.$.da;E&&(E.Vl(this.Qe),E.aDc(this.bDa));Xd.a.Ma(this.Ua);this.documentVisibilityObserver=this.$=null}crg(){return this.Pmc()?0:(V.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}kxg(E,ma){if(0<ma&&!this.Pmc()){const Ya=V.AFrameworkApplication.fa.Af("AccessTokenExpirationPromptSeconds",V.AFrameworkApplication.r0),Ub=(ma-E.getTime())/6E4;R.ULS.shipAssertTag(537170713,0,0<=Ub,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ma}] creationTime [${E.getTime()}] tokenLifetimeInMin [${Ub}]`);
Ub<this.rZi?(R.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.Tig}] tokenLifetimeInMin [${Ub}]`),V.AFrameworkApplication.r0=this.Tig):V.AFrameworkApplication.r0!==Ya&&(R.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Ya}] tokenLifetimeInMin [${Ub}]`),V.AFrameworkApplication.r0=Ya)}}Voh(E){return!this.context||this.context.nQb||
this.context.cfd!==E?(E=new lg(Of.a.create().toString(),E),this.context&&!this.context.PKc&&R.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${E.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.nQb}] `),this.BV=E,!0):!1}LGj(E){E&&this.DH&&!this.Gfa&&this.$.da.kh.fs&&!this.B9&&(this.DH=!1)}Qlf(E){this.LGj(E);if(!(this.rrb||this.akb&&!E||this.DH)&&this.qjb){this.rrb=!0;var ma=
this.context?this.context.creationTime:null,Ya=this.Voh(E);this.sHd=!0;var Ub=this.$.da,Hc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Hc.newContextCreated=Ya;Hc.IsUserActive=Ub.kh.fs;Hc.IsSessionActive=Ub.Zd;Hc.ContainsChangesWorkbookOperations=this.$.userOperationManager.AMa();Hc.isSessionExpired=E;Hc.stopRefreshRetriesUntilTokenExpired=this.akb;Hc.FailedToRefreshExpiredToken=this.DH;Hc.numOfFailuresWhileUserIsActive=Q.a.a$;Hc.numOfFailuresWhileUserIsInActive=Q.a.b$;Hc.numOfFailuresWhileOffline=
Q.a.DCa;Hc.RefreshAccessTokenCorrelationID=this.context.correlationID;Ya&&ma&&(Hc.TimeInMinFromPreviosContextCreation=Math.round(wc.b(Nd.a.$a,ma)/60));ma=$d.a.ye(Hc);R.ULS.sendTraceTag(40416199,0,50,ma);this.sUd.start();this.Kne=Ub.kh.fs;this.Vz=new yg.a;this.yQi(E);var Gd=this.A8d.Ewj(!E,this.Vz?this.Vz.token:null);Gd.continueWith(()=>{this.Chh();const he=this.A8d.wqj(Gd);this.sUd.stop();const Ke=this.Pmc();if(!he||Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
Ke){const af=Gd.result.errors;he&&Ke&&this.OVg(af);this.tpi(af,E)}else this.akb=!1,this.vpi(Gd.result.tokens,E);this.rrb=!1},8)}}OVg(E){const ma=[Object(zd.a)(new Ja,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];E.add(Object(zd.a)(new ec,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ma}))}yQi(E){E&&(this.$.da.kh.fs?this.Hng():(this.$.da.kh.qwa(this.OOd),this.vQb=!0))}Hng(){this.SBc=Cg.AsyncMethodContext.Or(()=>{this.Dwj()},1E3*this.u4f,Ib.a.lwj,this.SBc)}Chh(){this.SBc&&
this.SBc.cancel();this.vQb&&(this.$.da.kh.jEa(this.OOd),this.vQb=!1);this.Vz=null}Dwj(){R.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.u4f}]`);this.Vz.cancel()}tpi(E,ma){this.akb=!0;ma&&(this.DH||(this.xsb=this.DH=!0),this.A8d.sIb(E)&&(this.moe=!0));const Ya=!ma||this.qjb&&!Q.a.xHc?40380379:39982555;ma=this.TSe(ma);ma.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ma.FailedToRefreshExpiredToken=
this.DH;ma.LastErrorIsPermanent=this.B9;if(0<E.count){var Ub=E.ma(0);ma.errorName=Ub.Name;0<Ub.Errors.length&&(ma.ErrorId=Ub.Errors[0].Id,Ub=Ub.Errors[0].Details,ma.ErrorDetails=this.$Ch(Ub.toString())?"PiiScrubbed":Ub)}ma=$d.a.ye(ma);R.ULS.sendTraceTag(Ya,0,15,ma);this.Ua.raiseEvent("TokenRefreshed",new Ic(null,E))}$Ch(E){return Xc.a.contains(E,"makes the internet safe for businesses",!0)}TSe(E){const ma={},Ya=this.$.da;ma.Name="";ma.IsUserActive=Ya.kh.fs;ma.IsSessionActive=Ya.Zd;ma.GotDeploymentOrTimedOutError=
Ya.f2;ma.TimeInSecFromLastStatefulSuccessfulRequest=Ya.g_;ma.TimeFromLastUserActivityInMs=Ya.kh.Ckb;ma.calledFromSessionExpiredFlow=E;ma.RefreshTokenDurationInMS=this.sUd.Ee;ma.numOfFailuresWhileUserIsActive=Q.a.a$;ma.numOfFailuresWhileUserIsInActive=Q.a.b$;ma.numOfFailuresWhileOffline=Q.a.DCa;ma.RefreshAccessTokenCorrelationID=this.context.correlationID;ma.accessTokenTTL=V.AFrameworkApplication.accessTokenTtl;ma.ContainsChangesWorkbookOperations=this.$.userOperationManager.AMa();ma.IsDocumentHidden=
this.documentVisibilityObserver?this.documentVisibilityObserver.Ui.toString():"Unknown";ma.TimeFromFirstOpenInHr=Math.floor(wc.b(Nd.a.$a,$b.toUtc(Ya.uXf))/3600);return ma}vpi(E,ma){this.DH=!1;this.Ikk();this.kxg(new Date,V.AFrameworkApplication.accessTokenTtl);const Ya=this.$.da,Ub=!ma&&Ya.kh.fs,Hc=!this.$.isEditMode&&Ya.Qgb;ma=this.TSe(ma);ma.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ma.shouldTriggerSilentReloadAfterExpiring=Ub;ma.WopiTokenTaskItemPriority=V.AFrameworkApplication.wce;
ma.isDirtyViewSession=Hc;ma=$d.a.ye(ma);R.ULS.sendTraceTag(39982556,0,15,ma);this.Ua.raiseEvent("TokenRefreshed",new Ic(E,null));Hc?Ya.kh.fs&&(R.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Ya.hnd()):Ya.kh.fs?Ub&&(E=oa.a(this.$).ef.activityState,E[Q.a.alb]=!0,E[ri.a.v0]=!0,E[xi.a.pu]=this.$.isEditMode,gd.a(this.$).mt(new De.a(zb.a.Gra,2,null))):Ya.Zd&&Yc.j(this.$.pa.ua,
!0,!1,!1,null,null,null,null,null)}Ikk(){void 0!==this.$.da.workbookContext.WorkbookUri&&null!==this.$.da.workbookContext.WorkbookUri?(this.$.da.workbookContext.WorkbookUri=qg.a.rW(this.$.da.workbookContext.WorkbookUri,V.AFrameworkApplication.CJ,V.AFrameworkApplication.accessToken),this.$.da.workbookContext.WorkbookUri=qg.a.rW(this.$.da.workbookContext.WorkbookUri,V.AFrameworkApplication.dM,V.AFrameworkApplication.accessTokenTtl.toString()),this.$.da.Vyc()):R.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.xa.AccessToken=V.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=V.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=qg.a.rW(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,V.AFrameworkApplication.CJ,V.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=qg.a.rW(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,
V.AFrameworkApplication.dM,V.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=qg.a.rW(this.$.xa.EmbedConfiguratorUrl,V.AFrameworkApplication.CJ,V.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=qg.a.rW(this.$.xa.EmbedConfiguratorUrl,V.AFrameworkApplication.dM,V.AFrameworkApplication.accessTokenTtl.toString()));this.context.nQb=!0}}Object(N.a)(Ad,"EwaAccessTokenExpirationRefreshManager",
null,[870,197,5]);class md{}md.C6b="ActivityDuration";md.error="Error";md.Ajd="Errors";md.failed="Failed";md.WWh="FirstActivity";md.initialized="Initialized";md.KOi="LastActivity";md.pag="RetryOverride";md.hGj="RequestGroups";md.requests="Requests";md.U$f="Responses";md.NFc="SessionDuration";md.status="Status";md.success="Success";md.successful="Successful";md.tokens="Tokens";Object(N.a)(md,"SessionExpirationStrings",null,[]);class Rd{constructor(E){this.Xq={};this.A_={};this.LOg={};this.nDf=15;this.Ene=
!1;this.tQg=new Date;this.T1b=new Date;this.Uf=E;this.m5b=new Yh.a(2,2,6E4*this.nDf,Object(ha.a)(this,this.kAg,"writeMeasures"),135,"SL",!1);this.Uf.Ah(this.m5b);this.Ixi()}kAg(){R.ULS.sendTraceTag(41964821,217,50,R.ULS.ye({["Aggregate"]:this.A_,["Current"]:this.Xq}))}Ixi(){this.A_[md.hGj]=0;this.A_[md.requests]=0;this.A_[md.U$f]=0;this.A_[md.status]=md.initialized;this.A_[md.WWh]=new Date;this.A_[md.NFc]=0;this.A_[md.C6b]=0;this.A_[md.NFc]=0;this.Xq[md.NFc]=0;this.A_[md.C6b]=0;this.Xq[md.C6b]=0}mxd(E,
ma){var Ya=E[ma];Ya=Ya?Ya:0;Ya++;E[ma]=Ya;this.Z0d(E)}Z0d(E){const ma=new Date;E[md.C6b]=+ma-+this.T1b;this.T1b=ma;E[md.NFc]=+this.T1b-+this.tQg;E[md.KOi]=this.T1b}p4(E,ma){this.Xq[E]=ma;this.Z0d(this.Xq)}v0d(E,ma){this.Xq[E]=ma;this.Z0d(this.Xq)}incrementCounter(E){this.mxd(this.Xq,E);this.mxd(this.A_,E);this.mxd(this.LOg,E)}flush(){this.Ene||(this.A_[md.status]=this.Xq[md.status],this.kAg(this.m5b),this.Uf.kra(this.m5b,6E4*this.nDf))}stop(){R.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Ene=!0;this.Uf.hr(this.m5b)}}Object(N.a)(Rd,"SessionLogger",null,[965]);var Pc=a(476),Kd=a(1003),ye=a(177),ke=a(123);class we{constructor(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf){Ub=void 0===Ub?null:Ub;Hc=void 0===Hc?!1:Hc;Gd=void 0===Gd?null:Gd;he=void 0===he?!1:he;Ke=void 0===Ke?!1:Ke;af=void 0===af?!1:af;xf=void 0===xf?!1:xf;this.qca=0;this.c6=this.Sk=null;this.y5b=new hb.a;this.gJ=new hb.a;this.ym=null;this.E0a=!1;this.zsb=this.Asb=null;this.Uf=E;this.Gse=ma;this.Gse.execute(wg=>{wg.em(uf.a.twd,
Object(ha.a)(this,this.gaj,"onHostResponseReceived"))});this.xJ=Ya;this.hxe=new Kd.a("WebServiceCall","TokenRefresh");this.im=Ub||new Rd(E);this.oQg=Hc;this.eW=Gd?Gd:rg.SessionStatusManager.instance;this.ije=he;this.g0b=Ke;this.zQg=af;this.AQg=xf}gaj(E){if(E.MessageId!==uf.a.twd)ke.a(39408099,306,15,"Unexpected message.");else{var ma=new hb.a,Ya=new hb.a;this.im.incrementCounter(md.U$f);var Ub=E.Values[gf.a.Eeg];if(!Ub||0>=Ub.length)ke.a(40122317,306,15,"Found no tokens in the dictionary"),Ub=E.Values;
ke.a(40122318,306,100,"The Tokens array contains {0} tokens",Ub.length);this.im.p4("Correlation",E.CorrelationId);var Hc="";for(let Ke=0;Ke<Ub.length;Ke++){this.im.v0d(md.tokens,Ub.length);var Gd=Ub[Ke],he=Gd;if(!he||!he.Name)continue;this.im.incrementCounter(he.Name);const af=Gd;if(af&&af.Value)ke.a(39408128,306,100,"Received token with name: {0}",af.Name),ma.add(af),this.y5b.add(af),this.g0b||this.im.p4(md.status,md.success),this.ije&&this.eW&&this.eW.gHj();else if(Gd=this.Xgi(Gd),ke.a(39408129,
306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",he.Name,JSON.stringify(Gd),this.c6),Ya.add(Gd),this.g0b||(this.gJ.add(Gd),Hc=JSON.stringify(Gd),this.im.p4(md.error,JSON.stringify(Gd)),this.im.p4(md.status,md.failed)),this.ije)for(const xf of Gd.Errors)he=this.f8h(xf),this.eW&&this.eW.hYg(he)}this.g0b?(0<Ya.count?this.zsb?this.zsb(new Ic(ma,Ya)):ke.a(512267295,306,15,"Received errors but the promise has completed"):this.Asb?this.Asb(new Ic(ma,Ya)):ke.a(512267294,306,
15,"Received valid tokens but the promise has completed"),ke.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ma.count,Ya.count,E.CorrelationId,this.c6)):(0<Ya.count&&""!==Hc?(Ub=Object.assign(new ye.a,{extendedProperties:new Map}),Ub.extendedProperties.set("Errors",Hc),Ub.extendedProperties.set("RetryCount",this.qca.toString()),Ub.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Ub.extendedProperties.set("IsTokenExpiring",
this.E0a.toString()),qe.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ub)):qe.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ke.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ma.count,Ya.count,E.CorrelationId,this.c6),0<Ya.count&&!this.sIb(Ya)?(E=this.xJ.fhf(Ya),E!==this.xJ.aib&&(this.im.v0d(md.pag,E),this.Uf.kra(this.Sk,E))):(this.im.flush(),this.Sk&&(ke.a(39408131,306,100,"Deleting task {0} from task manager",
this.Sk.name),this.Uf.hr(this.Sk)),this.ym&&!this.ym.task.isCompleted?this.ym.setResult(new Ic(ma,Ya)):ke.a(512267293,306,15,"Received results but the task has completed")))}}Xgi(E){if(!E)return null;const ma=Object.assign(new ec,{Name:E.Name,Errors:[]});for(const Ya of E.Errors)E=new Ja,E.Id=Ya.Id,E.Details=Pc.a.NPa(Ya.Details,500),ma.Errors.push(E);return ma}requestTokensOnce(){this.Z9f()}Z9f(){V.AFrameworkApplication.lU("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.qca>=
this.xJ.TGf?(ke.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.c6),this.XSe(this.ym,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(qe.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Odg())}Odg(){const E={};E[gf.a.Eeg]=this.xJ.tokens;this.zQg&&(E[gf.a.YOj]=this.AQg);const ma=Of.a.create().toString();ke.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",
JSON.stringify(this.xJ.tokens),this.qca+1,ma,this.c6);this.Gse.execute(Ya=>{Ya.sendMessage(uf.a.iFe,E,ma)});this.qca++;this.im.incrementCounter(md.requests)}XSe(E,ma,Ya){const Ub=new hb.a;for(let Hc=0;Hc<this.xJ.tokens.length;Hc++){const Gd=Object.assign(new ec,{Name:this.xJ.tokens[Hc],Errors:[Object.assign(new Ja,{Id:ma,Details:Ya})]});Ub.add(Gd);this.gJ.add(Gd)}this.Uf.hr(this.Sk);this.im.p4(md.Ajd,JSON.stringify(this.gJ));this.im.p4(md.status,md.failed);E&&!E.task.isCompleted&&E.setResult(new Ic(new hb.a,
this.gJ))}Ewj(E,ma){ma=void 0===ma?null:ma;V.AFrameworkApplication.lU("ej4if276;fheca743");this.hxe.start();this.E0a=E;this.c6=Of.a.create().toString();ke.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.c6,this.E0a);this.qca=0;this.gJ.clear();this.y5b.clear();const Ya=new Mc.a;this.ym=Ya;ma&&ma.R(()=>{const Ub=!!Ya&&!Ya.task.isCompleted;ke.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.c6,this.E0a,
Ub);Ub&&this.XSe(Ya,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.g0b?this.$9f(this.xJ.TGf).then(Ub=>{this.ym&&!this.ym.task.isCompleted&&this.ym.setResult(Ub);this.zsb=this.Asb=null;this.im.p4(md.Ajd,JSON.stringify(this.gJ));this.im.p4(md.status,md.success);this.im.flush()}).catch(Ub=>{this.ym&&!this.ym.task.isCompleted&&this.ym.setResult(Object(Za.a)(873,Ub));this.zsb=this.Asb=null;this.im.p4(md.Ajd,JSON.stringify(this.gJ));this.im.p4(md.status,md.failed);this.im.flush()}):
(this.Sk=new Yh.a(this.xJ.priority,2,this.xJ.aib,Object(ha.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,uf.a.iFe,!0),this.oQg&&this.Z9f(),this.Uf.Ah(this.Sk));return this.ym.task}$9f(E){const ma=this,Ya=new Promise((Ke,af)=>{ma.Asb=Ke;ma.zsb=af;qe.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);ma.Odg()}),Ub=this,Hc=new Promise((Ke,af)=>{window.setTimeout(()=>{af(Ub.cTe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Ub.xJ.aib)});
let Gd=E;const he=this;return new Promise((Ke,af)=>{Gd--;Promise.race([Ya,Hc]).then(xf=>{qe.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ke(xf)}).catch(xf=>{var wg=he.xJ.aib;if(Object(Gc.a)(873,xf)&&(xf=Object(Za.a)(873,xf),0<xf.errors.count)){he.WSi(xf.errors);he.Et(xf.errors);if(he.sIb(xf.errors)){af(xf);return}const Ig=he.xJ.fhf(xf.errors);Ig!==he.xJ.aib?(he.im.v0d(md.pag,Ig),wg=Ig):he.iMi(xf.errors)&&(wg=0)}Gd?window.setTimeout(()=>{he.$9f(Gd).then(Ke).catch(af)},wg):(wg=he.cTe("TOO_MANY_ATTEMPTS",
"We did not receive a new token from the host after the maximum allowed number of attempts"),he.Et(wg.errors),af(wg),ke.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",he.c6))})})}Et(E){for(let ma of E)this.gJ.add(ma)}iMi(E){if(!E.count)return!1;E=E.ma(E.count-1);return E.Errors.length?"TIMEOUT"==E.Errors[0].Id:!1}cTe(E,ma){const Ya=new hb.a;for(let Ub=0;Ub<this.xJ.tokens.length;Ub++){const Hc=this.Lqh(this.xJ.tokens[Ub],E,ma);Ya.add(Hc)}return new Ic(new hb.a,Ya)}Lqh(E,
ma,Ya){return Object.assign(new ec,{Name:E,Errors:[Object.assign(new Ja,{Id:ma,Details:Ya})]})}WSi(E){if(E.count){E=E.ma(E.count-1);E=JSON.stringify(E);var ma=Object.assign(new ye.a,{extendedProperties:new Map});ma.extendedProperties.set("Errors",E);ma.extendedProperties.set("RetryCount",this.qca.toString());ma.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());ma.extendedProperties.set("IsTokenExpiring",this.E0a.toString());qe.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,ma);this.im.p4(md.error,E);this.im.p4(md.status,md.failed)}}wqj(E){this.hxe.stop();const ma=this.Mqi(E.result.errors);R.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!ma,this.c6,this.E0a,this.qca,this.gJ.count,0<E.result.errors.count?E.result.errors.ma(0).Name:"",0<E.result.errors.count&&0<E.result.errors.ma(0).Errors.length?
E.result.errors.ma(0).Errors[0].Id:"",0<E.result.errors.count&&0<E.result.errors.ma(0).Errors.length?E.result.errors.ma(0).Errors[0].Details:"");return ma?!1:this.vqj(E.result.tokens)}sIb(E){return this.xJ.sIb(E)}vqj(E){for(let ma=0;ma<E.count;ma++){const Ya=E.ma(ma);if(Ya.Name===gf.a.accessToken){const Ub=(new Date).getTime();Ya.Expiry>V.AFrameworkApplication.accessTokenTtl?(R.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Ya.Expiry,["NowGetTime"]:Ub,["BootTime"]:V.AFrameworkApplication.gla},
"PreviousAccessTokenTtl",V.AFrameworkApplication.accessTokenTtl),V.AFrameworkApplication.accessToken=Ya.Value,V.AFrameworkApplication.accessTokenTtl=Math.floor(Ya.Expiry),V.AFrameworkApplication.vce=Ub,V.AFrameworkApplication.$va=Math.floor(Ya.Expiry)):R.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Ya.Expiry,["NowGetTime"]:Ub,["BootTime"]:V.AFrameworkApplication.gla},"PreviousAccessTokenTtl",V.AFrameworkApplication.accessTokenTtl)}}return!0}Mqi(E){let ma=
!1;for(let Ya=0;Ya<E.count;Ya++){ma=!0;const Ub=E.ma(Ya);R.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Ub.Name,JSON.stringify(Ub.Errors),this.c6)}return ma}f8h(E){let ma=Jc.a.MFc;E=parseInt(E.Id);if(isNaN(E))ma=Jc.a.bpk;else{switch(E){case 401:ma=Jc.a.epk;break;case 403:ma=Jc.a.$ok;break;case 500:ma=Jc.a.apk;break;case 503:ma=Jc.a.dpk}ma===Jc.a.MFc&&(ma=500<E?Jc.a.cpk:Jc.a.Zok)}return ma}}Object(N.a)(we,"TokenRefreshManager",null,[874]);class Ye{constructor(){this.aib=
V.AFrameworkApplication.hpk;this.TGf=V.AFrameworkApplication.fpk;this.tokens=V.AFrameworkApplication.Xli();this.priority=V.AFrameworkApplication.wce;this.Qte=this.ATj();this.W2c=V.AFrameworkApplication.Wli()}sIb(E){E=JSON.stringify(E);if(this.W2c&&0<this.W2c.length)for(const ma of this.W2c)if(0<ma.length&&0<=E.indexOf(ma))return!0;return!1}fhf(E){try{if(E)for(let ma of E)if(ma.Errors)for(const Ya of ma.Errors)if(Ya.Id in this.Qte)return Number.parseInvariant(this.Qte[Ya.Id].toString())}catch(ma){R.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ma.toString())}return this.aib}ATj(){const E={};try{if(!V.AFrameworkApplication.Wlc()||0>=V.AFrameworkApplication.Wlc().length||""===V.AFrameworkApplication.Wlc()[0])return E;for(const ma of V.AFrameworkApplication.Wlc())0<ma.length&&(E[ma]=V.AFrameworkApplication.gpk)}catch(ma){R.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ma.toString())}return E}}Object(N.a)(Ye,"TokenRefreshPolicy",
null,[872]);class rf extends Db.a{constructor(E){super();this.$=E;this.Md()}create(){V.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.qd(this.Rqh()):this.qd(this.$.ea.Ba(38)||this.$.ea.Ja(38,new sf(this.$)))}Rqh(){var E=this.$.ea.Ba(38);if(E)return E;E=new we(V.AFrameworkApplication.Lj,V.AFrameworkApplication.BT(),new Ye);return this.$.ea.Ja(38,new Ad(this.$,E))}static la(E){E.ea.Ja(39,new rf(E))}}Object(N.a)(rf,"AccessTokenExpirationManagerFactory",Db.a,[]);var Cf=a(1131),Yf;(function(E){E[E.generalException=
0]="generalException";E[E.invalidArgument=1]="invalidArgument";E[E.notAllowed=2]="notAllowed";E[E.apiNotAvailable=3]="apiNotAvailable";E[E.unresolvedPendingRequest=4]="unresolvedPendingRequest";E[E.timeout=5]="timeout";E[E.adalTimeout=6]="adalTimeout";E[E.userNotSignedIn=7]="userNotSignedIn";E[E.userAborted=8]="userAborted";E[E.silentSignInFailed=9]="silentSignInFailed";E[E.invalidResourceUrl=10]="invalidResourceUrl";E[E.invalidGrant=11]="invalidGrant";E[E.connectionLost=12]="connectionLost";E[E.clientError=
13]="clientError";E[E.serverError=14]="serverError"})(Yf||(Yf={}));Object(N.b)("ErrorCodes",Yf);a(1244);class vf{constructor(E,ma){this.requestCallback=this.requestParameters=null;this.requestParameters=E;this.requestCallback=ma}}Object(N.a)(vf,"OutstandingRequest",null,[]);class Df{}Df.k1i="AADSTS50058";Df.invalidResourceUrl="AADSTS50001";Df.e1i="AADSTS65001";Df.w1i="AADSTS70011";Df.userAborted="13002";Df.unj="Popup Window is null";Df.tnj="Popup Window closed";Df.adalTimeout="Token renewal operation failed due to timeout";
Df.Pak="tokenRevoked";Object(N.a)(Df,"WopiHostErrorType",null,[]);var Rf=a(430),hh=a(583),Qg=a(1243);class Ah{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(N.a)(Ah,"WopiIdentityInfo",null,[717]);class Ih{constructor(E,ma,Ya){this.expiration=this.authority=this.accessToken=null;this.accessToken=E;this.authority=ma;this.expiration=Ya}}Object(N.a)(Ih,"WopiIdentityToken",null,[716]);var di=a(179),vh=a(73),ai=a(359);class Ci{constructor(E){this._initialized=
!1;this.mfb={};this.lJc={};this.rR=V.AFrameworkApplication.sa.tG;this.rwd=E}s7a(E){this._initialized||(E.Vn(uf.a.rZf),E.em(uf.a.rZf,Object(ha.a)(this,this.Jdj,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(E,ma,Ya){Ya=void 0===Ya?null:Ya;this.RSa(E,ma);return new Promise((Ub,Hc)=>{if(this.Nyd(ma))if(ma in this.mfb)Hc("unresolvedPendingRequest");else{var Gd=window.setTimeout(()=>{R.ULS.sendTraceTag(37856032,344,10,Sb.c({["error"]:"Request timeout.",["callerId"]:ma}));Hc("timeout")},
12E4);this.hod(E,ma,Ya,(he,Ke)=>{window.clearTimeout(Gd);he?Ub(he):(R.ULS.sendTraceTag(37856033,369,15,Sb.c({["error"]:Yf[Ke]})),Hc(Ke))})}else R.ULS.sendTraceTag(37856034,344,10,Sb.c({["error"]:"Caller is not allowed."})),Hc("notAllowed")})}getPrimaryIdentityInfo(E){return new Promise((ma,Ya)=>{this.Nyd(E)?this.Eei((Ub,Hc)=>{Ub?ma(Ub):(R.ULS.sendTraceTag(37856064,369,10,Sb.c({["error"]:Hc.toString()})),Ya(Hc))}):(R.ULS.sendTraceTag(37856065,344,10,Sb.c({["error"]:"Caller is not allowed."})),Ya("notAllowed"))})}getAuthContext(E){return new Promise((ma,
Ya)=>{const Ub=this.getAuthContextSync(E);Ub?ma(Ub):Ya("notAllowed")})}getAuthContextSync(E){if(this.Nyd(E)){const ma=new Qg.a;ma.upn=V.AFrameworkApplication.fa.Ta("UserPrincipalName");ma.userId=V.AFrameworkApplication.fa.Ta("LoggableUserId");ma.authority=V.AFrameworkApplication.fa.Ta("HostAuthAuthority");ma.tenantId=V.AFrameworkApplication.fa.Ta("TenantId");ma.isAnonymous=V.AFrameworkApplication.fa.qa("IsAnonymousUser");ma.supportsAuthToken=this.sti(E);E=V.AFrameworkApplication.fa.Ta("HostAuthType");
ma.authorityType="aad"===E.toLowerCase()?2:"msa"===E.toLowerCase()?1:0;return ma}R.ULS.sendTraceTag(40751647,344,10,Sb.c({["error"]:"Caller is not allowed."}));return null}sti(E){const ma=Rf.OAuthManagerSettings.wFb;return pb.a.wBa?ma&&Rf.OAuthManagerSettings.eqg?Array.contains(Rf.OAuthManagerSettings.eqg,E.toLowerCase()):!1:ma}hod(E,ma,Ya,Ub){var Hc=[];Array.add(Hc,Object.assign(new vh.a,{name:"CallerId",string:ma}));Array.add(Hc,Object.assign(new vh.a,{name:gf.a.L5d,string:E.correlationId}));di.a.sendTelemetryEvent(Object.assign(new ai.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Hc}));Hc=hh.a.create().toString();const Gd="getAccessToken_"+Hc,he=this.rR.Le("ComponentAttach",Gd);this.lJc[Gd]=he;const Ke={};Ke[gf.a.M5d]=Hc;Ke[gf.a.R4j]=E.resource;Ke[gf.a.S4j]=E.scope;Ke[gf.a.ing]=V.AFrameworkApplication.fa.Ta("HostAuthType");Ke[gf.a.V4j]=V.AFrameworkApplication.fa.Ta("UserPrincipalName");Ke[gf.a.T4j]=E.silentLogin;Ke[gf.a.O4j]=E.options;Ke[gf.a.L5d]=E.correlationId;Ke[gf.a.P4j]=ma;Ya&&(Ke[gf.a.addinName]=
Ya.AddinName,Ke[gf.a.N4j]=Ya.AddinTrustId);this.rwd.execute(af=>{this.s7a(af);af.sendMessage(uf.a.getAuthToken,Ke)});this.mfb[Hc]=new vf(E,Ub)}Eei(E){const ma=V.AFrameworkApplication.fa.Ta("UserName"),Ya=V.AFrameworkApplication.fa.Ta("UserPrincipalName"),Ub=V.AFrameworkApplication.fa.Ta("LoggableUserIdSpace"),Hc=new Ah;Hc.email=Ya;Hc.displayName=ma;switch(Ub){case "OrgIdPuid":Hc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Hc.authority="MicrosoftAccount";break;default:Hc.authority=
Ub}E(Hc,null)}Jdj(E){let ma=null;try{let Ub=E.Values[gf.a.M5d];const Hc=E.Values[gf.a.M4j],Gd=E.Values[gf.a.ing],he=E.Values[gf.a.U4j];let Ke=null,af=null;const xf=this.mfb[Ub];if("undefined"!==typeof xf&&xf){var Ya=[];Array.add(Ya,Object.assign(new vh.a,{name:gf.a.L5d,string:xf.requestParameters.correlationId}));di.a.sendTelemetryEvent(Object.assign(new ai.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Ya}));ma=xf.requestCallback;delete this.mfb[Ub];"undefined"!==
typeof Hc&&Hc&&Hc.length?af=new Ih(Hc,Gd,he):Ke=Yf[this.gXi(E)];Ya="getAccessToken_"+Ub;Ya in this.lJc&&(this.lJc[Ya].stop(),delete this.lJc[Ya]);ma(af,Ke)}else R.ULS.sendTraceTag(37856066,344,10,Sb.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Ub}))}catch(Ub){E=E.Values[gf.a.M5d],E in this.mfb&&delete this.mfb[E],this.cuc(),R.ULS.sendTraceTag(37856067,344,10,Sb.c({["error"]:Ub.message,["stack"]:Ub.stack})),ma&&ma(null,"generalException")}}Nyd(E){var ma=V.AFrameworkApplication.Vli();
E=E.toLowerCase();for(const Ya of ma)if(E===Ya.toLowerCase())return!0;ma=Rf.OAuthManagerSettings.M6c;for(let Ya in ma)if(E===ma[Ya].toLowerCase())return!0;return!1}gXi(E){E=E.Values[gf.a.Q4j];this.cuc();R.ULS.sendTraceTag(39068821,344,15,Sb.c({["error"]:E}));return E?-1<E.indexOf(Df.k1i)?9:-1<E.indexOf(Df.unj)||-1<E.indexOf(Df.tnj)?12:-1<E.indexOf(Df.invalidResourceUrl)?10:-1<E.indexOf(Df.userAborted)?8:-1<E.indexOf(Df.w1i)||-1<E.indexOf(Df.e1i)||E===Df.Pak?11:-1<E.indexOf(Df.adalTimeout)?6:0:13}RSa(E,
ma){E=this.kwj(E.resource);R.ULS.sendTraceTag(39921882,344,50,Sb.c({["callerId"]:ma,["resource"]:E}))}cuc(){R.ULS.sendTraceTag(39068822,344,50,Sb.c({["userAgent"]:window.navigator.userAgent}))}kwj(E){return(E?E:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(N.a)(Ci,"WopiIdentityManager",null,[711]);class ei{constructor(){this.Rc=null}get name(){return"Common.App.WopiIdentity"}Oj(E){this.Rc=E;E.register(Ci,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").se().Ae(()=>
new Ci(E.Ed("Postmessage.IHostPostmessenger")))}init(){V.AFrameworkApplication.fa&&V.AFrameworkApplication.fa.Xw(Object(ha.a)(this,this.VD,"onFullAppSettingsReady"))}VD(){try{this.Rc.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(E){R.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+E)}}dispose(){}static main(){Wa.a.instance.Mk(new ei)}}Object(N.a)(ei,"WopiIdentityPackage",null,[3,4]);var Bi=a(1263),Mg=a(1132);class hg{constructor(E,ma,Ya,Ub,Hc){this.XTc=
this.bJa=null;this.h0a=this.XOc=!1;this.Uf=ma;this.I2b=E;this.Dua=Ya;this.dS=Ub;this.UYc=Hc;this.k5f(null)}k5f(){const E=document.getElementById(V.AFrameworkApplication.Lub);!this.h0a&&this.dS&&E&&(this.dS.ta(uc.a.sCa,E,Object(ha.a)(this,this.FJd,"mouseActivityHandler"),null),this.h0a=!0);this.UYc(()=>{this.dispose()})}FJd(){this.h0a&&(this.dS.Aa(uc.a.sCa,document.getElementById(V.AFrameworkApplication.Lub),Object(ha.a)(this,this.FJd,"mouseActivityHandler")),this.h0a=!1);this.vze();return!1}vze(){this.XOc=
!0;this.XTc||(this.XTc=new Yh.a(3,2,this.I2b,Object(ha.a)(this,this.k5f,"registerHandlerTask"),112),this.Uf.Ah(this.XTc));this.bJa||(this.$Sb(null),this.bJa=new Yh.a(3,2,this.I2b,Object(ha.a)(this,this.$Sb,"sendPostMessageIfNecessary"),111),this.Uf.Ah(this.bJa))}$Sb(){this.XOc&&(this.Dua.CWR(()=>this.Dua.result.sendMessage(uf.a.wlk,null)),R.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.XOc=!1)}dispose(){this.h0a&&(this.dS.Aa(uc.a.sCa,
document.getElementById(V.AFrameworkApplication.Lub),Object(ha.a)(this,this.FJd,"mouseActivityHandler")),this.h0a=!1)}}Object(N.a)(hg,"UserActivityHostNotificationManager",null,[867,5]);class gg{constructor(){this.Rc=null}get name(){return"Common.App.EditNotification"}init(){V.AFrameworkApplication.fa&&V.AFrameworkApplication.fa.Xw(Object(ha.a)(this,this.VD,"onFullAppSettingsReady"))}VD(){gg.editNotificationIsEnabled&&0<gg.nid&&(this.Rc.register(Bi.a,"Common.App.HostNotification.EditNotificationEventSource").se(),
this.Rc.register(hg,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").se().Ae(()=>new hg(6E4,Vi.a.instance,Sf.a.Tq(this.Rc.Ed("Postmessage.IHostPostmessenger")),Mh.a.instance,V.AFrameworkApplication.fkb)),this.Rc.register(Mg.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").se().Ae(()=>new Mg.a(gg.nid,Vi.a.instance,Sf.a.Tq(this.Rc.Ed("Postmessage.IHostPostmessenger")),
this.Rc.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Rc.ai("Common.Interface.IUserActivityHostNotificationManager"),gg.editNotificationPostMessageIsEnabled,gg.jEh)),this.Rc.resolve("Common.Interface.IEditNotificationManager"),R.ULS.shipAssertTag(38086291,209,0<gg.nid,"EditNotification Interval is less than or equal to 0."))}Oj(E){this.Rc=E}dispose(){}static get nid(){return V.AFrameworkApplication.fa?parseInt(V.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get jEh(){return V.AFrameworkApplication.fa?parseInt(V.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get editNotificationIsEnabled(){return!!V.AFrameworkApplication.fa&&V.AFrameworkApplication.fa.qa("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!V.AFrameworkApplication.fa&&V.AFrameworkApplication.fa.qa("EditNotificationPostMessageIsEnabled")}static main(){Wa.a.instance.Mk(new gg)}}
Object(N.a)(gg,"CommonHostNotificationPackage",null,[3,4]);class Hf{constructor(E,ma,Ya){this.HJa=null;this.Uf=E;this.Oa=ma;this.cke=Ya.create()}w5f(){this.HJa?R.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(R.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.HJa=new Yh.a(2,1,3E4,Object(ha.a)(this,this.PUb,"showFloatPane"),67),this.Uf.Ah(this.HJa))}PUb(){this.HJa=null;R.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");
this.cke.display()}zVa(){this.Oa.Pd(ob.a.PUb,Ia.a.frame,Object(ha.a)(this,this.A0j,"showFloatPaneHandler"))}A0j(E,ma,Ya,Ub,Hc){return E!==ob.a.PUb?2:1===Ya?32:2===Ya&&Hc?(R.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Hc),Hc?this.w5f():(this.HJa?(R.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Uf.hr(this.HJa)):(R.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.cke.remove(null)),this.HJa=
null),32):8}}Object(N.a)(Hf,"FloatPaneActor",null,[866]);var Kg=a(171);class ng{constructor(E,ma,Ya,Ub,Hc){this.sXc=this.Yob=this.O3b=this.Kja=this.gS=this.xt=this.sQc=this.HO=this.Rqb=this.Ypb=this.Zpb=this.rTc=null;this.Uf=ma;this.Pa=E;this.Ak=Ya;this.Rc=Hc;this.g5=Ub}W5a(){this.HO=document.createElement("div");this.HO.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.HO.style.width=this.gS.width+"px";(this.sXc=this.Zci(this.g5))?(this.Kja=document.createElement("a"),this.Kja.setAttribute(Ua.a.wf,
Ua.a.Kt),this.Ak.ta(uc.a.click,this.Kja,Object(ha.a)(this,this.aTf,"onRedirectClick")),this.Kja.href=this.sXc,this.Kja.target="_blank",this.Kja.appendChild(this.gS),this.HO.appendChild(this.Kja)):this.HO.appendChild(this.gS);this.xt=document.createElement("a");this.xt.setAttribute(Ua.a.wf,Ua.a.zv);this.xt.className="StandardButton WACFloatPaneCloseButton";this.xt.title=CommonUIStrings.l_Close;this.xt.tabIndex=-1;this.sQc=Kg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.sQc.setAttribute(Ua.a.wf,Ua.a.Kt);this.xt.appendChild(this.sQc);this.Ak.ta(uc.a.click,this.xt,Object(ha.a)(this,this.onClose,"onClose"));this.HO.appendChild(this.xt);this.Rqb.appendChild(this.HO)}N$h(E){const ma=this.Pa.qa("O365PromotionHasStarted");switch(E){case 2:return sa.a.oxa(String.format("adppt{0}.png",ma?"sale":""));case 1:return sa.a.oxa(String.format("adxls{0}.png",ma?"sale":""));case 3:return sa.a.oxa(String.format("addoc{0}.png",ma?"sale":""))}return null}Zci(E){const ma=
this.Pa.Ta("O365AdPaneRedirectedURL");switch(E){case 1:return String.format(ma,"Excel");case 2:return String.format(ma,"PowerPoint");case 3:return String.format(ma,"Word")}return null}hide(E){this.Yob=null;this.HO&&!this.O3b&&((void 0===E?0:E)?R.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):R.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.HO.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.HO.style.height=
"0px",this.O3b=new Yh.a(2,1,1E3,Object(ha.a)(this,this.remove,"remove"),67),this.Uf.Ah(this.O3b))}remove(){this.HO&&this.Rqb&&(this.Kja&&this.Ak.Aa(uc.a.click,this.Kja,Object(ha.a)(this,this.aTf,"onRedirectClick")),this.Ak.Aa(uc.a.click,this.xt,Object(ha.a)(this,this.onClose,"onClose")),this.Rqb.removeChild(this.HO),this.HO=null);this.O3b=null}display(){if(this.rTc=this.Rc.ai("Common.IFloatPaneContainer"))if(this.Rqb=this.rTc.container){var E=this.N$h(this.g5);E?(R.ULS.sendTraceTag(23674908,207,50,
"Begin downloading image from server: {0}.",E),this.gS=document.createElement("img"),this.gS.className="WACFloatPaneImage",this.Zpb=Object(ha.a)(this,this.Abj,"onLoadImageFinish"),tf.a.addHandler(this.gS,uc.a.load,this.Zpb),this.Ypb=Object(ha.a)(this,this.zbj,"onLoadImageError"),tf.a.addHandler(this.gS,uc.a.error,this.Ypb),this.gS.src=E):R.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else R.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");
else R.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Abj(){const E=this.Pa.Af("O365AdPaneShowingDuration",60);this.W5a();this.HO.style.display="block";this.HO.style.height=this.gS.height+"px";this.Yob=new Yh.a(2,1,1E3*E,Object(ha.a)(this,this.hide,"hide"),67);this.Uf.Ah(this.Yob);this.s6f()}zbj(){R.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.s6f();this.gS=null}s6f(){this.Zpb&&
this.gS&&tf.a.removeHandler(this.gS,uc.a.load,this.Zpb);this.Zpb=null;this.Ypb&&this.gS&&tf.a.removeHandler(this.gS,uc.a.error,this.Ypb);this.Ypb=null}aTf(){R.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Yob&&this.Uf.hr(this.Yob);this.hide();return!0}dispose(){this.hide()}}Object(N.a)(ng,"FloatPane",null,[900]);class Pg{constructor(E,ma,Ya,Ub,Hc){this.Uf=ma;this.Pa=E;this.Ak=Ya;this.Rc=Hc;this.g5=Ub}create(){return new ng(this.Pa,
this.Uf,this.Ak,this.g5,this.Rc)}}Object(N.a)(Pg,"FloatPaneFactory",null,[865]);class Hh{constructor(){this.Rc=null}get name(){return"Common.App.FloatPane"}get fuf(){return V.AFrameworkApplication.fa.qa("O365AdvertisementIsEnabled")&&V.AFrameworkApplication.fa.qa("IsShowAdvertisementPaneEnabled")}init(){this.fuf&&(R.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Rc.resolve("Common.App.FloatPane.IFloatPaneActor").w5f(),R.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
this.Rc.resolve("Common.App.FloatPane.IFloatPaneActor").zVa())}Oj(E){this.Rc=E;this.fuf&&(this.Rc.register(Pg,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ae(()=>new Pg(V.AFrameworkApplication.fa,V.AFrameworkApplication.Lj,ue.a.instance,V.AFrameworkApplication.sa.Sa.Xi,this.Rc)).se(),this.Rc.register(Hf,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ae(()=>new Hf(V.AFrameworkApplication.Lj,V.AFrameworkApplication.jd,this.Rc.resolve("Common.App.FloatPane.IFloatPaneFactory"))).se())}dispose(){}static main(){Wa.a.instance.Mk(new Hh)}}
Object(N.a)(Hh,"FloatPanePackage",null,[3,4]);var fi=a(951),ph=a(756);class Ri{constructor(E,ma){this.nob=null;this.Oa=E;this.Pa=ma}Mi(){(this.nob=this.Pa.Ta("StatusBarEnvironmentNameToUse"))&&""!==this.nob&&this.Oa.pg(ob.a.b1f,Ia.a.frame,Object(ha.a)(this,this.Yhk,"updateEnvironmentName"),96)}Yhk(E,ma,Ya,Ub,Hc){if(1===Ya)return 32;Hc[fi.a.Value]=this.nob;Hc[ph.a.Sj]=this.nob;Hc[fi.a.Visible]=!0;return 32}}Object(N.a)(Ri,"DisplayEnvironmentName",null,[]);class Xi{constructor(){this.Rc=null}get name(){return"Common.App.DisplayEnvironmentName"}Oj(E){this.Rc=
E;this.Rc.register(Ri,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").se().Ae(()=>new Ri(V.AFrameworkApplication.jd,V.AFrameworkApplication.fa))}init(){this.Rc.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Mi()}dispose(){}static main(){Wa.a.instance.Mk(new Xi)}}Object(N.a)(Xi,"DisplayEnvironmentNamePackage",null,[3,4]);var Ii=a(193),Si=a(168);class Ng extends Ii.a{constructor(E){super();this.zQ=()=>{this.Uxd()};this.sga=()=>{this.Uxd()};this.$=E}dispose(){this.$&&
Si.a(this.$)&&(Si.a(this.$).SVa(this.sga),this.$.da.X3(this.zQ));this.$=null;super.dispose()}nDh(){V.AFrameworkApplication.ybb()&&!this.Uxd()&&(Si.a(this.$).zKa(this.sga),this.$.da.y0(this.zQ))}Uxd(){return this.$.isEditMode&&(V.AFrameworkApplication.S6a||Hb.a.mi.Yv)?(Si.a(this.$).SVa(this.sga),fc.TaskExtensions.ya(Rb.GetServiceTaskFactory.create(this.$.ea,119,this.ka,1),E=>{E.result.initialize()},this.ka,3),!0):!1}static main(){vc.a.Fa(E=>{(new Ng(E)).nDh()})}}Object(N.a)(Ng,"FileOpSliceDownloaderBootStraper",
Ii.a,[]);var Dh=a(95),li=a(469),sh=a(118);class bi{constructor(E){this.RX=null;this.hEf=new Set;this.dyf=!1;this.d3=(ma,Ya)=>{if(!this.hEf.has(ma)){var Ub=[];if(Ya){const Hc=ub.h(this.$).ed.Dh(Ya,!1);if(!Hc){1!==Ya.top||1!==Ya.left||this.dyf||(Ub.push(sh.a.Mg("IsTableOnA1","false",1)),tg.a("MsFormsTableUsage",void 0,void 0,Ub),this.dyf=!0);return}if(1!==Hc.usedRange.top||1!==Hc.usedRange.left)return}Ya=We.b().pl(ma);Ub.push(sh.a.Mg("Command",Ya,2));tg.a("MsFormsTableUsage",void 0,void 0,Ub);this.hEf.add(ma)}};
this.bae=(ma,Ya)=>{if(!this.$.da.Ii.get(61)||Dh.k(this.$.tg))Dh.k(this.$.tg)&&Ya&&Ya.item.name===this.RX.SM&&this.aIe();else if(this.$.va.Rl(this.RX.QBb)){const Ub={};Ub.SheetName=this.RX.QBb;Ub.NamedObjectName=this.RX.QBb;Ub.FirstColumn=0;Ub.FirstRow=0;Ub.LastColumn=0;Ub.LastRow=2;const Hc=he=>{if(!Dh.k(this.$.tg)){if(null===he||void 0===he?0:he.Result)this.$.workbookContext.MsFormId=he.Result[0][0],this.RX.SM=he.Result[1][0],he=he.Result[2][0],this.aO(!!this.$.workbookContext.MsFormId&&this.PMi(he),
1024),this.aIe();Dh.c(this.$.tg)&&(Ya?R.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${qa.a.zy(this.$.workbookContext.MsFormId).toString()}`):R.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${qa.a.zy(this.$.workbookContext.MsFormId).toString()}`));Dh.c(this.$.tg)&&!Ya&&R.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${qa.a.zy(this.$.workbookContext.MsFormId).toString()}`);!Dh.c(this.$.tg)&&
Ya||this.aO(!0,2048)}},Gd=this.$.pa.ua.Ud();this.$.userOperationManager.BH(new Eh.a(159,0,(he,Ke,af)=>Yc.r(this.$.pa.dz,Ub,!1,te.b(he,Hc),Ke,af,null,Gd),16))}else Ya||this.aO(!0,2048)};this.$bj=(ma,Ya)=>{Ya&&Ya.item.name===this.RX.QBb&&(this.aO(!1,1024),this.aO(!0,2048))};this.$=E}Zdk(){this.RX=li.a.current;this.bae(null,null);this.$.va.Dka(this.bae);this.$.va.C0(this.$bj)}dispose(){this.$.va.ara(this.bae)}PMi(E){if(!E)return!0;const ma=RegExp("-","g"),Ya=this.$.workbookContext.MsFormDocUrl.toLowerCase();
return Ya.includes(E.toLowerCase())||Ya.includes(E.toLowerCase().replace(ma,""))?!0:!1}aIe(){Dh.c(this.$.tg)&&this.RX.SM&&this.$.va.na&&this.$.va.na.name!==this.RX.SM&&this.$.va.Rl(this.RX.SM)&&this.$.va.getItemByName(this.RX.SM).activate({scenario:"msForm"})}aO(E,ma){this.$.workbookContext.Options=ce.HelperMethods.jR(E,this.$.workbookContext.Options,ma)}}Object(N.a)(bi,"MsFormInfoUpdatingService",null,[863,5]);class vi extends Db.a{constructor(E){super();this.msFormInfoUpdatingService=null;this.$=
E;this.Md()}create(){this.qd(Object(ic.a)(this.$.ea,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new bi(this.$))));this.msFormInfoUpdatingService.Zdk()}static la(E){E.ea.Ja(236,new vi(E))}}Object(N.a)(vi,"MsFormInfoUpdatingServiceFactory",Db.a,[]);var Uh=a(238);class hj extends ta.a{constructor(E,ma,Ya){super();this.value=null;this.MEd=E;this.ry=ma;this.bNg=Ya}zZg(E){this.addHandler("EnabledStateChanged",E)}get isEnabled(){return this.ry}set isEnabled(E){E!==this.ry&&(this.ry=
E,fa.a.Fo()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.MEd.replace(" ","")+"Button",E)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get Sj(){return this.value?String.format(de.a.instance.gd(79),this.MEd,this.value):this.MEd}get ruc(){return this.bNg}}Object(N.a)(hj,"StatusBarAggregateControl",ta.a,[902]);class qi extends ta.a{constructor(){super();this.controls=new Hi.a(!1);this.Jee=null;this.x1f=()=>{this.raiseEvent("AggregatesChanged")};
this.Hca(0,415,"Average",!0);this.Hca(1,416,"Count",!0);this.Hca(2,417,"NumericalCount",!1);this.Hca(3,418,"Minimum",!1);this.Hca(4,419,"Maximum",!1);this.Hca(5,420,"Sum",!0)}GYg(E){this.addHandler("AggregatesChanged",E)}OAj(E){this.removeHandler("AggregatesChanged",E)}get t3a(){return this.Jee||qi.K_e}set t3a(E){E=E||qi.K_e;E!==this.t3a&&(this.PEa(0,E.Average),this.PEa(1,E.Count),this.PEa(2,E.NumericalCount),this.PEa(3,E.Minimum),this.PEa(4,E.Maximum),this.PEa(5,E.Sum),this.Jee=E,this.x1f())}dispose(){Xd.a.te(this.controls.values);
this.controls.clear();super.dispose()}tza(E){return this.controls.getItem(E)}pVg(E,...ma){E=this.tza(E.toString());for(const Ya of ma)this.controls.add(Ya,E)}Hca(E,ma,Ya,Ub){ma=new hj(de.a.instance.Ia(ma),Ub,Ya);ma.zZg(this.x1f);this.controls.add(E.toString(),ma)}PEa(E,ma){this.tza(E.toString()).value=ma}static get K_e(){qi.qua||(qi.qua={},qi.qua.Average=qi.qua.Count=qi.qua.NumericalCount=qi.qua.Minimum=qi.qua.Sum=null);return qi.qua}}qi.qua=null;Object(N.a)(qi,"StatusBarAggregateControlCollection",
ta.a,[]);var dk=a(201),ek=a(81);const Mi=[{u3a:0,name:"Average",FYa:-1015637685,v3a:1,q8a:!0},{u3a:1,name:"Count",FYa:1957769939,v3a:3,q8a:!1},{u3a:2,name:"NumericalCount",FYa:-1292677035,v3a:2,q8a:!1},{u3a:3,name:"Minimum",FYa:405783320,v3a:5,q8a:!0},{u3a:4,name:"Maximum",FYa:1210824414,v3a:4,q8a:!0},{u3a:5,name:"Sum",FYa:1265371067,v3a:9,q8a:!0}];class uj{constructor(E,ma,Ya){ma=void 0===ma?null:ma;Ya=void 0===Ya?null:Ya;this.mjc=this.QLc=this.RLc=this.PLc=null;this.twa=new qi;this.Bcb=new Hi.a(!0);
this.sqg=0;this.ytg=Ub=>{const Hc=this.ha.ra.activeCell.clone(),Gd=Md.d(this.ha.ra.selectedRanges);var he=this.$.na;const Ke=null===he||void 0===he?void 0:he.sheetId,af=null===he||void 0===he?void 0:he.hash,xf=this.$.da.mg,wg=this.$.da.gU;he=this.$.listSeparator;const Ig=Md.i(Md.H(Gd),he,this.$,!1),Jh=`=${this.calcManager.config.localeInfo.getWorksheetFuncName(485)}({0}${he}5${he}{1})`;Promise.all(Mi.map(Bh=>this.calcManager.evalFormula(String.format(Jh,Bh.v3a,Ig),Hc,void 0,Bh.q8a?excelOnlineCalc.calc.evalFormulaFormatAggregate():
excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(Bh=>{var Wh;const Hj=this.ha.ra.selectedRanges,Ij=this.ha.ra.activeCell,Pj=null===(Wh=this.$.na)||void 0===Wh?void 0:Wh.sheetId;if(Md.R(Gd,Hj)&&Hc.equals(Ij)&&Ke===Pj){Wh=[];for(var gj of Bh.entries()){[,Bh]=gj;if(void 0===(null===Bh||void 0===Bh?void 0:Bh.formatted)||!excelOnlineCalc.util.isSuccess(Bh.formatted)||!excelOnlineCalc.util.isSuccess(Bh.value)){this.AZd();return}Bh=this.calcManager.nI.renderValue(Bh.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);
if(!excelOnlineCalc.util.isSuccess(Bh)){this.AZd();return}Bh=excelOnlineCalc.numfmt.renderedValueToString(Bh.value);Wh.push(Bh)}gj={};for(var yj of Mi)gj[yj.name]="";yj=Wh[1];Bh=Wh[2];if(1<+yj&&(gj.Count=yj,0<+Bh))for(const Ui of Mi.entries()){const [Bj,Qj]=Ui;gj[Qj.name]=Wh[Bj]}this.aUb(gj);this.p9j(gj,yj,xf,wg,Gd,Hc,Ke,af,Ub)}}).catch(Bh=>{R.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(Bh)}`);this.AZd()})};this.df=()=>{this.Xug()};this.ih=
(Ub,Hc)=>{Ub=Hc.Re.hash;Hc=Hc.Re.block;const Gd=Hc.iea;if(Hc.state&4&&Gd&&Gd!==this.Bcb.getItem(Ub)){this.Bcb.add(Ub,Gd);var he=(Ub=Hc.gh)?ub.g(Ub.getRowNumbers(),Ub.getColumnNumbers()):null;Uh.a.any(this.ha.ra.selectedRanges,Ke=>Ke.Te(he))&&this.Xug()}};this.jp=(Ub,Hc)=>{this.Bcb.remove(Hc.Re.hash)};this.kf=()=>{this.$.ea.Zc(29,Ub=>{this.statusBarManager=Ub;Ub.gM(this);R.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.Qe=(Ub,Hc)=>{!Ub.Zd&&
Xh.b(Hc)&&this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null,R.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.$9j=()=>{let Ub;const Hc=this.ha.ra.selectedRanges;(()=>{let Gd=this.Xdk(Hc);({E$b:Ub}=Gd);return Gd})().returnValue?this.aUb(Ub):this.O9f()};this.O9f=()=>{var Ub;const Hc=Md.d(this.ha.ra.selectedRanges),Gd=this.ha.ra.activeCell.clone(),he=null===(Ub=this.$.na)||void 0===Ub?void 0:Ub.sheetId;
this.iGf(Gd,Hc,Ke=>{var af;const xf=this.ha.ra.selectedRanges,wg=this.ha.ra.activeCell,Ig=null===(af=this.$.na)||void 0===af?void 0:af.sheetId;Md.R(Hc,xf)&&Gd.equals(wg)&&he===Ig&&this.aUb(Ke.Result)})};this.Esf=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5809185_StatusBarAggregatesCSE");this.DEe=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=E;this.gridView=ub.h(this.$);this.T6=ma||V.AFrameworkApplication.mf;this.oj=Ya||Nd.a.$a;this.$.da.Pl(this.Qe);
this.$.Pm(this.kf);this.ha.cr(this.df);this.ha.add_activeCellChanged(this.df);this.za.yw(this.ih);this.za.GJ(this.jp);for(const Ub of Mi)this.IUj(Ub.u3a,Ub.name,Ub.FYa);(this.statusBarManager=this.$.ea.Ba(29))&&this.statusBarManager.gM(this);this.Esf&&((Ga.EwaSettings.JD()?Ub=>Gb.a.resolve(fd.m,{Qa:1}).then(Hc=>setTimeout(()=>Ub(Hc),0)):Ub=>this.$.ea.Zc(266,Ub))(Ub=>{this.calcManager=Ub}),this.$.ea.Zc(268,Ub=>{this.instantaneousSupportInformationManager=Ub}))}Ks(E){this.twa.GYg(E)}ot(E){this.twa.OAj(E)}get t3a(){return this.twa.t3a}aUb(E){this.twa.t3a=
E}get za(){return this.gridView.za}get ha(){return this.gridView.ha}dispose(){this.$&&(this.$.da.Vl(this.Qe),this.$.Rn(this.kf),this.ha.vr(this.df),this.ha.remove_activeCellChanged(this.df),this.za.Tu(this.ih),this.za.bL(this.jp),this.PLe());this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null);Xd.a.te([this.PLc,this.RLc,this.QLc,this.twa]);this.$=this.twa=this.QLc=this.RLc=this.PLc=null;this.Bcb&&(this.Bcb.clear(),this.Bcb=null)}Du(E,ma){return this.tza(E)&&this.Ggf(E,
ma)?!0:!1}Ggf(E,ma){const Ya=this.tza(E);if(!Ya)return!1;let Ub=Ya.Sj;if(E.endsWith("Label"))ma.Visible=Ya.isVisible,fa.a.Fo()?ma.LabelText=Ub:ma.Value=Ub;else if(E.endsWith("Button"))ma.LabelText=Ub,ma.On=Ya.isEnabled;else return!1;return!0}Jp(){return!0}Ce(){return!1}executeCommand(E,ma){E=this.tza(ma.command);if(!E)return dk.a(ma.command);E.isEnabled=!E.isEnabled;this.KSi(E.ruc,E.isEnabled);return Ba.Task.Wa(!0)}qe(E,ma){return!!this.tza(ma.command)}Ge(){return!1}iGf(E,ma,Ya){var Ub=this.$;this.PLe();
if(this.$.da.Zd){var Hc=Ub.pa.ua;E=Md.o(E,Ub);ma=Md.r(ma,Ub);Ub=Hc.Ra(1,null);Ub.activeCell=E;Ub.selectedRanges=ma;this.mjc=Yc.g(Hc,"GetStatusBarAggregates",Ub,Ya,null,null,null,0)}}Xdk(E){let ma,Ya=uj.xtg(E);({E$b:ma}=Ya);return{returnValue:Ya.returnValue||this.$4g(E)&&this.X4g(E),E$b:ma}}p9j(E,ma,Ya,Ub,Hc,Gd,he,Ke,af){const xf=this.DEe?1:.05,wg=this.DEe?1E3:20;if(af||!(this.sqg>wg||Math.random()>xf))this.sqg++,this.iGf(Gd,Hc,Ig=>{var Jh,Bh,Wh,Hj;if(!Ch.a(Ig)){var Ij=this.ha.ra.selectedRanges,Pj=
this.ha.ra.activeCell,gj=null===(Jh=this.$.na)||void 0===Jh?void 0:Jh.sheetId;Jh=Ig.StateId;if(Md.R(Hc,Ij)&&Gd.equals(Pj)&&he===gj&&Ya===this.$.da.mg&&Ub===this.$.da.gU&&Ya===Jh){var yj=Ig.Result;Jh={};const pk={};gj=!0;for(var Ui of Mi){var Bj=yj[Ui.name],Qj=E[Ui.name];const qk=Bj===Qj;Jh[Ui.name]=qk;pk[Ui.name]=[Bj.length,Qj.length];gj&&(gj=qk)}({category:Pj}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.Qdk(null!==(Hj=null===(Wh=null===(Bh=this.gridView.yd(Pj))||
void 0===Bh?void 0:Bh.cell)||void 0===Wh?void 0:Wh.Di)&&void 0!==Hj?Hj:0):{category:"uninitialized"});Bh=Ij.length;Ij=Md.b(Ij);Wh=this.gridView.vmf()||this.gridView.umf();Ui=this.gridView.Tc;Hj=Ui.HOb;Bj=this.gridView.Uk("StatusBarAggregates");Ui=ek.c(Gd,Ui.Hk,Ui.jl,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(Nh.c)(Bj)?Bj.value:null);Ui=Ui.X+"_"+Ui.Y+"_"+Ui.PaneType;yj=yj.Count;Bj=E.Count;Qj=this.gridView.ed.Xci(Hc);Ig=`StatusBarAggregateManager.testCalcResult: allCorrect: ${gj}, ${JSON.stringify(Jh)}, numberFormatCategory: ${Pj}, resLength(server,calc): ${JSON.stringify(pk)}, stateId: ${Ya}, latestSuccessfulStateId: ${Ub}, prevSheetId: ${he}, prevSheetHash: ${Ke}, numOfRanges: ${Bh}, numOfCells: ${Ij}, prevActiveCell: ${Gd}, prevSelectedRanges: ${Hc.join(";")}, sheetHasHidden: ${Wh}, panesState: ${Hj}, blockPositionString: ${Ui}, ReportCalcState: ${Ig.ReportCalcState}, CalcComplete: ${Ig.CalcComplete}, serverCount: ${yj}, calcCount: ${Bj}, calcCountUnfiltered: ${ma}, enumeratorCount: ${Qj}, forceTestResult: ${af}`;
R.ULS.sendTraceTag(520426510,0,50,Ig);gj||af||window.setTimeout(()=>{this.ytg(!0)},100)}}})}$4g(E){const ma=this.gridView.Yk,Ya=this.gridView.Gr;return!!ma&&Uh.a.all(E,Ub=>ma.contains(Ub))&&Uh.a.all(E,Ub=>!Ya.jbb(Ub))}X4g(E){if(500<Md.b(E))return!1;const ma=this.oj.eg;E=this.gridView.h7("StatusBarAggregateManager.AreAllCellsEmpty",E);try{for(let Ya=0;E.$$mn();Ya++)if(E.$$cu().wG||!(Ya%25)&&100<wc.c(this.oj,ma))return!1}finally{E&&E.dispose()}return!0}tza(E){return this.twa.tza(E)}IUj(E,ma,Ya){this.twa.pVg(E,
"Query"+ma+"Label","Query"+ma+"Button",Ya.toString())}Xug(){var E;if(this.$.sf&4&&!this.gridView.Xc&&!this.gridView.Jk){var ma;(()=>{let Ya=uj.xtg(this.ha.ra.selectedRanges);({E$b:ma}=Ya);return Ya})().returnValue?this.aUb(ma):(this.aUb(null),this.Esf&&(null===(E=this.calcManager)||void 0===E?0:E.jpc)?this.lLj():this.PLc=Cg.AsyncMethodContext.Or(this.$9j,500,Ib.a.e6j,this.PLc))}}lLj(){this.QLc=Cg.AsyncMethodContext.Or(()=>this.ytg(!1),10,Ib.a.f6j,this.QLc)}AZd(){this.RLc=Cg.AsyncMethodContext.Or(this.O9f,
500,Ib.a.d6j,this.RLc)}PLe(){this.mjc&&(this.T6.nx(this.mjc.Bw),this.mjc=null)}KSi(E,ma){const Ya={};Ya.a=this.$.xa.UserSessionId;Ya.b=E;Ya.c=ma;We.b().Wg(29,Ya)}static initData(){const E=bc.a.Gca;for(const ma of Mi)E(ma.FYa,fa.a.Fo()?Ac.a.vi|8192:Ac.a.vi,0,0)}static la(E){uj.initData();const ma=new uj(E);E.Ha.n6(ma);E.ea.Ja(27,ma)}static xtg(E){return{returnValue:1===E.length&&E[0].isSingle,E$b:null}}}Object(N.a)(uj,"StatusBarAggregateManager",null,[853,5,187,188,190]);var fk=a(1232),Gj=a(925);class yi{}
yi.i$j=864E5;yi.H1g=3;yi.E3i=144E5;Object(N.a)(yi,"AddinConstantsNum",null,[]);var Pi=a(755),Rj=a(835),rj=a(870);class Sj{constructor(E,ma,Ya,Ub){this.fa=(Ub=void 0===Ub?null:Ub)?Ub:V.AFrameworkApplication.fa;this.YUc=2;this.NQa=E;this.aTg=ma;this.Jd=Ya}get hoa(){return this.YUc}get Alk(){return this.aTg}DYd(E){if(this.fa.qa("AgaveSupportsLiveIdSpoofing")){var ma=(new Date).getTime();this.NQa(E,this.hoa,{["ak0"]:ma})}else if(rj.a.cZj(E)){ma=String.format(V.AFrameworkApplication.sa.Sa.XY+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",
"laststoreupdate",V.AFrameworkApplication.sa.Sa.Xi,this.Alk,V.AFrameworkApplication.tk);const Ya=V.AFrameworkApplication.mf;let Ub=null;this.Jd&&(Ub=this.Jd.Le("ComponentAttach",Rj.a[E]+Gj.a[this.hoa]));Ya.Vo(ma,1,null,null,!0,4,Hc=>{this.xhj(E,Hc.data.Lf);Ub&&Ub.stop()},Hc=>{R.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Hc.data.httpStatus);this.Oeb(E,1,"request failed");Ub&&Ub.stop()},null)}else rj.a.Wlf(E)?(ma=rj.a.aaf(E),this.NQa(E,this.hoa,{["ak0"]:ma})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(this.BP?this.Oeb(E,1,"no local timestamp"):this.NQa(E,this.hoa,null))}xhj(E,ma){if(ma&&""!==ma)if(ma=Sys.Net.XMLDOM(ma)){rj.a.oLc(Pi.a.sDe,((new Date).getTime()+yi.E3i).toString(),E);let Ya=ma.getElementsByTagName("update");Ya&&Ya.length||(Ya=ma.getElementsByTagName("o:update"));Ya&&0<Ya.length?(ma=Date.parse(Ya[0].firstChild.nodeValue),rj.a.aaf(E)<ma||rj.a.Wlf(E)?this.NQa(E,this.hoa,{["ak0"]:ma}):this.Oeb(E,1,"outdate timestamp in reponse")):this.Oeb(E,2,"no timestamp in response")}else this.Oeb(E,
1,"response data is invalid");else this.Oeb(E,1,"no responseData")}Oeb(E,ma,Ya){this.BP&&this.NQa(E,this.hoa,{["AddinServiceUserState"]:ma,["DiagnosticInfo"]:Ya})}get BP(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(N.a)(Sj,"AddinCommandsAnonymousAPIInitializer",null,[940]);class Ej{constructor(E,ma,Ya){this.YUc=Ya;this.NQa=E;this.wj=
ma}get hoa(){return this.YUc}DYd(E){let ma=null;this.wj&&(ma=this.wj.Le("ComponentAttach",Rj.a[E]+Gj.a[this.hoa]));if(null==this.w3d(E)?0:this.w3d(E)){const Ya=(new Date).getTime()-yi.H1g*yi.i$j;this.NQa(E,this.hoa,{["ak0"]:Ya})}ma&&ma.stop()}}Object(N.a)(Ej,"AddinCommandsInitializerBase",null,[940]);class Tj extends Ej{constructor(E,ma){super(E,ma,5)}w3d(){return!0}}Object(N.a)(Tj,"AddinCommandsInitializer",Ej,[]);class gk extends Ej{constructor(E,ma){super(E,ma,1)}w3d(E){try{const ma=Pi.a.hdf()+
E;return Boolean.parse(this.f4h(ma)||"false")}catch(ma){R.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",ma.toString())}return null}f4h(E){const ma=localStorage;return void 0!==ma&&null!==ma?ma.getItem(E):null}}Object(N.a)(gk,"AddinCommandsLocalCacheInitializer",Ej,[]);var hk=a(569);class Jj{constructor(E,ma){ma=void 0===ma?null:ma;this.Jd=E;this.fa=ma?ma:V.AFrameworkApplication.fa}get appUILocale(){return hk.a.XM(V.AFrameworkApplication.lcid).name}Ewi(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var E={};E[Pi.a.$Dh]="TeachingCallout";this.QAc(ob.a.blb,E)}const ma=this.yod();if(ma)if(this.fa.qa("OcpsIsEnabled"))qb.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ya=>
{Ya.isFeatureEnabled("ConnectedServices",!0).then(Ub=>{for(let Hc of ma){if(!Ub&&0===Hc.key){this.BP&&this.vsg(0,Hc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Gd=this.A$e(Hc.value);Gd&&Gd.DYd(Hc.key)}return null})});else for(let Ya of ma)(E=this.A$e(Ya.value))&&E.DYd(Ya.key)}EYd(E,ma,Ya){Ya&&Ya[Pi.a.FKa]?(Ya[Pi.a.D0]=E,Ya[Pi.a.AW]=ma,this.QAc(ob.a.lra,Ya),rj.a.oLc(Pi.a.FKa,Ya[Pi.a.FKa].toString(),E)):this.BP?this.vsg(E,ma,Ya):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&0===E&&(Ya={},Ya[Pi.a.D0]=E,Ya[Pi.a.AW]=ma,this.QAc(ob.a.fE,Ya))}A$e(E){let ma=null;switch(E){case 1:ma=new gk(Object(ha.a)(this,this.EYd,"retrieveAddinFlagCompleted"),this.Jd);break;case 2:ma=new Sj(Object(ha.a)(this,this.EYd,"retrieveAddinFlagCompleted"),this.appUILocale,this.Jd,this.fa);break;case 5:ma=new Tj(Object(ha.a)(this,this.EYd,"retrieveAddinFlagCompleted"),this.Jd)}return ma}vsg(E,ma,Ya){0===E&&Ya&&Ya[Pi.a.vDe]&&(Ya[Pi.a.D0]=E,Ya[Pi.a.AW]=ma,R.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
Ya[Pi.a.vDe].toString(),JSON.stringify(Ya)),this.QAc(ob.a.fE,Ya))}get BP(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(N.a)(Jj,"AddinCommandsInitializerHost",null,[]);var mk=a(277),Fj=a(833),Uj=a(267),Vj=a(361);let Wj;class Aj extends Ne.StandardDialog{constructor(E,ma){super();this.zge=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;
this.vje=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.wje=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.Lqb=!1;this.yvb=()=>{this.hide();this.Lqb&&F(this.Tia)};this.z5i=()=>{Fj.a.instance.getItem("optedIntoAddinDeveloperMode")?(Fj.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Lqb=!1):(Fj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Lqb=!0)};this.Tia=E;Wj=ma}showDialog(E,ma){try{this.kg=void 0===this.kg||null===this.kg?Uj.a.fVa(Vj.a.a5).toString():
this.kg,this.show({["type"]:"StandardDialogProps",["id"]:this.kg,["dialogIcon"]:3,["headerText"]:E,["titleText"]:ma,["resultHandler"]:this.yvb,["messageAreaLink"]:this.Sth(),["permanentDismissCheckbox"]:this.Oth(),["renderMicrosoftLogoInHeader"]:!1})}catch(Ya){this.xOc(E,ma)}}Sth(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.vje,["handler"]:{["href"]:this.wje,["target"]:"_blank"},["onExecute"]:null}}Oth(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",
["label"]:this.zge,["onExecute"]:this.z5i}}xOc(E,ma){const Ya=new jb.a(!1,!1,!1);Ya.Fd=1;Ya.kg=Uj.a.fVa(Vj.a.a5).toString();Ya.Oh=String.format(this.bY(),ma,this.wje,this.vje,this.zge);Ya.initializeAndShow(E,this.UCg,{optInCheckbox:!1})}UCg(E,ma){1==E&&ma.optInCheckbox&&(Fj.a.instance.getItem("optedIntoAddinDeveloperMode")?(Fj.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Lqb=!1):(Fj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Lqb=!0,F(this.Tia)))}bY(){return Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?
"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(N.a)(Aj,"AppsForOfficeDeveloperModeOptInDialog",Ne.StandardDialog,[]);var nk=a(388);class Xj extends Jj{constructor(E){super(E.Jd);
this.Tia=this.K_b=null;this.OIa=new mk.a;this.e5f=ma=>{1===ma&&this.Tia&&this.d5f()};this.$=E;fk.a.vFb=fk.a.C5e}get appUILocale(){return this.$.xa.UICultureTag}gtg(){this.Ewi();this.pek()}yod(){const E=new nk.a;this.$.da.Ii.get(27)&&(E.ga(0,2),""!==V.AFrameworkApplication.fa.Ta("HostInstallAddIns")&&E.ga(16,5));this.$.da.Ii.get(33)&&E.ga(1,1);Ga.EwaSettings.Da(52)&&E.ga(8,1);this.$.ag.get(35)&&E.ga(10,5);return E}QAc(E,ma){this.PGh(()=>{const Ya=new Pe.a(E,0,this.$.ee,0,null);this.$.Ha.kd(Ya,ma)})}PGh(E){(ma=>
{ma=this.$.ea.Ba(ma);return!!ma&&rd.d(ma)})(198)?(new Mc.a,this.$.ea.Zc(198,ma=>{E(ma)})):E(null)}pek(){this.Tia=V.AFrameworkApplication.fa.Ta("DevAddinManifestFileUrl");this.K_b=V.AFrameworkApplication.fa.Ta("DevAddinManifestGuid");var E=V.AFrameworkApplication.fa.Ta("IsDevAddinTest");if(this.Tia&&this.K_b&&E){E="true"===E;var ma=this.OIa.getItem("optedIntoAddinDeveloperMode");const Ya=this.OIa.getItem(this.K_b);ma||E&&V.AFrameworkApplication.fa.qa("SuppressDeveloperAddinDialogs")?Ya||E&&V.AFrameworkApplication.fa.qa("SuppressDeveloperAddinDialogs")?
this.d5f():(E=new Ne.StandardDialog,E.Fd=4,ma=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Tia)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,E.bV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ma,this.e5f)):(E=new Aj(this.Tia,this.e5f),E.Fd=0,E.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}d5f(){const E=
Rb.GetServiceTaskFactory.create(this.$.ea,106,this.$.ka,1);fc.TaskExtensions.ya(E,()=>{E.result.Eg.validateAndCacheNewDevAddinManifest(this.Tia);this.OIa.setItem(this.K_b,"true")},this.$.ka,3)}}Object(N.a)(Xj,"AddinCommandsInitService",Jj,[864]);class vj extends Db.a{constructor(E){super();this.addinCommandsInitService=null;this.Qe=()=>{R.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.da.Zd}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.sf&
16384)}] `);this.addinCommandsInitService.gtg();this.$.da.Vl(this.Qe)};this.$=E;this.Md()}create(){this.$.ea.Zc(53,()=>{this.qd(Object(ic.a)(this.$.ea,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new Xj(this.$))));this.$.da.Zd?(R.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.sf&16384)}] `),this.addinCommandsInitService.gtg()):this.$.da.Pl(this.Qe)})}static la(E){E.ea.Ja(201,
new vj(E))}}Object(N.a)(vj,"AddinCommandsInitServiceFactory",Db.a,[]);var ik=a(284);class Yj{constructor(E){this.XSa=this.fId=this.aTa=this.Fuc=0;this.ZHd=this.HFf=null;E?(this.Ouc=E,this.Xyb=Date.now,this.dth(),this.byj()):R.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}$Sj(){this.HFf="Office.Excel.Online.Data.Activity.PenMinutes"}byj(){window.document.body.addEventListener("pointerenter",Object(ha.a)(this,this.kyc,"onPointerEnter"));window.document.body.addEventListener("pointerleave",
Object(ha.a)(this,this.Cga,"onPointerLeave"));qb.a.instance.Ed("Common.App.VisibilityManagement.IVisibilityManager").execute(E=>{E.SCe(Object(ha.a)(this,this.EEb,"handleVisibilityChange"))})}kyc(E){"pen"!==E.pointerType||this.aTa||(this.aTa=Math.floor(this.Xyb()/1E3),this.aTa<=this.Fuc&&(this.aTa=this.Fuc),this.fId=0)}Cga(){this.ylf()}ylf(){const E=Math.ceil(this.Xyb()/1E3);this.aTa&&E>this.Fuc&&(this.fId=E,this.XSa+=this.fId-this.aTa);this.Fuc=E;this.aTa=0}EEb(E,ma){0!==ma.newState&&this.ylf()}dth(){this.ZHd=
new Yh.a(4,2,6E4,Object(ha.a)(this,this.dUi,"logPenUsage"));this.Ouc.Ah(this.ZHd)}dUi(){0<this.XSa&&this.eeg(this.XSa);this.XSa=0}eeg(E){const ma=new ik.a;ma.name=this.HFf;const Ya=[];(E=sh.a.Mg("PenInputSec",E.toString(),3))&&Array.add(Ya,E);ma.dataFields=Ya;di.a.sendActivityEvent(ma)}dispose(){0<this.XSa&&this.eeg(this.XSa);this.Ouc.hr(this.ZHd)}}Object(N.a)(Yj,"PenMinutesManager",null,[903]);class Kj{constructor(){this.wZc=this.Rc=null}get name(){return"Common.App.PenMinutesManager"}Oj(E){this.Rc=
E;const ma=V.AFrameworkApplication.Lj;this.Rc.register(903,"Common.App.PenMinutesManager.IPenMinutesManager").se().Ae(()=>new Yj(ma))}init(){this.wZc=this.Rc.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.wZc&&this.wZc.dispose()}static main(){Wa.a.instance.Mk(new Kj)}}Object(N.a)(Kj,"PenMinutesManagerPackage",null,[3,4]);class Zj extends Db.a{constructor(E){super();this.$=E;this.Md()}static la(E){E.ea.Ja(514,new Zj(E))}create(){this.qd(Object(ic.a)(this.$.ea,513,()=>{Type.registerNamespace("Common.App.PenMinutesManager");
Kj.main();const E=qb.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");E.$Sj();return E}))}}Object(N.a)(Zj,"PenMinutesFactory",Db.a,[]);class wj{static d4h(E){try{return caches.open(wj.Wfe).then(ma=>ma.match(E))}catch(ma){return Promise.reject(null)}}static oza(E,ma){try{return wj.d4h(E).then(Ya=>Ya&&Number.parseInvariant(Ya.headers.get("cachedTime"))>Date.now()-ma?Promise.resolve(Ya.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(Ya){return Promise.reject(null)}}static store(E,
ma){try{return caches.open(wj.Wfe).then(Ya=>{Ya.put(E,ma).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(Ya){return Promise.resolve(!0)}}static D6j(E,ma){const Ya={};Ya.body=ma;const Ub={};Ub.cachedTime=Date.now().toString();Ya.headers=Ub;ma=new Response(ma,Ya);wj.store(E,ma).then(()=>!0)}}wj.Wfe="ConsentState";Object(N.a)(wj,"CacheManager",null,[]);class ak{constructor(){this.message=null;this.J8=0}}Object(N.a)(ak,"HttpRequstToPromiseRejectData",null,[]);class Lj{constructor(E){this.e0=
E}SY(E,ma,Ya,Ub,Hc,Gd){di.a.sendTelemetryEvent(Object.assign(new ai.a,{name:"Office.Online."+E,dataFields:[Object.assign(new vh.a,{name:"EventMessage",string:ma}),Object.assign(new vh.a,{name:"FormFactor",string:this.e0.formFactor}),Object.assign(new vh.a,{name:"CorrelationId",string:this.e0.correlationId}),Object.assign(new vh.a,{name:"AccountType",string:this.e0.accountType}),Object.assign(new vh.a,{name:"OSVersion",string:this.e0.osVersion}),Object.assign(new vh.a,{name:"AppId",string:this.e0.appId}),
Object.assign(new vh.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new vh.a,{name:"ConsentLanguage",string:this.e0.consentLanguage}),Object.assign(new vh.a,{name:"EventCode",string:Ya}),Object.assign(new vh.a,{name:"Region",string:this.e0.region}),Object.assign(new vh.a,{name:"ModelType",string:Ub}),Object.assign(new vh.a,{name:"ModelId",string:Hc}),Object.assign(new vh.a,{name:"Platform",string:this.e0.os}),Object.assign(new vh.a,{name:"ReConsentReason",string:""}),Object.assign(new vh.a,
{name:"ConsentType",string:Gd})]}))}}Object(N.a)(Lj,"TelemetryLogger",null,[]);var ok=a(219);class bk{constructor(E,ma,Ya){this.DHg="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Pa=E;this.Ei=ma;this.Wva=Ya;this.mS=new Lj(Ya)}OMa(E,ma){return new Promise((Ya,Ub)=>{const Hc=this.Pa.Af("UCNoticeCheckinCallTimeoutMs",5E3);let Gd=this.Pa.Ta("UCNoticeCheckinStateUrl");Gd&&Gd.length||(Gd=this.DHg);this.Ei.r6(Gd,1,null,this.iDb(E),null,!1,0,he=>{try{if(void 0===he||null===he||void 0===
he.data||null===he.data||void 0===he.data.Lf||null===he.data.Lf){this.mS.SY("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);let af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Ub(this.pK(af,he))}else if(he.data.httpStatus!==ok.a.zE){this.mS.SY("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",he.data.httpStatus.toString(),
null,null,null);let af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",he.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Ub(this.pK(af,he))}else{var Ke=ma(he.data.Lf);if(Ke)Ya(Ke);else{this.mS.SY("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);let af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Ub(this.pK(af,he))}}}catch(af){this.mS.SY("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",af,"UnifiedConsent.ConsentGetFailed"),Ub(this.pK(Ke,he))}},he=>{this.mS.SY("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",he.data.httpStatus.toString(),null,null,null);const Ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
he.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Ub(this.pK(Ke,he))},null,void 0,void 0,2500,Hc)})}pK(E,ma){const Ya=new ak;Ya.message=E;Ya.J8=ma&&ma.data?ma.data.httpStatus:-1;return Ya}iDb(E){const ma={};ma["Accept-Language"]=this.Wva.consentLanguage;ma.consentsurface="AppStart";ma.platform="Web";ma.formfactor=pb.a.J2?"Mobile":"Desktop";ma["x-Cid"]=this.Wva.correlationId;ma.Authorization="Bearer "+E;return ma}}Object(N.a)(bk,"HttpRequestToPromiseUtility",null,[]);class jk{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(N.a)(jk,"WebSdkAdapterProps",null,[]);class si{constructor(E,ma,Ya,Ub){this.rle=this.Nia=this.N5=this.Z_=null;this.ZZa=Ub;this.Pa=E;this.$Fg=Ya;this.Ei=ma;this.Wva=this.getDimensions();this.mS=new Lj(this.Wva)}Hkg(){"MSA"===
(this.Pa.Ta("HostAuthType")||"").toUpperCase()&&wj.oza(this.Wva.userId,this.Pa.Af("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.mS.SY(si.IIa,"CacheFound","701",this.Z_,this.N5,this.Nia);return{}}).catch(()=>{this.$Fg.execute(E=>{E.rE("Consent",si.NRg).then(ma=>{ma.IsSuccess?(this.mS.SY(si.IIa,"CheckInTokenSuccess","702",this.Z_,this.N5,this.Nia),this.I5h(ma.Token).then(Ya=>{this.Qbi(Ya);this.Z_&&""!==this.Z_&&E.rE("Consent",si.PRg).then(Ub=>{Ub.IsSuccess?(this.mS.SY(si.IIa,"WebTokenSuccess",
"703",this.Z_,this.N5,this.Nia),this.o1j(Ub,this.Z_)):this.mS.SY(si.IIa,"WebTokenFailed : "+Ub.ErrorMessage,Ub.ErrorCode,this.Z_,this.N5,this.Nia);return{}});return{}})):this.mS.SY(si.IIa,"CheckInTokenFailed : "+ma.ErrorMessage,ma.ErrorCode,this.Z_,this.N5,this.Nia);return{}})})})}I5h(E){this.rle=new bk(this.Pa,this.Ei,this.Wva);return this.rle.OMa(E,Object(ha.a)(this,this.fkj,"parseConsentCheckinState")).then(ma=>Promise.resolve(ma),ma=>Promise.reject("Error while getting result"+ma))}fkj(E){if(void 0===
E||null===E)return this.mS.SY(si.IIa,"Checkin response undefined or null","705",this.Z_,this.N5,this.Nia),null;try{let ma;({zu:ma}=Sb.d(E));return ma}catch(ma){this.mS.SY(si.IIa,"Checkin response parse error : "+ma.message,"706",this.Z_,this.N5,this.Nia)}return null}Qbi(E){for(const ma of E.consentValues)if(ma.needConsent&&!ma.maxPromptsReached){this.N5=ma.id;this.Nia=ma.consentType;this.Z_=ma.modelType;return}wj.D6j(this.Wva.userId,Sb.c(E))}o1j(E,ma){if(ya.a("showConsentNotice")){const Ya=document.createElement("div");
document.body.appendChild(Ya);appChrome.api.showConsentNotice(this.n7h(E.Token,ma),Ya)}else this.mS.SY(si.FMg,"1JS : ShowConsentNotice API not found","704",this.Z_,this.N5,this.Nia)}n7h(E,ma){const Ya=this.Wva;Ya.token=E;Ya.modelType=ma;return Ya}getDimensions(){const E=this.Bxd(this.Pa.Ta("SessionStartInfoJson"));return Object.assign(new jk,{emailId:this.Pa.Ta("UserPrincipalName"),userId:this.Pa.Ta("LoggableUserId"),accountType:"AAD"===(this.Pa.Ta("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Pa.Ta("OfficeApplicationId"),
appVersion:this.Pa.Ta("appVersion"),appName:"Application"in E?E.Application:"",appEnv:this.ZZa,consentLanguage:this.Pa.Ta("UICulture")||"en-US",formFactor:pb.a.J2?"Mobile":"Desktop",os:"Os"in E?E.Os:"",osVersion:"OsVersion"in E?E.OsVersion:"",region:this.Pa.Ta("region"),correlationId:Of.a.create().toString(),isDarkMode:this.Pa.qa("DarkModeIsOn"),useCache:!0})}Bxd(E){let ma={};try{ma=Sb.b(E)}catch(Ya){}return ma}}si.PRg="https://consentservice.microsoft.com/web";si.NRg="https://consentservice.microsoft.com/checkin";
si.FMg="UnifiedConsent.ConsentGetFailed";si.IIa="UnifiedConsent.AuthTokenStatus";Object(N.a)(si,"ConsentNoticeManager",null,[901]);class ck{constructor(){this.Rc=null}get name(){return"Common.App.ConsentNoticeDialog"}Oj(E){this.Rc=E;E.register(si,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").se().Ae(()=>new si(V.AFrameworkApplication.fa,V.AFrameworkApplication.mf,E.Ed("Common.App.OAuth.IOAuthManager"),V.AFrameworkApplication.SNa))}init(){this.Rc.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Wa.a.instance.Mk(new ck)}}
Object(N.a)(ck,"ConsentNoticeDialogPackage",null,[3,4]);let Mj=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");ck.main();qb.a.instance.Ed("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(E=>E.Hkg())}};Mj=Object(Hd.a)([Object(Gb.d)(fd.Kc)],Mj);Object(N.a)(Mj,"UnifiedConsentAdapter",null,[]);let Nj=class{constructor(E){this.bMf=()=>{this.hZa(this.$.da.TYa,this.$.da.Ygb);this.Pik()};this.$=E;this.shortcutKeyManager=this.$.shortcutKeyManager;this.isMac=pb.a.isMac;
this.shortcutKeyManager.SYg(this.bMf)}dispose(){this.shortcutKeyManager.WAj(this.bMf);this.$=null}KRj(){const E=this.zkh.concat(this.FZi).map(ma=>appChrome.actions.setControlCustomTooltip(ma.commandId,this.I9a(ma)));appChrome.api.dispatch(E)}hZa(E,ma){this.jfk&&(this.PO[0].title=this.PO[2].title=this.Aae(E),this.PO[1].title=this.Mwg(ma),this.PO[1].shortcut=this.isMac?this.shortcutKeyManager.Tm(192):this.shortcutKeyManager.Tm(154));E=this.I9a(this.PO[1]);ma=this.I9a(this.PO[2]);E=[appChrome.actions.setControlCustomTooltip(this.PO[0].commandId,
this.I9a(this.PO[0])),appChrome.actions.setControlCustomTooltip(this.PO[1].commandId,E),appChrome.actions.setControlCustomTooltip(this.PO[2].commandId,ma)];appChrome.api.dispatch(E)}bTi(E,ma){this.XKi(E)&&tg.b(ma)}XKi(E){return-1502853784===E||-111689794===E||-287251124===E||-1925065947===E||1764140053===E||-1590502662===E||-600086683===E||963349338===E||862890474===E||1220954656===E||1891435765===E||1896159024===E||-1554384558===E||-1985798686===E||-911352779===E||237279923===E||996232352===E?!0:
!1}get FZi(){this.rJ||(this.rJ=[],this.rJ.push(this.hk("Paste_MLR",de.a.instance.Ia(513),de.a.instance.Ia(767),this.shortcutKeyManager.Tm(176))),this.rJ.push(this.hk("Cut",de.a.instance.Ia(511),de.a.instance.Ia(768),this.shortcutKeyManager.Tm(172))),this.rJ.push(this.hk("Copy",de.a.instance.Ia(512),de.a.instance.Ia(769),this.shortcutKeyManager.Tm(174))),this.rJ.push(this.hk("AlignTop_MLR",de.a.instance.Ia(791),de.a.instance.Ia(792))),this.rJ.push(this.hk("AlignMiddle_MLR",de.a.instance.Ia(793),de.a.instance.Ia(794))),
this.rJ.push(this.hk("AlignBottom_MLR",de.a.instance.Ia(795),de.a.instance.Ia(796))),this.rJ.push(this.hk("AlignLeft_MLR",de.a.instance.Ia(797),de.a.instance.Ia(799))),this.rJ.push(this.hk("AlignCenter_MLR",de.a.instance.Ia(800),de.a.instance.Ia(801))),this.rJ.push(this.hk("AlignRight_MLR",de.a.instance.Ia(802),de.a.instance.Ia(803))),this.rJ.push(this.hk("IncreaseIndent",de.a.instance.Ia(804),de.a.instance.Ia(805))),this.rJ.push(this.hk("DecreaseIndent",de.a.instance.Ia(806),de.a.instance.Ia(807))),
this.rJ.push(this.hk("Wrap",de.a.instance.Ia(808),de.a.instance.Ia(809))),this.rJ.push(this.hk("Merge",de.a.instance.Ia(810),de.a.instance.Ia(811))),this.rJ.push(this.hk("NumberFormatPercentage_MLR",de.a.instance.ia(453),de.a.instance.Ia(814),this.shortcutKeyManager.Tm(404))),this.rJ.push(this.hk("NumberFormatComma_MLR",de.a.instance.Ia(815),de.a.instance.Ia(816))));return this.rJ}get zkh(){this.rq||(this.rq=[],this.rq.push(this.hk("UndoRedo",de.a.instance.Ia(83),"",this.isMac?this.shortcutKeyManager.Tm(191):
this.shortcutKeyManager.Tm(153))),this.rq.push(this.hk("FormatPainter",de.a.instance.ia(14),de.a.instance.Ia(770))),this.rq.push(this.hk("FontName_New",de.a.instance.Ia(771),de.a.instance.Ia(772))),this.rq.push(this.hk("FontSize",de.a.instance.Ia(773),de.a.instance.Ia(774))),this.rq.push(this.hk("Bold",de.a.instance.ia(1333),de.a.instance.Ia(775),this.isMac?this.shortcutKeyManager.Tm(180):this.shortcutKeyManager.Tm(179))),this.rq.push(this.hk("Italic",de.a.instance.ia(1334),de.a.instance.Ia(776),
this.isMac?this.shortcutKeyManager.Tm(184):this.shortcutKeyManager.Tm(183))),this.rq.push(this.hk("BordersSplitButtonCompactMenu",de.a.instance.Ia(777),de.a.instance.Ia(779),this.isMac?this.shortcutKeyManager.Tm(190):this.shortcutKeyManager.Tm(189))),this.rq.push(this.hk("FillColor",de.a.instance.ia(537),de.a.instance.Ia(780))),this.rq.push(this.hk("FontColor",de.a.instance.Ia(781),de.a.instance.Ia(782))),this.rq.push(this.hk("GrowFontSize",de.a.instance.Ia(783),de.a.instance.Ia(784),this.shortcutKeyManager.Tm(187))),
this.rq.push(this.hk("ShrinkFontSize",de.a.instance.Ia(785),de.a.instance.Ia(786),this.shortcutKeyManager.Tm(188))),this.rq.push(this.hk("Underline",de.a.instance.ia(1335),de.a.instance.Ia(787),this.isMac?this.shortcutKeyManager.Tm(182):this.shortcutKeyManager.Tm(181))),this.rq.push(this.hk("Strikethrough",de.a.instance.ia(1336),de.a.instance.Ia(788),this.isMac?this.shortcutKeyManager.Tm(186):this.shortcutKeyManager.Tm(185))),this.rq.push(this.hk("DoubleUnderline",de.a.instance.Ia(789),de.a.instance.Ia(790))),
this.rq.push(this.hk("NumberFormatNew",de.a.instance.Ia(812),de.a.instance.Ia(813))),this.rq.push(this.hk("NumberFormatAccountingNew",de.a.instance.ia(449),de.a.instance.Ia(817))),this.rq.push(this.hk("IncreaseDecimal",de.a.instance.Ia(818),de.a.instance.Ia(819))),this.rq.push(this.hk("DecreaseDecimal",de.a.instance.Ia(820),de.a.instance.Ia(821))),this.rq.push(this.hk("ConditionalFormatting",de.a.instance.Ia(822),de.a.instance.Ia(823))),this.rq.push(this.hk("CellStylesGallery",de.a.instance.Ia(824),
de.a.instance.Ia(825))),this.rq.push(this.hk("FormatAsTableAlt",de.a.instance.Ia(826),de.a.instance.Ia(827))),this.rq.push(this.hk("Format",de.a.instance.Ia(828),de.a.instance.Ia(829))),this.rq.push(this.hk("AutoSum",de.a.instance.Ia(830),de.a.instance.Ia(831),this.shortcutKeyManager.Tm(259))),this.rq.push(this.hk("SortAndFilter",de.a.instance.Ia(832),de.a.instance.Ia(833))),this.rq.push(this.hk("FindAndSelect",de.a.instance.Ia(834),de.a.instance.Ia(835),this.shortcutKeyManager.Tm(85))),this.rq.push(this.hk("AnalyzeData",
de.a.instance.Ia(836),de.a.instance.Ia(837))),this.rq.push(this.hk("Sensitivity",de.a.instance.Ia(838),de.a.instance.Ia(839))),this.rq.push(this.hk("InsertCells",de.a.instance.ia(345),de.a.instance.Ia(840),this.shortcutKeyManager.y$?this.shortcutKeyManager.Tm(409):"")),this.rq.push(this.hk("DeleteCells",de.a.instance.ia(409),de.a.instance.Ia(841),this.shortcutKeyManager.y$?this.shortcutKeyManager.Tm(407):"")),this.rq.push(this.hk("ClearCells",de.a.instance.Ia(842),de.a.instance.Ia(843))));return this.rq}get jfk(){this.PO||
(this.PO=[],this.PO.push(this.hk("Undo",this.Aae(2),de.a.instance.Ia(765),this.isMac?this.shortcutKeyManager.Tm(191):this.shortcutKeyManager.Tm(153))),this.PO.push(this.hk("Redo",this.Mwg(2),de.a.instance.Ia(766),this.isMac?this.shortcutKeyManager.Tm(192):this.shortcutKeyManager.Tm(154))),this.PO.push(this.hk("UndoRedo",this.Aae(2),"",this.isMac?this.shortcutKeyManager.Tm(191):this.shortcutKeyManager.Tm(153))));return this.PO}hk(E,ma,Ya,Ub){return{commandId:E,title:ma,description:Ya,shortcut:Ub,rri:Ub?
!0:!1}}I9a(E){let ma;ma=E.title;E.rri&&(ma+=" "+E.shortcut);"UndoRedo"!==E.commandId&&(ma+="\n\n"+E.description);return ma}Aae(E){switch(E){case 1:case 0:return E=de.a.instance.Ia(81);case 3:return E=de.a.instance.Ia(84);case 2:return E=de.a.instance.Ia(83);case 4:return E=de.a.instance.Ia(82);default:return E=de.a.instance.Ia(81)}}Mwg(E){switch(E){case 1:case 0:return E=de.a.instance.Ia(78);case 2:return E=de.a.instance.Ia(80);case 4:return E=de.a.instance.Ia(79);default:return E=de.a.instance.Ia(78)}}Pik(){var E=
this.hk("InsertCells",de.a.instance.ia(345),de.a.instance.Ia(840),this.shortcutKeyManager.y$?this.shortcutKeyManager.Tm(409):"");const ma=this.hk("DeleteCells",de.a.instance.ia(409),de.a.instance.Ia(841),this.shortcutKeyManager.y$?this.shortcutKeyManager.Tm(407):"");E=[appChrome.actions.setControlCustomTooltip(E.commandId,this.I9a(E)),appChrome.actions.setControlCustomTooltip(ma.commandId,this.I9a(ma))];appChrome.api.dispatch(E)}};Nj=Object(Hd.a)([Object(Gb.d)(fd.V),Object(Hd.b)(0,Object(fd.R)())],
Nj);Object(N.a)(Nj,"ExtendedTooltipsManager",null,[5]);class kk{constructor(){this.startTime=Nd.a.$a.Wd;this.Vz=new yg.a}Kcf(){return wc.a(Nd.a.$a,this.startTime)}}Object(N.a)(kk,"OngoingAction",null,[]);class lk extends Va.a{constructor(E,ma,Ya,Ub,Hc){Hc=void 0===Hc?null:Hc;super();this.iUa=this.uub=null;this.z9c=0;this.Xyc=null;this.qej=()=>{const Gd=this.iUa.Kcf();R.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.ypa}>.OnRunningLong: Operation running for more than ${Gd}ms`);this.Xyc=
Ob.a.instance.create(this.t$,Math.max(this.rKe-Gd,0),Ib.a.Sye)};this.t$=()=>{R.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.ypa}>.OnTimeout: Operation running for more than ${this.iUa.Kcf()}ms, timing out. Has pending actions: ${this.aab}`);this.z9c++;this.z9c>this.qKe&&R.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.ypa}>.OnTimeout: passed the allowed bypassed count`);this.iUa.Vz.cancel();this.V7e()};this.hC=()=>{this.aab&&R.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.ypa}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.WQa}, AggregatedActionParams not null: ${this.aab}`);
this.uyd()};this.YTg=E;this.ZTg=ma;this.documentVisibilityObserver=Ya;this.ypa=Ub;this.iO=Hc;Ya&&this.documentVisibilityObserver.vW(this.hC);this.y9c=!!Ya&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.qKe=Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ma=Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.rKe=E.U$e(ma);E=
Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.Tbh=Math.max(this.rKe-ma,0)+E}get WQa(){return!!this.iUa}get aab(){return!!this.uub}qYf(E){R.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.ypa}>.PerformThrottledAction: Start. IsActionOngoing: ${this.WQa}, AggregatedActionParams not null: ${this.aab}`);this.uub=this.ZTg.bEe(E,this.uub);this.uyd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.hEa(this.hC);
this.$Le();super.dispose()}Ugg(E){this.y9c?(this.iUa=E?new kk:null,E?this.startTimer():this.$Le()):this.iUa=E?{}:null}V7e(E){E=void 0===E?null:E;this.y9c&&E&&E.XP?R.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.ypa}>.FinishedCallback: timedout, skipping`):(R.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.ypa}>.FinishedCallback: Start. IsActionOngoing: ${this.WQa}, AggregatedActionParams not null: ${this.aab}`),this.Ugg(!1),this.uyd())}uyd(){if(!this.HUb()){var E=this.uub;this.uub=
null;this.Ugg(!0);R.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.ypa}>.InternalPerformAction: Calling PerformAction.`);var ma=this.y9c?this.iUa.Vz.token:xd.a.none;fc.TaskExtensions.ya(this.YTg.mYf(E),()=>{this.V7e(ma)},ma,0,this.iO)}}HUb(){return!this.aab||this.WQa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ui?(R.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.ypa}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}$Le(){this.Xyc&&
this.Xyc.cancel()}startTimer(){this.z9c<=this.qKe&&(this.Xyc=Ob.a.instance.create(this.qej,this.Tbh,Ib.a.Sye))}}Object(N.a)(lk,"ActionAggregator",Va.a,[840,5]);class xj extends ta.a{constructor(E){super();this.Yy=this.firstElement=null;this.rRa=!1;this.gv=null;this.bXj=pb.a.hh;this.NQf=ma=>{const Ya=ma.Ca.keyCode;return Ya===ag.a.Yj?this.S7i():Ya===ag.a.gB&&ma.Ca.shiftKey?this.fTh(this.firstElement):!1};this.mWf=ma=>{if(!this.rRa||ma.Ca.keyCode!==ag.a.KL)return!1;xj.Nnf();Ba.Task.delay(1).Nr(()=>
{this.Yy.focus();return!0},0,this.ka);return!0};this.Ehj=()=>{document.activeElement&&document.activeElement.id===this.Yy.id||(xj.Nnf(),Ba.Task.delay(1).Nr(()=>{this.Yy.focus();return!0},0,this.ka))};this.MOf=()=>{this.fsg(this.Yy)};this.MQf=ma=>{ma.stopPropagation();ma.preventDefault();this.rRa&&(this.rRa=!1)};this.$=E;(E=this.$.da.ae)&&R.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${E.qxa}; InWebPart = '${E.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${E.inEmbedView?
"True (+Modern)":"False (not Modern)"}'`);E&&(E.inWebPart||E.inEmbedView)?R.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${E.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${E.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Yqh(),this.Vrh(),Ld.KeyInputManager.instance.ta(uc.a.Rd,this.$.domElement,this.mWf));this.$.ea.Ja(238,this)}y_g(E){this.addHandler("KBIS",
E)}nCj(E){this.removeHandler("KBIS",E)}dispose(){this.firstElement&&tf.a.removeHandler(this.firstElement,uc.a.focus,this.MOf);this.gv&&this.gv.detach("focus");this.Yy&&(tf.a.removeHandler(this.Yy,uc.a.focus,this.MQf),tf.a.removeHandler(this.Yy,uc.a.blur,xj.onBlur),Ld.KeyInputManager.instance.Aa(uc.a.Rd,this.Yy,this.NQf));Ld.KeyInputManager.instance.Aa(uc.a.Rd,this.$.domElement,this.mWf);this.gv=this.Yy=this.firstElement=this.$=null;super.dispose()}Yqh(){this.bXj?(this.firstElement=document.documentElement,
this.gv=Oa.a.instance.XJ(document.parentWindow),this.gv.la("focus",this.Ehj)):(this.firstElement=xj.fTe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),tf.a.addHandler(this.firstElement,uc.a.focus,this.MOf))}Vrh(){this.Yy=xj.fTe();this.Yy.id=ie.a.G_e;this.Yy.setAttribute(ie.a.Aw,de.a.instance.ia(863));document.body.appendChild(this.Yy);tf.a.addHandler(this.Yy,uc.a.focus,this.MQf);tf.a.addHandler(this.Yy,uc.a.blur,xj.onBlur);Ld.KeyInputManager.instance.ta(uc.a.Rd,this.Yy,
this.NQf)}fTh(E){this.fsg(E);return!1}S7i(){this.rRa=!0;ub.h(this.$).focus();ub.h(this.$).ha.Wkf();this.raiseEvent("KBIS");return!0}fsg(E){this.rRa?this.rRa=!1:(this.rRa=!0,E&&E.focus())}static fTe(){const E=document.createElement("div");E.tabIndex=0;return E}static Nnf(){document.body.classList.add(bd.a.$1e)}static onBlur(){document.body.classList.remove(bd.a.$1e)}}Object(N.a)(xj,"EmbedViewFocusControl",ta.a,[839,5]);var Dg=a(69),Oj=a(534),M=a(126);class Ca extends ta.a{constructor(E,ma){super();
this.WRb=this.Wpd=this.XCb=this.aS=null;this.d2b=!1;this.Dhe=null;this.Boa=this.VSd=!1;this.w9i=(Ya,Ub,Hc)=>{R.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Hc);this.WRb&&this.WRb.stop();this.aS=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.x9i=Ya=>{Ch.a(Ya)||(this.WRb&&this.WRb.stop(),this.d2b=!1,(this.aS=Ya.Result)&&0<this.aS.length&&R.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.aS.length} rich value field list context for autocomplete`),
this.u0a=!0,this.gBc())};this.u0a=!1;this.dd=E;this.F0b=-1;this.tableManager=ma;this.VSd=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.Boa=Ga.EwaSettings.Boa()}g5c(E){this.addHandler("FieldInfoListContextLoaded",E)}UVd(E){this.removeHandler("FieldInfoListContextLoaded",E)}WZg(E){this.addHandler("GetFieldInfoListContextOperationFailed",E)}TBj(E){this.removeHandler("GetFieldInfoListContextOperationFailed",E)}get qAd(){return this.u0a}get HRi(){return this.d2b}get R9e(){return this.F0b}get pfd(){return this.Dhe}get $(){return this.dd}get ir(){return this.aS}get C8h(){return!!this.XCb}dispose(){this.dd=
null;this.PDc();super.dispose()}c9a(E,ma,Ya,Ub){Ub=void 0===Ub?null:Ub;if(E){this.e$c();this.Q$b();var Hc=null,Gd=!1;if(!Ub&&(()=>{let he=this.Odk(E,ma,Ya);({wfb:Gd,ir:Hc}=he);return he})().returnValue)if(this.VSd||this.Tfg(Hc),this.d2b=!0,this.aS=Hc,this.VSd){if(!Gd){this.u0a=!0;this.gBc();return}}else if(this.aS&&0<this.aS.length&&(this.u0a=!0,this.gBc()),!Gd)return;this.iwg(E,Ub,ma,Ya,!1)}}iwg(E,ma,Ya,Ub,Hc){if(this.$.da.Zd){this.$.Jd&&(this.WRb=this.$.Jd.Le("WebServiceCall","GetRichValueFieldInfoListContext"));
this.XCb=null;var Gd=this.$.pa.ua.Ud(),he=this.$.pa.ua,Ke=this.x9i,af=this.w9i;const xf=he.Ra(1,null);xf.selectedRange=E;xf.richValueKeyPath=ma;xf.singleColumn=Ya;xf.searchForRange=Ub;xf.calculateMajorityDataType=Hc;this.XCb=Yc.g(he,"GetRichValueFieldListContextList",xf,Ke,af,null,Gd,4)}else this.aS=null}PDc(){this.aS=null;this.u0a=!1;this.e$c();this.Q$b();this.XCb=null;this.F0b=-1}e$c(){Ca.zwb(this.XCb)}Q$b(){Ca.zwb(this.Wpd)}gBc(){this.raiseEvent("FieldInfoListContextLoaded")}Vt(E){E=Md.E(E);--E.left;
--E.right;return this.tableManager.Vt(E)}jPa(E){E.FirstColumn=E.FirstColumn;E.LastColumn=E.LastColumn;E.FirstRow=E.FirstRow;E.LastRow=E.LastRow;this.Q$b();this.Wpd=null;return Gh.a(this.$.userOperationManager,(ma,Ya,Ub)=>Sh.k(this.$.pa.ua,E,te.b(ma,Hc=>{this.G9i(Hc)}),te.a(Ya,Ya,Hc=>{this.F9i(Hc)}),Ub,null),ma=>new Eh.a(264,0,ma,80),null)}F9i(E){E=M.a.Bg(E.data);R.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${$g.a.me(E)}`)}G9i(E){if(Ch.a(E))-315732528!==
E.Errors[0].MessageId&&R.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${$g.a.me(E.Errors)}`);else if(E&&E.Result){E=E.Result;var ma=E.HasHeaderRow;ma=new Oj.AutofilterRange(E.TableRange.FirstRow+(ma?1:0)+1,E.TableRange.FirstColumn+1,E.TableRange.LastRow+1,E.TableRange.LastColumn+1,null,null,null,0,ma);this.F0b=E.TableRange.FirstColumn;(E=this.C0f(!1,!0,ma))||R.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");
this.Tfg(E)}else R.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}Odk(E,ma,Ya){let Ub,Hc;Hc=null;Ub=!1;if(E.SheetName!==this.$.da.na.sheetName)return{returnValue:!1,wfb:Ub,jPa:!1,ir:Hc};let Gd;this.F0b=-1;if(Ya){Gd=this.Vt(E);if(!Gd||!Gd.$na)return{returnValue:!1,wfb:Ub,jPa:!1,ir:Hc};var he=this.Boa?(he=ub.h(this.$).ed.jhf(Gd))&&0<he.size:(he=ub.h(this.$).ed.khf(Gd))&&0<he.count;this.Dhe=Gd;if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&
he)return--E.FirstColumn,--E.LastColumn,this.Wpd=this.jPa(E),{returnValue:!0,wfb:Ub,jPa:!0,ir:Hc};Gd.top+=1;Gd.right=Md.E(E).right-1}else Gd=new Oj.AutofilterRange(E.FirstRow+1,E.FirstColumn+1,E.LastRow+1,E.LastColumn+1,null,null,null,0,!1);if(Gd.top>Gd.bottom||Gd.left>Gd.right)return{returnValue:!0,wfb:Ub,jPa:!1,ir:Hc};E=ub.h(this.$);var Ke=E.Tc.width,af=E.Tc.height;he=E.view.visibleArea;Ke=new Dg.a(he.x-Ke,he.y-af,he.width+Ke,he.height+af);af=E.Bi(Gd);if(!he||!af||!E.trc(Gd))return{returnValue:!1,
wfb:Ub,jPa:!1,ir:Hc};Ke.contains(af)||(Ub=!0);Hc=this.C0f(ma,Ya,Gd);return{returnValue:!0,wfb:Ub,jPa:!1,ir:Hc}}Tfg(E){E&&R.ULS.sendTraceTag(25264348,0,50,`Retrieved ${E.length} rich value field contexts from block cache`);this.d2b=!0;(this.aS=E)&&0<this.aS.length&&(this.u0a=!0,this.gBc())}C0f(E,ma,Ya){let Ub;Ub=null;const Hc=Ya.clone();if(ma)for(let Gd=Ya.right,he=0;Gd>=Ya.left;--Gd){if(Hc.left=Gd,Hc.right=Gd,ma=this.Zcf(Hc,!0,Ya.left)){Ub||(Ub=[]);Ub[he]=ma;if(E)break;++he}}else if(E=this.Zcf(Hc,
!1))Ub=[],Ub[0]=E;return Ub}Zcf(E,ma,Ya){Ya=void 0===Ya?0:Ya;var Ub=null;let Hc=[];if(this.Boa){var Gd=ub.h(this.$).ed.jhf(E);if(!Gd||0>=Gd.size)return Ub;Hc=Array(Gd.size);let Ke=0;Gd.forEach(af=>{let xf={};xf.Name=af.Value;xf.RefersToDotFunction=af.RefersToDotFunction;Hc[Ke]=xf;++Ke})}else{var he=ub.h(this.$).ed.khf(E);if(!he||0>=he.count)return Ub;Hc=Array(he.count);Ub=0;for(Gd of he.values)he={},he.Name=Gd,Hc[Ub]=he,++Ub}Gd="";he=-1;0<E.top&&ma&&(E=new Qf.Range(E.top-1,E.left,E.top-1,E.left,!1,
!1),null!=ub.h(this.$).yd(E)&&null!=ub.h(this.$).yd(E).originalText&&(Gd=ub.h(this.$).yd(E).originalText),he=E.left-Ya);Ub={};Ub.ColumnName=Gd;Ub.ColumnIndex=he;Ub.FieldInfoDataList=Hc;return Ub}static zwb(E){E&&V.AFrameworkApplication.mf.nx(E.Bw)}}Object(N.a)(Ca,"FieldInfoManager",ta.a,[315,5]);class xb extends Ca{constructor(E,ma,Ya,Ub){super(E,ma);this.f7a=null;this.GOf=()=>{this.UVd(this.GOf);if(this.ir&&this.ir.length&&this.contextMenuManager){var Hc=this.contextMenuManager.fpd("autoFilterRichFieldList"),
Gd=window.document.getElementById(this.f7a);Hc.s4(null,Gd,this,null,!0)}};this.cGg=Ya;this.contextMenuManager=Ub}get MJ(){return this.cGg}O8h(E,ma){this.f7a=ma;R.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${E.FirstRow}, ${E.FirstColumn}, ${E.LastRow}, ${E.LastColumn})`);this.iwg(E,null,!0,!1,!0)}}Object(N.a)(xb,"FilterInfoManager",Ca,[361,315,5]);var hc=a(970),Qc=a(1133);class ud{}ud.dNh=
"ewa-sharedUi-launchButton";ud.gNh="ewa-sharedUi-launchButtonWithText";ud.eNh="ewa-sharedUi-launchButtonClick";ud.hNh="ewa-sharedUi-launchButtonWithTextClick";ud.fNh="ewa-sharedUi-launchButtonText";Object(N.a)(ud,"CssClassNames",null,[]);a(528);var Id=a(299),Pd=a(77),xe=a(265);class Fe extends dc.a{constructor(E,ma,Ya,Ub,Hc,Gd,he,Ke,af){super(document.createElement("div"));this.AAf=null;this.V4d=!1;this.Od=this.nWb=this.MXa=null;this.BQ=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.AQ=()=>
{this.raiseEvent("OnObjectButtonMouseOut")};this.G2j=()=>{this.dze()};this.We=xf=>{this.raiseEvent(this.bPb,xf);this.Qfb();return!0};this.x7i=xf=>{100<wc.a(Nd.a.$a,this.AAf)&&this.zud(new Sys.UI.Point(Math.round(xf.clientX),Math.round(xf.clientY)))};this.xQ=xf=>{Pd.g(xf.Ca,!1);return!1};this.r1=this.lg.MMa();this.set_visible(!1);this.Yrc=Hc;this.bPb=Gd;this.hwc=E;this.Sac=ma;this.Od=af;this.Yrc&&(this.MXa=Ob.a.instance.create(this.G2j,3E4,"OnObjectButton.ShyTimerFired",!1,!1));E&&this.domElement.classList.add(E);
this.$vb=document.createElement("div");this.domElement.appendChild(this.$vb);Ya&&this.$vb.classList.add(Ya);this.z$d(Ub);he&&(this.nWb=document.createElement("div"),this.domElement.appendChild(this.nWb),this.nWb.classList.add(Ke),this.nWb.innerText=he,this.domElement.style.padding="3px",od.a.instance.ta(uc.a.pointerDown,this.domElement,this.xQ));this.u4a=new Id.a(this.domElement,7);ue.a.instance.ta(uc.a.click,this.domElement,this.We);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
od.a.instance.ta(uc.a.pointerDown,this.domElement,this.xQ);E=xf=>{Pd.g(xf)};this.Me.la("mouseup",E);this.Me.la("click",E);this.Me.la("dblclick",E)}z0(E){this.addHandler(this.bPb,E)}aaa(E){this.get_events().removeHandler(this.bPb,E)}S_g(E){this.addHandler("OnObjectButtonMouseOver",E)}FCj(E){this.get_events().removeHandler("OnObjectButtonMouseOver",E)}R_g(E){this.addHandler("OnObjectButtonMouseOut",E)}ECj(E){this.get_events().removeHandler("OnObjectButtonMouseOut",E)}z$d(E){E&&this.Od.Ij(this.$vb,E)}ihk(E,
ma,Ya){var Ub=16,Hc=16;Ub=void 0===Ub?0:Ub;Hc=void 0===Hc?0:Hc;this.Od.kH(this.$vb);E?E.kfa(ma,16,16,this.$vb,Ub,Hc,void 0,Ya):R.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}jhk(E,ma){E&&(this.nWb.innerText=E);this.domElement.title=ma}dispose(){this.get_isInitialized()&&(this.hide(),this.Me.zH(),Xd.a.te([this.r1,this.u4a]),ue.a.instance.Aa(uc.a.click,this.domElement,this.We),od.a.instance.Aa(uc.a.pointerDown,this.domElement,this.xQ),this.MXa&&
this.MXa.dispose(),super.dispose())}GRb(){this.Sac&&this.domElement.classList.remove(this.Sac);this.hwc&&this.domElement.classList.add(this.hwc)}Qfb(){this.hwc&&this.domElement.classList.remove(this.hwc);this.Sac&&this.domElement.classList.add(this.Sac);this.u7a()}u7a(){this.Yrc&&(this.MXa.cancel(),this.fog(),this.setOpacity(1));this.set_visible(!0)}Mo(E,ma,Ya,Ub,Hc){Hc=void 0===Hc?!1:Hc;E=Hg.a(Ub).Cj(E);ma=Hg.a(Ub).Cj(ma);Hg.a(Ub).AGc(this.domElement);this.domElement.style.top=ce.HelperMethods.De(ma);
this.domElement.style.left=this.domElement.style.right="";ma=E;Hc&&(ma=E-this.domElement.offsetWidth);xe.c(this.domElement.style,Ya,ce.HelperMethods.De(ma));this.set_visible(!0);this.setOpacity(1);this.Yrc&&(this.V4d=!1,this.z5j(),this.MXa.ps())}hide(){this.GRb();this.set_visible(!1);this.Yrc&&(this.fog(),this.MXa.cancel())}Jid(){this.Me.la("mouseover",this.BQ,!0);this.Me.la("mouseout",this.AQ,!0)}z5j(){this.r1.Ik("mousemove")||this.r1.la("mousemove",this.x7i)}fog(){this.r1.Ik("mousemove")&&this.r1.detach("mousemove")}zud(E){if(this.domElement.parentNode){var ma=
Sys.UI.DomElement.getBounds(this.domElement);const Ya=new Sys.UI.Point(Math.round(ma.x+ma.width),Math.round(ma.y+ma.height));ma=Math.abs(Ya.x-E.x);E=Math.abs(Ya.y-E.y);E=ma>E?ma:E;this.V4d?this.setOpacity(Fe.cdh(E)):100>=E&&this.dze()}}dze(){this.V4d=!0;this.MXa.cancel()}setOpacity(E){pb.a.setOpacity(this.domElement,E);this.AAf=Nd.a.$a.Wd}static cdh(E){return 100>=E?1:250<=E?0:.01*(100-(E-100)/150*100)}}Object(N.a)(Fe,"OnObjectButton",dc.a,[847,222,5]);var zf=a(811);const Af=ud.fNh;class dg extends Va.a{constructor(E,
ma,Ya,Ub,Hc,Gd,he,Ke,af){af=void 0===af?"":af;super();this.yAa=null;this.pof=!1;this.Od=this.Hvc=this.Ivc=null;this.buttons={};this.q1e={};this.$=E;this.svgIconProvider=ma;this.O5i=Ya;this.Xwd=Ub;this.Wwd=Hc;this.altText=Gd;this.bPb=he;this.Od=Ke;this.buttonText=af}get Qx(){return Hg.a(this.$).NKa(ef.a.Ccj)}get Iwb(){return ef.a.Bcj}get buttonWidth(){return Hg.a(this.$).NKa(ef.a.Dcj)}dispose(){this.VBh();this.$=null;super.dispose()}getButton(E,ma){return this.mza(E,void 0===ma?!0:ma)}mza(E,ma){const Ya=
E.toString();Ya in this.buttons||this.Xrh(E,void 0===ma?!0:ma);return this.buttons[Ya]}Mo(E,ma,Ya,Ub,Hc,Gd){Hc=void 0===Hc?!0:Hc;Gd=void 0===Gd?!1:Gd;this.hide();if(this.$.da.isNamedObjectViewMode&&Jf.i(this.$.na)){var he=ub.h(this.$).TU.domElement;const Ke=E+this.buttonWidth-he.scrollWidth;he=ma+this.buttonWidth-he.scrollHeight;E=0<Ke?E-Ke:E;ma=0<he?ma-he:ma}this.mza(Ub,Hc).Mo(E,ma,Ya,this.$,Gd)}hide(){const E=this.buttons;for(let ma in E)E[ma].hide()}Jid(E,ma){!this.pof&&(ma=this.buttons[ma.toString()])&&
(this.Ivc=(Ya,Ub)=>{E(Ub,!0)},ma.S_g(this.Ivc),this.Hvc=(Ya,Ub)=>{E(Ub,!1)},ma.R_g(this.Hvc),this.pof=!0,ma.Jid())}Xrh(E,ma){this.yAa=String.format(this.Xwd===bd.a.Kgc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',qa.a.am(this.Xwd),qa.a.am(this.Wwd),"{0}");var Ya=String.format(this.yAa,qa.a.am(this.altText));ma=new Fe(""===this.buttonText?ud.dNh:ud.gNh,""===this.buttonText?ud.eNh:ud.hNh,
bd.a.nH,Ya,ma,this.bPb,this.buttonText,Af,this.Od);Ya=(Ub,Hc)=>{this.O5i(Hc,E)};ma.z0(Ya);this.buttons[E.toString()]=ma;this.q1e[E.toString()]=Ya;Ya=ub.h(this.$).Ih(E);Ya.domElement.insertBefore(ma.domElement,Ya.domElement.firstChild)}VBh(){for(const E of zf.a(this.buttons)){const ma=this.buttons[E];ma.aaa(this.q1e[E]);Xd.a.Ma(ma);delete this.buttons[E];this.Ivc&&ma.FCj(this.Ivc);this.Hvc&&ma.ECj(this.Hvc)}}domElement(E){return this.mza(E).domElement}u7a(E){this.mza(E).u7a()}JXb(E,ma,Ya){Ya=void 0===
Ya?!0:Ya;this.yAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',qa.a.am(this.Xwd),qa.a.am(this.Wwd),"{0}");E=String.format(this.yAa,qa.a.am(E));this.mza(ma,Ya).z$d(E)}fZa(E,ma,Ya){this.mza(Ya,!1).jhk(E,ma)}gwg(){var E=void 0===E?!1:E;this.yAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",qa.a.am(this.Wwd),"{1}");const ma=String.format(this.yAa,void 0,qa.a.am(void 0));
this.mza(void 0,E).z$d(ma)}S$d(E,ma,Ya){this.mza(Ya,!1).ihk(this.svgIconProvider,E,ma)}}Object(N.a)(dg,"OnObjectLaunchButton",Va.a,[838,5]);class mh extends Xe.a{constructor(E,ma){super(E);this.AKb=null;this.DBh=()=>{this.display()};this.Wui=Math.max(1,ma)}dispose(){Xd.a.Ma(this.AKb);this.AKb=null;super.dispose()}YXa(){Xd.a.Ma(this.AKb);this.AKb=Ob.a.instance.create(this.DBh,this.Wui,Ib.a.LRi)}eYa(){Xd.a.Ma(this.AKb);this.hide()}}Object(N.a)(mh,"LoadingIndicatorBehavior",Xe.a,[803,5]);class nh extends mh{constructor(E,
ma,Ya,Ub){super(E,ma);this.zKb=null;this.DIg=Ya;this.isi=Ub;this.qWg()}dispose(){this.zKb=null;super.dispose()}display(){this.DIg(this.zKb)}hide(){this.isi(this.zKb)}qWg(){this.zKb=document.createElement("div");this.domElement.appendChild(this.zKb)}}Object(N.a)(nh,"ShimmerLoadingIndicatorBehavior",mh,[]);var Vg=a(75);class jh extends mh{constructor(E,ma,Ya,Ub,Hc,Gd){Ub=void 0===Ub?null:Ub;Hc=void 0===Hc?null:Hc;Gd=void 0===Gd?0:Gd;super(E,ma);this.x$a=this.JSa=null;this.x$a=Ya;this.Qnc=Ub||Vf.a.current.gq(102);
this.wCf=Gd;this.ufd=Hc;this.pWg()}dispose(){this.JSa=null;super.dispose()}display(){nb.DOMElementExtensions.setVisible(this.JSa,!0)}hide(){nb.DOMElementExtensions.setVisible(this.JSa,!1)}pWg(){this.JSa=document.createElement("div");this.JSa.classList.add(Vg.a.MLh);const E=document.createElement("div");E.classList.add(Vg.a.NLh);this.ufd&&""!=this.ufd&&E.classList.add(this.ufd);const ma=0===this.wCf?"":de.a.instance.ia(this.wCf),Ya=String.format('<div class="'+Vg.a.OLh+'">{0}</div>',ma);this.Qnc?this.x$a.Ij(E,
`<img src="${this.Qnc}" alt="${ma}" title="${ma}"/>`+Ya):this.x$a.Ij(E,Ya);this.JSa.appendChild(E);this.domElement.appendChild(this.JSa)}}Object(N.a)(jh,"SpinnerLoadingIndicatorBehavior",mh,[]);Object(Gb.b)(fd.tc)(E=>Io(function*(){const ma=yield Gb.a.resolve(fd.tb,{Qa:E.Qa});return new Fh(ma)}));class Fh{constructor(E){this.x$a=E}ted(E,ma,Ya){return new hc.a(E,ma,Ya)}Qcc(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf){return new Qc.a(E,ma,Ya,Ub,Hc,Gd,he,Ke,af,xf)}wyb(E,ma,Ya,Ub,Hc){return new jh(E,ma,this.x$a,Ya,
Ub,void 0===Hc?0:Hc)}Drd(E){return E.ea.Ba(238)||new xj(E)}nyb(E,ma,Ya,Ub,Hc,Gd,he,Ke){return new dg(E,ma,Ya,Ub,Hc,Gd,he,this.x$a,void 0===Ke?"":Ke)}dTe(E,ma){return new Ca(E,ma)}Tqh(E,ma,Ya,Ub){return new xb(E,ma,Ya,Ub)}fSe(E,ma,Ya,Ub){return new lk(E,ma,Ya,Ub)}}Object(N.a)(Fh,"SharedUIControlsFactory",null,[745]);Type.registerNamespace("Common.App.InProductMessaging");wa.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");yb.main();(()=>{vc.a.Fa(()=>{vc.a.Fa(mb.la)})})();(()=>
{vc.a.Fa(()=>{vc.a.Fa(Wb.la)})})();vc.a.Fa(Vc.la);(()=>{vc.a.Fa(E=>{Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2NetworkConnectionStateManager",!1)||yd.la(E)})})();(()=>{vc.a.Fa(E=>{Zj.la(E)})})();Sd.a.wk(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Object(Ue.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")||vc.a.Fa(Ee.la);(()=>{vc.a.Fa(E=>{pd.la(E);nf.la(E)})})();(()=>{vc.a.Fa(E=>{qc.la(E);Mf.la(E)})})();(()=>{vc.a.Fa(E=>{Uf.la(E)})})();(()=>{Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingServicesMigration",!1)||vc.a.Fa(E=>{Fd.la(E)})})();(()=>{vc.a.Fa(E=>{Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2Services15",!1)||Wd.la(E)})})();Type.registerNamespace("Common.App.Rename");Wa.a.instance.Mk(new Wi,
7);(()=>{vc.a.Fa(E=>{Xf.la(E)})})();(()=>{vc.a.Fa(E=>{Ge.la(E)})})();Sd.a.wk(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}");
(()=>{vc.a.Fa(E=>{E.ea.Ja(203,new Bf)})})();Type.registerNamespace("Common.App.LivePersonaUtils");eg.main();Type.registerNamespace("Common.App.SaveStatus");Wa.a.instance.Mk(new qh);vc.a.Fa(pi.la);vc.a.Fa(mj.la);(()=>{vc.a.Fa(E=>{Ga.EwaSettings.JD()||Gi.la(E)})})();Sd.a.wk('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
vc.a.Fa(bj.la);Type.registerNamespace("CAUI");Li.main();cd.a.Ln.Ja(141,new Ma);vc.a.Fa(rf.la);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Cf.a;Type.registerNamespace("Common.App.WopiIdentity");ei.main();Type.registerNamespace("Common.App.HostNotification");gg.main();Type.registerNamespace("Common.App.FloatPane");Hh.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");Xi.main();Ng.main();vc.a.Fa(vi.la);(()=>
{vc.a.Fa(E=>{E.ea.Zc(29,()=>{uj.la(E)})})})();vc.a.Fa(vj.la);String(O);String(T);String(W);String(L);String(S);String(I);String(K);window.___1688279196341_closurehack=O;window.___1688279196341_closurehack=T;window.___1688279196341_closurehack=W;window.___1688279196341_closurehack=L;window.___1688279196341_closurehack=S;window.___1688279196341_closurehack=I;window.___1688279196341_closurehack=K},747:function(w,D,a){a.d(D,"a",function(){return S});w=a(0);var b=a(2),c=a(15),e=a(96),f=a(235),d=a(14),
h=a(117),r=a(192),n=a(6),u=a(93);D=a(249);var v=a(1119),x=a(18),k=a(7),m=a(336),t=a(57),z=a(13),y=a(77),C=a(16),J=a(21),F=a(98),K=a(967),L=a(1);class S extends D.a{constructor(W,G){super(document.createElement("div"));this.FBf=this.AEe=this.Tye=this.$ac=this.Ufa=this.rba=this.PR=this.zB=null;this.hAa=this.pY=this.Wt=this.hideCloseButton=!1;this.S5i=O=>{this.aG(O)};this.Y5i=O=>{13===O.keyCode&&this.aG(O)};this.TLd=O=>{this.io(O.ud);return!0};this.ZLd=O=>{this.YY(O.ud);return!0};this.Mxc=O=>{this.jqa(O.ud?
O.ud:0);return!0};this.T5i=O=>{this.aG(O.Ca);return!0};this.dDg=O=>{O=void 0===O?null:O;this.io(O.inputMethod?O.inputMethod:0);return!0};this.eDg=O=>{O=void 0===O?null:O;this.YY(O.inputMethod?O.inputMethod:0);return!0};this.j5=W;this.Pv=G;this.m8c=G.D4a.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get Fbh(){return this.Pv.D4a}get businessBar(){return this.j5}get actionButton(){return this.Pv?this.Pv.actionButton:""}get UKa(){return this.Pv?this.Pv.UKa:""}get linkText(){return this.Pv?
this.Pv.link:""}get Cm(){return this.Pv?this.Pv.Cm:""}get alt(){return this.Pv?this.Pv.alt:""}Ira(W){this.Pv.businessBarType=W}dispose(){e.a.te([this.$ac,this.PR,this.rba]);this.Wt&&this.PR&&(f.a.instance.Aa(d.a.click,this.PR.domElement,this.TLd),h.KeyInputManager.instance.Bz(this.domElement,this.Tye));this.pY&&this.rba&&(f.a.instance.Aa(d.a.click,this.rba.domElement,this.ZLd),h.KeyInputManager.instance.Bz(this.domElement,this.AEe));this.hAa&&this.Ufa&&(f.a.instance.Aa(d.a.click,this.Ufa,this.Mxc),
h.KeyInputManager.instance.Bz(this.domElement,this.FBf));this.Ufa=this.zB=this.j5=this.rba=this.PR=null;super.dispose()}update(){}hhk(){this.YTe(!0)}DSe(){this.YTe(!1)}Mth(){const W=this.businessBar.$.Jd.Yh("DOMUpdate","ReactBusinessBar");W.start();this.message=F.a.Zg(this.message);this.title=F.a.Zg(this.title);r.UISurfaces.jrd().then(G=>{G.initializeMessageBarInStore();let O=Object(b.a)(new K.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.Pv.businessBarType,dismissButtonAriaLabel:C.a.instance.ia(10)});
this.hideCloseButton||(O.onDismiss=this.T5i);this.hAa&&(O.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Mxc});this.Wt&&(O.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.dDg});this.pY&&(O.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.UKa,["onExecute"]:this.eDg});L.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.Pv.iconName&&(O.messageBarIconProps={["iconName"]:this.Pv.iconName});
L.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?G.createNewMessageBarWithCallback(this.domElement,O,()=>{W.stop();c.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Pv.RNa} in: ${W.Ee} milliSeconds.`)}):G.createNewMessageBar(this.domElement,O);return null},()=>{c.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Pv.RNa} could not be initialized`);return null});if(n.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),
this.domElement.classList.add("WACBusinessBarEntry");else{let G="1px solid ";switch(this.Pv.businessBarType){case 1:case 2:case 3:G+="#F1707B";break;case 4:G+="#92C353";break;case 5:G+="#FCE100";break;case 0:G+="#C8C6C4";break;default:G+="#C8C6C4"}this.domElement.style.border=G}this.domElement.classList.add("ReactBusinessBarEntry");L.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")||(this.domElement.tabIndex=0);this.businessBar.domElement.appendChild(this.domElement)}Ush(W){W||
(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var G=this.businessBar.$.Ad;W=G+"ewaBusinessBarEntryBody"+this.m8c;const O=G+"ewaBusinessBarEntryTitle"+this.m8c;var T=G+"ewaBusinessBarEntryIcon"+this.m8c;this.domElement.className=v.a.xIh;z.DOMElementExtensions.kH(this.domElement);G=document.createElement("div");G.className=v.a.yIh;G.id=W;var I=document.createElement("div");I.className=v.a.wIh;var N=document.createElement("a");N.className=v.a.EIh;N.title=this.alt;
var R=document.createElement("span");R.classList.add(x.a.Yac);R.classList.add(v.a.AIh);R.id=T;this.Cm.length&&(T=document.createElement("img"),T.classList.add(this.Cm),T.src=t.a.di(0),R.appendChild(T));N.appendChild(R);I.appendChild(N);N=document.createElement("span");N.classList.add(v.a.DIh);N.id=O;N.innerText=F.a.Zg(this.title);I.appendChild(N);N=document.createElement("span");N.classList.add(v.a.CIh);N.id="message";N.innerText=F.a.Zg(this.message);I.appendChild(N);N=document.createElement("a");
N.id="link";N.href="#";N.className=v.a.BIh;N.innerText=F.a.Zg(this.linkText);I.appendChild(N);N=document.createElement("span");N.classList.add(v.a.D1e);R=document.createElement("button");R.type="button";R.id="action";R.className=v.a.C1e;R.innerText=F.a.Zg(this.actionButton);N.appendChild(R);I.appendChild(N);N=document.createElement("span");N.classList.add(v.a.D1e);R=document.createElement("button");R.type="button";R.id="altAction";R.className=v.a.C1e;R.innerText=F.a.Zg(this.UKa);N.appendChild(R);
I.appendChild(N);G.appendChild(I);I=document.createElement("a");I.className=v.a.zIh;I.tabIndex=0;I.setAttribute("role","button");N=document.createElement("span");N.id="close";N.classList.add(x.a.nH);R=document.createElement("img");R.classList.add(x.a.rkd);R.src=t.a.di(13);R.alt=C.a.instance.ia(793);R.title=C.a.instance.ia(793);R.setAttribute("role","button");N.appendChild(R);I.appendChild(N);G.appendChild(I);this.domElement.appendChild(G);z.DOMElementExtensions.wz(this.domElement,k.a.Tka,O,W);this.Ufa=
$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.Ufa,this.hAa);this.hAa&&(f.a.instance.ta(d.a.click,this.Ufa,this.Mxc),this.FBf=h.KeyInputManager.instance.ew(this.Ufa,this.Mxc,u.a.Yj,u.a.o_));this.PR=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.PR.isVisible=this.Wt;this.rba=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.rba.isVisible=this.pY;this.Wt&&(f.a.instance.ta(d.a.click,this.PR.domElement,this.TLd),this.Tye=
h.KeyInputManager.instance.ew(this.PR.domElement,this.TLd,u.a.Yj,u.a.o_),this.pY&&(f.a.instance.ta(d.a.click,this.rba.domElement,this.ZLd),this.AEe=h.KeyInputManager.instance.ew(this.PR.domElement,this.ZLd,u.a.Yj,u.a.o_)));this.zB=$get("close",this.domElement);this.$ac=this.lg.Zf(this.zB);this.$ac.la("click",this.S5i);this.$ac.la("keydown",this.Y5i);z.DOMElementExtensions.setVisible(this.zB,!this.hideCloseButton)}YTe(W){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.Mth():this.Ush(W)}io(){c.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Pv.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Pv.RNa}`);J.h(this.businessBar.$).ys(!0)}YY(){c.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Pv.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Pv.RNa}`);J.h(this.businessBar.$).ys(!0)}jqa(){c.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Pv.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Pv.RNa}`);J.h(this.businessBar.$).ys(!0)}aG(W){c.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.Pv.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Pv.RNa}`);this.set_visible(!1);this.businessBar.removeEntry(this.Fbh);y.g(W)}TM(){return L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.PR.domElement}}Object(w.a)(S,"BusinessBarEntry",D.a,[])},804:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(96),e=a(238),f=a(6),d=a(32),h=a(841),r=a(144),n=a(84),u=a(39),v=a(18),x=a(7),k=
a(182),m=a(1198),t=a(1193),z=a(178),y=a(569),C=a(361),J=a(65);const F=(Z,aa,Ea,za,bb,Mb,zb,oa,Xa,bc,Ac)=>{Ac=Z.Ra(1,void 0===Ac?null:Ac);Ac.selectedRanges=aa;Ac.isChangeObject=Ea;Ac.isFloodgateEnabled=za;Ac.isStarterData=bb;Ac.starterDataDomainId=Mb;return J.g(Z,"GetDataSelectorPaneData",Ac,zb,oa,Xa,bc,4)};var K=a(80),L=a(744),S=a(838);class W{}W.Eti="EnrichmentContentFrame";W.width=320;Object(w.a)(W,"EnrichmentConstants",null,[]);class G{constructor(Z){this.messageType=0;this.messageType=Z}}Object(w.a)(G,
"EnrichmentResponseMessage",null,[]);class O extends G{constructor(Z,aa){super(Z);this.messageContent=null;this.messageContent=aa}}Object(w.a)(O,"EnrichmentResponseMessageWithContent",G,[]);class T extends O{constructor(Z,aa,Ea){super(Z,aa);this.telemetryJson=null;this.telemetryJson=Ea}}Object(w.a)(T,"EnrichmentResponseMessageWithContentAndTelemetryData",O,[]);var I=a(276),N=a(14),R=a(104),V=a(49),sa=a(93),U=a(117),ka=a(43),ja=a(63),Da=a(33),qa=a(116),Ba=a(735),ua=a(28);class pa{constructor(Z,aa,
Ea,za,bb){this.xt=this.Ll=this.Lle=this.Jle=this.py=this.rx=null;this.Hz=!1;this.Ak=Z;this.Yf=aa;this.$R=Ea;this.Xd=za;this.Oa=bb;this.sua=U.KeyInputManager.Mn(sa.a.nta,0)}get pUb(){return!0}get rAb(){return f.AFrameworkApplication.fa.Ta("EnrichmentPaneUrl")}dispose(){this.pUb&&this.xt&&(this.Ak.Aa(N.a.click,this.xt,Object(K.a)(this,this.tn,"onClosePaneClick")),this.Yf.Aa(N.a.Hf,this.xt,Object(K.a)(this,this.FQf,"onKeyHide")));this.xt=null;this.py&&(this.Tfk(),this.py.parentNode.removeChild(this.py),
this.py=null);this.Xd.vk("EnrichmentPaneId").um(this.sua)}show(Z,aa,Ea){this.rx=Z;this.Hz||(this.Ll=this.W5a(),this.pra.appendChild(this.Ll),this.Exj(),this.Oa.Pd(ua.a.GOe,qa.a.frame,Object(K.a)(this,this.Pni,"handleEscapeKeyAction")),this.nXa(),this.Hz=!0);this.py.src=this.rAb&&this.rAb.length?this.rAb+"?culture="+aa.market+"&appName="+aa.applicationName+"&themeId="+aa.themeId+"&featuresBitMask="+aa.featuresBitMask:pa.YJf;this.Jle=aa;this.Lle=Ea;this.Gjb()}jMc(Z,aa){Z=new T(2,Z,aa);this.lAc(Z)}nXa(){const Z=
this.Xd.vk("EnrichmentPaneId");Z.parent=I.AFrame.eTa;this.Ak.Ctb("EnrichmentPaneId",this.Ll);Z.bindAction(this.sua,ua.a.GOe)}cgg(){if(this.py){R.FocusManager.Usa(this.py.contentWindow);const Z=new T(4,null,null);this.lAc(Z)}}tn(){this.bbc();return!0}FQf(Z){Z=Z.Ca.keyCode;return Z===Sys.UI.Key.enter||Z===Sys.UI.Key.space?(this.bbc(),!0):!1}bbc(){this.hide();if(this.rx)this.rx.onPaneClosed()}W5a(){const Z=L.a("div","EnrichmentPaneId","EnrichmentPane");this.pUb&&Z.appendChild(this.fed());this.xxi(Z);
return Z}fed(){const Z=L.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),aa=L.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");aa.innerText=CommonUIStrings.l_EnrichmentPaneTitle;aa.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ea=S.a.fd("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Ak.ta(N.a.click,Ea,Object(K.a)(this,this.tn,"onClosePaneClick"));this.Yf.ta(N.a.Hf,Ea,Object(K.a)(this,this.FQf,"onKeyHide"));
Z.appendChild(aa);Z.appendChild(Ea);this.xt=Ea;return Z}xxi(Z){this.py=L.b("iframe","","EnrichmentFrame");Z.appendChild(this.py);this.py.id=W.Eti;this.py.setAttribute("role","presentation")}Exj(){V.a.addHandler(this.py,"load",Object(K.a)(this,this.iQf,"onIFrameLoad"));V.a.addHandler(this.py,"error",Object(K.a)(this,this.Bxc,"onIFrameError"));$addHandler(window,"message",Object(K.a)(this,this.jQf,"onIFrameMessage"))}Tfk(){V.a.removeHandler(this.py,"load",Object(K.a)(this,this.iQf,"onIFrameLoad"));
V.a.removeHandler(this.py,"error",Object(K.a)(this,this.Bxc,"onIFrameError"));$removeHandler(window,"message",Object(K.a)(this,this.jQf,"onIFrameMessage"))}nxh(){this.py.src=pa.YJf}hide(){this.lnc();this.nxh()}Pni(Z,aa,Ea){if(1!==Ea&&(this.hide(),this.rx))this.rx.onPaneClosed();return 32}iQf(){}Bxc(){}jQf(Z){Z=Z.rawEvent;if(!this.py||-1!==this.py.src.indexOf(Z.origin)){try{var aa=ka.a(Z.data)}catch(Ea){return}if(!Ba.c(aa.messageType)){Z=window.g_badCastCallback;window.g_badCastCallback=null;switch(aa.messageType){case 2:this.lAc(new T(1,
ka.c(this.Jle),this.Lle));break;case 1:this.lAc(new O(0,this.x2h()));break;case 3:this.rx&&this.rx.selectEntity(aa.messageContent);break;case 5:this.rx&&this.rx.OLb(aa.messageContent);break;case 8:this.rx&&(aa=ka.a(aa.messageContent),0<aa.DomainId?this.rx.UZd(aa.Query,aa.TelemetryJson,aa.DomainId,aa.DomainIdString):this.rx.searchEntity(aa.Query,aa.TelemetryJson));break;case 6:this.rx&&this.rx.cancelSearch();break;case 11:aa=ka.a(aa.messageContent);aa=pa.Pcc("keydown","f6",sa.a.YYb,!0,!1,aa,!0,!1);
this.py&&this.py.dispatchEvent(aa);break;case 12:if(ka.a(aa.messageContent).keyCode===sa.a.KL&&(aa=pa.Pcc("keydown","esc",sa.a.KL,!0,!1,!1,!1,!1),this.py&&(this.py.dispatchEvent(aa),this.hide(),this.rx)))this.rx.onPaneClosed();break;case 13:this.rx&&this.rx.selectDataType(aa.messageContent);break;case 14:this.rx&&this.rx.showHelpArticle(aa.messageContent);break;case 15:this.rx&&this.rx.showSurveyDialog(aa.messageContent);break;case 16:this.rx&&(aa=ka.a(aa.messageContent),this.rx.insertTable(aa.DomainId,
aa.DomainIdString))}window.g_badCastCallback=Z}}}x2h(){return ka.c([2,1,3,5,8,6])}lAc(Z){Z=ka.c(Z);this.py.contentWindow.postMessage(Z,ja.a.ZM(this.rAb))}static Pcc(Z,aa,Ea,za,bb,Mb,zb,oa){Da.a.WB?(Mb=String.format("{0} {1} {2}",Mb?"Shift":"",zb?"Control":"",oa?"Alt":""),Mb.trim(),Ea=document.createEvent("KeyboardEvent"),Ea.initKeyboardEvent(Z,za,bb,window.self,aa,0,Mb,!1,"en-US")):(aa={},aa.keyCode=Ea,aa.ctrlKey=zb,aa.shiftKey=Mb,aa.altKey=oa,aa.bubbles=za,aa.cancelable=bb,Ea=new KeyboardEvent(Z,
aa));return Ea}}pa.YJf="about:blank";Object(w.a)(pa,"EnrichmentPane",null,[971,5]);class Ka extends pa{constructor(Z){super(f.AFrameworkApplication.sa.cB,f.AFrameworkApplication.sa.dB,f.AFrameworkApplication.sa.jia,f.AFrameworkApplication.sa.Cg,f.AFrameworkApplication.jd);this.taskPane=Z;this.taskPane.a0g(this.cgg)}get pra(){return this.taskPane.de}Gjb(){this.taskPane.isVisible||this.taskPane.Zi(!0)}lnc(){this.taskPane.Zi(!1)}dispose(){this.taskPane&&(this.taskPane.KCj(this.cgg),this.taskPane=null);
super.dispose()}}Object(w.a)(Ka,"EnrichmentTaskPaneWrapper",pa,[]);class $a{constructor(Z){this.lB=null;this.Zia=Z}sPi(Z,aa){this.lB=Z;this.Zia&&this.Zia.show(this,aa,null)}jMc(Z,aa){this.Zia&&this.Zia.jMc(Z,aa)}qFb(){this.Zia&&this.Zia.hide()}dispose(){this.Zia&&(this.Zia.dispose(),this.Zia=null)}selectEntity(Z){return this.lB?this.lB.selectEntity(Z):!1}searchEntity(Z,aa){this.lB&&this.lB.searchEntity(Z,aa)}UZd(Z,aa,Ea,za){this.lB&&this.lB.UZd(Z,aa,Ea,za)}OLb(Z){return this.lB?this.lB.OLb(Z):!1}onPaneClosed(){if(this.lB)this.lB.onPaneClosed()}cancelSearch(){this.lB&&
this.lB.cancelSearch()}selectDataType(Z){this.lB&&this.lB.selectDataType(Z)}showHelpArticle(Z){this.lB&&this.lB.showHelpArticle(Z)}showSurveyDialog(Z){this.lB&&this.lB.showSurveyDialog(Z)}insertTable(Z,aa){this.lB&&this.lB.insertTable(Z,aa)}}Object(w.a)($a,"EnrichmentManager",null,[970,5]);class ha extends $a{constructor(Z){super(Z)}dispose(){super.dispose()}}Object(w.a)(ha,"ExcelEnrichmentManager",$a,[]);var cb=a(16);class Ia{constructor(Z){this.campaignId=this.commentQuestion=null;this.isZeroBased=
!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Z;this.commentQuestion=cb.a.instance.gd(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=cb.a.instance.gd(195);this.ratingValuesAscending=[cb.a.instance.gd(196),cb.a.instance.gd(197),cb.a.instance.gd(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=cb.a.instance.gd(194)}}
Object(w.a)(Ia,"FloodgateSurvey",null,[]);var ob=a(27),gb=a(76),Za=a(433),da=a(46),ya=a(384),ib=a(202),vb=a(31),eb=a(94),Ta=a(35),La=a(295),fb=a(21);class Pb{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(w.a)(Pb,"EnrichmentMessageContentAppProperties",null,[]);class Sa{constructor(Z,aa,Ea,za,bb){this.hya=this.aYe=!1;this.yib=this.sfa=
!0;this.rOb=this.zUb=!1;this.Pjb=null;this.uzc=0;this.fz=()=>{(this.yib||this.hya)&&2!==this.uzc&&(this.rOb||this.BFd(!1))};this.Qe=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.H6i=Mb=>{Ta.a.Bh(Mb.Errors)?(Mb=Ta.a.me(Mb.Errors),Mb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Mb}`)):
Mb.Result&&(this.$.da.Vl(this.Qe),this.$.da.Pl(this.Qe),Mb=Mb.Result,this.Pjb=Mb.SkydanceFeatureBitmask,this.OJd(Mb),this.zUb=!0)};this.dh=()=>{(this.yib||this.hya)&&this.BFd(!1)};this.uxc=(Mb,zb)=>{Ta.a.Bh(Mb.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Ta.a.me(Mb.Errors)}`):Mb.Result&&(Mb=Mb.Result,Mb.DisambiguationJson?(this.zUb=!1,this.$gg(zb),this.Pjb=Mb.SkydanceFeatureBitmask,zb=Mb.DisambiguationJson,b.ULS.sendTraceTag(537166940,
0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.rOb=!1,this.jBf(zb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.r9i=(Mb,zb)=>{Ta.a.Bh(Mb.Errors)?(zb=Ta.a.me(Mb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${zb}`)):Mb.Result&&(Mb=Mb.Result,Mb.DisambiguationJson?(this.$gg(zb),this.Pjb=
Mb.SkydanceFeatureBitmask,zb=Mb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.rOb=!0,this.jBf(zb)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.Zbj=Mb=>{Ta.a.Bh(Mb.Errors)?(Mb=Ta.a.me(Mb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Mb}`),
this.yib=!0):Mb.Result&&(Mb=Mb.Result,this.Pjb=Mb.SkydanceFeatureBitmask,this.OJd(Mb),this.zUb=!0)};this.Vej=Mb=>{if(Ta.a.Bh(Mb.Errors)){const zb=Ta.a.me(Mb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${zb}`)}Mb.Result?(this.OJd(Mb.Result),this.zUb=!0):this.mxa()};this.$Tf=Mb=>{Ta.a.Bh(Mb.Errors)?(Mb=Ta.a.me(Mb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Mb}`)):
Mb.Result?this.agc.jMc(Mb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.mxa())};this.Faj=Mb=>{Ta.a.Bh(Mb.Errors)?(Mb=Ta.a.me(Mb.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Mb}`)):this.mxa()};this.$=Z;this.gridView=fb.h(this.$);this.gridView.ha.YG(this.dh);this.gridView.tu(this.fz);this.W0e=za;this.convertToLinkedEntityManager=bb;vb.a.ff()||
Ea.KT(aa);Z=new Ka(aa);this.agc=new ha(Z);n.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Mb=>{Mb.isFeatureEnabled("mso_sendASmile",!0).then(zb=>{this.sfa=zb;return null})})}dispose(){this.$&&(this.gridView.ha.lG(this.dh),this.gridView.hx(this.fz))}selectEntity(Z){const aa=da.o(this.gridView.ha.ra.activeCell,this.$),Ea=()=>new Za.a;ya.a(this.$.userOperationManager,(za,bb,Mb)=>{var zb=this.$.pa.ua;za=La.b(za,this.Vej);const oa=zb.Ra(9,null);oa.activeCell=aa;
oa.selectionIndex=Z;return J.g(zb,"SelectLinkedEntityForDisambiguation",oa,za,bb,Mb,null,4)},za=>new ib.a(109,0,za,void 0,Ea),null);return!0}searchEntity(Z,aa,Ea,za,bb){Ea=void 0===Ea?!1:Ea;za=void 0===za?0:za;bb=void 0===bb?null:bb;b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${aa}`);const Mb=da.o(this.gridView.ha.ra.activeCell,this.$);ya.a(this.$.userOperationManager,(zb,oa,Xa)=>{var bc=this.$.pa.ua,Ac=this.sfa,Xc=Ea,Ed=za,
Qd=bb;zb=La.b(zb,this.$Tf);const zd=bc.Ra(1,null);zd.searchCell=Mb;zd.searchQuery=Z;zd.isFloodgateEnabled=Ac;zd.isStarterData=Xc;zd.starterDataDomainId=Ed;zd.starterDataDomainIdString=Qd;return J.g(bc,"LinkedEntitySearch",zd,zb,oa,Xa,null,4)},zb=>new ib.a(110,0,zb,16),null)}OLb(Z){const aa=da.o(this.gridView.ha.ra.activeCell,this.$);this.yib=!1;ya.a(this.$.userOperationManager,(Ea,za,bb)=>{var Mb=this.$.pa.ua;Ea=La.b(Ea,this.Zbj);const zb=Mb.Ra(1,null);zb.activeCell=aa;zb.isBackward=Z;return J.g(Mb,
"MoveToNextAmbiguousLinkedEntity",zb,Ea,za,bb,null,4)},Ea=>new ib.a(111,0,Ea,16),null);return!0}onPaneClosed(){this.hya=!1;this.aYe=!0;this.uzc=0;this.rOb=!1}cancelSearch(){const Z=this.q_d();Z&&ya.a(this.$.userOperationManager,(aa,Ea,za)=>{var bb=this.$.pa.ua;aa=La.b(aa,this.$Tf);const Mb=bb.Ra(9,null);Mb.activeCell=Z;return J.g(bb,"CancelSearchLinkedEntity",Mb,aa,Ea,za,null,4)},aa=>new ib.a(112,0,aa,16),null)}selectDataType(Z){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");
this.mxa();if(Z&&Z.length)if(Z=JSON.parse(Z))if(null==Z.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var aa={};aa.Id=Z.domainId;aa.StringId=Z.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(aa)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(Z){const aa=
new eb.a(-859308420,gb.a.ld,this.$.ee,9,null);this.$.Ha.kd(aa,{[gb.a.Lh]:"HelpID="+Z,["InputMethod"]:gb.a.ld,["ShouldCanvasTakeFocus"]:!0,[gb.a.Ie]:x.a.OP})}showSurveyDialog(Z){t.a.Kjb(new Ia(Z))}insertTable(Z,aa){const Ea=this.q_d();Ea&&ya.a(this.$.userOperationManager,(za,bb,Mb)=>{var zb=this.$.pa.ua;za=La.b(za,this.Faj);const oa=zb.Ra(1,null);oa.cell=Ea;oa.starterDataDomainId=Z;oa.starterDataDomainIdString=aa;return J.g(zb,"InsertStarterDataTable",oa,za,bb,Mb,null,4)},za=>new ib.a(259,0,za,1),
null)}BFd(Z){this.launchOrCloseDisambiguationPane(Z)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Z=this.QMj();Z&&ya.a(this.$.userOperationManager,(aa,Ea,za)=>F(this.$.pa.ua,Z,!0,this.sfa,!1,null,La.b(aa,this.r9i),Ea,za,1),aa=>new ib.a(114,0,aa,16),null)}launchLinkedEntityDataTypeSelectorPane(Z,aa){ya.a(this.$.userOperationManager,(Ea,za,bb)=>{var Mb=
this.$.pa.ua;Ea=La.b(Ea,this.uxc);const zb=Mb.Ra(1,null);zb.selectedRanges=Z;zb.letyDomainId=aa;return J.g(Mb,"GetDataTypeSelectorData",zb,Ea,za,bb,2,4)},Ea=>new ib.a(233,0,Ea,16),null)}mPi(Z,aa){Z&&ya.a(this.$.userOperationManager,(Ea,za,bb)=>F(this.$.pa.ua,Z,!1,!1,!0,aa,La.b(Ea,this.uxc),za,bb,2),Ea=>new ib.a(257,0,Ea,16),null)}$gg(Z){Z&&(this.uzc=Z)}jBf(Z){var aa=new eb.a(-90814711,gb.a.ld,0,10,null);this.$.Ha.kd(aa,null);this.hya?this.agc.jMc(Z,null):(aa=3,null!=this.Pjb?aa=this.Pjb:b.ULS.shipAssertTag(537166937,
0,!1,"SkydanceFeatureBitmask was not set"),(Z=this.d8h(Z,aa))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.W0e||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.agc.sPi(this.W0e,Z),this.hya=!0)}mxa(){this.hya&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.agc.qFb(),this.hya=!1,this.uzc=0,this.rOb=!1)}OJd(Z){var aa=Z.Row+1;Z=Z.Column+1;0>aa||
0>Z?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.mxa(),this.$.da.Vl(this.Qe)):(aa=new ob.Range(aa,Z,aa,Z,!0,!1),this.gridView.ha.updateSelection(aa,aa,60),this.yib=!0)}d8h(Z,aa){const Ea=new Pb;Ea.applicationVersion=f.AFrameworkApplication.buildVersion;Ea.applicationName="ExcelWac";Ea.anid="00000000-0000-0000-0000-000000000000";Ea.sessionId=f.AFrameworkApplication.userSessionId;Ea.appCorrelationId=z.a.create().toString();
var za=y.a.XM(f.AFrameworkApplication.lcid);za=za?za.name:null;Ea.uiLanguage=za;Ea.market=this.Vjc(za);Ea.themeId=0;Ea.disambiguationJson=Z;aa<=C.a.a5?Ea.featuresBitMask=aa:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ea}Vjc(Z){Z=Z.split("-");return Z[Z.length-1]}launchOrCloseDisambiguationPane(Z){const aa=this.gridView.ha.ra.activeCell;if(this.q_d()&&aa)if(this.gridView.ed.CGb(aa)){if((!this.aYe||Z||this.zUb)&&!this.gridView.Xc){Z&&
(this.yib=!0);var Ea=da.q(aa,this.$);ya.a(this.$.userOperationManager,(za,bb,Mb)=>F(this.$.pa.ua,Ea,!1,this.sfa,!1,null,La.b(za,this.uxc),bb,Mb,1),za=>new ib.a(114,0,za,16),null)}}else this.mxa();else this.mxa()}swj(){if(this.hya){var Z=this.gridView.ha.ra.activeCell;if(Z){var aa=da.q(Z,this.$);ya.a(this.$.userOperationManager,(Ea,za,bb)=>F(this.$.pa.ua,aa,!1,this.sfa,!1,null,La.b(Ea,this.uxc),za,bb,1),Ea=>new ib.a(114,0,Ea,16),null)}else this.mxa()}}q_d(){const Z=this.gridView.ha.ra;return Z.Bfa()?
da.o(Z.activeCell,this.$):null}QMj(){const Z=this.gridView.ha.ra;return Z.Bfa()?da.q(Z.activeCell,this.$):null}}Object(w.a)(Sa,"ConvertToLinkedEntityDisambiguationPane",null,[5]);var Wa=a(2),pb=a(387),wa=a(1233),hb=a(57),Sb=a(752);class Bc{constructor(Z,aa,Ea){this.JBf=2;this.IBf="Size64by48";this.$=Z;this.Ya=aa;this.convertToLinkedEntityManager=Ea}p0h(Z,aa){var {ConvertToLinkedEntityManager:Ea}=a(804);this.tik();aa=this.Ya.Qt(aa).cH();let za=0,bb=0,Mb=!1;for(var zb of Z.Categories){const oa=this.U0h(zb,
za);oa&&(bb===Ea.Ncb&&(Mb=!0),aa.MenuSectionList.push(oa),++za);++bb}Mb&&za<=Ea.KBf&&aa.MenuSectionList.splice(Ea.Ncb,1);Ea=this.Ya.He().e$b();zb=hb.a.di(11);for(const oa of Z.LongButtons)this.convertToLinkedEntityManager.HZj(oa)&&this.rXg(Ea,oa,zb);0<Ea.ControlList.length&&aa.MenuSectionList.push(Ea);return aa}rXg(Z,aa,Ea){if(aa){var za="Data.ConvertToLinkedEntityMenuItem_"+aa.Name,bb=this.convertToLinkedEntityManager.wX(aa.DomainId);bb&&(aa=Object(Wa.a)(new pb.a,{Id:za,ExternalId:za,Command:"-1662108744",
LabelText:aa.Name,Alt:aa.SuperTip,Visible:!0,MenuItemId:a(804).ConvertToLinkedEntityManager.W6a(aa.DomainId),Image16by16:Ea,Image16by16Class:this.hui(bb.FontLocator)}),Z.ControlList.push(aa))}}P0h(Z,aa){return Object(Wa.a)(new wa.a,{Id:a(804).ConvertToLinkedEntityManager.QZe+Z.toString(),ExternalId:a(804).ConvertToLinkedEntityManager.QZe+Z.toString(),MenuItemId:a(804).ConvertToLinkedEntityManager.$hd+Z.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.Fof(aa.FontLocator),
LabelText:aa.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.vpd(aa)})}h7g(Z){switch(Z){case "Animal":return Sb.a.q3g;case "Apple":return Sb.a.w4g;case "Atom":return Sb.a.X5g;case "Beaker":return Sb.a.Y7g;case "Bridge":return Sb.a.C9g;case "Cat":return Sb.a.Neh;case "City":return Sb.a.ehh;case "Constellation":return Sb.a.$lh;case "Dog":return Sb.a.fDh;case "Finance":return Sb.a.Q7g;case "GradCap":return Sb.a.pmi;case "HumanAnatomy":return Sb.a.Bti;case "LocationPointer":return Sb.a.XRi;
case "Map":return Sb.a.sij;case "MedicineNeedle":return Sb.a.FYi;case "Mountain":return Sb.a.a_i;case "Movie":return Sb.a.t_i;case "Music":return Sb.a.F_i;case "OuterSpace":return Sb.a.Zij;case "Planet":return Sb.a.jmj;case "Satellite":return Sb.a.jKj;case "WolframGeneric":return Sb.a.dJj;default:return Sb.a.Lnh}}hui(Z){if("PowerBIRibbon"!==Z)return v.a.qkd;switch(Z){case "AnimalRibbon":return v.a.POh;case "AppleRibbon":return v.a.QOh;case "AtomRibbon":return v.a.ROh;case "BeakerRibbon":return v.a.SOh;
case "BridgeRibbon":return v.a.TOh;case "CenterMapRibbon":return v.a.UOh;case "CityRibbon":return v.a.VOh;case "CurrencyRibbon":return v.a.WOh;case "ExerciseRibbon":return v.a.XOh;case "FinanceRibbon":return v.a.A4e;case "FirstAidRibbon":return v.a.YOh;case "GlobeLightningRibbon":return v.a.ZOh;case "GradCapRibbon":return v.a.$Oh;case "HumanAnatomyRibbon":return v.a.aPh;case "LeafRibbon":return v.a.bPh;case "LocationPointerRibbon":return v.a.dPh;case "MapRibbon":return v.a.y4e;case "MountainRibbon":return v.a.ePh;
case "MovieRibbon":return v.a.fPh;case "MusicRibbon":return v.a.gPh;case "NotablePeopleRibbon":return v.a.hPh;case "OuterSpaceRibbon":return v.a.iPh;case "PartlySunnyWeatherRibbon":return v.a.jPh;case "PowerBIRibbon":return v.a.z4e;case "SatelliteRibbon":return v.a.kPh;case "WolframGenericRibbon":return v.a.cPh;case "YogaRibbon":return v.a.mPh;default:return v.a.x4e}}Fof(Z){switch(Z){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";
case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";
case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}U0h(Z,aa){aa=this.Ya.qF("ConvertToLinkedEntitySection_"+aa,this.JBf,this.IBf);var Ea=!1;for(var za of Z.DomainIds){const bb=this.convertToLinkedEntityManager.wX(za);if(!bb||bb.DomainBlocked||!bb.ShowInRibbon)continue;Ea=bb.Name;const Mb=a(804).ConvertToLinkedEntityManager.W6a(za);
aa.vv("Data.ConvertToLinkedEntityMenuItem_"+Mb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Mb,this.Fof(bb.FontLocator),void 0,void 0,this.vpd(bb),Ea);Ea=!0}if(!Ea)return null;za=aa.d$b(!0);aa=this.Ya.He();aa.title=Z.Name;Z=aa.e$b();Z.ControlList.push(za);return Z}tik(){this.JBf=5;this.IBf="Size112by64"}vpd(Z){return Z.RibbonTooltipHeader?Z.RibbonTooltipHeader+"\n\n"+Z.RibbonTooltip:Z.RibbonTooltip}}Object(w.a)(Bc,"ConvertToLinkedEntityMenuRenderer",null,[956]);var ab=a(61),qb=a(324),mc=a(126),
yb=a(1),vc=a(112),Db=a(73);class Ga{constructor(Z,aa){this.qvd=this.tvd=!1;this.Edj=Ea=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.tvd=!0;if(Ta.a.Bh(Ea.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Ta.a.me(Ea.Errors)}`);else{var za=0,bb=[],Mb=!1;try{if(!Ea.Result)return;const zb=Ea.Result;if(!zb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}bb=this.pkj(zb);
if(!bb||!bb.length)return;za=bb.length;this.UYi(bb);this.yEa.m$f();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.yEa.Vgb.length}`);if(yb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const oa of this.yEa.Vgb)if(1===(oa.Id&1048320)>>8){Mb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Mb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${za} data types.`),
Ea=[],Ea.push(Object(Wa.a)(new Db.a,{name:"MruCount",int64:za})),Ea.push(Object(Wa.a)(new Db.a,{name:"MruWolframAvailable",bool:Mb})),vc.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ea)}this.qvd&&(this.lAg(this.yEa.Vgb),this.qvd=!1)}};this.Qhj=Ea=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Ta.a.Bh(Ea.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Ta.a.me(Ea.Errors)}`):Ea.Result&&(Ea.Result||b.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.ETf=(Ea,za,bb)=>{Ea=mc.a.Bg(Ea.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${bb}. Errors: ${Ta.a.me(Ea)}.`)};this.$=Z;this.yEa=aa}Hfi(){!this.tvd&&this.$.da.Zd&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),qb.y(this.$.pa.ua,0,this.Edj,this.ETf,null,null))}lAg(Z){Z&&Z.length?this.tvd?
(Z=this.DOj(Z))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),qb.F(this.$.pa.ua,0,Z,this.Qhj,this.ETf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.qvd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}DOj(Z){if(!Z||!Z.length)return b.ULS.sendTraceTag(537166687,
0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var aa=[];for(const Ea of Z)Z={},Z.Id=Ea.Id,Ea.StringId&&(Z.StringId=Ea.StringId),aa.push(Z);aa="<DataTypes>"+ab.a.ye(aa)+"</DataTypes>";return 1906<aa.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):aa}pkj(Z){if(!Z)return b.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),
null;if(!Z.startsWith("<DataTypes>")||!Z.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Z=Z.substring(11,Z.length-12);if(!Z)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let aa=[];try{aa=ab.a.nk(Z)}catch(Ea){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ea.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${aa.length} data types.`);return aa}UYi(Z){const aa=this.yEa.Vgb,Ea=this.yEa.pvj;if(aa.length!==Ea){for(let za=0;za<Z.length&&aa.length<Ea;++za){const bb=Z[za];this.yEa.wX(bb)&&!aa.includes(bb)&&aa.push(bb)}this.yEa.Vgb=aa}}}Object(w.a)(Ga,"LinkedDataTypeRoamingHandler",null,[]);var Eb=a(59),Zb=a(54),ic=a(155),mb=a(40),Hb=a(52),Wb=a(34),Ob=a(248),Gc=a(24),Va=a(108),Jb=a(86),ub=a(92),Qa=a(151),P=a(19);a.d(D,"ConvertToLinkedEntityManager",
function(){return ta});class ta extends u.a{constructor(Z,aa,Ea,za,bb,Mb,zb){super();this.Uxf=this.oDd=this.lEd=this.YBd=this.XBd=this.pbb=this.Vyd=null;this.sMb=this.Tud=0;this.qpa=null;this.gzd=!1;this.Hnd=this.aq=this.UYd=null;this.Mu=0;this.O0=null;this.jQa=8;this.Z9c=this.HBf=this.buf=this.ifb=!1;this.vDa=this.Q$e=this.v7e=null;this.j8c=0;this.r7g=5;this.u9b=3E4;this.isg=!1;this.Owa=null;this.rya=Array(yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataTabReorgExperiment",!1)?3:
5);this.Vug=this.r$d=!1;this.Nag=this.aGd=0;this.Od=this.Kpe=null;this.amg=!0;this.Qe=(oa,Xa)=>{Xa.Zd&&!Xa.OIb&&this.showUntrustedImageBusinessBarIfNecessary()};this.r$i=oa=>{if(oa.Result){var Xa=oa.Result;if(Xa&&Xa.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Xa.length} labels`);var bc=Zb.GetServiceTaskFactory.Vc(this.$.ea,274,275,0);mb.TaskExtensions.ya(bc,()=>{bc.result.X7c(Xa,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},
this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.vh=()=>{this.Edk();this.Doi(this.$.da.fp.LinkedEntityAsyncRefreshStateId);this.Bbb?this.Hpi(this.$.da.fp.RichDataClassificationLabelStateId):this.Cab&&this.H9d(!0)};this.P7i=()=>{this.r$d=!0;this.aq&&this.aq.swj()};this.K9i=oa=>{if(oa&&!Ob.a(oa))try{oa.Result.HasUntrustedImageUrl&&(this.businessBar.ki(59,null),this.Vug=!0)}catch(Xa){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Xa}.`)}};
this.fBf=()=>{if(!this.HBf&&this.$Gb()&&!this.Xzd())if(vc.a("DataTabActive"),Eb.a.mi.XT)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var oa=this.Ccc();if(oa){var Xa={};Xa.InputMethod=gb.a.ld;Xa.CalloutName=8;Xa.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ha.kd(oa,Xa);this.HBf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.I6i=oa=>{Ta.a.Bh(oa.Errors)||(this.Bbb||this.H9d(!1),this.raiseEvent("LinkedEntityConverted"))};this.Wfj=()=>{yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?void Qa.a.resolve(P.f).then(oa=>{oa.readText(cb.a.instance.ia(1813))}):this.$.ea.Zc(211,oa=>{oa.readText(cb.a.instance.ia(1813))})};
this.kf=(oa,Xa)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Xa.GY?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.gNe():this.NGj(),this.r$d&&this.X_e())};this.T9i=oa=>{this.Kac();if(oa.Result){var Xa=oa.Result;oa=Xa.DomainDataArray;if(this.qpa=Xa.Ribbon){var bc={};bc.Name=cb.a.instance.ia(1803);bc.DomainIds=this.oN;this.qpa.Categories.splice(ta.Ncb,0,bc)}0<
Xa.MaximumCellsToConvert&&(this.Kpe=Xa.MaximumCellsToConvert);this.Mu=2;Xa=!1;if(oa){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${oa.length} domains`);this.DSa||(this.DSa=[]);bc=cb.a.instance.ia(1800);const Ac=cb.a.instance.ia(1802);for(const Xc of oa)Xc.DomainId?(this.DSa.push(Xc),Xc.DomainBlocked?(oa=!!Xc.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${oa?Xc.DomainId.Id.toString():Xc.Name} is telemetry only, do not show in menu (Has String ID: ${oa})`)):
(this.vX.ga(ta.W6a(Xc.DomainId),Xc),Xc.Name===bc||268435456===Xc.DomainId.Id?this.v7e=Xc.DomainId.Id.toString():Xc.Name===Ac||536870912===Xc.DomainId.Id?this.Q$e=Xc.DomainId.Id.toString():268435712===Xc.DomainId.Id&&Xc.ShowInRibbon&&(this.Z9c=!0),Xa=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Xa||(this.DSa=null);this.Lvg();this.UYd.Hfi();this.isg||(this.zdk(),this.isg=!0)}else this.DSa=null,this.Mu=3,-1<this.jQa&&window.setTimeout(()=>{this.gPb()},
100*(8-this.jQa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.rUd();this.yTe();this.Z9c&&this.qvf&&ic.c(this.fBf,this.$.ka,500);this.Cab&&!this.Bbb&&this.H9d(!0)};this.S9i=oa=>{oa=mc.a.Bg(oa.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Ta.a.me(oa)}].`);this.DSa=null;this.Mu=3;this.ifb=!0;this.rUd()};this.onContentReady=()=>{this.ztg()&&this.gridView.hx(this.onContentReady);this.amg&&this.$.workbookContext.Options&
1048576&&(this.businessBar.C2j(),this.amg=!1)};this.Lk=()=>{this.Kac()};this.xbj=oa=>{if(Ob.a(oa)){const Xa=Object(Jb.b)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(ub.d)(Qa.a.resolve(P.l,{Qa:0})):Zb.GetServiceTaskFactory.Vc(this.$.ea,5,4,0);mb.TaskExtensions.ya(Xa,()=>{let Ac=null;if(null===oa||void 0===oa?0:oa.Errors)Ac=oa.Errors[0];Xa.result.Hlg(Ac,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ta.a.me(oa.Errors)}].`);
const bc=Ta.a.hE(oa.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.da.Pq(bc)}};this.U9c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.u9b} millisecond interval`);this.mrf("Periodic auto-refresh check",this.V4i,this.U4i)};this.V4i=oa=>{Ob.a(oa)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ta.a.me(oa.Errors)}].`),
++this.j8c):this.j8c=0;c.a.Ma(this.vDa);this.j8c>=this.r7g?(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.vDa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.vDa=Hb.a.instance.create(this.U9c,this.u9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};
this.U4i=oa=>{oa=mc.a.Bg(oa.data);e.a.Vi(oa)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Ta.a.me(oa)}].`);c.a.Ma(this.vDa);this.vDa=Hb.a.instance.create(this.U9c,this.u9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.zcj=oa=>{oa=!!oa.Result&&oa.Result;b.ULS.sendTraceTag(537166790,
0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${oa.toString()}`);oa?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Wb.a.$a.eg.m-this.Tud} ms, retry count = ${this.sMb}`),this.gPb()):this.VIc()};this.ycj=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.VIc()};this.v9i=oa=>{oa.Result?(oa=oa.Result)?(this.BVd(),this.businessBar.Hlg(null,oa)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):
b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Z;this.businessBar=Mb;this.svgIconProvider=Ea;this.Od=zb;this.DSa=[];this.oN=[];this.gridView=fb.h(this.$);this.Emc=-1;this.oHi=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.Cab=yb.EwaSettings.Da(387);this.Bbb=yb.EwaSettings.Da(586);this.qvf=yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",
!1);this.vX=new Va.a;this.xdb=new Bc(Z,aa,this);za&&(this.aq=new Sa(Z,za,bb,this,this));this.$.Pm(this.kf);k.a(this.$)&&k.a(this.$).hQj(this);this.gNe();(this.Cab||this.Bbb)&&this.$.da.zw(this.vh);yb.EwaSettings.Da(123)&&yb.EwaSettings.Da(131)&&(this.ztg()||this.gridView.tu(this.onContentReady));this.$.tB(this.Lk);this.$.da.Pl(this.Qe);this.showUntrustedImageBusinessBarIfNecessary();this.UYd=new Ga(this.$,this)}dispose(){(this.Cab||this.Bbb)&&this.$.da.Zx(this.vh);this.$.da.Vl(this.Qe);!this.Owa&&
yb.EwaSettings.Da(123)&&yb.EwaSettings.Da(131)&&this.gridView.hx(this.onContentReady);this.aq&&this.aq.dispose();this.$.iE(this.Lk);this.$.Rn(this.kf);this.Cab&&(this.Vyd=null);c.a.Ma(this.vDa)}F_g(Z){this.addHandler("LinkedEntityConverted",Z)}uCj(Z){this.removeHandler("LinkedEntityConverted",Z)}get pvj(){return 5}get Vgb(){return this.oN}set Vgb(Z){this.oN=Z}selectEntity(Z){return this.aq?this.aq.selectEntity(Z):!1}searchEntity(Z,aa){this.aq&&this.aq.searchEntity(Z,aa)}UZd(Z,aa,Ea,za){this.aq&&this.aq.searchEntity(Z,
aa,!0,Ea,za)}OLb(Z){return this.aq?this.aq.OLb(Z):!1}onPaneClosed(){if(this.aq)this.aq.onPaneClosed()}cancelSearch(){this.aq&&this.aq.cancelSearch()}selectDataType(Z){this.aq&&this.aq.selectDataType(Z)}showHelpArticle(Z){this.aq&&this.aq.showHelpArticle(Z)}showSurveyDialog(Z){this.aq&&this.aq.showSurveyDialog(Z)}insertTable(Z,aa){this.aq&&this.aq.insertTable(Z,aa)}Hpi(Z){if(this.$.isEditMode&&this.Nag!==Z&&f.AFrameworkApplication.fa.qa("SupportsPolicies")){this.Nag=Z;b.ULS.sendTraceTag(537166925,
0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");Z=this.$.pa.ua;var aa=this.r$i;const Ea=Z.Ra(1,null);J.g(Z,"GetRichDataClassificationLabels",Ea,aa,null,null,null,4)}}X_e(){this.$.userOperationManager.enqueueOperation(new ib.a(589,0,(Z,aa,Ea)=>{var za=this.$.pa.ua;Z=La.b(Z,this.P7i);const bb=za.Ra(1,null);return J.g(za,"LinkedEntitiesEnableUntrustedImages",bb,Z,aa,Ea,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.r$d||this.Vug||
!this.$.da.Zd||this.FNj()}FNj(){this.$.userOperationManager.enqueueOperation(new ib.a(588,0,(Z,aa,Ea)=>{var za=this.$.pa.ua;Z=La.b(Z,this.K9i);const bb=za.Ra(1,null);return J.g(za,"GetHasUntrustedImageUrls",bb,Z,aa,Ea,null,4)},80),null)}H9d(Z){if(this.Cab&&null==this.Vyd&&!this.Bbb&&f.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.pbb&&this.pbb&&(!Z||this.$.workbookContext.Options&262144)){var aa=Zb.GetServiceTaskFactory.Vc(this.$.ea,274,275,0);mb.TaskExtensions.ya(aa,()=>{this.Vyd=aa.result.X4f(2)},
this.$.ka,3)}}get mLb(){return this.rya.length}get CYi(){return this.Kpe}Mnh(Z){(Z=this.jDh(Z))?this.convertToLinkedEntity(Z):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Z){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Z.Id}].`);if(this.gridView){var aa=this.gridView.ha.ra.Ye,Ea=aa.Xf(this.gridView.pT);this.gzd&&this.dYg(Z);if(Ea){Ea=this.gridView.ed.kBa(Ea);if(!this.gmf(Z)&&
this.pwf(Z.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Eb.a.mi.XT){aa=this.Lod();if(!aa){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ea=this.Ccc();if(!Ea){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var za={["InputMethod"]:gb.a.ld,CalloutName:3};za.Target=aa;za.RibbonButtonLabel=yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?
this.Aag(Z):this.DJb(Z.Id.toString());za.ExampleEntities=this.u5e(Z);this.$.Ha.kd(Ea,za);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.pwf(Z.Id)&&!Z.StringId)this.launchLinkedEntityDataTypeSelectorPane(ta.W6a(Z));else{if(Ea){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");
if(yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.J7j(Z)){aa=da.r(this.gridView.ha.ra.selectedRanges,this.$);this.aq.mPi(aa,Z);return}if(Eb.a.mi.XT){aa=this.Lod();if(!aa){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ea=this.Ccc();if(!Ea){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}za={["InputMethod"]:gb.a.ld,CalloutName:2};za.Target=aa;za.RibbonButtonLabel=
this.Aag(Z);za.ExampleEntities=this.u5e(Z);za.BlankCellResourceId=this.w8g(Z);za.HasBlankCellWalkthrough=this.Cqi(Z);za.ServiceDomain=Z.Id;this.$.Ha.kd(Ea,za);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.cdd(Z,!1,aa)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Owa&&this.Owa.HMa()}onAutoDetectUIShown(){ya.a(this.$.userOperationManager,
(Z,aa,Ea)=>{var za=this.$.pa.ua;const bb=za.Ra(1,null);return J.g(za,"OnAutoDetectUIShown",bb,Z,aa,Ea,null,4)},Z=>new ib.a(230,0,Z,80),null)}cdd(Z,aa,Ea){const za=da.q(Ea,this.$),bb=()=>new Za.a;ya.a(this.$.userOperationManager,(Mb,zb,oa)=>{var Xa=this.$.pa.ua;Mb=La.b(Mb,this.I6i,this.Wfj,this.aq.H6i);const bc=Xa.Ra(1,null);bc.selectedRanges=za;bc.domainId=Z;bc.autodetect=aa;return J.g(Xa,"ConvertToLinkedEntity",bc,Mb,zb,oa,null,4)},Mb=>new ib.a(115,0,Mb,void 0,bb),null)}dYg(Z){if(this.gzd){var aa=
{};aa.Id=Z.Id;Z.StringId&&(aa.StringId=Z.StringId);if(!(0<this.oN.length&&this.oN[0].Id===aa.Id&&this.oN[0].StringId===aa.StringId)){Z=!1;this.oN.splice(0,0,aa);for(let Ea=1;Ea<this.oN.length;++Ea)if(this.oN[Ea].Id===aa.Id&&this.oN[Ea].StringId===aa.StringId){this.oN.splice(Ea,1);Z=!0;break}for(;5<this.oN.length;)this.oN.splice(this.oN.length-1,1);this.qpa.Categories[ta.Ncb].DomainIds=this.oN;this.m$f();Z||this.UYd.lAg(this.oN)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.gridView){var Z=da.q(this.gridView.ha.ra.Ye,this.$);ya.a(this.$.userOperationManager,(aa,Ea,za)=>{var bb=this.$.pa.ua;const Mb=bb.Ra(1,null);Mb.selectedRanges=Z;return J.g(bb,"ConvertLinkedEntityToText",Mb,aa,Ea,za,null,4)},aa=>new ib.a(116,0,aa),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(fb.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.BVd();var Z=da.r(this.gridView.ha.ra.selectedRanges,this.$);ya.a(this.$.userOperationManager,(aa,Ea,za)=>{var bb=this.$.pa.ua;const Mb=bb.Ra(1,null);Mb.selectedRanges=Z;return J.g(bb,"RefreshLinkedEntitiesInRange",Mb,aa,Ea,za,null,4)},aa=>new ib.a(248,0,aa),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}HZj(Z){Z=this.wX(Z.DomainId);
if(!Z||Z.DomainBlocked||yb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Z.HasCuratedData)return!1;if(this.oHi){for(let aa of this.vX)if(aa.value.DomainId.Id===Z.DomainId.Id&&aa.value.ShowInRibbon)return!0;return!1}return Z.ShowInRibbon}jYj(Z){return 2!==this.Mu||!this.rya[Z]}launchDisambiguationPaneForSearch(){this.aq&&this.aq.launchDisambiguationPaneForSearch()}Ge(Z,aa,Ea){if("PopulateConvertToLinkedEntityMenu"!==aa)return!1;this.Hnd=Ea.MenuId;if(0===this.Mu||
3===this.Mu)return this.Mmj(),!0;if(!this.qpa)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.vX)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.O0=this.O0||this.xdb.p0h(this.qpa,Ea.MenuId);Ea.MenuItems=this.O0;return this.gzd=!0}Mmj(){-1===this.Emc&&(this.gPb(),this.Emc=window.setInterval(()=>{this.gPb()},2E3))}gPb(){if(this.$.da.Zd&&2!==this.Mu){this.jQa--;b.ULS.sendTraceTag(537166870,
0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Mu=1;var Z=this.$.pa.ua,aa=this.T9i,Ea=this.S9i;const za=Z.Ra(1,null);J.g(Z,"GetLinkedEntityMetadata",za,aa,Ea,null,null,4)}}Xzd(){return this.$.isEditMode&&2!==this.Mu&&(0<=this.jQa||!this.ifb)}jae(Z){f.AFrameworkApplication.fi?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):k.a(this.$)?(this.ajk(),Z&&this.$.fh()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}NGj(){this.sMb=
0;this.jQa=8;this.ifb=!1;this.Mu=this.Emc=0;this.DSa=this.qpa=null;this.Kac();for(let Z=0;Z<this.mLb;++Z)this.rya[Z]=null;this.$Gb()&&this.jae(!0)}Kac(){this.O0=null}$Gb(){const Z=x.a.YPb,aa=k.a(this.$);return!!aa&&aa.xr.WA===Z}Lvg(){if(this.qpa){let Ea=0;var Z=-1,aa=-1;let za=0,bb=0,Mb=0,zb=0;const oa=[null,null,null,null,null];for(const Xa of this.qpa.Categories){let bc=!1;for(const Ac of Xa.DomainIds){let Xc=this.wX(Ac);Xc&&!Xc.DomainBlocked&&Xc.ShowInRibbon&&(Ea<this.mLb?(this.rya[Ea]=Ac,bb===
ta.Ncb&&(-1===Z&&(Z=Ea),aa=Ea,zb=aa-Z+1),++Ea):Ea===this.mLb&&za<zb&&bb!==ta.Ncb&&(oa[za]=Ac,++za),bc=!0)}bc&&++Mb;++bb}if(-1<Z&&Mb<=ta.KBf){for(;aa>=Z;--aa)this.rya.splice(aa,1);for(Z=0;Z<zb;++Z)this.rya.splice(Ea+Z,0,oa[Z])}for(;Ea<this.mLb;)this.rya[Ea]=null,++Ea}}ztg(){const Z=fb.h(this.$).za,aa=this.gridView.ha.ng;if(Z&&Z.Zud&&1===aa&&this.gridView.ha.ra.activeCell){const Ea=Object(ub.d)(Qa.a.resolve(P.tc,{Qa:1}));mb.TaskExtensions.ya(Ea,()=>{this.Owa=new m.a(this.$,this.svgIconProvider,Ea.result,
this,this.Od)},this.$.ka,3);return!0}return!1}pPi(){this.aq&&this.aq.BFd(!0)}launchLinkedEntityDataTypeSelectorPane(Z){if(this.aq)if(Z=this.Chd(Z))if(Z.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var aa=da.r(this.gridView.ha.ra.selectedRanges,this.$);this.aq.launchLinkedEntityDataTypeSelectorPane(aa,Z.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}cmh(Z){const aa=
this.gui(Z),Ea=d.a.am(this.DJb(Z));Z=d.a.am(this.I8d(Z));return ta.U_h(aa,hb.a.di(11),Ea,Z)}I8d(Z){try{return this.bZe(parseInt(Z,10)).Description}catch(aa){}return cb.a.instance.ia(1797)}DJb(Z){try{return this.bZe(parseInt(Z,10)).Name}catch(aa){}return cb.a.instance.ia(1783)}Aag(Z){try{return this.wX(Z).Name}catch(aa){}return this.DJb(Z.Id.toString())}w8g(Z){try{return this.wX(Z).BlankCellResourceId}catch(aa){}return null}Cqi(Z){try{return this.wX(Z).HasBlankCellWalkthrough}catch(aa){}return!1}gmf(Z){try{const aa=
ta.W6a(Z);if(this.vX.Wc(aa))return this.vX.ma(aa).HasCuratedData}catch(aa){}return!1}J7j(Z){try{return this.wX(Z).SupportsStarterData}catch(aa){}return!1}pwf(Z){return 268435968===Z}Lod(){return 2===k.a(this.$).bR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Ccc(){return new eb.a(-847286761,gb.a.ld,this.$.ee,0,x.a.P3)}yTe(){if(this.$Gb()&&!this.Xzd()&&!this.buf&&yb.EwaSettings.Da(387)&&this.gmf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Eb.a.mi.XT){const Ea=this.Lod();if(Ea){var Z=this.Ccc();if(Z){var aa={["InputMethod"]:gb.a.ld,CalloutName:6};aa.Target=Ea;aa.ShouldCanvasTakeFocus=!0;this.$.Ha.kd(Z,aa);this.buf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Kti(Z){Z=
this.Chd(Z);return Z?this.xdb.h7g(Z.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}npc(Z){return this.Owa?this.Owa.g7g(Z):!1}b3h(){return this.Owa?this.Owa.Y3h():""}N7h(Z,aa){const Ea=this.mpf(Z);if(0>Ea)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Z}`);else if(Z=(Z=this.cZe(Z))?this.wX(Z):null)aa[h.a.GalleryButtonProps]=this.xdb.P0h(Ea,
Z),aa[h.a.Alt]=this.xdb.vpd(Z)}m$f(){this.Lvg();this.$Gb()&&this.jae(!0);this.Kac()}gui(Z){return Z===this.v7e?v.a.A4e:Z===this.Q$e?v.a.y4e:v.a.x4e}u5e(Z){try{return this.wX(Z).ExampleEntities}catch(aa){}return cb.a.instance.ia(1805)}rUd(){(0>this.jQa||this.ifb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Mu||0>this.jQa||this.ifb)&&window.clearInterval(this.Emc);this.Xzd()?this.Hnd&&this.$.frame.Cz(this.Hnd):this.jae(this.$Gb())}Cd(Z){return this.$.Ad+
Z}ajk(){var Z=!0;const aa=Array(this.mLb),Ea=k.a(this.$)?k.a(this.$).xr:null;if(Ea){for(let za=0;za<aa.length;++za)this.jYj(za)?aa[za]=!0:Z=aa[za]=!1;Ea.lhg(["ConvertToLinkedEntityGallery"],Z);if(!Z)for(Z=0;Z<aa.length;++Z)aa[Z]&&Ea.lhg([this.M7h(Z)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}wX(Z){const aa=ta.W6a(Z);if(this.vX.Wc(aa))return this.vX.ma(aa);b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Z.Id} (Has String ID: ${!!Z.StringId})`);
return null}M7h(Z){return"ConvertToLinkedEntityPreview"+Z.toString()}$$d(){r.a.get_instance().$j(10,()=>{this.yTe();this.Z9c&&this.qvf&&ic.c(this.fBf,this.$.ka,500)})}rmc(Z,aa){switch(Z){case "QueryLinkedEntityGalleryButtons":if(!aa[h.a.InnerHTML]){Z=aa[gb.a.Ie].toString();const Ea=Gc.a.equals(Z,cb.a.instance.ia(1800),!0)||Gc.a.equals(Z,cb.a.instance.ia(1801),!0),za=Gc.a.equals(Z,cb.a.instance.ia(1802),!0);Ea||za||this.N7h(Z,aa)}break;case "QueryLinkedEntityMenuGalleryButtons":aa[h.a.InnerHTML]||
(aa[h.a.InnerHTML]=this.cmh(aa[gb.a.Ie]))}return aa}jDh(Z){var aa=this.cZe(Z);if(aa)return aa;if(aa=this.Chd(Z))return aa.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Z}`);return null}bZe(Z){const aa={};aa.Id=Z;return this.wX(aa)}Chd(Z){return this.vX.Wc(Z)?this.vX.ma(Z):null}mpf(Z){if(!Z.startsWith(ta.$hd))return-1;const aa=parseInt(Z.substr(ta.$hd.length),10);return isNaN(aa)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Z}`),
-1):aa}cZe(Z){Z=this.mpf(Z);return 0>Z?null:this.rya[Z]}mrf(Z,aa,Ea){if(this.vX&&this.vX.count){b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Z})`);var za=this.$.pa.ua.Ud();this.$.da.Zd&&(Z=this.$.pa.ua,aa=La.b(this.xbj,aa),za=Z.Ra(1,void 0===za?null:za),J.g(Z,"LinkedEntityTryAutoRefresh",za,aa,Ea,null,null,0))}}zdk(){this.mrf("Auto-refresh on load",null,null)}Edk(){this.vX&&this.vX.count&&(this.vDa?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.da.fp.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.vDa=Hb.a.instance.create(this.U9c,this.u9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}VIc(){if(this.$.da.Zd&&
null!=this.pbb&&null!=this.XBd&&null!=this.YBd&&null!=this.lEd&&null!=this.oDd)if(++this.sMb,12>=this.sMb){1===this.sMb&&(this.Tud=Wb.a.$a.eg.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Z=this.$.pa.ua.Ud();qb.w(this.$.pa.ua,this.sQi,this.tQi(),this.zcj,this.ycj,null,Z)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Wb.a.$a.eg.m-this.Tud} ms`),this.ifb=!0,this.rUd()}gNe(){if(this.$.isEditMode)if(null!=
this.pbb)this.VIc();else{var Z=Wb.a.$a.eg.m,aa=[];n.a.instance.Ed("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ea=>{Ea.isFeatureEnabled("ExcelPowerBiPro",!1).then(za=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Wb.a.$a.eg.m-Z} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${za}]`);return this.pbb=za}).then(()=>{aa.push(Ea.isFeatureEnabled("ExcelWolframAlpha",
!1).then(za=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Wb.a.$a.eg.m-Z} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${za}]`);return this.lEd=za}))}).then(()=>{aa.push(Ea.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(za=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Wb.a.$a.eg.m-
Z} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${za}]`);const bb=[Object(Wa.a)(new Db.a,{name:"IsRestrictedByLicense",bool:za})];vc.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,bb);this.Uxf=za&&yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return za}))}).then(()=>{aa.push(Ea.isFeatureEnabled("StockHistory",!1).then(za=>{b.ULS.sendTraceTag(537166739,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Wb.a.$a.eg.m-Z} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${za}]`);return this.oDd=za}))}).then(()=>{aa.push(Ea.isFeatureEnabled("ExcelPowerBiFree",!1).then(za=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Wb.a.$a.eg.m-Z} Millisecond.`);b.ULS.sendTraceTag(537166735,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${za}]`);return this.XBd=za}))}).then(()=>{aa.push(Ea.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(za=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Wb.a.$a.eg.m-Z} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${za}]`);
return this.YBd=za}))}).then(()=>{Promise.all(aa).then(()=>{this.VIc()})})})}}get sQi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}tQi(){return[this.pbb,this.lEd,this.oDd,this.XBd,this.YBd,this.Uxf]}BVd(){this.businessBar&&this.businessBar.Foa(58)&&this.businessBar.removeEntry(58)}Doi(Z){if(this.aGd!==Z&&this.businessBar)if(this.aGd=Z){Z=this.$.pa.ua;var aa=this.v9i;const Ea=Z.Ra(1,null);J.g(Z,"GetErrorMessageForLinkedDataTypeRefresh",
Ea,aa,null,null,null,4)}else this.BVd()}static U_h(Z,aa,Ea,za){Z=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Z,aa,za);Ea=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Ea);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Z,Ea)}static W6a(Z){return Z.StringId?Z.Id.toString()+"."+Z.StringId:
Z.Id.toString()}}ta.QZe="ConvertToLinkedEntityPreview";ta.$hd="PreviewGalleryButtonIndex.";ta.Ncb=0;ta.KBf=2;Object(w.a)(ta,"ConvertToLinkedEntityManager",u.a,[885,886,5,887])},886:function(w,D,a){a.d(D,"a",function(){return c});w=a(0);D=a(747);var b=a(94);class c extends D.a{constructor(e,f,d){super(e,f);this.Wt=!0;this.command=d}io(e){super.io(e);this.businessBar.$.Ha.kd(new b.a(this.command,e,this.businessBar.$.ee,10,null))}}Object(w.a)(c,"CommandActionBusinessBarEntry",D.a,[])},911:function(w,
D,a){a.r(D);w=a(0);var b=a(2),c=a(15),e=a(331),f=a(35),d=a(12),h=a(277);class r{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(w.a)(r,"ConnectionErrorLogInfo",null,[]);var n=a(1115),u=a(1116);class v{constructor(z){this.wwd=[n.a.YAg,n.a.mOc];this.Wn=(y,C)=>{this.$Q[C]=y;this.mri()&&this.JFj("OnNetworkDownImmediatePing"===y.caller)};this.Kpa=z;this.$=z.$;this.$Q={}}kPi(){const z=u.a.Znd(this.Wn,"OnNetworkDownImmediatePing",this.$,this.wwd);for(const y of z)y.runTest()}mri(){for(const z of this.wwd)if(void 0===
this.$Q[z]||null===this.$Q[z])return!1;return!0}JFj(z){const y=this.$.Ig.m9;z&&this.K6j(y);for(var C of this.wwd)this.$Q[C]=Sys.Serialization.JavaScriptSerializer.serialize(this.$Q[C]);z=Date.now();C=(()=>this.Kpa.htd(a(911).NetworkConnectionHealthChecker.dMb))().returnValue;const J=(()=>this.Kpa.htd(a(911).NetworkConnectionHealthChecker.kTb))().returnValue;this.$Q.isOfflineMode=y;this.$Q.networkDownBBAge=-1===C?C:z-C;this.$Q.transientServerCommunicationFailuresBBAge=-1===J?J:z-J;this.Kpa.businessBar?
(this.$Q.isNetworkDownBBShown=this.Kpa.businessBar.jH(56).toString(),this.$Q.isServerErrorBBShown=this.Kpa.businessBar.jH(21).toString()):(this.$Q.isNetworkDownBBShown="unknown",this.$Q.isServerErrorBBShown="unknown");c.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.$Q)}`)}K6j(z){const {NetworkConnectionHealthChecker:y}=a(911),C={};for(const J of Object.keys(this.$Q)){const F=this.$Q[J];C[F.testName]=F.isSuccess}C.isOfflineMode=
z;this.Kpa.v6d(y.wcd,Sys.Serialization.JavaScriptSerializer.serialize(C))}}Object(w.a)(v,"ConnectionHealthTestsRunner",null,[]);var x=a(151),k=a(19),m=a(1);a.d(D,"NetworkConnectionHealthChecker",function(){return t});class t{constructor(z){this.businessBar=this.tcb=null;this.cMf=(y,C)=>{C.mhd?this.N4i(C):this.M4i(C)};this.lj=(y,C)=>{y=C.context.methodName;this.tcb&&y===this.tcb&&(c.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.tcb}" has now succeeded. Querying local storage for BB showings.`),
this.Ycb(t.kTb,!0),this.tcb=null);this.DDf(!1);this.Ibc=!1};this.Jo=(y,C)=>{f.a.aj(C.errors,[-1387426400])&&!this.Ibc&&(this.Ibc=!0,this.Cjg()&&window.performance.mark(t.NKf),(new v(this)).kPi())};this.Zh=()=>{this.DDf(!0);this.Ycb(t.dMb,!1);this.Ycb(t.kTb,!1)};this.ZCa=()=>{this.Ycb(t.dMb,!0)};this.$=z;this.pa=this.$.pa;this.localStorage=new h.a;this.Ibc=!1;this.$.da.Ol(this.Zh);this.pa.Ig.Vtb(this.ZCa);this.pa.Ht(this.lj);m.EwaSettings.isChangeGateEnabled("OfficeVSO:8010793_ConvertBusinessBarManagerServiceStage2")?
void x.a.cce(k.l).then(y=>{const C=this;return Io(function*(){C.businessBar=y;y.NBe(C.cMf)})}):this.$.ea.Zc(5,y=>{this.businessBar=y;y.NBe(this.cMf)});this.pa.Pz(this.Jo)}dispose(){this.$&&(this.$.da&&this.$.da.mo(this.Zh),this.pa&&(this.pa.Ig.aRb(this.ZCa),this.pa.UA(this.Jo),this.pa.Uu(this.lj)))}N4i(z){const y={};y.Timestamp=Date.now().toString();switch(z.D4a){case 21:this.tcb=z.data.FailedMethod;y.FailedMethod=this.tcb;this.v6d(t.kTb,JSON.stringify(y));break;case 56:this.v6d(t.dMb,JSON.stringify(y))}}M4i(z){switch(z.D4a){case 21:this.Ycb(t.kTb,
!0);break;case 56:this.Ycb(t.dMb,!0)}}v6d(z,y){try{this.localStorage.Rh()&&this.localStorage.setItem(z,y)}catch(C){c.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${C.message||"Unknown"}`)}}htd(z){if(this.localStorage.Rh()&&(z=this.localStorage.xPa(z))&&"null"!==z){var y=JSON.parse(z);z=parseInt(y.Timestamp,10);y=Sys.Serialization.JavaScriptSerializer.serialize(y);return{returnValue:z,rawData:y}}return{returnValue:-1,
rawData:null}}DDf(z){if(this.localStorage.Rh()){const y=this.localStorage.xPa(t.wcd);if(y&&"null"!==y){let C=-1;this.Ibc&&(C=this.K7h(t.NKf,t.t3i));c.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(y)}, Period offline: ${C}, New session: ${z}`);this.localStorage.removeItem(t.wcd)}}}K7h(z,y){if(!this.Cjg())return-1;window.performance.measure(y,z);z=window.performance.getEntriesByName(y);
return z.length&&z[z.length-1]?z[z.length-1].duration:(c.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${y} returned no measures.`),-1)}Ycb(z,y){try{let C;const J=(()=>{let F=this.htd(z);({rawData:C}=F);return F})().returnValue;if(-1!==J){const F=Object(b.a)(new r,{timeElapsed:Date.now()-J,scenario:z,isNewSession:!y,rawData:C});c.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(F)}`)}this.localStorage.removeItem(z)}catch(C){c.ULS.sendTraceTag(537155226,
0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${C.message||"Unknown"}`)}}Cjg(){return d.HelperMethods.a$b&&e.a.t4a}}t.dMb="NetworkDownBBShown";t.kTb="ServerCommunicationFailureBBShown";t.wcd="ConnectionHealthPingRsults";t.NKf="offMoStMa";t.t3i="offMoDuMea";Object(w.a)(t,"NetworkConnectionHealthChecker",null,[5])},968:function(w,D,a){a.d(D,"a",function(){return d});w=a(0);var b=a(15),c=a(6),e=a(42),f=a(33);class d{static taf(h,r){switch(h){case 3:return d.qli(r);
case 2:return d.Hdi(r);case 1:return d.q8h(r)}return""}static qli(h){switch(h){case 1:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static Hdi(h){switch(h){case 1:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static q8h(h){switch(h){case 1:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return c.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,r,n){if(f.a.Ki||f.a.Hp)window.setTimeout(()=>{d.p4f(n,d.Cjf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.nFe(n),h,0,!1)}static oih(h,r,n,u){r&&u&&u();d.openInClient(h,r,n)}static Cjf(){return f.a.Ki?1:f.a.Hp?2:f.a.kSa?3:f.a.isMac?4:0}static get XHb(){return"zh-CN"===window.navigator.language}static p4f(h,r){1===r?(b.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),
h=d.taf(h,r),8<f.a.AFb?e.a.Gg(h,void 0,void 0,"RedirectToAppStore"):e.a.mT(h)):document.hidden||(d.XHb?(h=c.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(b.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.mT(h)):b.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(b.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.taf(h,r),null,null)))}static nFe(h){switch(h){case 3:return 5;
case 2:return 3;case 1:return 1;default:return 0}}static get L3d(){return(f.a.kSa||f.a.isMac)&&f.a.Eo}static Iaf(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static jHi(h){return(h=d.wai(h))&&""!==h?Boolean.parse(h):!1}static I1d(h){d.cSj(h)}static wai(h){try{return localStorage.getItem(h)}catch(r){return b.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+r.message),
null}}static cSj(h){try{localStorage.setItem(h,"true")}catch(r){b.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+r.message)}}}d.$gh="ChromeExtensionBarDismiss";Object(w.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/7f1800051be7a510966619b2ea9f84a7/EwaTS.pi.js.map