'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1214:function(w,D,a){a.r(D);w=a(0);var b=a(15),c=a(105),e=a(87),f=a(12),d=a(234);class h extends d.a{constructor(u){super();this.$=u;this.Md()}create(){const {RenderingFidelityTracker:u}=a(1214);let v=this.$.ea.Ba(462);v||(v=this.$.ea.Ja(462,new u));this.qd(v)}}Object(w.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var r=a(50);a.d(D,"RenderingFidelityTracker",function(){return n});class n extends e.a{constructor(){super();
this.wZi=3E4;this.Skb={};this.Ibe={};this.SIe={};c.Health.instance.addQosPillar("Fidelity")}static la(u){u.ea.Ja(463,new h(u))}o3g(u,v,x,k){if(!(r.PageLoadTrackingInfo.instance.Qza(new Date)<this.wZi)){var m=f.HelperMethods.qU(()=>{var t=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),z=Object.keys(t),y=this.SIe[u];for(var C=0;C<z.length;C++){var J=z[C];this.Ibe[J]||(null===y||void 0===y?0:y[J])&&this.Skb[J]&&(this.Skb[J]-=y[J])}this.SIe[u]=t;for(C=0;C<z.length;C++)if(y=z[C],!this.Ibe[y])if(J=
t[y],this.Skb[y]&&(J+=this.Skb[y]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,J)){this.Ibe[y]=!0;t=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);C=!("ThickBorder"===y||"MediumBorder"===y);t&&z&&C&&c.Health.instance.recordQosError(t,[z],!1,!0,!0,!1,null);b.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+y+", isHC:"+x+", scaleFactor:"+k+"}");
break}else this.Skb[y]=J});1<m&&b.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${m}`)}}}Object(w.a)(n,"RenderingFidelityTracker",e.a,[379,5])},1334:function(w,D,a){function b(X){var ca=X.replace(/-.*/g,()=>"");ca=Ib.get(ca);return null!==ca&&void 0!==ca?ca:X.startsWith("ooux")?"ooux":"other"}function c(X){switch(!0){case X.Wy:return oe.MergedCell;case X.eN:return oe.ABg;case X.Qy:return oe.Formula;
case X.hasAutoFilter:return oe.AutoFilter;case X.l2:return oe.PivotFilter;case !!X.Nfb:return oe.PivotTable;case X.Tea:return oe.Comment;case X.h$a:return oe.Sparkline;case X.REb:return oe.InCellImage;case X.hasRichText:return oe.lDg;default:return""}}a.r(D);var e={};a.r(e);a.d(e,"InteractivityTrackerService",function(){return xd});var f={};a.r(f);a.d(f,"JsSelfProfilerManager",function(){return $d});var d={};a.r(d);a.d(d,"PageLoadEngagementInfo",function(){return kd});var h={};a.r(h);var r={};a.r(r);
a.d(r,"GridActionTelemetryManager",function(){return Yd});var n={};a.r(n);a.d(n,"DocumentVisibilityObserver",function(){return ba});var u={};a.r(u);a.d(u,"ValidationTelemetryManager",function(){return sc});var v=a(0),x=a(15);class k{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=
this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(v.a)(k,"BrowserInfo",null,[]);class m{constructor(){this.Version=this.Name=null}}Object(v.a)(m,"PluginInfo",null,[]);var t=a(6),z=a(33);class y{static LGd(){if(t.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var X=
y.m_h();try{const ca=JSON.stringify(X);x.ULS.sendTraceTag(6903563,102,50,ca)}catch(ca){x.ULS.sendTraceTag(6903564,102,15,ca.message)}}else x.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static fei(){const X=window.navigator.plugins;if(!X||!X.length)return null;const ca=[];for(let Qb=0;Qb<X.length;Qb++){const Uc=X[Qb].name,Od=X[Qb].version;Array.add(ca,Object.assign(new m,{Name:Uc,Version:Od}))}return ca}static m_h(){const X=new k,ca=new Sys.StringBuilder;y.Rv(Qb=>
{X.DocElemClientHeight=Qb},()=>document.documentElement.clientHeight,ca);y.Rv(Qb=>{X.DocElemClientWidth=Qb},()=>document.documentElement.clientWidth,ca);y.Rv(Qb=>{X.DocElemOffsetHeight=Qb},()=>document.documentElement.offsetHeight,ca);y.Rv(Qb=>{X.DocElemOffsetWidth=Qb},()=>document.documentElement.offsetWidth,ca);y.Rv(Qb=>{X.ScreenAvailHeight=Qb},()=>window.screen.availHeight,ca);y.Rv(Qb=>{X.ScreenAvailWidth=Qb},()=>window.screen.availWidth,ca);y.Rv(Qb=>{X.ScreenWidth=Qb},()=>window.screen.width,
ca);y.Rv(Qb=>{X.ScreenHeight=Qb},()=>window.screen.height,ca);y.Rv(Qb=>{X.ScreenLogicalXdpi=Qb},()=>window.screen.logicalXDPI,ca);y.Rv(Qb=>{X.ScreenLogicalYdpi=Qb},()=>window.screen.logicalYDPI,ca);y.Rv(Qb=>{X.ScreenDeviceXdpi=Qb},()=>window.screen.deviceXDPI,ca);y.Rv(Qb=>{X.ScreenDeviceYdpi=Qb},()=>window.screen.deviceYDPI,ca);y.Rv(Qb=>{X.WinInnerHeight=Qb},()=>window.self.innerHeight,ca);y.Rv(Qb=>{X.WinInnerWidth=Qb},()=>window.self.innerWidth,ca);y.Rv(Qb=>{X.WinOuterHeight=Qb},()=>window.self.outerHeight,
ca);y.Rv(Qb=>{X.WinOuterWidth=Qb},()=>window.self.outerWidth,ca);y.Rv(Qb=>{X.WinOrientation=Qb},()=>window.self.orientation,ca);y.Rv(Qb=>{X.WinDevicePixelRatio=Qb},()=>window.self.devicePixelRatio,ca);y.Rv(Qb=>{X.SupportsTouch=Qb},()=>z.a.HJc,ca);y.Rv(Qb=>{X.NavAppName=Qb},()=>window.navigator.appName,ca);y.Rv(Qb=>{X.NavAppVersion=Qb},()=>window.navigator.appVersion,ca);y.Rv(Qb=>{X.NavLanguage=Qb},()=>window.navigator.browserLanguage||window.navigator.language,ca);y.Rv(Qb=>{X.NavUserAgent=Qb},()=>
window.navigator.userAgent,ca);y.Rv(Qb=>{X.NavPlatform=Qb},()=>window.navigator.platform,ca);y.Rv(Qb=>{X.NavPlugins=Qb},y.fei,ca);y.Rv(Qb=>{X.CalculatedDevicePixelRatio=Qb},()=>y.devicePixelRatio,ca);X.Error=ca.toString();return X}static get devicePixelRatio(){const X=window.devicePixelRatio;return isNaN(X)?window.screen.deviceXDPI/window.screen.logicalXDPI:X}static Rv(X,ca,Qb){try{const Uc=ca();X(Uc)}catch(Uc){Qb.isEmpty()||Qb.append(" | "),Qb.append(Uc.message||"null")}}}Object(v.a)(y,"BrowserInfoLogger",
null,[]);var C=a(261);class J{get name(){return"Common.App.BrowserInfoLogger"}Oj(){}init(){y.LGd()}dispose(){}static main(){C.a.instance.Mk(new J)}}Object(v.a)(J,"BrowserInfoLoggerPackage",null,[3,4]);var F=a(63);class K{constructor(X){this.uPc=X}stf(X){if(!this.uPc)return!0;X=F.a.Iqd(X);if(!X)return!1;X=X.toLowerCase();for(let ca=0;ca<this.uPc.length;ca++)if(X.endsWith(this.uPc[ca]))return!0;return!1}}Object(v.a)(K,"DomainAllowListManager",null,[]);class L{constructor(X,ca){this.nX=null;this.f2c=
X;this.url=ca}get Fae(){return F.a.V3(this.url)}get ut(){return this.f2c}q8d(){const X={},ca=this.ut;X.a=this.Fae;X.b=this.round(ca.navigationStart);X.c=this.round(ca.unloadEventStart);X.d=this.round(ca.unloadEventEnd);X.e=this.round(ca.redirectStart);X.f=this.round(ca.redirectEnd);X.g=this.round(ca.fetchStart);X.h=this.round(ca.domainLookupStart);X.i=this.round(ca.domainLookupEnd);X.j=this.round(ca.connectStart);X.k=this.round(ca.connectEnd);X.l=void 0!==ca.secureConnectionStart&&null!==ca.secureConnectionStart?
this.round(ca.secureConnectionStart):0;X.m=this.round(ca.requestStart);X.n=this.round(ca.responseStart);X.o=this.round(ca.responseEnd);X.q=this.round(ca.domInteractive);X.r=this.round(ca.domContentLoadedEventStart);X.s=this.round(ca.domContentLoadedEventEnd);X.t=this.round(ca.domComplete);X.u=this.round(ca.loadEventStart);X.v=this.round(ca.loadEventEnd);X.w=this.nX;return X}round(X){return Math.round(1E3*X)/1E3}}Object(v.a)(L,"PerformanceTimingEntry",null,[]);const S=(X,ca)=>{const Qb={};let Uc=null;
switch(X){case 0:Uc="ResourceTiming";X=ca.a;null!=X&&(Qb.Url=X);X=ca.b;null!=X&&(Qb.InitiatorType=X);X=null==ca.c?null:ca.c.toString();null!=X&&(Qb.RedirectStart=X);X=null==ca.d?null:ca.d.toString();null!=X&&(Qb.RedirectEnd=X);X=null==ca.e?null:ca.e.toString();null!=X&&(Qb.FetchStart=X);X=null==ca.f?null:ca.f.toString();null!=X&&(Qb.DomainLookupStart=X);X=null==ca.g?null:ca.g.toString();null!=X&&(Qb.DomainLookupEnd=X);X=null==ca.h?null:ca.h.toString();null!=X&&(Qb.ConnectStart=X);X=null==ca.i?null:
ca.i.toString();null!=X&&(Qb.ConnectEnd=X);X=null==ca.j?null:ca.j.toString();null!=X&&(Qb.SecureConnectionStart=X);X=null==ca.k?null:ca.k.toString();null!=X&&(Qb.RequestStart=X);X=null==ca.l?null:ca.l.toString();null!=X&&(Qb.ResponseStart=X);X=null==ca.m?null:ca.m.toString();null!=X&&(Qb.ResponseEnd=X);X=ca.n;null!=X&&(Qb.CustomText=X);X=null==ca.o?null:ca.o.toString();null!=X&&(Qb.DecodedBodySize=X);X=null==ca.p?null:ca.p.toString();null!=X&&(Qb.EncodedBodySize=X);ca=null==ca.q?null:ca.q.toString();
null!=ca&&(Qb.TransferSize=ca);break;case 1:Uc="PerformanceTiming",X=ca.a,null!=X&&(Qb.Url=X),X=null==ca.b?null:ca.b.toString(),null!=X&&(Qb.NavigationStart=X),X=null==ca.c?null:ca.c.toString(),null!=X&&(Qb.UnloadEventStart=X),X=null==ca.d?null:ca.d.toString(),null!=X&&(Qb.UnloadEventEnd=X),X=null==ca.e?null:ca.e.toString(),null!=X&&(Qb.RedirectStart=X),X=null==ca.f?null:ca.f.toString(),null!=X&&(Qb.RedirectEnd=X),X=null==ca.g?null:ca.g.toString(),null!=X&&(Qb.FetchStart=X),X=null==ca.h?null:ca.h.toString(),
null!=X&&(Qb.DomainLookupStart=X),X=null==ca.i?null:ca.i.toString(),null!=X&&(Qb.DomainLookupEnd=X),X=null==ca.j?null:ca.j.toString(),null!=X&&(Qb.ConnectStart=X),X=null==ca.k?null:ca.k.toString(),null!=X&&(Qb.ConnectEnd=X),X=null==ca.l?null:ca.l.toString(),null!=X&&(Qb.SecureConnectionStart=X),X=null==ca.m?null:ca.m.toString(),null!=X&&(Qb.RequestStart=X),X=null==ca.n?null:ca.n.toString(),null!=X&&(Qb.ResponseStart=X),X=null==ca.o?null:ca.o.toString(),null!=X&&(Qb.ResponseEnd=X),X=null==ca.p?null:
ca.p.toString(),null!=X&&(Qb.DomLoading=X),X=null==ca.q?null:ca.q.toString(),null!=X&&(Qb.DomInteractive=X),X=null==ca.r?null:ca.r.toString(),null!=X&&(Qb.DomContentLoadedEventStart=X),X=null==ca.s?null:ca.s.toString(),null!=X&&(Qb.DomContentLoadedEventEnd=X),X=null==ca.t?null:ca.t.toString(),null!=X&&(Qb.DomComplete=X),X=null==ca.u?null:ca.u.toString(),null!=X&&(Qb.LoadEventStart=X),X=null==ca.v?null:ca.v.toString(),null!=X&&(Qb.LoadEventEnd=X),ca=ca.w,null!=ca&&(Qb.CustomText=ca)}Qb.Table=Uc;return Sys.Serialization.JavaScriptSerializer.serialize(Qb)};
var W=a(55),G=a(176),O=a(331);class T{constructor(X,ca,Qb){this.Oi=X;this.Eae=this;this.aKg=(void 0===ca?null:ca)||(()=>window.location.href);this.vSc=new K(void 0===Qb?null:Qb)}run(){if(T.DS(window.performance))try{const Od=this.aKg();if(T.GSg.exec(Od)&&this.vSc.stf(Od)){var X=new L(window.performance.timing,Od);O.a.instance.zvj(X.ut.fetchStart);O.a.instance.Avj(X.ut.navigationStart);O.a.instance.uLb(W.a.nZh,"connectStart","requestStart");O.a.instance.uLb(W.a.vZh,"requestStart","responseStart");
O.a.instance.uLb(W.a.yZh,"responseStart","responseEnd");this.Eae.Wg(1,X.q8d());this.Oi.en(W.a.cza,X.ut.fetchStart);this.Oi.en(W.a.sZh,X.ut.domainLookupStart);this.Oi.en(W.a.rZh,X.ut.domainLookupEnd);this.Oi.en(W.a.pZh,X.ut.connectStart);this.Oi.en(W.a.zZh,X.ut.secureConnectionStart);this.Oi.en(W.a.oZh,X.ut.connectEnd);this.Oi.en(W.a.wZh,X.ut.requestStart);this.Oi.en(W.a.xnd,X.ut.responseStart);this.Oi.en(W.a.tZh,X.ut.responseEnd-X.ut.responseStart);this.Oi.en(W.a.xZh,X.ut.responseStart-X.ut.requestStart);
var ca=0,Qb=0,Uc=0;(()=>{let me=this.gek(Od);({transferSize:ca,Mid:Qb,fgd:Uc}=me);return me})().returnValue&&(this.Oi.en(W.a.AZh,ca),this.Oi.en(W.a.qZh,Uc),this.Oi.en(W.a.uZh,Qb));this.Oi.en(W.a.wnd,X.ut.navigationStart)}}catch(Od){x.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Od)}}gek(X){let ca,Qb,Uc;Uc=Qb=ca=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:ca,Mid:Qb,fgd:Uc};
X=window.performance.getEntriesByName(X,"navigation");if(void 0===X||null===X||1!==X.length)return{returnValue:!1,transferSize:ca,Mid:Qb,fgd:Uc};X=X[0];var Od=X.transferSize;void 0!==ca&&null!==ca&&(ca=Od);Od=X.decodedBodySize;void 0!==Od&&null!==Od&&(Uc=Od);X=X.encodedBodySize;void 0!==X&&null!==X&&(Qb=X);return{returnValue:!0,transferSize:ca,Mid:Qb,fgd:Uc}}Wg(X,ca){x.ULS.sendTraceTag(4551815,306,50,S(X,ca))}static get instance(){return T.La||(T.La=new T(G.a.instance,null,t.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?
t.AFrameworkApplication.fa.Ox("ResourceLoggerDomainAllowList"):null))}static DS(X){return!(void 0===X||null===X)&&!(void 0===X.timing||null===X.timing)}}T.La=null;T.GSg=RegExp("^https?://.*","i");Object(v.a)(T,"PerformanceTimingLogger",null,[403]);var I=a(107),N=a(139);class R{constructor(X,ca){this.nX=null;this.f2c=X;this.behavior=ca;this.url=this.ut.name}get Fae(){return 2===this.behavior?this.url:F.a.V3(this.url)}get ut(){return this.f2c}q8d(){const X={},ca=this.ut;X.a=this.Fae;X.b=ca.initiatorType;
X.c=this.round(ca.redirectStart);X.d=this.round(ca.redirectEnd);X.e=this.round(ca.fetchStart);X.f=this.round(ca.domainLookupStart);X.g=this.round(ca.domainLookupEnd);X.h=this.round(ca.connectStart);X.i=this.round(ca.connectEnd);X.j=void 0!==ca.secureConnectionStart&&null!==ca.secureConnectionStart?this.round(ca.secureConnectionStart):0;X.k=this.round(ca.requestStart);X.l=this.round(ca.responseStart);X.m=this.round(ca.responseEnd);X.o=this.round(R.Pza(ca,"decodedBodySize"));X.p=this.round(R.Pza(ca,
"encodedBodySize"));X.q=this.round(R.Pza(ca,"transferSize"));X.n=this.nX;return X}round(X){return Math.round(1E3*X)/1E3}static Pza(X,ca){return X[ca]}}Object(v.a)(R,"ResourceTimingEntry",null,[415]);var V=a(105),sa=a(145),U=a(43),ka=a(119),ja=a(177);class Da{constructor(X,ca,Qb){this.Xee=X;this.W4b=void 0===ca?null:ca;this.Fta={};this.JGg=void 0===Qb?100:Qb}wdk(X){var ca=X.name.toLowerCase();const Qb=F.a.a2(ca);this.P$f(Qb,ca)&&(Qb in this.Fta?x.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
Qb):(ca={},ca.fetchstart=X.fetchStart,ca.responseend=X.responseEnd,ca.iscached=this.yyf(X),ca.encodedsize=R.Pza(X,"encodedBodySize"),ca.decodedsize=R.Pza(X,"decodedBodySize"),this.Fta[Qb]=ca))}xdk(X){var ca=X.name.toLowerCase();const Qb=F.a.a2(ca);this.OHj(Qb,ca)&&(Qb in this.Fta?x.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",Qb):(ca={},ca.fetchstart=X.fetchStart,ca.responseend=X.responseEnd,ca.iscached=this.yyf(X),ca.encodedsize=R.Pza(X,
"encodedBodySize"),ca.decodedsize=R.Pza(X,"decodedBodySize"),ca.it=X.initiatorType,ca.ress=X.responseStart,ca.cs=X.connectStart,ca.ce=X.connectEnd,ca.dls=X.domainLookupStart,ca.dle=X.domainLookupEnd,ca.rs=X.redirectStart,ca.re=X.redirectEnd,ca.reqs=X.requestStart,ca.scs=X.secureConnectionStart,this.Fta[Qb]=ca))}P$f(X,ca){if(this.Xee)return Array.contains(this.Xee,X);if(this.W4b)for(X=F.a.mK(ca),ca=0;ca<this.W4b.length;ca++)if(this.W4b[ca]&&X.endsWith(this.W4b[ca]))return!0;return!1}OHj(X,ca){return this.P$f(X,
ca)?X.endsWith(".js")||X.endsWith(".css"):!1}yyf(X){try{const ca=R.Pza(X,"transferSize");if(void 0!==ca&&null!==ca)return!ca;x.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return X.responseEnd-X.fetchStart<this.JGg}catch(ca){x.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",ca.message)}return!1}Yvj(){if(ka.a.Vi(this.Fta))x.ULS.sendTraceTag(575931855,306,
15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var X=t.AFrameworkApplication.flightId?t.AFrameworkApplication.flightId.split(";"):[],ca=Object.assign(new ja.a,{extendedProperties:sa.a.Pt()});ca.extendedProperties.set("Flights",U.c(X));this.ETi(ca,this.Fta,V.Health.instance)}}qod(X){let ca=0,Qb=0,Uc=0,Od=0;const me=this.Fta;for(let jf in me){var Oe=me[jf];jf.endsWith(".js")&&(Oe=Object(N.a)(Object,Oe),Oe.responseend<X&&(ca+=1,Qb+=Oe.decodedsize,Od+=Oe.encodedsize,Uc+=Oe.iscached?
0:Oe.encodedsize))}X={};X.filesLoaded=ca;X.decodedBytes=Qb;X.transferredBytes=Uc;X.encodedBytes=Od;return X}ETi(X,ca,Qb){if(ca){var Uc=0,Od=0,me=0,Oe=0,jf=0,kf=0,Kf=0,cg=0,jg=0,$f=0,Jg=0;for(let Fb in ca){var Aa=ca[Fb];try{const kc=Object(N.a)(Object,Aa);if(!kc)continue;const Dc=kc.iscached?Boolean.parse(kc.iscached.toString()):!1,Fd=kc.fetchstart?this.parseFloat(kc.fetchstart.toString()):0,be=(kc.responseend?this.parseFloat(kc.responseend.toString()):0)-Fd,Wd=kc.encodedsize?this.parseFloat(kc.encodedsize.toString()):
0,Je=kc.decodedsize?this.parseFloat(kc.decodedsize.toString()):0;Uc+=be;Oe+=Wd;Kf+=Je;$f++;Dc?(me+=be,kf+=Wd,jg+=Je,Jg++):(Od+=be,jf+=Wd,cg+=Je)}catch(kc){x.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",kc.message)}}X.extendedProperties.set("StaticResources",U.c(ca));X.extendedProperties.set("TotalResourceDownloadLatency",Uc.toString());X.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Od.toString());X.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",
me.toString());X.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Oe.toString());X.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",jf.toString());X.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",kf.toString());X.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Kf.toString());X.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",cg.toString());X.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",jg.toString());
X.extendedProperties.set("TotalNumberOfResourcesDownloaded",$f.toString());X.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Jg.toString());Qb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);Qb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",X)}}parseFloat(X){if(!X)return 0;X=parseFloat(X);return isNaN(X)?0:X}}Object(v.a)(Da,"AppStaticResourceManager",null,[]);class qa extends Sys.EventArgs{constructor(X){super();this.entries=
X}}Object(v.a)(qa,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var Ba=a(114);class ua{constructor(X,ca,Qb,Uc,Od,me){Qb=void 0===Qb?null:Qb;Uc=void 0===Uc?null:Uc;Od=void 0===Od?100:Od;me=void 0===me?!1:me;this.uWc=!1;this.Sk=null;this.Cnb=0;this.Za=new I.a;this.cHa=null;this.OV=!1;this.fxe=0;this.Uf=X;this.Uhe=0;this.Eae=this;this.vSc=new K(Qb);this.tx=ca;Uc&&(this.cHa=new Da(null,Uc,Od));this.oFg=me}get xJe(){try{return!(void 0===this.tx||null===this.tx)&&!(void 0===this.tx.getEntriesByType||null===
this.tx.getEntriesByType)}catch(X){return x.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",X),!1}}get Axh(){return this.Uhe}get isActive(){return this.OV}get f8d(){return this.fxe}BZg(X){this.Za.addHandler(ua.qjd,X)}BBj(X){this.Za.removeHandler(ua.qjd,X)}Oj(X,ca){const Qb=this.f8d!==X;this.fxe=X;this.isActive&&this.Uf&&Qb&&(this.hr(),this.Ah());this.Uhe=ca}activate(){!this.isActive&&this.xJe&&(this.Ah(),this.OV=!0)}deactivate(X){this.isActive&&
(this.hr(),X&&this.flush(),this.OV=!1)}flush(){if(this.isActive&&this.xJe)try{var X=window.performance.getEntriesByType("resource");0<X.length-this.Cnb&&x.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",X.length-this.Cnb);const ca=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);ca&&(window.performance.clearResourceTimings(),this.Cnb=0);const Qb=[];for(let Uc=this.Cnb;Uc<
X.length;Uc++)this.vSc.stf(X[Uc].name)&&(this.cHa&&(this.oFg?this.cHa.xdk(X[Uc]):this.cHa.wdk(X[Uc])),Qb.push(new R(X[Uc],this.Axh)));ca||(this.Cnb=X.length);this.Za.raiseEvent(ua.qjd,new qa(Qb));for(X=0;X<Qb.length;X++)0!==Qb[X].behavior&&2!==Qb[X].behavior||this.Eae.Wg(0,Qb[X].q8d());0<Qb.length&&x.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",Qb.length)}catch(ca){x.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",
ca)}}Wg(X,ca){x.ULS.sendTraceTag(4310804,306,50,S(X,ca))}yvj(){this.cHa.Yvj()}qod(X){return this.cHa.qod(X)}Ah(){this.Uf&&0<this.f8d&&(this.Sk=new Ba.a(3,2,1E3*this.f8d,()=>{this.flush()},5),this.Uf.Ah(this.Sk),this.uWc=!0)}hr(){this.uWc&&(this.Uf.hr(this.Sk),this.Sk=null,this.uWc=!1)}}ua.qjd="EntriesAvailable";Object(v.a)(ua,"ResourceTimingLogger",null,[388,403]);var pa=a(122);class Ka{constructor(){this.Rc=null}get name(){return"Common.ResourceTiming"}init(){this.Rc.resolve("Common.NetworkTiming.IResourceTimingLogger");
T.instance.run()}dispose(){}Oj(X){this.Rc=X;let ca=null;if(t.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{ca=t.AFrameworkApplication.fa.Ox("ResourceLoggerDomainAllowList")}catch(me){x.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const Qb=[];Qb.push(F.a.mK(pa.a.xL).toLowerCase());Qb.push(F.a.mK(pa.a.hjb).toLowerCase());const Uc=t.AFrameworkApplication.fa.Af("AppStaticResourceMonitorCacheThresholdInMs",100),Od=t.AFrameworkApplication.fa.qa("PPTAggregateResourceTimingV2Enabled");
X.register(388,"Common.NetworkTiming.IResourceTimingLogger").se().Ae(()=>new ua(t.AFrameworkApplication.Lj,window.performance,ca,Qb,Uc,Od))}static main(){C.a.instance.Mk(new Ka)}}Object(v.a)(Ka,"ResourceTimingPackage",null,[3,4]);var $a=a(80);class ha extends Sys.EventArgs{constructor(X,ca){super();this.U9j=X;this.actualValue=ca}}Object(v.a)(ha,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var cb=a(123);class Ia{constructor(){this.t_a=[];this.rhe=this.MRc=0;this.Oia=null;this.Za=new I.a}init(X,
ca,Qb){this.Oia=X;this.MRc=ca;this.rhe=Qb;this.Oia.KCe(Object($a.a)(this,this.M6i,"onCpuMeterFrameAvailable"));this.Z_g(Object($a.a)(this,this.yoh,"cpuPercentThresholdExceeded"))}M6i(X,ca){ca.aJf&&(Array.enqueue(this.t_a,ca.aJf.CP),this.t_a.length>this.rhe&&(Array.dequeue(this.t_a),this.ngh()))}ngh(){var X=this.t_a.length;let ca=0;for(let Qb=0;Qb<X;Qb++){const Uc=Array.dequeue(this.t_a);ca+=Uc;Array.enqueue(this.t_a,Uc)}X=ca/X;X>this.MRc&&this.Za.raiseEvent("CPTTE",new ha(this.MRc,X))}yoh(X,ca){cb.a(16782158,
306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.Aqh(ca.U9j,ca.actualValue))}Z_g(X){this.Za.addHandler("CPTTE",X)}Aqh(X,ca){const Qb={};Qb.ThresholdValue=X;Qb.ActualValue=ca;return Qb}}Object(v.a)(Ia,"CpuMeterMonitor",null,[406]);var ob=a(181);class gb{constructor(){this.S=this.T=this.M=this.C=0}}Object(v.a)(gb,"ProfileInformation",null,[]);var Za=a(14),da=a(49),ya=a(267);class ib{constructor(X,ca){this.SUc=!1;this.lIa={};this.k2b=void 0===X?0:X;this.t2b=void 0===ca?0:ca;this.v2c=0;da.a.addHandler(window.self,
Za.a.C2g,()=>{this.SUc=!0});da.a.addHandler(window.self,Za.a.D2g,()=>{this.SUc=!1})}eEe(X,ca,Qb){const Uc=ib.generateKey(ca,Qb);Uc in this.lIa?ca=this.lIa[Uc]:(ca=new gb,ca.S=Qb?1:0,this.lIa[Uc]=ca,this.v2c++);ca.C++;ca.M=X>ca.M?X:ca.M;ca.T+=X}qS(X,ca){this.eEe(X,ca,!1);this.SUc&&this.eEe(X,ca,!0)}getData(){if(0<this.t2b&&this.v2c>this.t2b)return this.n6h();const X=0<this.k2b,ca={},Qb=this.lIa;for(let Od in Qb){var Uc=Od;const me=Qb[Od];this.cbg(me);X&&me.T>=this.k2b&&(ca[Uc]=me)}return X?ka.a.Vi(ca)?
null:ca:this.lIa}n6h(){var X=0<this.k2b,ca=[];const Qb=this.lIa;for(let Uc in Qb){const Od={key:Uc,value:Qb[Uc]};let me=Od.value;(!X||me.T>=this.k2b)&&Array.add(ca,Od)}if(ca.length>this.t2b)ca.sort((Uc,Od)=>Od.value.T-Uc.value.T),ca=ca.slice(0,this.t2b);else if(!ca.length)return null;X={};for(const Uc of ca)ca=Uc.value,this.cbg(ca),X[Uc.key]=ca;return X}cbg(X){X.M=ya.a.naa(X.M,0);X.T=ya.a.naa(X.T,0)}reset(){this.lIa={};this.v2c=0}static generateKey(X,ca){return ca?X+" [it]":X}}Object(v.a)(ib,"FunctionCallAggregator",
null,[217]);class vb{}vb.V7g="BatchedOperation";vb.replication="Replication";vb.Lek="25";vb.PEj="9_"+vb.V7g+"_"+vb.replication;Object(v.a)(vb,"CpuMeterConstants",null,[]);class eb{}Object(v.a)(eb,"CpuMeterFrame",null,[]);class Ta extends Sys.EventArgs{constructor(X){super();this.aJf=X}}Object(v.a)(Ta,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class La{}Object(v.a)(La,"MiniTaskItemInfo",null,[]);class fb{}Object(v.a)(fb,"TaskItemInfo",null,[]);var Pb=a(564),Sa=a(108);class Wa{static Bli(){if(!Wa.nZb&&
(Wa.nZb=new Sa.a,t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.Mr("AggregatorIdDisabledList"))){const X=t.AFrameworkApplication.fa.Ox("AggregatorIdDisabledList");for(let ca=0;ca<X.length;ca++)Wa.nZb.ga(X[ca],!0)}return Wa.nZb}}Wa.nZb=null;Object(v.a)(Wa,"DisabledAggregatorListStore",null,[]);var pb=a(270);class wa{constructor(X,ca,Qb,Uc,Od,me,Oe){me=void 0===me?!0:me;Oe=void 0===Oe?null:Oe;this.L_=this.vwe=this.Ine=!1;this.Uf=null;if(!X)throw pb.a.argument("taskManagerLazy");if(!Od)throw pb.a.argument("dataAggregator");
this.TRg=X;this.UYc=ca;this._id=Qb;this.Yle=6E4*Uc;this.A_b=Od;this.Ite=me;this.Erb=Oe;Wa.Bli().Wc(this._id.toString())&&(this.L_=!0)}get taskManager(){return this.Uf||(this.Uf=this.TRg.value)}track(X,ca){ca=void 0===ca?null:ca;this.L_||(this.rHh(),this.rLj(),this.A_b.qS(X,ca))}rLj(){!this.Ine&&0<this.Yle&&(this.Ine=!0,this.Scg())}Scg(){const X=new Ba.a(5,1,this.Yle,()=>{this.sNj()},19,this._id.toString());this.taskManager.Ah(X)}sNj(){!this.Erb||this.Erb.jXj()?this.Udg():this.Ite&&this.A_b.reset();
this.Scg()}Udg(){const X=this.A_b.getData();if(X){const ca=parseInt(String(X.length));if(isNaN(ca)||0<ca)this.EFc(X),this.Ite&&this.A_b.reset()}}EFc(X){x.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:X})}rHh(){this.vwe||(this.UYc(()=>{this.Udg()}),this.vwe=!0)}static HP(X,ca,Qb,Uc,Od){return new wa(new Pb.a(()=>t.AFrameworkApplication.Lj),t.AFrameworkApplication.fkb,X,ca,Qb,Uc,Od)}static L8a(X,ca,Qb){return wa.HP(X,ca,Qb,!0,null)}}Object(v.a)(wa,"Aggregator",
null,[218]);class hb{constructor(X){X=void 0===X?null:X;this.Qo=null;this.reset();this.Erb=X}qS(X,ca){if(!this.Erb||this.Erb.jXj())ca in this.Qo||(this.Qo[ca]=[]),this.Qo[ca].push(X)}getData(){return ka.a.count(this.Qo)?this.Qo:null}reset(){this.Qo={}}}Object(v.a)(hb,"NamedValuesAggregator",null,[217]);var Sb=a(238);class Bc{constructor(X,ca,Qb,Uc,Od){this.KJa=0;this.OG=null;this.e4b=this.fwe=0;this.wue=!1;this.U_a=0;this.upb=!1;this.hva=null;this.h1b=0;this.ore=new I.a;this.RRg=[];this.wO=X;this.NXc=
ca;this.FTc=Qb;this.ype=Uc;t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.EEd();this.kJg=Od;this.GTc=new ib(100);this.eNg=wa.L8a(1,5,new hb)}KCe(X){this.ore.addHandler("OnCpuMeterFrameAvailable",X)}jgb(X,ca,Qb,Uc){Qb=(Uc=void 0===Uc?null:Uc)?Uc.priority:7;const Od=this.wO();this.start(ca,Qb);try{X()}finally{this.stop(ca,Uc),X=this.wO()-Od,this.ype.track(X,ca)}}oZ(X,ca){const Qb=this.wO();try{X()}finally{X=this.wO()-Qb,this.FTc.qS(X,ca),0<this.KJa&&
this.GTc.qS(X,ca),this.ype.track(X,ca)}}IOd(X){const ca=new fb;ca.TN=X.ruc;ca.TP=X.priority;this.o2f(1,ca)}odb(X){this.h1b|=X}start(X,ca){if(!this.KJa){this.GTc.reset();const Qb=this.Lyf(X);Qb&&this.HId(1);this.OG=new fb;this.OG.TN=X;this.OG.TP=ca;this.OG.ST=(new Date).toISOString();this.OG.STS=ya.a.naa(this.wO(),2);Qb?this.OG.UI=1:this.IHi(X)?this.OG.UI=2:this.OG.UI=0}this.KJa++}HId(X){this.U_a|=X}Aad(X,ca){this.U_a=void 0===X||X?0:this.U_a&~(void 0===ca?0:ca)}stop(X,ca){ca=void 0===ca?null:ca;let Qb;
this.KJa--;0>=this.KJa&&this.OG&&(Qb=this.wO()-this.OG.STS,this.e4b+=Qb,this.NXc.qS(Qb,X),this.Lyf(X)&&this.Aad(!1,1),this.OG.TRT=ya.a.naa(Qb,2),ca&&(this.OG.TQT=ya.a.naa(ca.Vrj,2),this.OG.TDT=ya.a.naa(ca.dAf,2)),this.kJg&&(this.o2f(0,this.OG),this.AFj()),this.KJa=0);0<=X.indexOf(vb.Lek)&&this.odb(2);0<=X.indexOf(vb.PEj)&&this.odb(4);1===(this.U_a&1)&&this.odb(1);2===(this.U_a&2)&&this.odb(8)}AFj(){var X=this.OG.TRT;if(750<X){let Qb=this.GTc.getData();if(Qb){const Uc={};for(let Od in Qb){var ca=Qb[Od];
const me=Od;me.startsWith("SiOp_")||me.endsWith("[it]")||(Uc[me]=Math.round(100*ca.T/X))}Qb=Uc}X=Object.assign(new La,{B:this.OG.STS,T:X,S:Qb});this.eNg.track(X,this.OG.TN)}}W3j(){var X=this.wO()-this.fwe,ca=ya.a.naa(this.e4b/X*100,2);X=new eb;X.CP=ca;X.II=this.h1b;ca=this.NXc.getData();ka.a.count(ca)&&(X.LRT=ca);ca=this.FTc.getData();ka.a.count(ca)&&(X.FP=ca);this.ore.raiseEvent("OnCpuMeterFrameAvailable",new Ta(X));this.sng()}sng(){this.NXc.reset();this.FTc.reset();this.e4b=this.KJa=0;this.fwe=
this.wO();this.h1b=0;this.OG=null}run(){this.wue?this.W3j():(this.sng(),this.wue=!0);this.hva?this.hva(Object($a.a)(this,this.run,"run"),1E3):window.setTimeout(Object($a.a)(this,this.run,"run"),1E3)}o2f(X,ca){X=this.RRg[X];if(!Sb.a.Vi(X))for(let Uc=0;Uc<X.length;Uc++){var Qb=X[Uc];const Od=Qb[0];Qb=Qb[1];Od&&!Od(ca)||Qb(ca)}}EEd(){if(!this.upb){const X=window.setTimeout;this.hva=(ca,Qb)=>X(ca,Qb);this.upb=!0}}Lyf(X){return X.startsWith("key")||X.startsWith("input")}IHi(X){return X.startsWith("click")||
X.startsWith("mouse")||X.startsWith("pointer")}}Object(v.a)(Bc,"CpuMeter",null,[112]);class ab{constructor(X){this.Anb=null;this.ym=new ob.a;this.wO=X}initialize(X,ca,Qb,Uc){this.Anb||(this.Anb=new Bc(this.wO,X,ca,Qb,void 0===Uc?!1:Uc),this.ym.setResult(this.Anb));return this.Anb}}Object(v.a)(ab,"CpuMeterProvider",null,[405]);class qb{constructor(X){this.Oz=[];this.I_b=[];this._count=void 0===X?1:X}lWh(){let X=0;for(let ca=0;ca<this.Oz.length;ca++)this.Oz[ca]<this.Oz[X]&&(X=ca);return X}qS(X,ca){X=
ya.a.naa(X,2);if(this.Oz.length<this._count)Array.add(this.Oz,X),Array.add(this.I_b,ca);else{var Qb=this.lWh();X>this.Oz[Qb]&&(this.Oz[Qb]=X,this.I_b[Qb]=ca)}}getData(){return this.Oz.length?{["Vals"]:this.Oz,["Desc"]:this.I_b}:null}reset(){this.Oz=[];this.I_b=[]}}Object(v.a)(qb,"MaxDataAggregator",null,[217]);var mc=a(42),yb=a(84);class vc{get name(){return"Common.App.CpuMeter"}Oj(X){X.register(ab,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").se().Ae(()=>new ab(mc.a.Kf));
X.register(Ia,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").se().Ae(()=>new Ia)}init(){const X=t.AFrameworkApplication.fa;if(X.qa("CpuMeterIsEnabled")){const ca=yb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");O.a.instance.dFe.continueWith(()=>{vc.Rwi(X,ca)})}}dispose(){}static Rwi(X,ca){const Qb=wa.L8a(10,5,new ib(X.Af("TaskManagerLoggingThreshold",0),X.Af("CpuMeterMaximumEntriesToLog",0)));ca=ca.initialize(new qb(5),new ib,Qb,X.qa("CPUMeterExposeTaskDetailsIsEnabled"));
X.qa("WordEditorInteractivePerfDisableCpuMeterFrames")||(ca.run(),X.qa("CpuMeterMonitorIsEnabled")&&yb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ca,X.n8("CpuMeterAverageCpuPercentThreshold",80),X.Af("CpuMeterRollingAverageFramesCount",15)));cb.a(16827671,306,50,"Initializing CpuMeter")}static main(){C.a.instance.Mk(new vc)}}Object(v.a)(vc,"CpuMeterPackage",null,[3,4]);var Db=a(1E3);class Ga{get name(){return"Common.App.EventsCachePackage"}Oj(){}init(){Db.a.instance.init()}dispose(){}static main(){C.a.instance.Mk(new Ga)}}
Object(v.a)(Ga,"EventsCachePackage",null,[3,4]);var Eb=a(10),Zb=a(234),ic=a(908),mb=a(183),Hb=a(386),Wb=a(254),Ob=a(167),Gc=a(59),Va=a(94),Jb=a(1),ub=a(24),Qa=a(174),P=a(765);class ta extends ic.a{constructor(X,ca,Qb){super(ca,Qb);this.Ua=new I.a;this.iti=Uc=>{if(Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Od=Uc.Values.m_Origin;t.AFrameworkApplication.wopiHostOriginFromPostMessage||(t.AFrameworkApplication.wopiHostOriginFromPostMessage=Od)}switch(Uc.MessageId){case mb.a.qwd:Qa.a(this.$).jlf(Uc);
break;case mb.a.pGd:Ob.a.ltas(null);break;case mb.a.Cnc:this.iaj();break;case mb.a.uwd:this.haj(Uc)}};this.$=X;Qb!==P.a.mM&&this.pS(Qb);this.dyi();this.mxi();X=this.iti;this.em(mb.a.qwd,X);this.em(mb.a.pGd,X);this.em(mb.a.Cnc,X);this.em(mb.a.uwd,X)}dispose(){this.$=null;super.dispose()}dyi(){this.Vn(mb.a.gLe);this.Vn(mb.a.qwd);this.Vn(mb.a.Cnc);this.Vn(mb.a.uwd);this.G2a(mb.a.pGd);this.Vn(mb.a.twd)}mxi(){this.oW(mb.a.Ssb);this.oW(mb.a.s1);this.oW("App_CloseTab");this.oW(mb.a.AZa);this.oW(mb.a.BZa);
this.oW(mb.a.dof);this.oW(mb.a.znc);this.oW("App_ModifyURLState")}iaj(){const X={};X.hostMessageReceived=(new Date).getTime();x.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");t.AFrameworkApplication.Xrc=!0;X.appUnloadStart=(new Date).getTime();X.sendBeaconFlight=t.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");X.sendBeaconSupported=Gc.a.Gha();Gc.a.oFe();X.appUnloadEnd=(new Date).getTime();X.appMessageSent=(new Date).getTime();this.sendMessage(mb.a.V3g,X)}haj(X){x.ULS.sendTraceTag(537162882,
0,50,"EwaHostMessenger.OnHostSwitchMode");X.Values&&Hb.a.EKd in X.Values&&ub.a.equals(X.Values[Hb.a.EKd],Wb.a.edit,!0)&&!this.$.isEditMode&&(x.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${X.Values[Hb.a.EKd]}`),X=new Va.a(-8805455,0,1,0,null),this.$.Ha.kd(X))}}Object(v.a)(ta,"EwaHostMessenger",ic.a,[402,387,5]);class Z extends Zb.a{constructor(X){super();this.uQe=!1;this.$=X;this.Md()}create(){const X=this.$.ea,ca=yb.a.instance;if(!this.uQe){this.uQe=!0;let Qb;
Qb=Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||P.a.mM:t.AFrameworkApplication.aRd||P.a.mM;ca.register(ta,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").se().Ae(()=>new ta(this.$,window.parent,Qb,t.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.qd(X.Ba(21)||X.Ja(21,ca.resolve("Postmessage.IHostPostmessenger")))}}Object(v.a)(Z,"HostMessengerFactory",
Zb.a,[]);var aa=a(118),Ea=a(179),za=a(713),bb=a(565),Mb=a(87),zb=a(142),oa=a(48),Xa=a(328),bc=a(335),Ac=a(334),Xc=a(441),Ed=a(7),Qd=a(56),zd=a(76);class fe{constructor(X,ca,Qb){this.correlations=this.properties=this.operation=null;this.operation=X;this.properties=ca;this.correlations=Qb}static KTh(X,ca,Qb){const Uc={},Od=Qd.b();switch(X.command){case -1537138325:Uc.Action=ca.LabelText;break;case -1104934572:Uc.PrevTab=Od.pl(parseInt(ca.OldContextCommand,10));Uc.NextTab=Od.pl(parseInt(ca.NewContextCommand,
10));break;case 802602464:Uc.Origin=ca[Ed.a.bK];break;case -1027730316:case -1059615499:Uc.MenuType=ca.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in ca&&(Uc.SqmControlId=ca.SqmControlId);break;case 1371713064:case 875133075:zd.a.Ie in ca&&(Uc.SampleTableId=ca[zd.a.Ie])}Uc.InputMethod=bc.a[X.method];Uc.Location=Ac.a[X.Hg];Uc.Mode=Xc.a[X.mode];Uc.ParentName=X.tabName;Uc.IsSystemInitiated="IsSystemInitiated"in ca?ca.IsSystemInitiated:
!1;Uc.NoReporting="NoReporting"in ca?ca.NoReporting:!1;"ControlIdToLog"in ca&&(Uc.ControlId=ca.ControlIdToLog);"TerminalParentControlIdToLog"in ca&&(Uc.TerminalParentControlId=ca.TerminalParentControlIdToLog);for(const me of Object.keys(Qb))Uc[me]=Qb[me];return Uc}}Object(v.a)(fe,"InteractivityRecord",null,[]);class jd extends fe{constructor(X,ca,Qb){super(X.operation,X.properties,X.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=ca;this.timeFromNavigationStart=
Qb}}Object(v.a)(jd,"FirstUserInteractivityRecord",fe,[]);var Xb=a(662);class Lc{constructor(){this.commandSurface=this.triggerMethod=aa.a.olb}static exi(){Lc.d8a||(Lc.d8a=new Xb.a(bb.a.Qh()),Lc.d8a.add("InputMethod"),Lc.d8a.add("Location"),Lc.d8a.add("Mode"))}}Lc.d8a=null;Object(v.a)(Lc,"ExcelUserAction",null,[]);var Bd=a(225),Nc=a(50),rb=a(440),va=a(155),yc=a(151),Zc=a(19);class cc extends Mb.a{constructor(X){super();this.Pqf=0;this.o8e=!1;this.ZEd=Array(cc.sdb);this.tdc=0;this.$=X;this.lyf=Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");
aa.a.ydi();this.nfa={};cc.m6b||(cc.m6b=new za.a(bb.a.Qh()),cc.nwi(cc.m6b));Lc.exi();if(Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(X=0;X<cc.sdb;X++)this.ZEd[X]="NA"}dispose(){this.$=this.nfa=null;super.dispose()}V8f(X,ca,Qb){const Uc=Qd.b().pl(X.command),Od=JSON.stringify(X);Uc||x.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${Uc}, command: ${X.command}, commandInfo: ${Od}`);ca=fe.KTh(X,
ca,Qb);Qb=!!ca&&(!("IsSystemInitiated"in ca)||!ca.IsSystemInitiated);this.$&&this.$.da.Og&&Qb&&Db.a.instance.T3f("OtelUserAction",new rb.a(Uc,X.tabName,Date.now()));this.i9f(Uc,ca,null,!0,!0)}Xe(X,ca,Qb,Uc){this.i9f(X,ca,void 0===Qb?null:Qb,!1,void 0===Uc?!1:Uc)}UIc(X){if(this.nfa){++this.Pqf;this.nfa[X]||(this.nfa[X]=[]);var ca=this.Pqf.toString();this.nfa[X].push(ca);x.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${X}', correlation=${ca}`)}else x.ULS.shipAssertTag(537155554,
0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${X}] == null`)}fJc(X){if(this.nfa&&this.nfa[X]){var ca=this.nfa[X],Qb=ca.pop().toString();ca.length||delete this.nfa[X];x.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${X}', correlation=${Qb}`)}else x.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${X}] == null`)}US(X,ca,Qb){Qb=void 0===Qb?!1:
Qb;return Xa.b(Uc=>{this.Xe(X,Uc(),void 0,Qb)},cc.W9j,this.ka,oa.a.aAi,!1,!ca)}jXd(){let X="";for(let ca=0;ca<cc.sdb;ca++)X+=this.ZEd[(this.tdc+cc.sdb-ca-1)%cc.sdb]+",";x.ULS.sendTraceTag(557188890,0,15,`Last operations ${X}`)}Xik(X){X&&(this.ZEd[this.tdc]=X,this.tdc=(this.tdc+1)%cc.sdb)}BTi(X,ca,Qb){t.AFrameworkApplication.cgc();const Uc=X.operation,Od=X.properties;void 0!==Qb?void yc.a.resolve(Zc.Ub,{Qa:0}).then(me=>{me.$vj(Uc,Od,Qb)}):this.Uek(X);this.Vek(X);this.Oij(ca,Od,Uc)}Uek(X){this.a3j(X)||
(this.o8e=!0,X=new jd(X,Nc.PageLoadTrackingInfo.instance.Qza(new Date),Nc.PageLoadTrackingInfo.tA()),X=Sys.Serialization.JavaScriptSerializer.serialize(X),x.ULS.sendTraceTag(458261331,0,50,`${X}`))}a3j(X){const ca=X.properties;X=X.operation;return this.o8e||void 0===X||null===X||X===zb.a.J3c||X===zb.a.v_d||X===zb.a.yRd||Gc.a.fCd(X)||!!ca&&"IsSystemInitiated"in ca&&ca.IsSystemInitiated}Vek(X){Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Xik(X.operation);
X=Sys.Serialization.JavaScriptSerializer.serialize(X);x.ULS.sendTraceTag(21542793,0,50,`${X}`)}Oij(X,ca,Qb){aa.a.dpa()&&(ca?"NoReporting"in ca&&ca.NoReporting||"IsSystemInitiated"in ca&&ca.IsSystemInitiated||!X&&!this.lyf||((X=aa.a.Ek(ca,cc.m6b,Lc.d8a))?(ca=cc.TTh(ca))?Ea.a.sendUserActionEvent(aa.a.adc(Qb,null,ca.triggerMethod,ca.commandSurface,X)):x.ULS.sendTraceTag(537155550,0,50,"user action was null"):x.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):x.ULS.sendTraceTag(537155548,
0,50,`Not logging action telemetry because adction data was null, actionName: ${Qb}`))}i9f(X,ca,Qb,Uc,Od){const me=Bd.a(this.$);if(this.lyf){let jf=null;ub.a.equals(X,zb.a.qFc,!0)&&ca&&"InputMethod"in ca&&(jf=zb.a.p9e(X,ca.InputMethod));me.zRb(jf||X,Qb)}else ub.a.equals(X,zb.a.qFc,!0)&&ca&&"InputMethod"in ca&&(X=zb.a.p9e(X,ca.InputMethod)),me.zRb(X,Qb);ca&&(ca.IsCommand=Uc);let Oe="ActionRelativeTime"in ca?ca.ActionRelativeTime:Nc.PageLoadTrackingInfo.tA();Object(va.c)(()=>{const jf=new fe(X,ca,this.nfa);
this.BTi(jf,Od,Oe)},this.$.ka,50)}static TTh(X){if(!X)return null;const ca=new Lc;"InputMethod"in X&&(ca.triggerMethod=X.InputMethod);"Location"in X&&(ca.commandSurface=X.Location);return ca}static nwi(X){X?(X.add("Origin",2),X.add("InputMethod",2),X.add("ButtonType",2),X.add("selectedRange",2),X.add("SelectedRanges",2),X.add("editRange",2),X.add("Location",2),X.add("Mode",2),X.add("CurrentSelectionMode",2),X.add("Action",2),X.add("type",2),X.add("floatingObjectType",2),X.add("PrevTab",2),X.add("NextTab",
2),X.add("DialogName",2),X.add("dx",3),X.add("dy",3),X.add("NumberOfSelectedRanges",3),X.add("IsCommand",1),X.add("IsInFormulaBarEdit",1),X.add("isLink",1),X.add("isSheetRef",1),X.add("isEmptyText",1),X.add("isFormula",1),X.add("IsResizingHiddenHeader",1)):x.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}cc.W9j=1E3;cc.sdb=40;cc.m6b=null;Object(v.a)(cc,"InteractivityLogger",Mb.a,[16]);var Le=a(2);class Re{constructor(){this.appInfoProperties=this.appState=null}}
Object(v.a)(Re,"CurrentAppInfo",null,[]);const Ib=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])}].forEach(X=>{X.actions.forEach(ca=>{Ib.set(ca,X.name)})});class Yc{constructor(){this.value=this.key=null}}Object(v.a)(Yc,"AppInfoProperty",null,[]);class Cb{constructor(X){this.$=X}getAppState(){const X=Nc.PageLoadTrackingInfo.instance.Qza(new Date);return-1===X?"boot":3E4>X?"postboot":"steady"}isChangeGateEnabled(X){return Jb.EwaSettings.isChangeGateEnabled(X)}getBooleanFeatureGate(X,ca){return Jb.EwaSettings.getBooleanFeatureGate(X,ca)}getCurrentAppInfo(){return Object(Le.a)(new Re,
{appState:this.getAppState(),appInfoProperties:[Object(Le.a)(new Yc,{key:"coauthCount",value:this.$.da.Kp.length.toString()})]})}sendBeaconTraceTag(X,ca,Qb,Uc){this.$.sendBeaconTraceTag(X,ca,Qb,Uc)}getActionBucket(X){return b(X)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.da.yYi}`}}Object(v.a)(Cb,"InteractivityTrackerCallbacks",null,[393]);class pc{constructor(){this.events=null;this.durationThresholdInMs=0;this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(v.a)(pc,
"InteractivityTrackerOptions",null,[]);const Mc=(X,ca)=>Io(function*(){return yc.a.resolve(Zc.O,ca).then(Qb=>Qb("interactivity"))});Object(yc.b)(Zc.zb,{Ux:"singleton"})(X=>Io(function*(){const ca=yield yc.a.resolve(Zc.R,X);yield Mc(ca,X);const Qb=interactivity.InteractivityTrackerFactoryGlobal.create();return new xd(ca,Qb)}));class xd{constructor(X,ca){this.u2=void 0===ca?null:ca;xd.$uf?x.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):
(this.initialize(X),xd.$uf=!0)}initialize(X){x.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||(this.u2=interactivity.InteractivityTrackerFactoryGlobal.create());if(this.u2){var ca=new pc;Jb.EwaSettings.NDd()&&xd.DJc.push(Za.a.jda);Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457630_addSupportedEventMouseUpAndTouchStart")&&(xd.DJc.push("mouseup"),
xd.DJc.push("touchstart"));ca.events=xd.DJc;ca.durationThresholdInMs=xd.durationThresholdInMs;ca.callbacks=new Cb(X);ca.patchTaskScheduling=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);X=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const Qb=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),Uc=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",
6E4);if(X||Qb)ca.periodicReport={isPassiveTestEnabled:Qb,intervalMs:Uc};ca=this.u2.start(ca);ca.started?x.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):x.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+ca.failureReason)}else x.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}YFa(X,ca,Qb){if(this.u2)return this.u2.track(X,ca,Qb);x.ULS.sendTraceTag(524326924,
0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${ca}`)}yUe(){return this.u2?this.u2.createActionsRetriever():(x.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.u2&&(this.u2.stop(),this.u2=null)}addContext(X,ca,Qb){this.u2?this.u2.addContext(X,ca,Qb):x.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}}
xd.durationThresholdInMs=100;xd.DJc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");xd.$uf=!1;Object(v.a)(xd,"InteractivityTrackerService",null,[368]);var Nd=a(737);class te extends Zb.a{constructor(X){super();this.$=X;this.Md()}create(){Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?void yc.a.resolve(Zc.O,{Qa:this.Na}).then(X=>X("interactivity")).then(()=>{Object(Nd.a)(this.$.ea,443,()=>new xd(this.$))}):this.qd(Object(Nd.a)(this.$.ea,
443,()=>new xd(this.$)))}static la(X){X.ea.Ja(444,new te(X))}}Object(v.a)(te,"InteractivityTrackerServiceFactory",Zb.a,[]);var tb=a(40),Gb=a(733),fd=a(96),lc=a(482),$c=a(9),Md=a(52),dd=a(61);class ee{constructor(X){this.H3j=X}getCustomProperties(X){const ca=new Map;if(X.hasOwnProperty("startTimeInMs")&&X.hasOwnProperty("totalExecutionTimeInMs")){const Qb=X.startTimeInMs;X=this.H3j.retrieveSlowActionsBetweenTimeRange(Qb,Qb+X.totalExecutionTimeInMs);ca.set("actions",dd.a.ye(X))}return ca}}Object(v.a)(ee,
"CallTreeCustomPropertiesRetriever",null,[392]);class Tc{constructor(){this.customProperties=new Map}addCustomProperty(X,ca){this.customProperties.set(X,ca)}getCustomProperties(){return this.customProperties}}Object(v.a)(Tc,"CustomPropertiesRetriever",null,[391]);class wd{isFeatureEnabled(X,ca){return Jb.EwaSettings.getBooleanFeatureGate(X,ca)}}Object(v.a)(wd,"ExcelFeatureChecker",null,[390]);class Kb{isProfilingEnabled(){return!0}}Object(v.a)(Kb,"ExcelProfilingFeatureChecker",null,[389]);class Vc{constructor(X,
ca){this.Rfj=X;this.Tfj=ca}onProfilerEvent(X){switch(X.eventId){case 1:this.Rfj(Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.Tfj();break;default:x.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${X.eventId}`)}}}Object(v.a)(Vc,"JSCPUProfilerObserver",null,[386]);class Hd{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=
null}}Object(v.a)(Hd,"JSCPUProfilerInitOptions",null,[]);class Xd{constructor(){this.profilerTraceLoggingChunkSize=this.shouldLogRawProfilerTrace=this.shouldRecordFrameCounts=this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=
this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=
this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(v.a)(Xd,"JSCPUProfilingPackageInitOptions",null,[]);class qe{filter(X){var ca,Qb,Uc;const Od=!Nc.PageLoadTrackingInfo.instance.TTSI||(null===(ca=X.serializedFrames[0])||void 0===ca?void 0:ca.startTimeInMs)<Nc.PageLoadTrackingInfo.instance.Hek;ca=(null===(Qb=X.propertyBag)||void 0===Qb?void 0:Qb.actions)&&"[]"!==X.propertyBag.actions;
Qb=!0;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7846441_dontSendUnmergedTreesPreTTSI")&&(Qb=0<(null===(Uc=X.serializedFrames[0])||void 0===Uc?void 0:Uc.totalExecutionTimeInMs));return Od&&Qb||ca}}Object(v.a)(qe,"CallTreeCustomFilterer",null,[382]);let $d=class{constructor(X,ca){this.interactivityTrackerService=this.zng=this.sSd=this.kgb=this.tSd=this.H0f=this.J0f=null;this.Bqj=new Set([1,0]);x.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=
X;this.interactivityTrackerService=ca;this.$xi();this.Zxi();this.cOi=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",16);this.profilingIntervalInMs=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.mRe=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.kjj=Jb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.N5j()}dispose(){x.ULS.sendTraceTag(537155527,
0,50,"JsSelfProfilerManager.Dispose");fd.a.Ma(this.zng);this.sSd=this.$=null;this.tSd.clear();this.kgb.clear()}c5j(){const X=Math.random()*this.mRe;x.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${X}`);this.zng=Md.a.instance.create(()=>{this.$ff("ExcelOnlineContinuousSessionProfiler",2).start()},X,oa.a.xWj,!0)}p5j(){x.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.$ff("ExcelOnlineFullSessionProfiler",
3).start()}I0f(X){return this.kgb.has(X)}N5j(){Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.p5j():this.c5j()}createProfiler(X,ca,Qb,Uc,Od,me){x.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const Oe=new Hd;Oe.samplingIntervalInMs=ca;Oe.maximumNumberOfSamplesToTake=Qb;Oe.idleIntervalInMs=Uc;Oe.profilingIntervalInMs=Od;return this.Bth(X,me,Oe)}Zxi(){const X=new Kb,ca=new Xd;ca.ulsInstance=new lc.a;ca.deObfuscationEndpoint=
"ProfilerReporting.ashx";ca.shouldCompressSerializedCallTrees=!1;ca.shouldKeepSamplesOutsideOfProfilingInterval=!1;ca.shouldSendAllCallTreesFromProfileInASingleRequest=!Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);ca.shouldUseSendBeaconForSendingCallTrees=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);ca.callTreeFilteringThresholdInMs=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",
1);ca.frameTotalExecutionTimeFilteringThresholdInMs=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);ca.deObfuscationRequestQueryParamsRetriever=this.sqh();ca.deObfuscationRequestBodyPropertiesRetriever=this.rqh();ca.featureEnabledChecker=new wd;ca.useMainEventLoopForProfilerTraceProcessing=!1;ca.profilerTraceProcessingWebWorkerSourceURL=this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;ca.shouldProcessProfileCapturedWhileUserIsIdle=
Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");const Qb=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldRecordProfilerFrameCounts",!1),Uc=Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldLogRawProfilerTrace",!1),Od=Jb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ProfilerTraceLoggingChunkSize",30);ca.shouldRecordFrameCounts=Qb;Uc&&(ca.shouldLogRawProfilerTrace=!0,ca.profilerTraceLoggingChunkSize=Od);
this.sSd=this.J0f.retrievePackage(X,ca).retrieveProfilerFactory()}sqh(){const X=new Tc;X.addCustomProperty($c.a.n1f,t.AFrameworkApplication.userType);X.addCustomProperty(t.AFrameworkApplication.kta,t.AFrameworkApplication.userSessionId);X.addCustomProperty($c.a.PKd,this.$.xa.SkipAuthentication?$c.a.qJf:null);X.addCustomProperty($c.a.QSd,this.$.xa.MachineCluster);return X}rqh(){const X=new Tc;X.addCustomProperty("appName","Excel");X.addCustomProperty("buildVersion",t.AFrameworkApplication.buildVersion);
X.addCustomProperty("shouldUseSourceMaps","true");X.addCustomProperty("shouldFilterSensitiveResources","true");X.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");return X}Bth(X,ca,Qb){const Uc=new Tc;Uc.addCustomProperty("ProfilerName",X);this.H0f.set(X,Uc);ca=this.sSd.createProfiler(ca,Qb,Uc);this.kgb.set(X,ca);X=this.Qrh(X);ca.subscribeProfilerObserver(X,this.Bqj);Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7875154_ProcessCallStacksWithActionOrBeforeTTSI")&&(X=new qe,ca.subscribeCallTreeCustomFilterer(X));
return ca}Vei(X){return this.I0f(X)?this.kgb.get(X):(x.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${X}) does not exist`),null)}$ff(X,ca){var Qb=void 0===Qb?null:Qb;X=this.kjj||X;if(this.I0f(X))return this.Vei(X);const Uc=this.cOi;return this.createProfiler(X,Uc,null!=Qb&&0<Uc?Qb/Uc:2E6,2===ca?this.mRe:null,0===ca?null:this.profilingIntervalInMs,ca)}Qrh(X){var ca=this.interactivityTrackerService;if(ca){const Qb=ca.yUe();if(Qb){ca=this.kgb.get(X);const Uc=
new ee(Qb);ca.subscribeCallTreeCustomPropertiesRetriever(Uc);ca=new Vc(Od=>{Qb.startCollectingSlowActions(Od)},Object($a.a)(Qb,Qb.stopCollectingSlowActions,"stopCollectingSlowActions"));this.tSd.set(X,ca);return ca}x.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}x.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null}$xi(){this.J0f=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.H0f=new Map;this.tSd=new Map;this.kgb=new Map}};$d=Object(Gb.a)([Object(yc.d)(Zc.Ab),Object(Gb.b)(0,Object(Zc.R)()),Object(Gb.b)(1,Object(Zc.zb)()),Object(Gb.b)(2,Object(Zc.Pb)())],$d);Object(v.a)($d,"JsSelfProfilerManager",null,[369,5]);var de=a(92);class le extends Zb.a{constructor(X){super();this.$=X;this.Md()}create(){x.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");
tb.TaskExtensions.ya((()=>de.d(yc.a.resolve(Zc.P,{Qa:this.Na})))(),X=>{Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)?void yc.a.cce(Zc.zb).then(ca=>{this.wTe(X.result,ca)}):this.$.ea.Zc(443,ca=>{this.wTe(X.result,ca)})},this.$.ka,3)}wTe(X,ca){tb.TaskExtensions.ya(de.d(X.lv.loadScript("officeOnlineCpuProfiling")),()=>{const Qb=Object(Nd.a)(this.$.ea,437,()=>new $d(this.$,ca));this.qd(Qb)},this.$.ka,3)}static la(X){X.ea.Ja(438,new le(X))}}Object(v.a)(le,
"JsSelfProfilerManagerFactory",Zb.a,[]);class $b{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(v.a)($b,"ActionData",null,[]);class wc{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(v.a)(wc,"BlockedEngagementInfo",null,[]);class gd extends $b{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(v.a)(gd,"SuccessfulActionData",$b,[]);class Ud{constructor(){this.successfulActions=[]}}Object(v.a)(Ud,"SuccessfulEngagementInfo",
null,[]);var ne=a(47),rc;let kd=rc=class{constructor(X){this.vOa=new Set;this.LVb=null;this.n8e=this.Zog=!1;this.afb=(ca,Qb)=>{this.Gvb.hasBlockedActions=!0;ca=this.Gvb.blockedActions.length;const Uc=Qb.details?Qb.actionName+"_"+Qb.details:Qb.actionName;Qb=Object(Le.a)(new $b,{order:ca+1,name:Uc,componentName:Qb.componentName,timeFromNavigationStart:Qb.timeFromNavigationStart});this.Gvb.blockedActions.push(Qb)};this.Zh=()=>{ne.a(this.$).bRb(this.afb);this.rSi();this.LVb=Md.a.instance.create(()=>{this.KKb()},
rc.s7j,oa.a.KKb)};this.oe=()=>{this.KKb()};this.dTd=()=>{this.$.Fe(2009315810,-1,0,null);this.q3d=!1};this.Gvb=new wc;this.Gvb.hasBlockedActions=!1;this.hkb=new Ud;this.lVh();this.$=X;this.$.da.Ol(this.Zh);this.$.sk(this.oe);this.v7j=0;this.q3d=!1;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.KRe=new Promise(ca=>{this.Wnh=ca}));ne.a(this.$).G7b(this.afb)}dispose(){this.$.da&&this.$.da.mo(this.Zh);this.$.Ym(this.oe);fd.a.Ma(this.LVb);this.$=this.LVb=
null}$vj(X,ca,Qb){if(void 0!==X&&null!==X&&ca){var Uc=this.hkb.successfulActions.length+1,Od="InputMethod"in ca?ca.InputMethod:"",me="IsCommand"in ca&&ca.IsCommand;if(this.FMi(X,ca,Od,me)){++this.v7j===rc.vlk?(this.q3d=!0,this.rlj=Md.a.instance.create(this.dTd,5E3,oa.a.dTd)):this.q3d&&this.rlj.ps();if(Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const Oe=!me&&X;this.n8e||Oe===zb.a.nzg||Oe===zb.a.ozg||Oe===zb.a.kzg||Oe===zb.a.lzg||(this.n8e=!0,this.Wnh(void 0))}Uc>
rc.HGf||(X=Object(Le.a)(new gd,{order:Uc,name:X,componentName:"Location"in ca?ca.Location:"",timeFromNavigationStart:Qb,inputMethod:Od,isCommand:me}),this.hkb.successfulActions.push(X),1===Uc?this.kTi():Uc===rc.HGf&&this.KKb())}}}rSi(){x.ULS.sendTraceTag(254546634,0,50,`${U.c(this.Gvb)}`)}kTi(){Nc.PageLoadTrackingInfo.instance.Qza(new Date)>rc.wVh?x.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${U.c(this.hkb.successfulActions[0])}`):x.ULS.sendTraceTag(254563592,0,50,`${U.c(this.hkb.successfulActions[0])}`)}KKb(){!this.Zog&&
this.hkb.successfulActions.length&&(this.Zog=!0,fd.a.Ma(this.LVb),this.LVb=null,this.$.sendBeaconTraceTag(254559496,50,!1,U.c(this.hkb)))}lVh(){this.vOa.add(zb.a.J3c);this.vOa.add(zb.a.v_d);this.vOa.add(zb.a.yRd);this.vOa.add(zb.a.d_f);this.vOa.add(zb.a.f_f);this.vOa.add(zb.a.h_f)}FMi(X,ca,Qb,Uc){Qb=!Qb||"unknown"===Qb;const Od="IsSystemInitiated"in ca&&ca.IsSystemInitiated;ca="NoReporting"in ca&&ca.NoReporting;const me=this.vOa.has(X);X=ub.a.equals(X,zb.a.qFc,!0)&&Qb;return!Od&&!ca&&!me&&!X&&!(Uc&&
Qb)}};kd.HGf=10;kd.wVh=6E4;kd.s7j=12E4;kd.vlk=25;kd=rc=Object(Gb.a)([Object(yc.d)(Zc.Ub),Object(Gb.b)(0,Object(Zc.R)())],kd);Object(v.a)(kd,"PageLoadEngagementInfo",null,[]);Object(yc.b)(Zc.Pb)(()=>Io(function*(){yield yc.a.resolve(Zc.O,{Qa:0}).then(X=>X("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var qd=a(21);const oe={MergedCell:"MergedCell",ABg:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",
InCellImage:"InCellImage",lDg:"RichText"};let Yd=class{constructor(X){this.oe=()=>{const ca=JSON.stringify(this.JPe),Qb=JSON.stringify(this.IPe);x.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${ca}}`);x.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${Qb}}`)};this.$=X;this.JPe=[];this.IPe=[];Jb.EwaSettings.JHb()&&this.$.sk(this.oe)}dispose(){this.$=null}bBe(X,ca){this.JPe.push({commandName:ca,
rowColCount:X.toString()})}h4c(X,ca){if(X&&0!==X.length){var Qb=[];const Uc={};for(let Od of X)Od.KCi()&&(X=c(Od),""!==X&&(Uc[X]=Uc[X]?Uc[X]+1:1));for(let Od of Object.keys(Uc))Qb.push({cellType:Od,count:Uc[Od]});0!==Qb.length&&this.IPe.push({commandName:ca,complexCellTypes:Qb})}}hAe(X,ca,Qb,Uc){const Od=qd.h(this.$);var me=Od.za.Maf();let Oe=[],jf=!1;"UnhideColumn"!==X&&"UnhideRow"!==X&&"insertColumns"!==X&&"insertRows"!==X||(jf=!0);for(let $f of me){{me=$f.Qf;var kf=Uc,Kf=Qb,cg=ca,jg=jf;let Jg=
null;if(kf&&me||!Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))jg?me.Te(kf)&&(Jg=me,cg?Jg.top=Jg.bottom-Kf+1:Jg.left=Jg.right-Kf+1):me.Te(kf)||(Jg=me,cg?Jg.bottom=Jg.top+Kf-1:Jg.right=Jg.left+Kf-1);me=Jg}me&&(me=Od.za.N1(me))&&(Oe=[...Oe,...me])}this.h4c(Oe,X+"Cascade")}};Yd=Object(Gb.a)([Object(yc.d)(Zc.nb),Object(Gb.b)(0,Object(Zc.R)())],Yd);Object(v.a)(Yd,"GridActionTelemetryManager",null,[367,5]);var We=a(54),He=a(58),bf=a(144),ef=a(527),nc=a(39),id=
a(88),Dd=a(431),fc=a(41),Oa=a(246);class Lb extends Sys.EventArgs{constructor(X){super();this.GX=X}}Object(v.a)(Lb,"ErrorDataArgs",Sys.EventArgs,[]);var Fc=a(668),Wc=a(120),td=a(34);class na{constructor(X,ca){this.YZb=null;this.Odc=this.lwd=!1;this.Iue=this.Jue=null;this.u$a=this.t$a=0;this.Zcg=X;this.Ure=ca}get oXf(){return this.Ure}get GSb(){return this.Jue}get Ycg(){return this.Iue}get aOi(){return this.XKe(this.Zcg.getTime())}get Gjj(){return this.XKe(this.Ycg.getTime())}get yjg(){return!(this.Odc||
void 0===window.bsqmXLSPageLoadStartTime)}get $ad(){try{return this.YZb||(this.YZb=Wc.toUtc(window.bsqmXLSPageLoadStartTime)),this.YZb}catch(X){return null}}set $ad(X){this.YZb=X}UTj(X){this.Odc||(this.Jue=X,this.Iue=Wc.toUtc(this.GSb))}oti(X){if(X.Values&&(!this.t$a||!this.u$a))try{Hb.a.iof in X.Values&&(this.t$a=parseInt(X.Values[Hb.a.iof].toString(),10));Hb.a.jof in X.Values&&(this.u$a=parseInt(X.Values[Hb.a.jof].toString(),10));const ca=O.a.instance;0<this.t$a&&(this.lDf(this.t$a,"PageLoadFromHostClick"),
ca.bwj(this.t$a));0<this.u$a&&(this.lDf(this.u$a,"PageLoadFromHostFrameCreation"),ca.cwj(this.u$a));const Qb=X.Values[Hb.a.rti]||0,Uc=X.Values[Hb.a.pti]||X.Values[Hb.a.qti]||0;0<Uc&&ca.Jvj(Uc);ca.Kvj(Qb)}catch(ca){}}eHj(){this.Zcg=this.$ad=td.a.$a.Wd;this.Ure=0;this.lwd=this.Odc=!1}XKe(X){const ca=this.$ad.getTime();return ca>=X?0:X-ca+this.oXf}lDf(X,ca){if(X){const Qb=Qd.b();Qb.WIc("UserAction",ca,ca,td.a.sId(X),Fc.EcmaDateClock.instance.appStart);Qb.Zfc(ca,Wc.toTimestamp(this.GSb))}}}Object(v.a)(na,
"PageLoadPerfInfo",null,[]);var Pa=a(77);class lb{constructor(X,ca,Qb){this.j1c=X.keyCode;this.sTb(X.ctrlKey,1);this.sTb(X.shiftKey,2);this.sTb(X.altKey,4);this.sTb(Pa.b(X),8);this.sTb(Qb,16);this.j1c=this.Wjb|ca<<24}get Wjb(){return this.j1c}get keyCode(){return this.Wjb&65535}sTb(X,ca){X&&(this.j1c=this.Wjb|ca<<16)}}Object(v.a)(lb,"ShortcutSqmData",null,[]);class Nb{constructor(){this.uHd=null;this.Mjh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.w$f()}Eeh(X,ca,Qb){0===Qb&&(Qb=
this.Mjh[ca.toString()]);return Nb.xjg(X,Qb)&&(X=new lb(X,Qb,z.a.isMac),!fc.a.yi(this.uHd,X.Wjb.toString()))?(this.uHd[X.Wjb.toString()]=!0,X):null}w$f(){this.uHd={}}static MFi(X){return 112<=X&&123>=X||61440<=X&&61451>=X}static nHi(X){return 17!==X&&18!==X&&16!==X&&91!==X&&93!==X}static xjg(X,ca){let Qb=X.ctrlKey||X.altKey||Pa.b(X);X=X.keyCode;Qb=Nb.MFi(X)||Qb;Qb=Nb.nHi(X)&&Qb;return 0!==ca&&Qb}}Object(v.a)(Nb,"UnhandledShortcutLogger",null,[]);class xc{constructor(X){this.qbc=[];this.U3g=null;this.sqmManager=
X}T6b(X){this.qbc.push(X)}c3(X,ca,Qb){try{if(ca)ca.endTime=Qb,this.sqmManager.gAe(ca);else for(let Uc=0,Od=this.qbc.length;Uc<Od;Uc++){const me=this.qbc[Uc];X?(me.endTime=me.startTime,me.KPe=0):me.endTime=Qb;this.sqmManager.gAe(me)}}catch(Uc){}finally{this.qbc.length=0}}}Object(v.a)(xc,"UserInteractionPerfInfo",null,[]);var Oc=a(38),yd=a(78),Sd=a(242);class ve extends Mb.a{constructor(X,ca){super();this.$ud=this.ERb=!1;this.Bjg=!0;this.Ua=new nc.a;this.PRc=!1;this.oe=()=>{const Qb=yd.a(this.$).ef.activityState,
Uc=fc.a.yi(Qb,Oc.a.Lze);fc.a.yi(Qb,Oc.a.ktb)||Uc||this.upload()};this.$=X;this.VCb=ca;this.da=X.da;this.$.sk(this.oe);this.aug=new Nb;this.tUa=new na(Gc.a.EZd,X.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.cNc=new xc(this)}f5c(X){this.Ua.addHandler("EREK",X)}TVd(X){this.Ua.removeHandler("EREK",X)}get hwh(){return this.PRc}get Mzi(){return this.$.frame.aU?$c.a.Ozi:$c.a.Nzi}get workbookContext(){return this.$.workbookContext}get PW(){ve.Lmb||(ve.Lmb=this.x0e());ve.c9c||(ve.c9c=!0,this.Vpf());
return ve.Lmb}set PW(X){ve.Lmb=X;ve.Lmb||(ve.c9c=!1)}get I6(){return id.a(this.$.xa,3)}dispose(){this.hwh&&t.AFrameworkApplication.xn&&t.AFrameworkApplication.xn.disable();this.$&&this.$.Ym(this.oe);this.$=this.cNc=this.tUa=this.PW=null;super.dispose()}jlf(X){this.tUa.oti(X);this.rTi()}h0d(X){this.setDw(9415,X)}T6b(X){this.cNc.T6b(X)}c3(X,ca,Qb){this.cNc.c3(X,ca,Qb)}RGd(X){this.I6&&(X=this.$.isEditMode||X&&this.da.workbookContext.Options&512?2:this.da.ae.inEmbedView?14:1,this.setDw(8721,X),this.qXh(X),
this.PRc=!1)}BDf(){const X=this.tUa;this.I6&&X.yjg&&(this.setDw(9450,X.oXf),this.setDw(9085,X.aOi))}CDf(X){if(!this.ERb){this.ERb=!0;const ca=this.tUa;let Qb=0;this.I6&&ca.yjg?(ca.UTj(X),this.cNc.U3g=ca.Ycg,this.setDw(9086,ca.Gjj),ca.Odc=!0,Qb=this.tUa.GSb.getTime()):Qb=X.getTime();tb.TaskExtensions.ya(this.VCb.value,Uc=>{Uc.result.sendMessage(mb.a.P3g,{[Hb.a.Q3g]:Qb})},this.ka,3)}}gAe(X){this.I6&&X&&1!==X.Zha&&this.Bka(8327,Oa.b(X),Oa.l(X),Oa.a(X),2,X.KPe,Oa.m(X),Oa.d(X),Oa.e(X))}fXd(X,ca){X&&X.MessageIdHash&&
this.eXd(X.MessageIdHash,X.MessageIdName,X.MessageId,X.ErrorCause?X.ErrorCause:He.a.yLc,!1,ca,X,null)}eXd(X,ca,Qb,Uc,Od,me,Oe,jf){ve.appEncounteredFirstError||(ve.appEncounteredFirstError=!0,bf.a.get_instance().isCompleted(13)||(bf.a.get_instance().Vu(13),x.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));X=this.xAb(X);const kf=!!Oe,Kf={};Kf.ErrorName=ca;Kf.ErrorHashCode=X.toString();Kf.ErrorId=Qb.toString();Kf.ErrorCause=Uc.toString();Kf.ErrorType=
0===me?"ErrorDialog":"BusinessBar";Kf.BusinessBarEntryName=jf||"null";Kf.ServerCorrelationId=kf?Oe.CorrelationId:"null";Kf.WebMethodName=kf?Oe.WebMethodName:"null";Kf.SessionHostingEcs=this.da.workbookContext?this.da.workbookContext.EcsServerName:"null";Kf.WfeServerId=kf?Oe.WfeServerId:"null";ca=dd.a.ye(Kf);this.Ua.raiseEvent("EREK",new Lb(Kf));x.ULS.sendTraceTag(1881314,0,15,ca);this.I6&&(sa.a.W3f(X.toString()),this.Bka(9134,X,Uc,He.a.Y9d),this.da.Rx||Od||(this.setDw(10459,X),this.RGd(!0),this.$ud=
!0,this.upload(),this.Vpf()))}xAb(X){return 5439488|(X>>>16^X&65535)&65535}nHd(X,ca,Qb){X=this.aug.Eeh(X,ca,Qb);this.I6&&X&&this.Bka(11007,X.Wjb)}upload(){!this.I6||!this.ERb&&!this.$ud||z.a.hh&&t.AFrameworkApplication.fi?z.a.hh&&t.AFrameworkApplication.fi&&x.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.PW.NXb(),this.PRc=!0);t.AFrameworkApplication.xn=this.PW=null;this.tUa.eHj();this.ERb=!1;t.AFrameworkApplication.xn=this.PW=this.x0e();this.aug.w$f()}rTi(){const X=
this.tUa;if(this.I6&&!X.lwd){var ca=X.t$a,Qb=X.u$a,Uc=X.GSb.getTime();t.AFrameworkApplication.tP=X.GSb;ca&&this.setDw(10324,ca>Uc?0:Uc-ca);Qb&&this.setDw(10325,Qb>Uc?0:Uc-Qb);X.lwd=!0}}Bka(X,...ca){this.I6&&this.PW.Bka(X,...ca)}setDw(X,ca){this.I6&&this.PW.setDw(X,ca)}x0e(){Dd.a.U0e(this.$.xa);return t.AFrameworkApplication.xn}qXh(X){let ca;try{ca=Object(N.a)(Object,dd.a.nk(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(Qb){x.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${Qb.message}`);
return}if(ca){let Qb=Object(N.a)(String,ca.ApplicationModeExtended),Uc=Object(N.a)(String,ca.ApplicationMode);Qb&&Uc&&(Qb=Qb.toUpperCase(),2!==X&&16!==X||"VIEW"!==Qb&&"UNIFIED"!==Qb?1!==X||"EDIT"!==Qb&&"UNIFIED"!==Qb||(Qb="VIEW",Uc="View"):(Qb="EDIT",Uc="Edit"),ca.ApplicationModeExtended=Qb,ca.ApplicationMode=Uc,t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=dd.a.ye(ca))}}Vpf(){const X=this.$.xa;this.PW.gQ=!0;this.PW.eZa(X.BWsaStartTime);this.setDw(59,83);this.ERb=!1;if(this.I6){const ca=
X.DocumentHostInfo;this.Quh();this.setDw(8491,this.$.vG);this.setDw(9236,X.RequestedUILcid);this.setDw(8473,X.WacHostId);this.setDw(9902,Oa.c(ca.ClusterId));Jb.EwaSettings.Da(398)?this.PW.Vfg(""):this.PW.Vfg(X.FlightHolder?X.FlightHolder.FlightId:"");this.h0d(this.da.ae.inEmbedView?1:0);this.$ud=!1;this.setDw(9104,Oa.c(ca.FileSourceId));this.setDw(10309,this.Mzi);this.PVj();t.AFrameworkApplication.jd.NUd(ef.a.getInstance(!1))}}PVj(){O.a.instance.twi(this.PW);if(this.Bjg){const X=O.a.instance;X.Fvj();
X.Xvj();X.Vvj();X.Uvj();X.Pvj();this.Bjg=!1}}Quh(){this.createStream(8327,1,Sd.a.ayh,Sd.a.y6a);this.createStream(9134,1,3,Sd.a.y6a);this.createStream(11007,1,1,Sd.a.y6a)}createStream(X,ca,Qb,Uc){this.PW.createStream(X,ca,Qb,Uc)}}ve.Lmb=null;ve.c9c=!1;ve.appEncounteredFirstError=!1;Object(v.a)(ve,"SqmManager",Mb.a,[171,380]);var Ee=a(770);class Ue{constructor(X,ca){this.entryTypes=null;this.buffered=!1;this.entryTypes=X;this.buffered=void 0===ca?!1:ca}}Object(v.a)(Ue,"PerformanceObserverInit",null,
[]);class hf extends Sys.EventArgs{constructor(X){super();this.X0e=X}}Object(v.a)(hf,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Rb extends Sys.EventArgs{constructor(X){super();this.roc=X}}Object(v.a)(Rb,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class ed{constructor(X){this.Ua=new nc.a;this.cVc=!1;this.Zh=()=>{if(z.a.Eo){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.yVi)).observe(new Ue([$c.a.yHd])),this.cVc=
!0)}catch(ca){this.cVc=!1,x.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${ca}`)}this.Ua.raiseEvent("ltpoiek",new Rb(this.roc))}};this.yVi=ca=>{this.Ua.raiseEvent("ltoek",new hf(ca))};this.$=X;this.$.da.Og?this.Zh(this,Sys.EventArgs.Empty):this.$.da.Ol(this.Zh)}get roc(){return this.cVc}ACe(X){this.Ua.addHandler("ltoek",X)}xCj(X){this.Ua.removeHandler("ltoek",X)}J_g(X){this.Ua.addHandler("ltpoiek",X)}yCj(X){this.Ua.removeHandler("ltpoiek",X)}dispose(){this.$.da.mo(this.Zh);
fd.a.Ma(this.Ua);this.$=this.Ua=null}}Object(v.a)(ed,"LongTaskPerformanceObserver",null,[5]);var pd=a(162);class ie{constructor(X,ca){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===X?0:X;this.longTaskDuration=void 0===ca?0:ca}get BHd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}cNi(X){return 100*this.BHd>X}cYg(X){this.tBe(X.longTaskDuration);this.Q4c(X.activeSessionDuration)}tBe(X){this.longTaskDuration+=X}Q4c(X){this.activeSessionDuration+=
X}}Object(v.a)(ie,"LongTaskPerformanceData",null,[]);class Ce{constructor(X,ca,Qb,Uc,Od){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=X;this.entireSessionData=ca;this.worstWindowData=Qb;this.postBootWindowData=Uc;this.maxUsersCount=Od}get reportName(){return"LongTaskPerformance"}static get MFh(){return new Ce(!1,new ie,new ie,new ie,0)}}Object(v.a)(Ce,"LongTaskPerformanceDataStatistics",null,[248]);class Pe extends Sys.EventArgs{constructor(X){super();
this.zHd=X}}Object(v.a)(Pe,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var lf=a(390),nf=a(302);class If{constructor(X,ca){this.Ua=new nc.a;this.rSa=this.O9=this.sV=this.Mf=null;this.Xzf=this.H3d=this.nsc=!1;this.TSa=null;this.maxUsersCount=0;this.Pxc=(Qb,Uc)=>{Qb=Uc.X0e.getEntriesByType($c.a.yHd);for(const Od of Qb)this.Mf.OF(Od.duration)||t.AFrameworkApplication.WRa||(this.sV.tBe(Od.duration),this.Ua.raiseEvent("lttek",new Pe(Od)),Qb={},Qb.LongTaskDuration=Od.duration,Qb.LongTaskStartTime=Od.startTime,
x.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Qb)))};this.Zh=()=>{this.H3d=!0;this.BVb()};this.XD=(Qb,Uc)=>{Uc&&(this.maxUsersCount=Math.max(this.maxUsersCount,Uc.Rlk));this.O9.maxUsersCount=this.maxUsersCount};this.kf=()=>{this.BVb()};this.oe=()=>{this.EVb()};this.gRf=(Qb,Uc)=>{Uc.roc&&this.BVb()};this.dEf=()=>{this.sV.Q4c(Wc.getElapsedMilliseconds(this.rSa,td.a.$a.Wd));this.O5d(!0);var Qb=!1;this.O9.postBootWindowData.activeSessionDuration?(!this.Xzf&&Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(Qd.b().l9f(2),V.Health.instance.recordKpiUsage(nf.a.longJsTask,0,lf.a.bOi,null),this.Xzf=!0),!this.O9.isVetoSession&&this.sV.cNi(this.Zyg)&&(this.O9.isVetoSession=!0,Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Qd.b().m9f(2,this.wVi),V.Health.instance.recordKpiFailure(nf.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.O9.worstWindowData.BHd<=this.sV.BHd&&(this.O9.worstWindowData=this.sV),this.O9.entireSessionData.cYg(this.sV)):(this.O9.postBootWindowData=
new ie(this.sV.activeSessionDuration,this.sV.longTaskDuration),Qb=!0);const Uc={};Uc.LastWindowScore=this.sV;Uc.postBootWindow=Qb;Uc.CoauthersNumber=this.$.da.Kp.length;Qb=JSON.stringify(Uc);x.ULS.sendTraceTag(20779346,0,50,Qb);this.sV=new ie};this.Jwc=()=>{this.Mf.Ui||t.AFrameworkApplication.WRa||this.O5d(!1)};this.Iwc=()=>{this.sV.Q4c(Wc.getElapsedMilliseconds(this.rSa,td.a.$a.Wd));this.rSa=null;this.TSa.cancel()};this.$=X;this.Zyg=X.xa.LongTaskPerformanceVetoThreshold;this.wVi="PercentageOver_"+
this.Zyg.toString();this.AHd=X.xa.LongTaskPerformanceWindowDurationInMs;this.kQ=ca;Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void yc.a.resolve(Zc.K).then(Qb=>{this.Mf=Qb;this.BVb()}):this.$.ea.Zc(291,Qb=>{this.Mf=Qb;this.BVb()});this.$.da.Og?this.Zh(this,Sys.EventArgs.Empty):this.$.da.Ol(this.Zh);this.kQ.J_g(this.gRf);this.$.Pm(this.kf);this.$.sk(this.oe)}K_g(X){this.Ua.addHandler("lttek",X)}zCj(X){this.Ua.removeHandler("lttek",X)}dispose(){this.H3d=
!1;this.EVb();this.$.Rn(this.kf);this.$.Ym(this.oe);this.kQ.yCj(this.gRf);fd.a.Ma(this.TSa);this.kQ=this.$=this.TSa=null;void 0!==this.Mf&&null!==this.Mf&&fd.a.Ma(this.Mf)}BVb(){void 0===this.Mf||null===this.Mf?x.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.kQ.roc?this.nsc?x.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.H3d?(this.nsc=!0,this.O9=Ce.MFh,this.sV=new ie,this.$.da.Nca(this.XD),this.maxUsersCount=this.$.da.Kp.length,this.kQ.ACe(this.Pxc),this.Mf.A0(this.Iwc),this.Mf.vW(this.Jwc),t.AFrameworkApplication.W4c(this.Iwc),t.AFrameworkApplication.X4c(this.Jwc),this.TSa=Md.a.instance.create(this.dEf,this.AHd,oa.a.qDf,!1),Bd.a(this.$).sW(this.O9),this.Mf.Ui||t.AFrameworkApplication.WRa||this.O5d(!0),x.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):x.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):x.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}EVb(){this.nsc&&(this.nsc=!1,this.$.da.mo(this.Zh),this.kQ.xCj(this.Pxc),this.$.da.faa(this.XD),void 0!==this.Mf&&null!==this.Mf&&(this.Mf.QVa(this.Iwc),this.Mf.hEa(this.Jwc)),t.AFrameworkApplication.Y6f(this.Iwc),
t.AFrameworkApplication.Z6f(this.Jwc),this.TSa.cancel(),this.rSa=this.sV=this.O9=null,this.maxUsersCount=0)}O5d(X){X||void 0===this.rSa||null===this.rSa?(this.rSa=td.a.$a.Wd,this.TSa=pd.AsyncMethodContext.oyb(this.dEf,X?this.AHd:this.AHd-this.sV.activeSessionDuration,oa.a.qDf,this.TSa)):x.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(v.a)(If,
"LongTaskPerformanceTracker",null,[5]);var Ff=a(31);class Mf extends nc.a{constructor(X,ca){super();this.statusBarManager=this.Mf=null;this.hRf=(Qb,Uc)=>{Uc.zHd&&Uc.zHd.duration>=this.zVi&&(this.xEf++,this.uAf=Uc.zHd.duration)};this.$=X;this.$.ea.Zc(29,Qb=>{this.statusBarManager=Qb;Qb.gM(this)});Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void yc.a.resolve(Zc.K).then(Qb=>{this.Mf=Qb}):this.$.ea.Zc(291,Qb=>{this.Mf=Qb});this.uAf=this.xEf=
0;this.zVi=X.xa.LongTaskThresholdMs;this.bdb=ca;this.bdb.K_g(this.hRf)}Ks(X){this.addHandler("LTSCEK",X)}ot(X){this.removeHandler("LTSCEK",X)}fC(){this.Jp("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Du(X,ca){if("QueryLongTasksCount"!==X)return!1;this.npi(ca);return!0}Jp(){return Jb.EwaSettings.Da(505)}dispose(){this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null);this.bdb.zCj(this.hRf);super.dispose()}npi(X){const ca=`Long Tasks: ${this.xEf} | Last Task Duration: ${Math.round(this.uAf)}ms`;
Ff.a.Fo()?(X.LabelText=ca,X.Visible=!0):X.Value=ca}}Object(v.a)(Mf,"LongTasksStatusBarManager",nc.a,[5,187,188]);var dc=a(12);class B{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(v.a)(B,"NetworkInfoData",null,[]);class fa extends nc.a{constructor(X){super();this.statusBarManager=null;this.z4c=!1;this.NJf=()=>{this.raiseEvent("NetworkInformation")};this.$=X;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.oQ=this.D9d("connection")||this.D9d("mozConnection")||this.D9d("webkitConnection"))&&Jb.EwaSettings.Da(410)&&X.ea.Zc(29,ca=>{this.statusBarManager=ca;ca.gM(this);this.oQ.addEventListener("change",this.NJf);this.z4c=!0})}Ks(X){this.addHandler("NetworkInformation",X)}ot(X){this.removeHandler("NetworkInformation",X)}n9a(){return this.oQ?Object(Le.a)(new B,{bandwidthMps:this.oQ.downlink,rttMs:this.oQ.rtt,connectionType:this.oQ.type,effectiveConnection:this.oQ.effectiveType,downlinkMaxMps:this.oQ.downlinkMax}):
null}Du(X,ca){if("QueryNetworkInformation"!==X)return!1;this.opi(ca);return!0}Jp(){return this.z4c}dispose(){this.z4c&&(this.statusBarManager&&(this.statusBarManager.yI(this),this.statusBarManager=null),this.oQ&&this.oQ.removeEventListener("change",this.NJf));this.$=null;super.dispose()}D9d(X){return dc.HelperMethods.Ip(window.navigator,X)?window.navigator[X]:null}opi(X){const ca="Network: "+this.oQ.downlink.toString()+" Mbps, "+this.oQ.rtt.toString()+" ms";Ff.a.Fo()?(X.LabelText=ca,X.Visible=!0):
X.Value=ca}}Object(v.a)(fa,"NetworkInformationManager",nc.a,[187,188]);var Na=a(200);class nb{constructor(X,ca,Qb,Uc,Od,me,Oe,jf,kf,Kf){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===X?"":X;this.startTime=void 0===ca?-1:ca;this.startToNextFrame=void 0===Qb?-1:Qb;this.startToResponseRenderEnd=
void 0===Uc?-1:Uc;this.wasHidden=void 0===Od?!1:Od;this.isUserOperation=void 0===me?!0:me;this.isGroupBreaking=void 0===Oe?!0:Oe;this.operationThatLedToLogging=void 0===kf?"":kf;this.startToOperationThatLedToLogging=void 0===Kf?-1:Kf;this.isPartOfGroup=void 0===jf?!1:jf}}Object(v.a)(nb,"OperationStatisticsData",null,[]);var gc=a(85);class bd{constructor(){this.operationsGroups=null;this.Mvi()}isGroup(X,ca,Qb){const Uc=new Na.a;Uc.addRange(X);Uc.addRange(ca);for(let Od=0;Od<this.operationsGroups.count;Od++)if(this.MIi(this.operationsGroups.ma(Od),
Uc,Qb))return x.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${Qb}' is part of a group ( operationsList: ${this.YWf(X)} , frameOperationsList: ${this.YWf(ca)})`),!0;x.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${Qb}' is NOT part of a group.`);return!1}MIi(X,ca,Qb){let Uc=0;for(let Od=0;Od<ca.count;Od++)if(ca.ma(Od).isGroupBreaking){if(X.count<=Uc||!ub.a.equals(ca.ma(Od).name,X.ma(Uc),!0))return!1;Uc++}return X.count>Uc&&ub.a.equals(Qb,X.ma(Uc),!0)}YWf(X){X=
gc.select(X,ca=>ca.name);return`[${gc.toArray(X).join(", ")}]`}Mvi(){this.operationsGroups=new Na.a;this.K2a(new Na.a(["Paste","SelectingRange_unknown"]));this.K2a(new Na.a(["AutoSum","SelectingRange_unknown"]));this.K2a(new Na.a(["ChangeSheetDirection","ActiveItemChanged"]));this.K2a(new Na.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.K2a(new Na.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.K2a(new Na.a(["EditBoxEndEdit","SetCell",
"SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}K2a(X){this.operationsGroups.add(X)}}Object(v.a)(bd,"OperationsGroupDetector",null,[]);var Ra=a(28);class Tb{constructor(X,ca,Qb,Uc){this.framePerformanceTracker=this.qRb=this.C3=this.C4=null;this.nFj=()=>{this.F6c=-1;const Od=dc.HelperMethods.Dd();this.rkk(Od);Jb.EwaSettings.Da(326)&&(this.MSb&&(x.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.CXb(this.rH,Od),this.MSb=!1),this.uqc&&(this.CXb(this.dG,Od),this.MSb||this.CXb(this.rH,Od)));window.setTimeout(this.pTi,0)};this.pTi=()=>{var Od=[];const me=this.$.xa.OperationToPrevOperationThreshold;for(var Oe=0;Oe<this.rH.count;Oe++){var jf=this.rH.ma(Oe);Oe<me&&Od.push(jf);this.dG.add(jf)}qd.h(this.$)&&qd.h(this.$).za?((Oe=this.sessionStatisticsManager.rpd(0))?(jf=JSON.stringify(this.QKb),Od=JSON.stringify(Od),x.ULS.sendTraceTag(237798547,1,50,`DOM count: (${Oe.nZi}, ${Oe.E7g}, ${Oe.bYi}), long tasks: ${jf}, operations count: ${this.rH.count}, operations: ${Od}`)):
x.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.rH.count>me&&x.ULS.sendTraceTag(537153875,1,50,`More than ${me} operations are in the operationsList. count: ${this.rH.count}`),this.rH.clear(),this.QKb.clear()):x.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Pxc=(Od,me)=>{this.xVi(me.X0e)};this.$=X;this.pL=ca;this.oj=this.oj||td.a.$a;this.dG=new Na.a;this.rH=new Na.a;this.F6c=this.pcb=-1;this.QKb=new Na.a;this.operationsGroupDetector=
new bd;this.MSb=this.uqc=!1;this.iwi();this.Ovi();this.Nvi();this.sessionStatisticsManager=Qb;this.kQ=Uc;this.kQ.ACe(this.Pxc);this.$.ea.Zc(263,Od=>{this.framePerformanceTracker=Od})}zRb(X,ca){var Qb=dc.HelperMethods.Dd();const Uc=Jb.EwaSettings.Da(326)?this.operationsGroupDetector.isGroup(this.dG,this.rH,X):!1;this.uqc=this.Xvf(X);Jb.EwaSettings.Da(326)?this.uqc&&0<this.dG.count&&!Uc&&(this.vjk(),this.Cwg(X,Qb),this.G8e()):0<this.dG.count&&this.Xvf(X)&&(this.Cwg(X,Qb),this.G8e());this.pcb=-1;if(qd.h(this.$)&&
qd.h(this.$).za){var Od=!this.C4.contains(X);Qb=new nb(X,Qb,void 0,void 0,void 0,Od,this.uqc,Uc);this.rH.add(Qb);this.framePerformanceTracker&&this.framePerformanceTracker.E5j(Qb.name,ca);Jb.EwaSettings.Da(326)&&!this.MSb&&this.qRb.contains(X)&&(this.MSb=!0);-1===this.F6c&&(this.F6c=window.requestAnimationFrame(this.nFj))}else x.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}yDc(){this.pcb=dc.HelperMethods.Dd()}FDc(){this.dG.count||this.rH.count?(this.CXb(this.rH,this.pcb),
this.CXb(this.dG,this.pcb)):x.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.pcb}`);this.pcb=-1}Xvf(X){return!this.C3.contains(X)&&!X.includes("Menu")&&!X.includes("TellMe")}G8e(){for(let X=0;X<this.dG.count;X++){const ca=this.dG.ma(X);this.pL.VTg(ca);this.UTi(ca)}this.dG.clear()}rkk(X){for(let ca=0;ca<this.rH.count;ca++)this.rH.ma(ca).startToNextFrame=this.yrd(this.rH.ma(ca).startTime,X),this.rH.ma(ca).wasHidden=Ee.a.OF(this.rH.ma(ca).startToNextFrame)}Cwg(X,
ca){for(let Qb=0;Qb<this.dG.count;Qb++)-1===this.dG.ma(Qb).startToResponseRenderEnd&&(this.dG.ma(Qb).operationThatLedToLogging=X,this.dG.ma(Qb).startToOperationThatLedToLogging=this.yrd(this.dG.ma(Qb).startTime,ca))}vjk(){var X=!1;for(let ca of this.dG)if(ca.isPartOfGroup){X=!0;break}if(X)for(X=0;X<this.dG.count;X++)this.dG.ma(X).isPartOfGroup=this.dG.ma(X).isGroupBreaking}CXb(X,ca){for(let Qb=0;Qb<X.count;Qb++)X.ma(Qb).startToResponseRenderEnd=this.yrd(X.ma(Qb).startTime,ca),X.ma(Qb).wasHidden=Ee.a.OF(X.ma(Qb).startToResponseRenderEnd)}UTi(X){X=
JSON.stringify(X);x.ULS.sendTraceTag(2020372336,1,50,`${X}`)}yrd(X,ca){return-1===X?-1:-1===ca?-2:ca-X}xVi(X){X=X.getEntriesByType($c.a.yHd);for(let ca=0;ca<X.length;ca++)if(30>this.QKb.count)if(this.rH.count)this.QKb.add(this.plj(X[ca]));else{const Qb=X[ca];if(null===Qb||void 0===Qb?0:Qb.attribution)void 0!==Qb.attribution.containerSrc&&null!==Qb.attribution.containerSrc&&(Qb.attribution.containerSrc=""),void 0!==Qb.attribution.containerId&&null!==Qb.attribution.containerId&&(Qb.attribution.containerId=
""),void 0!==Qb.attribution.containerName&&null!==Qb.attribution.containerName&&(Qb.attribution.containerName="");x.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{x.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${X.length} First long task: ${this.QKb.ma(0)}`);break}}plj(X){return`name:${X.name}, startTime:${X.startTime}, duration:${X.duration}`}iwi(){this.C4||(this.C4=new Xb.a(bb.a.Qh()),
this.C4.add("ActiveItemChanged"),this.C4.add(Qd.b().pl(-1398645260)),this.C4.add(Qd.b().pl(722290388)),this.C4.add(Qd.b().pl(974713501)),this.C4.add(Ra.a.yT(Ra.a.gbc)),this.C4.add(Ra.a.yT(Ra.a.fbc)),this.C4.add(Ra.a.yT(Ra.a.lxb)),this.C4.add(Ra.a.yT(Ra.a.$0f)),this.C4.add(Ra.a.yT(Ra.a.lra)))}Ovi(){this.C3||(this.C3=new Xb.a(bb.a.Qh()),this.C3.add("PromptEditInBrowser"),this.C3.add(Qd.b().pl(-1398645260)),this.C3.add(Qd.b().pl(722290388)),this.C3.add(Qd.b().pl(974713501)),this.C3.add(Ra.a.yT(Ra.a.gbc)),
this.C3.add(Ra.a.yT(Ra.a.fbc)),this.C3.add(Ra.a.yT(Ra.a.lxb)),this.C3.add(Ra.a.yT(Ra.a.$0f)),this.C3.add(Ra.a.yT(Ra.a.lra)))}Nvi(){this.qRb||(this.qRb=new Xb.a(bb.a.Qh()),this.qRb.add("SelectingRange_keyboard"),this.qRb.add("SelectingRange_mouse"))}}Object(v.a)(Tb,"OperationStatistics",null,[]);var qc=a(596);class hd{constructor(X,ca){this.messageIdName=null;this.errorCause=0;this.messageIdName=X;this.errorCause=ca}}Object(v.a)(hd,"RequestError",null,[]);class Vd{constructor(X,ca,Qb,Uc,Od,me,Oe,jf,
kf,Kf,cg,jg,$f,Jg,Aa,Fb,kc){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=
this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=X;this.isUserTriggeredRequest=Vd.sai(X);this.isFullyLoggedKPIRequest=Vd.jai(X);this.isPromotedUTRRequest=Vd.lai(X);this.requestDuration=ca;this.totalOperationDuration=Qb;this.requestTimeInQueue=Uc;this.requestInvokedTime=Od;this.ecsOperationDuration=me.EcsOperationDuration;this.EcsRequestDuration=me.EcsRequestDuration;this.WfeRequestDuration=me.WfeRequestDuration;
this.TimeFromLastEcsFreeze=me.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=me.DuringLoadOnDemand;this.correlationID=Oe;this.errors=Vd.fmh(jf);this.httpStatus=kf;this.requestResourceTiming=Kf;this.communicationErrorRetryCount=cg;this.successfulCall=jg;this.isDocumentHidden=$f;this.coauthorsCount=Jg;this.responseSize=Aa;this.networkInfoData=Fb;this.responseToCallbackTime=kc}static fmh(X){if(!X)return[];const ca=[];for(const Qb of X)ca.push(new hd(Qb.MessageIdName,Qb.ErrorCause));return ca}static sai(X){return!Vd.n1i.contains(X)}static Lci(){const X=
new Xb.a(bb.a.Qh());X.add("CheckPersistedContentUpdate");X.add("GetContentBundle");X.add("GetSessionStatus");X.add("GetStatusBarAggregates");X.add("PollSessionStatus");X.add("UpdatePresenceUsers");X.add("UploadLatencyTelemetry");return X}static jai(X){return Vd.PZh.contains(X)}static lai(X){return Vd.Hqj.contains(X)}static K9h(){const X=new Xb.a(bb.a.Qh());X.add("SetRichTextCell");X.add("Copy");X.add("FormatCells");X.add("PasteRange");X.add("FindCell");X.add("ApplyToRangesV2");X.add("ResizeRowsColumns");
X.add("InsertDeleteCells");X.add("FillRange");X.add("PasteHtmlContent");X.add("ApplyFilter");X.add("PasteString");X.add("Undo");X.add("LineageUpdateView");X.add("FindAll");X.add("ApplyHyperlink");X.add("AutoFit");X.add("GetPrintSettings");X.add("GetEdgeCell");X.add("Paste");X.add("MoveAndResizeFloatingObject");X.add("FindRange");X.add("SetCustomFilter");X.add("RenameSheet");X.add("ApplyThreadedComment");X.add("SortFilterColumn");X.add("InsertCopiedCutCells");X.add("InsertSheet");X.add("ToggleAutoFilter");
X.add("ReorderSheets");X.add("SetOutlineLevel");X.add("RefreshAll");X.add("LineageOpenPaneOrChangeFilter");X.add("ApplySlicerSelection");X.add("GetCardViewCardByCell");X.add("AutoSum");X.add("LineageClosePane");X.add("Sort");X.add("ClearAutoFilter");X.add("DeleteSheet");X.add("Redo");Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(X.add("RemovePageBreak"),X.add("InsertPageBreak"),X.add("SetPrintArea"),X.add("ClearPrintArea"));return X}static mai(){const X=
new Xb.a(bb.a.Qh());X.add("DeleteConditionalFormattingRules");X.add("GetConditionalFormattingRules");X.add("AddConditionalFormattingRule");X.add("QuickEditConditionalFormattingRule");X.add("GetPrintSettings");X.add("UpdatePresenceUsers");X.add("GetThemeInfo");X.add("InsertCopiedCutCells");X.add("PasteRange");X.add("FillRange");X.add("InsertCopiedCutCellsCrossSession");Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(X.add("LineageOpenPaneOrChangeFilter"),X.add("LineageUpdateView"),
X.add("LineageRefreshView"),X.add("LineageLoadMore"));return X}}Vd.n1i=Vd.Lci();Vd.PZh=Vd.K9h();Vd.Hqj=Vd.mai();Object(v.a)(Vd,"RequestStatisticsData",null,[]);class Be{constructor(X,ca,Qb){this.$=X;this.pL=ca;this.Lpa=Qb}JDc(X,ca,Qb,Uc,Od,me,Oe,jf,kf,Kf,cg,jg,$f,Jg){jg=qc.a(jg);X=new Vd(X,ca,Qb,Uc,Od,me,Oe,jf,kf,jg,Kf,cg,Ee.a.OF(ca),this.Yqd(null),$f,this.Lpa.n9a(),Jg);this.vXd(X)}lj(X,ca){X="UnknownMethodName";var Qb=-1;void 0!==ca.context&&null!==ca.context&&(X=ca.context.methodName,Qb=ca.context.communicationErrorRetryCount);
let Uc,Od={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};ca.rf?(Uc=ca.rf.Errors||[],this.pL.fFj(ca.rf.EditSessionIsDirty),void 0!==ca.rf.RequestTelemetryData&&null!==ca.rf.RequestTelemetryData&&(Od=ca.rf.RequestTelemetryData)):Uc=[];const me=ca.duration,Oe=qc.a(ca.url);X=new Vd(X,me,ca.totalOperationDuration,ca.X7d,ca.YH,Od,ca.Q_d,Uc,ca.httpStatus,Oe,Qb,!0,Ee.a.OF(me),this.Yqd(ca.rf),ca.responseSize,this.Lpa.n9a(),ca.responseToCallbackTime);
this.vXd(X);X.requestResourceTiming&&(Qb=X.requestResourceTiming.totalDuration-X.WfeRequestDuration,Qb>=this.$.xa.LongNetworkTimeTelemetryThresholdInMilliseconds&&ca.responseHeaders&&x.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${X.requestName}, requestDuration = ${X.requestDuration}, networkTime = ${Qb},  ServerCorrelation = ${X.correlationID}, msEdgeHeader = ${$c.a.RLb in ca.responseHeaders?ca.responseHeaders[$c.a.RLb]:""}, backendDatacenter = ${$c.a.FLd in
ca.responseHeaders?ca.responseHeaders[$c.a.FLd]:""}, proxyDatacenter = ${$c.a.HLd in ca.responseHeaders?ca.responseHeaders[$c.a.HLd]:""}`))}Jo(X,ca){X="UnknownMethodName";let Qb=-1;void 0!==ca.context&&null!==ca.context&&(X=ca.context.methodName,Qb=ca.context.communicationErrorRetryCount);const Uc=ca.duration,Od=qc.a(ca.url);ca=new Vd(X,Uc,ca.totalOperationDuration,ca.X7d,ca.YH,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},ca.Q_d,
ca.errors||[],ca.httpStatus,Od,Qb,!1,Ee.a.OF(Uc),this.Yqd(null),-1,this.Lpa.n9a(),ca.responseToCallbackTime);this.vXd(ca)}vXd(X){this.pL.G2g(X);if(Jb.EwaSettings.Da(212)){var ca=X.requestName;if(ca!==$c.a.Oza&&"SetCell"!==ca&&"FindRange"!==ca&&"FindAll"!==ca&&"FindCell"!==ca)return}ca=Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===X.requestName||null===X.requestName)&&X.isPromotedUTRRequest;Be.PDh(X,ca);this.pL.WTg(X)}Yqd(X){var ca;if(null===(ca=null===X||
void 0===X?void 0:X.CollaborationResult)||void 0===ca?0:ca.Users)return X.CollaborationResult.Users.length;X=this.$.da.Kp.length;return 0<X?X:1}static PDh(X,ca){ca?Qd.b().GFc(388829456,0,15,X):(ca=Sys.Serialization.JavaScriptSerializer.serialize(X),x.ULS.sendTraceTag(388829456,0,50,ca));if(Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==X.requestName&&null!==X.requestName&&X.isFullyLoggedKPIRequest){ca=new Map;ca.set("isUserTriggeredRequest",X.isUserTriggeredRequest.toString());
ca.set("requestDuration",X.requestDuration.toString());ca.set("totalOperationDuration",X.totalOperationDuration.toString());ca.set("requestTimeInQueue",X.requestTimeInQueue.toString());ca.set("requestInvokedTime",X.requestInvokedTime.toString());ca.set("ecsOperationDuration",X.ecsOperationDuration.toString());ca.set("ecsRequestDuration",X.EcsRequestDuration.toString());ca.set("wfeRequestDuration",X.WfeRequestDuration.toString());ca.set("timeFromLastEcsFreeze",X.TimeFromLastEcsFreeze.toString());ca.set("duringLoadOnDemand",
X.DuringLoadOnDemand.toString());ca.set("correlationID",X.correlationID);ca.set("errors",X.errors.toString());ca.set("httpStatus",X.httpStatus.toString());if(X.networkInfoData){var Qb=X.networkInfoData;ca.set("networkInfoData_bandwidthMps",void 0===Qb.bandwidthMps||null===Qb.bandwidthMps?"NA":Qb.bandwidthMps.toString());ca.set("networkInfoData_rttMs",void 0===Qb.rttMs||null===Qb.rttMs?"NA":Qb.rttMs.toString());ca.set("networkInfoData_effectiveConnection",void 0===Qb.effectiveConnection||null===Qb.effectiveConnection?
"NA":Qb.effectiveConnection)}X.requestResourceTiming&&(Qb=X.requestResourceTiming,ca.set("requestResourceTiming_fetchStart",void 0===Qb.downloadDuration||null===Qb.downloadDuration?"NA":Qb.downloadDuration.toString()));ca.set("communicationErrorRetryCount",X.communicationErrorRetryCount.toString());ca.set("successfulCall",X.successfulCall.toString());ca.set("isDocumentHidden",X.isDocumentHidden.toString());ca.set("coauthorsCount",X.coauthorsCount.toString());ca.set("responseSize",X.responseSize.toString());
ca.set("responseToCallbackTime",X.responseToCallbackTime.toString());Qd.b().GDc(X.requestName,X.successfulCall,ca)}}}Object(v.a)(Be,"RequestStatistics",null,[]);var Qe=a(217),cf=a(65),wb=a(277);class zc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(v.a)(zc,"OperationTypeStatisticsData",null,[]);class rd{constructor(X,ca){this.data=
new zc;this.data.operationName=X;this.data.isUserOperation=ca;this.data.totalCount=0;this.Ing=[];this.Jng=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Xe(X){this.data.totalCount<rd.Thd&&(this.Ing.push(X.startToNextFrame),this.Jng.push(X.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<X.startToNextFrame&&(this.data.longestStartToNextFrame=X.startToNextFrame);
this.data.longestStartToResponse<X.startToResponseRenderEnd&&(this.data.longestStartToResponse=X.startToResponseRenderEnd)}Pld(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.kgf(this.Ing),this.data.startToResponsePercentiles=this.kgf(this.Jng))}kgf(X){X.sort(dc.HelperMethods.mI);let ca;ca="("+Ee.a.tna(X,25).toString();ca=ca+", "+Ee.a.tna(X,50).toString();ca=ca+", "+Ee.a.tna(X,75).toString();ca=ca+", "+Ee.a.tna(X,95).toString();return ca+")"}}rd.Thd=1E3;Object(v.a)(rd,"OperationTypeStatistics",
null,[]);class ce{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(v.a)(ce,"RequestTypeStatisticsData",null,[]);class Me{constructor(X){this.data=
new ce;this.data.requestName=X;this.data.totalCount=0;this.Lhb=[];this.V8d=this.N8d=this.O8d=this.S8d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}NFj(X){this.data.totalCount<Me.Thd&&this.Lhb.push(X.requestDuration);this.data.totalCount++;this.S8d+=X.requestDuration;
this.O8d+=Me.ood(X.ecsOperationDuration);this.N8d+=Me.ood(X.EcsRequestDuration);this.V8d+=Me.ood(X.WfeRequestDuration);0<X.TimeFromLastEcsFreeze&&X.TimeFromLastEcsFreeze<Me.EZh&&this.data.callsDuringEcsFreeze++;X.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;X.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<X.requestDuration)this.data.longestRequest=X}Pld(){0<
this.data.totalCount&&(this.data.averageDuration=Math.floor(this.S8d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.O8d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.N8d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.V8d/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Lhb.sort(dc.HelperMethods.mI),this.data.requestDurationPercentile25=
Ee.a.tna(this.Lhb,25),this.data.requestDurationPercentile50=Ee.a.tna(this.Lhb,50),this.data.requestDurationPercentile75=Ee.a.tna(this.Lhb,75),this.data.requestDurationPercentile95=Ee.a.tna(this.Lhb,95))}static ood(X){return 0>X?0:X}}Me.EZh=3E3;Me.Thd=1E3;Object(v.a)(Me,"RequestTypeStatistics",null,[]);class ra{constructor(X,ca,Qb,Uc,Od,me,Oe,jf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=
!1;this.requests=null;this.mode=X;this.ocsCapable=ca;this.endedBySplashScreen=Qb;this.dirtySessionOnLastRecordedRequest=Uc;this.loadOnDemandCount=Od;this.maxCoauthorsCount=me;this.everConnectedToOcs=Oe;X=[];for(let kf in jf)ca=jf[kf],ca.Pld(),X.push(ca.data);this.requests=X}}Object(v.a)(ra,"SessionStatisticsData",null,[]);class sb{constructor(X){this.dirtySessionOnLastRecordedRequest=this.J5d=!1;this.dCf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=X;this.Usb={};this.Tsb={};this.Efd=
{}}oe(){var X=this.Mvh();if(Gc.a.Gha()){var ca={};ca.xlendJson=X;this.$.yra(Qe.a.Opk,ca,!1)}else cf.N(this.$.pa.ua,X,null,null,null,null,null);X=this.Nvh();Gc.a.Gha()?(ca={},ca.xlenoJson=X,this.$.yra(Qe.a.Ppk,ca,!1)):x.ULS.sendTraceTag(388776782,0,50,X);X=this.oqh();Gc.a.Gha()?(ca={},ca.xlencJson=X,this.$.yra(Qe.a.Npk,ca,!1)):x.ULS.sendTraceTag(388776770,0,50,X);this.xGj()}psc(){this.everConnectedToOcs=this.$.da.Ybb||this.everConnectedToOcs;V.Health.instance&&V.Health.instance.addOrUpdatePartCDimension("IsOcsSession",
this.everConnectedToOcs.toString())}Zh(){const X=new wb.a;let ca="";const Qb=!this.$.isAnonymousUser(),Uc=X.Rh();if(Uc){if(Qb){X.OTb("UMI_Linkable","true");return}ca=X.xPa("UMI_Linkable")}Qb||x.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${Uc}, UMIIsLinkable:${!!ca}`)}Ihb(){this.J5d=!0}fFj(X){this.dirtySessionOnLastRecordedRequest=X}G2g(X){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,X.coauthorsCount);V.Health.instance&&
V.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}WTg(X){if(!(X.requestName in this.Usb)){const ca=new Me(X.requestName);this.Usb[X.requestName]=ca}this.Usb[X.requestName].NFj(X)}VTg(X){if(!(X.name in this.Tsb)){const ca=new rd(X.name,X.isUserOperation);this.Tsb[X.name]=ca}this.Tsb[X.name].Xe(X)}sW(X){this.Efd[X.reportName]=X}xGj(){this.dirtySessionOnLastRecordedRequest=this.J5d=!1;this.dCf=this.$.da.kGd;this.maxCoauthorsCount=1;this.everConnectedToOcs=
!1;this.Usb={};this.Tsb={};this.Efd={}}Mvh(){const X=new ra(this.$.isEditMode?"edit":"view",this.$.da.ocsCapable,this.J5d,this.dirtySessionOnLastRecordedRequest,this.$.da.kGd-this.dCf,this.maxCoauthorsCount,this.everConnectedToOcs,this.Usb);return Sys.Serialization.JavaScriptSerializer.serialize(X)}Nvh(){var X=new Na.a;const ca=this.Tsb;for(let Qb in ca){const Uc=ca[Qb];Uc.Pld();X.add(Uc.data)}X=X.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(X)}oqh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Efd)}}
Object(v.a)(sb,"SessionStatistics",null,[]);class uc extends Mb.a{constructor(X){super();this.ira=this.vqa=null;this.uVe=Array(1);this.MXc=this.CHd=null;this.lj=(ca,Qb)=>{Jb.EwaSettings.Da(39)&&(this.ira=this.ira||new Be(this.$,this.pL,this.Lpa),this.ira.lj(ca,Qb))};this.Jo=(ca,Qb)=>{Jb.EwaSettings.Da(39)&&(this.ira=this.ira||new Be(this.$,this.pL,this.Lpa),this.ira.Jo(ca,Qb))};this.oe=(ca,Qb)=>{Jb.EwaSettings.Da(39)&&this.pL.oe(ca,Qb)};this.Zh=(ca,Qb)=>{Jb.EwaSettings.Da(39)&&this.pL.Zh(ca,Qb)};
this.psc=(ca,Qb)=>{Jb.EwaSettings.Da(39)&&this.pL.psc(ca,Qb)};this.$=X;Jb.EwaSettings.Da(39)&&(Ee.a.Mpf(this.$),this.kQ=new ed(this.$),this.fsh(),Jb.EwaSettings.Da(505)&&this.bdb&&(this.CHd=new Mf(this.$,this.bdb)),this.pL=new sb(this.$),this.Lpa=new fa(this.$),this.$.sk(this.oe),this.$.pa.Ht(this.lj),this.$.pa.Pz(this.Jo),this.$.da.rCe(this.psc),Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.da.Ol(this.Zh))}get bdb(){return this.MXc}dispose(){this.$&&Jb.EwaSettings.Da(39)&&
(this.$.Ym(this.oe),this.$.pa.Uu(this.lj),this.$.pa.UA(this.Jo),this.$.da.D7f(this.psc),Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.da.mo(this.Zh));fd.a.Ma(this.Lpa);fd.a.Ma(this.bdb);this.MXc=null;fd.a.Ma(this.kQ);this.kQ=null;fd.a.Ma(this.CHd);this.$=this.CHd=null;super.dispose()}Ihb(){Jb.EwaSettings.Da(39)&&this.pL.Ihb()}JDc(X,ca,Qb,Uc,Od,me,Oe,jf,kf,Kf,cg,jg,$f,Jg){Jb.EwaSettings.Da(39)&&(this.ira=this.ira||new Be(this.$,this.pL,this.Lpa),this.ira.JDc(X,ca,Qb,
Uc,Od,me,Oe,jf,kf,Kf,cg,jg,$f,Jg))}zRb(X,ca){Jb.EwaSettings.Da(39)&&(this.vqa=this.vqa||new Tb(this.$,this.pL,this,this.kQ),this.vqa.zRb(X,ca))}yDc(){Jb.EwaSettings.Da(39)&&(this.vqa=this.vqa||new Tb(this.$,this.pL,this,this.kQ),this.vqa.yDc())}FDc(){Jb.EwaSettings.Da(39)&&(this.vqa=this.vqa||new Tb(this.$,this.pL,this,this.kQ),this.vqa.FDc())}sW(X){Jb.EwaSettings.Da(39)&&this.pL.sW(X)}rpd(X){return Jb.EwaSettings.Da(39)?this.uVe[X]:null}Dfg(X){X&&(this.uVe[X.type]=X)}n9a(){return this.Lpa.n9a()}fsh(){z.a.Eo&&
void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.MXc=new If(this.$,this.kQ))}}Object(v.a)(uc,"SessionStatisticsManager",Mb.a,[14]);var od=a(106),Ld=a(1117),ue=a(135),Xe=a(148);class re{constructor(X,ca){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=
!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=X;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=ca}n8d(){return dd.a.ye(this)}}Object(v.a)(re,"AppUnloadInfo",
null,[]);var Gf=a(731),Vf=a(124),pf=a(576);class tf{constructor(X){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=X.ZOe+X.Stg;this.dataLossReason=X.cLe;this.Ech(X.Wae)}Ech(X){const ca=new Gf.a(pf.a.aN());let Qb=0,Uc=0;for(const Od of X)ca.Wc(Od)||ca.ga(Od,0),X=ca.ga(Od,ca.ma(Od)+1),X>Qb&&(Qb=X,Uc=Od);Qb>this.mostCommonOperationCount&&(this.mostCommonOperationName=Vf.a(Uc),this.mostCommonOperationCount=
Qb)}}Object(v.a)(tf,"DataLossInfo",null,[]);var ag=a(66);class Wf{constructor(X){this.O6c="AppUnloadInfo";this.No=this.$=this.workbookHashedId=this.uB=null;this.Qee=this.nie=!1;this.kh=null;this.hpf=0;this.Dga=(ca,Qb)=>{this.hpf=Qb.zKc};this.ZVf=(ca,Qb)=>{Qb.Wae.length&&this.$.xK&&(this.uB.dataLossInfo=new tf(Qb),this.uB.wasDataLostDuringUnload=!0,this.nib())};this.Zh=()=>{this.$dg();this.$.da.mo(this.Zh)};this.FTa=()=>{this.uB.wasUpdatedOnBeforeUnload=!0;this.uB.inactivityDurationBeforeUnloadSeconds=
this.kh.Ckb<Wf.tYi?this.hpf:this.kh.Ckb;this.ywg()};this.jOb=()=>{this.uB.wasUpdatedOnUnload=!0;this.ywg();Sys.Application.remove_unload(this.jOb)};this.Cyc=()=>{this.uB.lastSilentReopenStartTime=td.a.$a.Wd;this.uB.lastSilentReopenEndTime=null;this.nib();this.$.Pm(this.$Nb)};this.$Nb=()=>{this.uB.lastSilentReopenEndTime=td.a.$a.Wd;this.nib();this.$.Rn(this.$Nb)};this.localStorage=new wb.a;this.localStorage.Rh()&&(this.$=X,this.workbookHashedId=ag.a(this.$),this.uB=new re(this.workbookHashedId,this.$.xa.UserSessionId),
this.No=Xe.a.instance.XJ(),this.No.la("beforeunload",this.FTa),this.$.userOperationManager.B1g(this.ZVf),X.da.Og?this.$dg():this.$.da.Ol(this.Zh),this.kh=this.$.da.kh,this.kh.qwa(this.Dga),Sys.Application.add_unload(this.jOb),this.$.da.eub(this.Cyc))}get dialogPromptedOnUnload(){return this.nie}set dialogPromptedOnUnload(X){this.nie=X;this.uB?(this.uB.dialogPromptedOnUnload=X,this.nib()):this.localStorage.Rh()&&x.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Rh()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.Qee}set apiBeforeCloseNotificationEnabledOnUnload(X){this.Qee=
X;this.uB?(this.uB.apiBeforeCloseNotificationEnabledOnUnload=X,this.nib()):this.localStorage.Rh()&&x.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Rh()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.VDj(this.ZVf);this.kh&&(this.kh.jEa(this.Dga),this.kh=null);this.No.zH();this.$=this.No=null}ywg(){this.GUj();this.nib()}GUj(){this.uB.wasOfflineDuringUnload=this.$.Ig.m9;
this.uB.timeFromLastConnectivity=ue.a(td.a.$a,this.$.Ig.SAf);this.uB.timeFromLastDisconnectionStart=ue.a(td.a.$a,this.$.Ig.NOi);this.uB.disconnectionSource=Enum.toString(Ld.a,this.$.Ig.disconnectionSource);this.uB.hadConnectivityIssuesDuringUnload=this.$.Ig.Coa;this.uB.timeFromLastStatusCode0=ue.a(td.a.$a,this.$.Ig.RAf)}nib(){this.uB.timestamp=Date.now();this.localStorage.OTb(this.O6c,this.uB.n8d())}$dg(){const X=this.localStorage.xPa(this.O6c);if(X)try{const ca=dd.a.nk(X);this.localStorage.nVd(this.O6c);
const Qb=this.EWi(ca);x.ULS.sendTraceTag(574677456,0,50,Qb)}catch(ca){x.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${ca.message}`)}else x.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}EWi(X){const ca={};ca.WACSessionID=X.wacSessionId;ca.wasRefreshed=this.Cgh(X,this.$.xa.MaxAppReloadDurationIndicatingRefresh);ca.closedWithDialogConfirmation=X.dialogPromptedOnUnload;
ca.wasOfflineDuringUnload=X.wasOfflineDuringUnload;ca.TimeFromLastConnectivityMs=X.timeFromLastConnectivity;ca.TimeFromLastDisconnectionStart=X.timeFromLastDisconnectionStart;ca.wasDataLostDuringUnload=X.wasDataLostDuringUnload;ca.DataLossInfo=X.dataLossInfo;ca.flushedOnUnload=X.wasUpdatedOnUnload;ca.flushedOnBeforeUnload=X.wasUpdatedOnBeforeUnload;ca.InactivityDurationBeforeUnload=X.inactivityDurationBeforeUnloadSeconds;ca.DisconnectionSource=X.disconnectionSource;ca.hadConnectivityIssuesDuringUnload=
X.hadConnectivityIssuesDuringUnload;ca.TimeFromLastStatusCode0=X.timeFromLastStatusCode0;ca.LastSilentReopenStartTime=X.lastSilentReopenStartTime;ca.LastSilentReopenEndTime=X.lastSilentReopenEndTime;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(ca.ApiBeforeCloseNotificationEnabledOnUnload=X.apiBeforeCloseNotificationEnabledOnUnload);return U.c(ca)}Cgh(X,ca){const Qb=window.performance.timing.navigationStart-X.timestamp;(X=this.workbookHashedId===
X.workbookHashedId&&Qb<ca)&&x.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return X}static la(X){X.da.ae.inWebPart||X.ea.Ja(410,new Wf(X))}}Wf.tYi=10;Object(v.a)(Wf,"AppUnloadTelemetryManager",null,[394,5]);var vg=a(16);class Nf{constructor(X){this.gWe=!1;this.iWe=null;this.df=()=>{this.PJj();qd.h(this.$).ha&&qd.h(this.$).ha.zZ(this.df)};this.cm=(ca,Qb)=>{Qb.na&&!this.L7d.has(Qb.na.name)&&(this.L7d.add(Qb.na.name),qd.h(this.$).ha&&(qd.h(this.$).ha.zZ(this.df),
qd.h(this.$).ha.zW(this.df)))};this.$=X;this.tqg=new Set;this.L7d=new Set;this.$.va&&this.$.va.na&&this.L7d.add(this.$.va.na.name);qd.h(this.$).ha.zW(this.df);this.$.va.Fi(this.cm)}dispose(){this.$=null}PJj(){this.iWe||this.Nch();const X=qd.d(qd.h(this.$));if(!this.gWe){const ca=vg.a.instance.Ia(281).split(",");X.push(...ca);this.gWe=!0}for(const ca of X)ca&&!this.tqg.has(ca)&&(this.mTi(ca),this.tqg.add(ca))}mTi(X){this.Wdh(X)}Nch(){this.iWe=Nf.Aza("monospace");Nf.Aza("sans-serif");Nf.Aza("serif")}Wdh(X){Nf.Aza(`${X},${"monospace"}`);
Nf.Aza(`${X},${"sans-serif"}`);Nf.Aza(`${X},${"serif"}`)}static la(X){if(Jb.EwaSettings.Da(61)){const ca=new Nf(X);X.ea.Ja(210,ca)}}static Aza(X){const ca=document.createElement("div"),Qb=document.createElement("div");ca.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Nf.uUj(Qb,X);document.body.appendChild(ca);ca.appendChild(Qb);Qb.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";X=Qb.offsetWidth+"x"+Qb.offsetHeight;document.body.removeChild(Qb.parentNode);
return X}static uUj(X,ca){X.style.cssText="display: inline; visibility: hidden;";X.style.fontSize="100px";X.style.fontWeight="normal";X.style.fontStyle="normal";X.style.letterSpacing="normal";X.style.lineHeight="normal";X.style.whiteSpace="nowrap";X.style.fontFamily=ca}}Object(v.a)(Nf,"FontTelemetryManager",null,[5]);var Rg=a(244),Tf=a(182),yh;(function(X){X[X.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";X[X.reactSingleLineRibbon=1]="reactSingleLineRibbon";X[X.reactMultiLineRibbon=2]="reactMultiLineRibbon";
X[X.invalid=3]="invalid"})(yh||(yh={}));Object(v.b)("RibbonMode",yh);var l=a(115);let ba=class extends nc.a{constructor(){super();this.GO=!1;this.hoe=this.goe=null;this.QMd=()=>{this.lwg()};this.Ocj=()=>{fd.a.Ma(this.r1);fd.a.Ma(this.No)};this.r1=Xe.a.instance.MMa();this.No=Xe.a.instance.XJ();this.r1.la("visibilitychange",this.QMd);this.No.la("pagehide",this.Ocj);this.lwg()}get Ui(){return this.GO}get eAf(){return this.goe}get Xsc(){return this.hoe}A0(X){this.addHandler("ekdh",X)}QVa(X){this.removeHandler("ekdh",
X)}vW(X){this.addHandler("ekduh",X)}hEa(X){this.removeHandler("ekduh",X)}OF(X){return this.Ui?!0:this.Xsc?Wc.getElapsedMilliseconds(this.Xsc,td.a.$a.Wd)<X:!1}dispose(){fd.a.Ma(this.r1);fd.a.Ma(this.No);super.dispose()}lwg(){this.GO="hidden"===window.document.visibilityState;this.Ui?(this.raiseEvent("ekdh"),this.goe=td.a.$a.Wd):(this.raiseEvent("ekduh"),this.hoe=td.a.$a.Wd)}};ba=Object(Gb.a)([Object(yc.d)(Zc.K)],ba);Object(v.a)(ba,"DocumentVisibilityObserver",nc.a,[364,5]);var Fa=a(133);class db{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(v.a)(db,"FramePerformanceData",null,[]);class Yb{constructor(X){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new db;this.l2FramePerformanceData=new db;this.l3FramePerformanceData=new db;this.name=X}}Object(v.a)(Yb,"FramePerformanceDataGroup",null,[]);class Cc{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(v.a)(Cc,"FramePerformanceSessionEndsReport",null,[248]);class ad{constructor(X){this.lPd={};this.Nka=null;this.Blb=(ca,Qb)=>{ca.longFramesOverThresholdOps++;ca.maxLongFrameDuration=Math.max(ca.maxLongFrameDuration,Qb)};this.zg=new Cc;this.Psh();X.ea.Zc(276,()=>{Bd.a(X).sW(this.zg)})}Psh(){this.Nka=new Yb("AllGridOperationsData");this.zg.operationsGroups.push(this.Nka);this.hyb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.hyb("DragScroll",["DragScroll"]);this.hyb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.hyb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.hyb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}GFj(X,ca,Qb,Uc){const Od=this.G9h(X);Od&&(Fa.b(this.zg.operationsGroups,me=>ub.a.equals(me.name,Od.name,!1))||this.zg.operationsGroups.push(Od),Od.count++,this.zMc(ca,Od),this.vMc(Qb,Od),this.Nka.count++,
this.zMc(ca,this.Nka),this.vMc(Qb,this.Nka),0<Uc&&this.djk(Uc,Od),0<=ca&&this.rik(ca,Od))}Fjk(){for(const X of this.zg.operationsGroups)ad.yik(X)}hyb(X,ca){X=new Yb(X);for(const Qb of ca)this.lPd[Qb]=X}G9h(X){return X in this.lPd?this.lPd[X]:null}rik(X,ca){30>X&&this.t$d(Qb=>{Qb.l1FramePerformanceData.fpsUnderThresholdOps++},ca);15>X&&this.t$d(Qb=>{Qb.l2FramePerformanceData.fpsUnderThresholdOps++},ca);5>X&&this.t$d(Qb=>{Qb.l3FramePerformanceData.fpsUnderThresholdOps++},ca)}djk(X,ca){100<=X&&(this.Clb(ca.l1FramePerformanceData,
X,this.Blb),this.Clb(this.Nka.l1FramePerformanceData,X,this.Blb));300<=X&&(this.Clb(ca.l2FramePerformanceData,X,this.Blb),this.Clb(this.Nka.l2FramePerformanceData,X,this.Blb));600<=X&&(this.Clb(ca.l3FramePerformanceData,X,this.Blb),this.Clb(this.Nka.l3FramePerformanceData,X,this.Blb))}t$d(X,ca){ca&&(X(ca),X(this.Nka))}Clb(X,ca,Qb){X&&Qb(X,ca)}zMc(X,ca){ca.minFPS=-1===ca.minFPS?X:Math.min(ca.minFPS,X)}vMc(X,ca){ca.maxFPS=Math.max(ca.maxFPS,X)}static yik(X){ad.Z$d(X.l1FramePerformanceData,X.count);
ad.Z$d(X.l2FramePerformanceData,X.count);ad.Z$d(X.l3FramePerformanceData,X.count)}static Z$d(X,ca){X.fpsUnderThresholdOpsPercentage=100*X.fpsUnderThresholdOps/ca;X.longFramesOverThresholdOpsPercentage=100*X.longFramesOverThresholdOps/ca}}Object(v.a)(ad,"FramePerformanceSessionEndsReportManager",null,[]);class cd{constructor(){this.f=null}}Object(v.a)(cd,"FpsDataWrapper",null,[]);class ae{constructor(X,ca){this.duration=this.startSecond=0;this.startSecond=void 0===X?-1:X;this.duration=void 0===ca?
-1:ca}}Object(v.a)(ae,"LongFrameData",null,[]);var se=a(361);class ze{constructor(X,ca,Qb,Uc,Od,me,Oe,jf,kf,Kf){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===X?null:X;this.count=void 0===ca?0:ca;this.start=void 0===Qb?-1:Qb;this.end=void 0===Uc?-1:Uc;this.Avg=void 0===Od?0:Od;this.Max=void 0===me?-1:me;this.Min=se.a.YBg;this.longFrameCount=void 0===Oe?0:Oe;this.coauth=(void 0===
jf?-1:jf)||1;this.tfAppInt=void 0===kf?-1:kf;this.Props=void 0===Kf?null:Kf;this.LFrame=null}}Object(v.a)(ze,"OperationFPSData",null,[]);var of=a(37),mf=a(811);class Uf extends Mb.a{constructor(X){super();this.Bub=-1;this.YEd=0;this.MBa=new Date(0);this.R0=null;this.bma={};this.zya=new Na.a;this.BYd=this.ucb=!1;this.t8a=null;this.oKc=this.Udb=0;this.isSynthetic=!1;this.K9e=()=>{const ca=new Date;var Qb=ca.getMinutes();const Uc=ca.getSeconds();this.TJb&&ca.getTime()-this.TJb.getTime()>this.T9j?(this.stop(),
this.Cmd(ca)):(Qb!==this.YEd&&(this.Cmd(ca),this.YEd=Qb),this.ucb&&(this.Mf.Ui?this.R0[Uc]=Uf.Lec:(this.RXe(Uc),this.ucb=!1,this.zya.clear(),this.bma={})),this.R0[Uc]!==Uf.Lec&&(this.R0[Uc]++,Qb=ca.getTime()-this.MBa.getTime(),Qb>this.tEf&&this.JTi(this.MBa,Qb)),this.Bub=window.requestAnimationFrame(this.K9e),this.MBa=ca)};this.pI=()=>{this.ucb=!0};this.rLf=()=>{this.pause()};this.tLf=()=>{this.BYd&&this.resume()};this.Uj=()=>{this.za.S8()&&this.mjk()};this.TJb=new Date;this.Mf=new ba;this.Mf.A0(this.pI);
t.AFrameworkApplication.W4c(this.rLf);t.AFrameworkApplication.X4c(this.tLf);this.$=X;this.tEf=X.xa.LongFrameThresholdMs;this.vVi="MoreThan_"+this.tEf.toString()+"_Ms";this.S9j=X.xa.ThresholdToEndOperationTrackingSeconds;this.T9j=X.xa.ThresholdToStopFPSTrackingMS;this.za=qd.h(this.$).za;t.AFrameworkApplication.fe&&t.AFrameworkApplication.fe.IsSynthetic&&(this.isSynthetic=ub.a.compare(t.AFrameworkApplication.fe[$c.a.isSynthetic],"True",!0)?!1:!0);this.za.su(this.Uj);this.RXd()}start(){this.BYd=!0;this.resume()}stop(){this.BYd=
!1;this.pause()}dispose(){this.stop();this.Mf.QVa(this.pI);t.AFrameworkApplication.Y6f(this.rLf);t.AFrameworkApplication.Z6f(this.tLf);fd.a.Ma(this.Mf);this.za.eu(this.Uj);super.dispose()}E5j(X,ca){const Qb=X in this.bma?this.bma[X]:null;this.TJb=new Date;this.start();const Uc=this.TJb.getSeconds(),Od=Uc+this.S9j;Qb&&Uc<=Qb.end?(Qb.count++,Qb.end=Od):(Qb&&Uc>Qb.end&&this.zya.add(Qb),this.bma[X]=new ze(X,1,Uc,Od,void 0,void 0,void 0,this.$.da.Kp.length,Nc.PageLoadTrackingInfo.instance.Qza(this.TJb),
ca))}krh(){this.t8a||(this.Cmd(new Date),this.t8a=new ad(this.$))}resume(){this.Wtf()||!this.za.YQ||this.isSynthetic||(this.ucb=this.Mf.Ui,this.MBa=new Date,this.YEd=this.MBa.getMinutes(),this.RXd(),this.RXe(this.MBa.getSeconds()),this.Bub=window.requestAnimationFrame(this.K9e))}Wtf(){return 0<=this.Bub}pause(){this.Wtf()&&(this.ucb||(this.SXe((new Date).getSeconds()),x.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.R0.toString()}`)),window.cancelAnimationFrame(this.Bub),this.Bub=-1)}Cmd(X){if(X.getTime()-
this.MBa.getTime()<Uf.fZi&&(this.ucb&&this.SXe(this.MBa.getSeconds()),this.jGh(),0<this.zya.count&&(X={},X.NonEmptyCellsCount=this.Udb,X.TextCellsCount=this.oKc,X.xlfpsJson=Object(Le.a)(new cd,{f:this.zya.toArray()}),X.memoryInfo=this.EYi(),X.zoom=of.a(this.$)?of.a(this.$).zoom:1,X.RibbonMode=Tf.a(this.$)?yh[Tf.a(this.$).bR]:Uf.invalid,X.deviceMemory=navigator.deviceMemory||0,X.hardwareConcurrency=navigator.hardwareConcurrency||0,X=JSON.stringify(X),x.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.R0.toString()}`),
!this.isSynthetic))){if(Gc.a.Gha()){var ca={};ca.xlfpsJson=X;this.$.yra(Qe.a.Qpk,ca,!1)}else x.ULS.sendTraceTag(388781010,0,50,`${X}`);for(let Qb of this.zya){ca=1E3>=this.Udb?"0_1000":3E3>=this.Udb?"1000_3000":"3000_inf";const Uc=new Map;Uc.set("Operation",Qb.Op);Uc.set("BucketOfRenderedCells",ca);V.Health.instance.recordKpiUsage(nf.a.longFrame,0,lf.a.canvas,Uc);0<Qb.longFrameCount&&V.Health.instance.recordKpiFailure(nf.a.longFrame,"LongFrame",!1,!0,Object(Le.a)(new ja.a,{extendedProperties:Uc}));
3E4<Qb.tfAppInt&&(0<Qb.longFrameCount?Qd.b().j9f(0,this.vVi,Uc):Qd.b().k9f(0,Uc))}x.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${X.length}`)}this.reset()}EYi(){const X={};if(window.performance){const ca=window.performance.memory;ca&&(X.jsHeapSizeLimit=ca.jsHeapSizeLimit,X.usedJSHeapSize=ca.usedJSHeapSize,X.totalJSHeapSize=ca.totalJSHeapSize)}return X}reset(){this.zya.clear();this.bma={};this.RXd()}jGh(){var X=!0;X=void 0===X?!0:X;if(this.R0){for(const ca of mf.a(this.bma)){const Qb=
this.bma[ca];Qb.end=Math.min(this.R0.length-1,Qb.end);this.zya.add(Qb)}this.ddh(this.zya,this.R0,X)}}ddh(X,ca,Qb){Qb=void 0===Qb?!0:Qb;for(let Uc of X){let Od=X=0;if(Uc.end<ca.length){for(let me=Uc.start;me<=Uc.end;me++){const Oe=ca[me];0<=Oe&&(Uc.Max=Math.round(Math.max(Uc.Max,Oe)),Uc.Min=Math.round(Math.min(Uc.Min,Oe)),X+=Oe,Od++)}0<Od&&(Uc.Avg=Math.round(X/Od));Qb&&this.t8a&&this.t8a.GFj(Uc.Op,Uc.Min,Uc.Max,Uc.LFrame?Uc.LFrame.duration:-1);Uc.Props&&(this.eek(Uc),Uc.Props=null)}}Qb&&this.t8a&&
this.t8a.Fjk()}RXd(){this.R0=Array(60).fill(0)}RXe(X){X++;for(let ca=0;ca<X;ca++)this.R0[ca]=Uf.Lec}SXe(X){for(;60>X;X++)this.R0[X]=Uf.Lec}JTi(X,ca){X=X.getSeconds();var Qb=mf.a(this.bma);if(0<Qb.length)for(const Uc of Qb)if(Qb=this.bma[Uc],X>=Qb.start&&X<Qb.end)Qb.LFrame?Qb.LFrame.duration<ca&&(Qb.LFrame.startSecond=X,Qb.LFrame.duration=ca,Qb.longFrameCount++):(Qb.LFrame=new ae(X,ca),Qb.longFrameCount++)}mjk(){this.oKc=this.Udb=0;for(const X of qd.h(this.$).Mp){const ca=X.AGa;for(let Qb in ca){const Uc=
this.za.Qj(ca[Qb].hashCode);if(null===Uc||void 0===Uc?0:Uc.il)this.Udb+=Uc.Jf.NonEmptyCellsCount,this.oKc+=Uc.Jf.TextValueCellsCount}}}eek(X){const ca=X.Props;if(Ed.a.wUb in ca&&ca[Ed.a.wUb]&&Ed.a.qWb in ca){let Qb;(Qb=Object(N.a)(Rg.a,ca[Ed.a.qWb]))&&Qb.continueWith(Uc=>{l.TextEditorTelemetry.instance.kWg(X.Op,X.Min,!!X.LFrame,X.LFrame?X.LFrame.duration:0,Uc.result)})}}}Uf.Lec=-1;Uf.fZi=6E4;Uf.invalid="Invalid";Object(v.a)(Uf,"FramePerformanceTracker",Mb.a,[407,5]);class Jf extends Zb.a{constructor(X){super();
this.$=X;this.Md()}create(){let X=this.$.ea.Ba(263);X||(X=this.$.ea.Ja(263,new Uf(this.$)));this.qd(X)}static la(X){X.ea.Ja(264,new Jf(X))}}Object(v.a)(Jf,"FramePerformanceTrackerFactory",Zb.a,[]);var Pf=a(1214),Qf=a(1003);class ff{Yh(X,ca){return new Qf.a(X,ca)}Le(X,ca){X=this.Yh(X,ca);X.start();return X}}Object(v.a)(ff,"DefaultStopwatchBuilder",null,[158]);class Ug{constructor(){this.uua=new ff}Yh(X,ca){return this.uua.Yh(X,ca)}Le(X,ca){return this.uua.Le(X,ca)}}Object(v.a)(Ug,"StopwatchBuilder",
null,[158]);var Zh=a(357),Nh=a(971),Tg=a(972),dh;(function(X){X[X.actions=0]="actions";X[X.correlationStart=1]="correlationStart";X[X.reorderSheetOp=2]="reorderSheetOp";X[X.formatCellOp=3]="formatCellOp";X[X.copyOp=4]="copyOp";X[X.pasteOp=5]="pasteOp";X[X.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";X[X.instantaneousSetData=7]="instantaneousSetData";X[X.immediateSetData=8]="immediateSetData";X[X.dependentCellsCalc=9]="dependentCellsCalc";X[X.dependentCellsGraphStat=10]="dependentCellsGraphStat";
X[X.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";X[X.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";X[X.gridBlockUpdates=13]="gridBlockUpdates";X[X.browserAppStart=14]="browserAppStart";X[X.linkedObjects=15]="linkedObjects";X[X.longFrames=16]="longFrames";X[X.task=17]="task";X[X.conflictInEditing=18]="conflictInEditing";X[X.incomingPresenceData=19]="incomingPresenceData";X[X.editorTableDelay=20]="editorTableDelay";X[X.presenceStartup=21]="presenceStartup";
X[X.presenceDelete=22]="presenceDelete";X[X.editorEvent=23]="editorEvent";X[X.editorTime=24]="editorTime";X[X.gridScreenReaderOps=25]="gridScreenReaderOps";X[X.sendPresenceToService=26]="sendPresenceToService";X[X.IME=27]="IME";X[X.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";X[X.customizeStatusBar=29]="customizeStatusBar";X[X.clientWebRequests=30]="clientWebRequests";X[X.showCommentTaskPane=31]="showCommentTaskPane";X[X.applyThreadedCommentChange=32]="applyThreadedCommentChange";X[X.upgradeLegacyCommentsChange=
33]="upgradeLegacyCommentsChange";X[X.findNextOrPreviousComment=34]="findNextOrPreviousComment";X[X.goto=35]="goto";X[X.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";X[X.richApiInvocation=37]="richApiInvocation";X[X.fxLibrary=38]="fxLibrary";X[X.embeddedApiSession=39]="embeddedApiSession";X[X.numberFormattingCalculator=40]="numberFormattingCalculator";X[X.requestDataAfterSend=41]="requestDataAfterSend";X[X.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";X[X.copy=43]="copy";
X[X.paste=44]="paste";X[X.dragDrop=45]="dragDrop";X[X.clearCopyState=46]="clearCopyState";X[X.webWorkerRecalcStats=47]="webWorkerRecalcStats";X[X.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";X[X.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";X[X.customSort=50]="customSort";X[X.namedSheetViewUserAction=51]="namedSheetViewUserAction";X[X.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";X[X.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";
X[X.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";X[X.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";X[X.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";X[X.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";X[X.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";X[X.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(dh||(dh={}));Object(v.b)("UsageTable",dh);var Zg=a(432),$g=a(485),Gh=a(616),Eh=a(669),
Sh=a(282);class rh extends Sys.EventArgs{constructor(){super();this.E0i=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(v.a)(rh,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Lh{constructor(X,ca){this.mZd=void 0===ca?1:ca;this.total=X}get average(){return this.total/this.mZd}Hjh(X){return new Lh(this.total+X.total,this.mZd+X.mZd)}static bah(X,ca){return`${X}_${ca}`}}Object(v.a)(Lh,"StopwatchAverage",null,[]);var Oh;(function(X){X[X.longFrame=0]="longFrame";X[X.longGetRange=
1]="longGetRange";X[X.longJsTask=2]="longJsTask";X[X.viewportCalculationLoops=3]="viewportCalculationLoops"})(Oh||(Oh={}));Object(v.b)("UtrKpiVeto",Oh);class pg{static K9a(X){return Enum.toString(Oh,X)}}pg.uGa="UTR";Object(v.a)(pg,"KpiConstants",null,[]);class Zf{}Zf.iyg="UTRVetoName";Zf.ayg="UTRErrorName";Zf.eyg="UTROperationName";Zf.fNc="UTRDuration";Zf.gyg="UTREndedInPhase";Zf.$ae="UTRMessage";Zf.hyg="UtrUnavailabilityType";Zf.operationName="OperationName";Zf.duration="Duration";Zf.message="Message";
Object(v.a)(Zf,"UtrAdditionalData",null,[]);class Og{}Og.Snk="VetoLike";Og.SZe="E2EOperationPerf";Og.mGj="RequestPerf";Og.Zek="UnavailabilityDurations";Object(v.a)(Og,"UtrTypes",null,[]);class ig{wRb(X,ca,Qb){Qb=void 0===Qb?null:Qb;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Qb=Qb?Object(Le.a)(new ja.a,{extendedProperties:Qb}):null,X=pg.K9a(X),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+X,ca,!1,!0,"",Qb))}iTb(X,ca,Qb,Uc,Od,me){me[pg.uGa]=Og.Snk;me[Zf.iyg]=
pg.K9a(Uc);me[Zf.ayg]=Od;x.ULS.sendTraceTag(X,ca,Qb,dd.a.ye(me));delete me[pg.uGa];delete me[Zf.iyg];delete me[Zf.ayg]}}Object(v.a)(ig,"UtrKpiVetoReporter",null,[]);class zg{DRb(X,ca){ca=void 0===ca?null:ca;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+pg.K9a(X),0,"",ca)}wRb(X,ca,Qb){Qb=void 0===Qb?null:Qb;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(X=pg.K9a(X),V.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+
X,ca,!1,!0,this.Cdd(Qb)))}tFj(X,ca){ca=void 0===ca?null:ca;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+pg.K9a(X),"",this.Cdd(ca))}sFj(X,ca,Qb){Qb=void 0===Qb?null:Qb;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(X=pg.K9a(X),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+X,ca,!1,!0,"",this.Cdd(Qb)))}Cdd(X){return X?Object(Le.a)(new ja.a,{extendedProperties:X}):null}}Object(v.a)(zg,
"UtrKpiVetoUsageReporter",null,[]);class Xg{zDc(X,ca,Qb){Qb=void 0===Qb?null:Qb;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+X,"",Object(Le.a)(new ja.a,{extendedProperties:Qb,durationMs:ca}))}GDc(X,ca,Qb){Qb=void 0===Qb?null:Qb;Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ca?V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+X,"",Object(Le.a)(new ja.a,{extendedProperties:Qb})):
V.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+X,"",!1,!1,"",Object(Le.a)(new ja.a,{extendedProperties:Qb})))}fTb(X,ca,Qb,Uc,Od,me,Oe,...jf){Oe=String.format(Oe,...jf);jf={};jf[pg.uGa]=Og.SZe;jf[Zf.eyg]=Uc;jf[Zf.gyg]=Od;jf[Zf.fNc]=me;jf[Zf.$ae]=Oe;x.ULS.sendTraceTag(X,ca,Qb,dd.a.ye(jf))}FFc(X,ca,Qb,Uc,Od,me,Oe){const jf={};jf[pg.uGa]=Og.SZe;jf[Zf.eyg]=Uc;jf[Zf.gyg]=Od;jf[Zf.fNc]=me;jf[Zf.$ae]=Oe;x.ULS.sendTraceTag(X,ca,Qb,dd.a.ye(jf))}hTb(X,ca,Qb,Uc,Od,me){this.Lhg(me,Uc,Od);x.ULS.sendTraceTag(X,
ca,Qb,dd.a.ye(me));this.Xyh(me)}gTb(X,ca,Qb,Uc,Od,me,...Oe){me=String.format(me,...Oe);Oe={};this.Lhg(Oe,Uc,Od,me);x.ULS.sendTraceTag(X,ca,Qb,dd.a.ye(Oe))}GFc(X,ca,Qb,Uc){Uc[pg.uGa]=Og.mGj;x.ULS.sendTraceTag(X,ca,Qb,dd.a.ye(Uc));delete Uc[pg.uGa]}Lhg(X,ca,Qb,Uc){Uc=void 0===Uc?null:Uc;X[pg.uGa]=Og.Zek;X[Zf.hyg]=ca;X[Zf.fNc]=Qb;Uc&&(X[Zf.$ae]=Uc)}Xyh(X){delete X[pg.uGa];delete X[Zf.hyg];delete X[Zf.fNc]}}Object(v.a)(Xg,"UtrOperationPerfReporter",null,[]);class Fg extends nc.a{constructor(X,ca,Qb,Uc,
Od,me){Qb=void 0===Qb?null:Qb;Uc=void 0===Uc?null:Uc;Od=void 0===Od?null:Od;me=void 0===me?!1:me;super();this.ySh=[Ed.a.dJe,Ed.a.A1e,Ed.a.B1e,Ed.a.eoc,Ed.a.Wtc,Ed.a.GRi,Ed.a.renderCachedContent,Ed.a.renderServerContent,Ed.a.bdc,Ed.a.QKj,Ed.a.vcg,Ed.a.wcg,Ed.a.AOj];this.xrb=this.JHa=this.PXb=this.Olb=this.ope=this.hIe=this.k1a=this.owe=null;this.hYf=this.bJe=!1;this.dyg=this.cyg=this.fyg=this.EXd=this.vzg=null;this.QJi=Jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7971370_ResourceTimingFontStatus");
this.oTf=(Oe,jf)=>{for(Oe=0;Oe<jf.entries.length;Oe++){const jg=jf.entries[Oe];jg.url=F.a.removeParameter(jg.url,t.AFrameworkApplication.CJ);var kf=F.a.V3(jg.url);!Jb.EwaSettings.Da(426)&&this.FJi(jg.url,kf)&&(jg.behavior=1);if("img"===jg.ut.initiatorType&&kf.endsWith(Nh.a.Yhd)){var Kf=F.a.b2(jg.url,Nh.a.Xhd),cg=F.a.b2(jg.url,Nh.a.Zhd);jg.nX=`${jg.nX}imageID=${Kf}, imgStateID=${cg}`}this.QJi&&"css"===jg.ut.initiatorType&&"responseStatus"in jg.ut&&(Kf=`responseStatus=${jg.ut.wsk}`,jg.nX=jg.nX?`${jg.nX},${Kf}`:
Kf);Kf=jg.ut.transferSize;let $f;cg=jg.ut.decodedBodySize;void 0!==Kf&&null!==Kf&&void 0!==cg&&null!==cg?$f=0===Kf&&0<cg:void 0!==Kf&&null!==Kf&&($f=0===Kf);Nc.PageLoadTrackingInfo.instance.pXg(kf,Math.round(jg.ut.fetchStart),Math.round(jg.ut.responseEnd),$f,this.qLi);ub.a.contains(kf,Ed.a.richTextEditor,!0)&&(kf=l.TextEditorTelemetry.instance,kf.WG(Ed.a.LHj,Math.round(jg.ut.fetchStart)),kf.WG(Ed.a.NHj,Math.round(jg.ut.responseEnd)))}};this.pI=()=>{const Oe=this.Oaa;for(let jf in Oe)Oe[jf].h=!0};
this.userSessionId=X;this.R5a=Qb=Qb||new Gh.a;this.oj=Uc||td.a.$a;this.y6j=Od||this;this.qLi=me;this.aWe=Qb.mdb();Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void yc.a.resolve(Zc.K).then(Oe=>{this.Mf=Oe;this.Mf.A0(this.pI)}):(this.Mf=new ba,this.Mf.A0(this.pI),ca.Ja(291,this.Mf))}get Oaa(){return this.owe||(this.owe={})}get gVe(){return this.Olb||this.aWe}get qVe(){return this.JHa||Fg.pJf}get t6d(){return this.hIe=this.hIe||{}}get Ozc(){return this.k1a||
"undefined"===typeof Stw?this.k1a:this.k1a=Stw.swpc}get nEf(){return this.ope=this.ope||{}}get sEa(){return this.xrb||(this.xrb=yb.a.instance.Ed("Common.NetworkTiming.IResourceTimingLogger"))}get byg(){return this.cyg||(this.cyg=new ig)}get qZa(){return this.fyg||(this.fyg=new Xg)}get gNc(){return this.dyg||(this.dyg=new zg)}WIc(X,ca,Qb,Uc,Od){Od=void 0===Od?null:Od;if(this.Oaa[Qb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.Oaa[Qb]=this.CUe(X,ca,Qb,Uc,Od)}Zfc(X,
ca){const Qb=this.Oaa[X];Qb&&(this.rQe(Qb,ca),this.Xgk(Qb),delete this.Oaa[X])}M6f(X){delete this.Oaa[X]}Kng(X,ca){this.Olb||this.yng(X,ca)}tng(){this.Kng(Fg.bud,this.oj.eg)}p0e(X,ca){ca=void 0===ca?!1:ca;if(this.Olb){if(this.JHa===Fg.EPd||this.JHa===Fg.bud){const Qb=O.a.instance;Qb.userSessionId=this.userSessionId;if(this.JHa===Fg.EPd){this.bJe||(this.tpa(X.m,Object($a.a)(Qb,Qb.Evj,"recordContentFetchEnd")),this.bJe=!0);if(ca){this.hYf||(this.tpa(X.m,Object($a.a)(Qb,Qb.Qvj,"recordPerceivedContentDisplayed")),
this.hYf=!0);return}this.tpa(X.m,Object($a.a)(Qb,Qb.Dvj,"recordContentDisplayed"))}else this.JHa===Fg.bud&&(ca=this.Oaa[this.PXb])&&this.tpa(Sh.a(X,ca.s),Object($a.a)(Qb,Qb.Lvj,"recordInteractivityContentDisplayed"),!1)}this.Zfc(this.PXb,X);this.PXb=this.JHa=this.Olb=null}}tpa(X,ca,Qb){Qb=void 0===Qb?!0:Qb;O.a.DS&&Object(Zh.a)(Eh.PerformanceClock,td.a.$a)&&Qb&&(X+=window.performance.timing.navigationStart);ca(X)}pl(X){return Zg.a(X)}Wg(X,ca,Qb){Qb=void 0===Qb?!1:Qb;try{if(this.nEf[dh[X]]=!0,Qb){var Uc=
x.ULS,Od=Uc.sendTraceTag;const sd={};let Lg=null;switch(X){case 0:Lg="Actions";var me=ca.a;null!=me&&(sd.Id=me);var Oe=null==ca.b?null:ca.b;null!=Oe&&(sd.Operation=Oe);var jf=ca.c;null!=jf&&(sd.Target=jf);var kf=null==ca.d?null:ca.d.toString();null!=kf&&(sd.StartTime=kf);var Kf=null==ca.e?null:ca.e.toString();null!=Kf&&(sd.Duration=Kf);var cg=ca.f;null!=cg&&(sd.CorrelationId=cg);var jg=ca.g;null!=jg&&(sd.ParentAction=jg);var $f=null==ca.h?null:ca.h.toString();null!=$f&&(sd.DocumentHidden=$f);break;
case 1:Lg="CorrelationStart";var Jg=ca.a;null!=Jg&&(sd.CorrelationId=Jg);var Aa=ca.b;null!=Aa&&(sd.UserSessionId=Aa);var Fb=ca.c;null!=Fb&&(sd.UserAction=Fb);break;case 2:Lg="ReorderSheetOp";var kc=ca.a;null!=kc&&(sd.UserSessionId=kc);var Dc=null==ca.b?null:ca.b.toString();null!=Dc&&(sd.IsDragReorder=Dc);var Fd=null==ca.c?null:ca.c.toString();null!=Fd&&(sd.DocumentUp=Fd);var be=null==ca.d?null:ca.d.toString();null!=be&&(sd.OldIndex=be);var Wd=null==ca.e?null:ca.e.toString();null!=Wd&&(sd.NewIndex=
Wd);var Je=null==ca.f?null:ca.f.toString();null!=Je&&(sd.TotalSheets=Je);break;case 3:Lg="FormatCellOp";var Ne=ca.a;null!=Ne&&(sd.UserSessionId=Ne);var Lf=null==ca.b?null:ca.b.toString();null!=Lf&&(sd.TaskId=Lf);var Ef=null==ca.c?null:ca.c.toString();null!=Ef&&(sd.NumberOfRanges=Ef);var ia=ca.d;null!=ia&&(sd.Ranges=ia);var jb=ca.e;null!=jb&&(sd.ActiveCell=jb);var oc=null==ca.f?null:ca.f.toString();null!=oc&&(sd.ActionId=oc);var Ec=ca.g;null!=Ec&&(sd.CommandParameters=Ec);var ge=ca.h;null!=ge&&(sd.UserActionStopwatchId=
ge);break;case 4:Lg="CopyOp";var Ae=ca.a;null!=Ae&&(sd.UserSessionId=Ae);var Ze=null==ca.b?null:ca.b.toString();null!=Ze&&(sd.IsChrome=Ze);var Y=null==ca.c?null:ca.c.toString();null!=Y&&(sd.IsIE=Y);var Ua=null==ca.d?null:ca.d.toString();null!=Ua&&(sd.IsFromUI=Ua);var ac=null==ca.e?null:ca.e.toString();null!=ac&&(sd.IsCopyInLoadedRange=ac);var Kc=null==ca.f?null:ca.f.toString();null!=Kc&&(sd.IsRepeatedCopy=Kc);var Td=null==ca.g?null:ca.g.toString();null!=Td&&(sd.IsClipboarAccessSupported=Td);var Ie=
null==ca.h?null:ca.h.toString();null!=Ie&&(sd.IsClipboarAccessInstallationSupported=Ie);var df=null==ca.i?null:ca.i.toString();null!=df&&(sd.RibbonCommand=df);var gf=null==ca.j?null:ca.j.toString();null!=gf&&(sd.CutCopyPasteFlags=gf);var uf=null==ca.k?null:ca.k.toString();null!=uf&&(sd.IsDrag=uf);var fg=null==ca.l?null:ca.l.toString();null!=fg&&(sd.IsIeBeforeAlowDenyPopUp=fg);var Ag=ca.m;null!=Ag&&(sd.IsPasteMatchCopy=Ag);var og=ca.n;null!=og&&(sd.WaitMessageInClipboard=og);var Eg=null==ca.o?null:
ca.o.toString();null!=Eg&&(sd.CallCount=Eg);break;case 5:Lg="PasteOp";var eh=ca.a;null!=eh&&(sd.UserSessionId=eh);var rg=null==ca.b?null:ca.b.toString();null!=rg&&(sd.IsChrome=rg);var ah=null==ca.c?null:ca.c.toString();null!=ah&&(sd.IsIE=ah);var gh=null==ca.d?null:ca.d.toString();null!=gh&&(sd.IsCopyActive=gh);var Bg=null==ca.e?null:ca.e.toString();null!=Bg&&(sd.IsFromUI=Bg);var wh=null==ca.f?null:ca.f.toString();null!=wh&&(sd.IsClipboarAccessSupported=wh);var ti=null==ca.g?null:ca.g.toString();null!=
ti&&(sd.IsClipboarAccessInstallationSupported=ti);var tg=null==ca.h?null:ca.h.toString();null!=tg&&(sd.RibbonCommand=tg);var Yh=null==ca.i?null:ca.i.toString();null!=Yh&&(sd.CutCopyPasteFlags=Yh);var Vi=ca.j;null!=Vi&&(sd.WaitMessageInClipboard=Vi);var ki=ca.k;null!=ki&&(sd.PopupDialog=ki);var zh=ca.l;null!=zh&&(sd.SimplePopupMessage=zh);var zi=ca.m;null!=zi&&(sd.DialogCloseButton=zi);var Sg=ca.n;null!=Sg&&(sd.UserPressedInstallLink=Sg);var Ni=null==ca.o?null:ca.o.toString();null!=Ni&&(sd.CallCount=
Ni);break;case 6:Lg="GetNumberViewModelDataOp";var ui=ca.a;null!=ui&&(sd.UserSessionId=ui);var Wi=ca.b;null!=Wi&&(sd.NumberFormatOptionsPreviousOutputJson=Wi);var xh=ca.c;null!=xh&&(sd.NumberFormatOptionsNewInputJson=xh);break;case 7:Lg="InstantaneousSetData";var Th=ca.a;null!=Th&&(sd.Id=Th);var Ch=null==ca.b?null:ca.b.toString();null!=Ch&&(sd.WasEmpty=Ch);var $h=null==ca.c?null:ca.c.toString();null!=$h&&(sd.ValueNotChanged=$h);var Ai=ca.d;null!=Ai&&(sd.Source=Ai);var Xf=null==ca.e?null:ca.e.toString();
null!=Xf&&(sd.ProcessingCompleted=Xf);break;case 8:Lg="ImmediateSetData";var Hg=ca.a;null!=Hg&&(sd.ClientStopwatchId=Hg);var Te=ca.b;null!=Te&&(sd.Operation=Te);var H=ca.c;null!=H&&(sd.Parameters=H);var la=null==ca.d?null:ca.d.toString();null!=la&&(sd.WasUpdatedByImmediate=la);var Ha=null==ca.e?null:ca.e.toString();null!=Ha&&(sd.areHtmlElementsEqualClientComparison=Ha);var Bb=null==ca.f?null:ca.f.toString();null!=Bb&&(sd.WasDecisionMadeByHtmlComparison=Bb);var jc=null==ca.g?null:ca.g.toString();null!=
jc&&(sd.IsNumeric=jc);var Rc=null==ca.h?null:ca.h.toString();null!=Rc&&(sd.IsDateTime=Rc);var Sc=null==ca.i?null:ca.i.toString();null!=Sc&&(sd.HasCurrencySymbol=Sc);var Cd=null==ca.j?null:ca.j.toString();null!=Cd&&(sd.HasPercentSymbol=Cd);var vd=null==ca.k?null:ca.k.toString();null!=vd&&(sd.IsFunc=vd);var Jd=null==ca.l?null:ca.l.toString();null!=Jd&&(sd.DiffInWrappingWhitespace=Jd);var pe=ca.m;null!=pe&&(sd.ImmediatePattern=pe);var Ge=null==ca.n?null:ca.n.toString();null!=Ge&&(sd.TextAlignmentMatch=
Ge);var $e=null==ca.o?null:ca.o.toString();null!=$e&&(sd.FontColorMatch=$e);var Bf=null==ca.p?null:ca.p.toString();null!=Bf&&(sd.FormulaTextMatch=Bf);var yf=null==ca.q?null:ca.q.toString();null!=yf&&(sd.isFormula=yf);var wf=ca.r;null!=wf&&(sd.FormulaText=wf);var sg=ca.s;null!=sg&&(sd.InstantaneousPattern=sg);var Sf=null==ca.t?null:ca.t.toString();null!=Sf&&(sd.AreHtmlInnerTextElementsEqualClientComparison=Sf);var eg=ca.u;null!=eg&&(sd.HtmlComparisonDecision=eg);break;case 9:Lg="DependentCellsCalc";
var xg=ca.a;null!=xg&&(sd.CalcStatus=xg);var mg=null==ca.b?null:ca.b.toString();null!=mg&&(sd.SuccessfullyCalculatedRanges=mg);var nd=null==ca.c?null:ca.c.toString();null!=nd&&(sd.RangesSkipped=nd);var je=null==ca.d?null:ca.d.toString();null!=je&&(sd.TotalErrors=je);var ug=null==ca.e?null:ca.e.toString();null!=ug&&(sd.Partial=ug);var kh=null==ca.f?null:ca.f.toString();null!=kh&&(sd.Canceled=kh);var qh=null==ca.g?null:ca.g.toString();null!=qh&&(sd.Aggregate=qh);var Xh=null==ca.h?null:ca.h.toString();
null!=Xh&&(sd.Unknown=Xh);var oh=null==ca.i?null:ca.i.toString();null!=oh&&(sd.UnavailableData=oh);var pi=null==ca.j?null:ca.j.toString();null!=pi&&(sd.Cycle=pi);var ji=null==ca.k?null:ca.k.toString();null!=ji&&(sd.NotImplemented=ji);var Qi=null==ca.l?null:ca.l.toString();null!=Qi&&(sd.InvalidInput=Qi);var Kh=null==ca.m?null:ca.m.toString();null!=Kh&&(sd.AreDepCells=Kh);break;case 10:Lg="DependentCellsGraphStat";var Hi=null==ca.a?null:ca.a.toString();null!=Hi&&(sd.ParsedFormulas=Hi);var lj=null==
ca.b?null:ca.b.toString();null!=lj&&(sd.GraphNodes=lj);var Yi=null==ca.c?null:ca.c.toString();null!=Yi&&(sd.GraphArcs=Yi);var ij=null==ca.d?null:ca.d.toString();null!=ij&&(sd.AnalyzedBlocks=ij);var Di=null==ca.e?null:ca.e.toString();null!=Di&&(sd.IterationId=Di);var th=ca.f;null!=th&&(sd.UniqueId=th);var Wg=null==ca.g?null:ca.g.toString();null!=Wg&&(sd.Aborted=Wg);break;case 11:Lg="DependentCellsGraphSectionStat";var mj=null==ca.a?null:ca.a.toString();null!=mj&&(sd.IterationId=mj);var Vh=ca.b;null!=
Vh&&(sd.BlockHash=Vh);var cj=ca.c;null!=cj&&(sd.Functions=cj);var uh=ca.d;null!=uh&&(sd.Operators=uh);var ci=null==ca.e?null:ca.e.toString();null!=ci&&(sd.CrossDocRefs=ci);var dj=null==ca.f?null:ca.f.toString();null!=dj&&(sd.CrossSheetRefs=dj);var kg=null==ca.g?null:ca.g.toString();null!=kg&&(sd.ErrRefs=kg);var Ji=null==ca.h?null:ca.h.toString();null!=Ji&&(sd.LargeRanges=Ji);var mi=null==ca.i?null:ca.i.toString();null!=mi&&(sd.NameRefs=mi);var bh=null==ca.j?null:ca.j.toString();null!=bh&&(sd.ParserErrors=
bh);var ch=null==ca.k?null:ca.k.toString();null!=ch&&(sd.RowRefs=ch);var nj=null==ca.l?null:ca.l.toString();null!=nj&&(sd.ColumnRefs=nj);var Qh=null==ca.m?null:ca.m.toString();null!=Qh&&(sd.TableRefs=Qh);var Zi=ca.n;null!=Zi&&(sd.UniqueId=Zi);var ih=null==ca.o?null:ca.o.toString();null!=ih&&(sd.UnreachableReferences=ih);break;case 12:Lg="GetRangeContentPrefetchFailures";var oj=ca.a;null!=oj&&(sd.UserSessionId=oj);var pj=ca.b;null!=pj&&(sd.ClientStopwatchId=pj);var ej=null==ca.c?null:ca.c.toString();
null!=ej&&(sd.StateId=ej);break;case 13:Lg="GridBlockUpdates";var ni=ca.a;null!=ni&&(sd.UserSessionId=ni);var Yg=ca.b;null!=Yg&&(sd.CorrelationId=Yg);var fj=ca.c;null!=fj&&(sd.Operation=fj);var Cj=null==ca.d?null:ca.d.toString();null!=Cj&&(sd.PerformanceType=Cj);var Ki=ca.e;null!=Ki&&(sd.BlockHash=Ki);var Dj=null==ca.f?null:ca.f.toString();null!=Dj&&(sd.DurationInMs=Dj);break;case 14:Lg="BrowserAppStart";var fh=null==ca.a?null:Tg.a.yxa(ca.a.getTime());null!=fh&&(sd.ScriptExecutionStart=fh);var jj=
ca.b;null!=jj&&(sd.UserSessionId=jj);var Ei=ca.c;null!=Ei&&(sd.ClockMechanism=Ei);var Gg=null==ca.d?null:ca.d.toString();null!=Gg&&(sd.ScreenDPI=Gg);var Fi=null==ca.e?null:ca.e.toString();null!=Fi&&(sd.NavigationToScriptExecutionDelta=Fi);break;case 15:Lg="LinkedObjects";var gi=ca.a;null!=gi&&(sd.ChildId=gi);var Gi=ca.b;null!=Gi&&(sd.ParentId=Gi);var sj=ca.c;null!=sj&&(sd.ChildTable=sj);var zj=ca.d;null!=zj&&(sd.ParentTable=zj);break;case 16:Lg="LongFrames";var Ti=null==ca.a?null:Tg.a.yxa(ca.a.getTime());
null!=Ti&&(sd.StartTime=Ti);var $i=null==ca.b?null:ca.b.toString();null!=$i&&(sd.DurationInMs=$i);break;case 17:Lg="Task";var lh=ca.a;null!=lh&&(sd.StopwatchId=lh);var oi=null==ca.b?null:ca.b.toString();null!=oi&&(sd.Status=oi);var hi=null==ca.c?null:ca.c.toString();null!=hi&&(sd.CreateTime=hi);var Li=null==ca.d?null:ca.d.toString();null!=Li&&(sd.TaskId=Li);break;case 18:Lg="ConflictInEditing";var ii=ca.a;null!=ii&&(sd.OtherUserState=ii);var wi=ca.b;null!=wi&&(sd.UserSessionId=wi);var tj=null==ca.c?
null:Tg.a.yxa(ca.c.getTime());null!=tj&&(sd.ConflictTime=tj);break;case 19:Lg="IncomingPresenceData";var Mh=ca.a;null!=Mh&&(sd.UserSessionId=Mh);var Oi=ca.b;null!=Oi&&(sd.UserId=Oi);var kj=null==ca.c?null:ca.c.toString();null!=kj&&(sd.Disconnected=kj);var qj=null==ca.d?null:Tg.a.yxa(ca.d.getTime());null!=qj&&(sd.ReceivedTime=qj);break;case 20:Lg="EditorTableDelay";var Rh=ca.a;null!=Rh&&(sd.UserSessionId=Rh);var aj=ca.b;null!=aj&&(sd.UserId=aj);var bj=null==ca.c?null:ca.c.toString();null!=bj&&(sd.Received=
bj);var A=null==ca.d?null:ca.d.toString();null!=A&&(sd.DurationInMs=A);var ea=null==ca.e?null:ca.e.toString();null!=ea&&(sd.NotAloneAtLogTime=ea);var Ma=null==ca.f?null:Tg.a.yxa(ca.f.getTime());null!=Ma&&(sd.Time=Ma);break;case 21:Lg="PresenceStartup";var Vb=ca.a;null!=Vb&&(sd.UserSessionId=Vb);var tc=null==ca.b?null:ca.b.toString();null!=tc&&(sd.EverReceived=tc);var Jc=null==ca.c?null:ca.c.toString();null!=Jc&&(sd.NotAloneOnOpen=Jc);var ld=null==ca.d?null:ca.d.toString();null!=ld&&(sd.NotAloneAtLogTime=
ld);var Zd=null==ca.e?null:ca.e.toString();null!=Zd&&(sd.EditorCount=Zd);var De=null==ca.f?null:ca.f.toString();null!=De&&(sd.WorkbookOpenToFirstReceivedInMs=De);break;case 22:Lg="PresenceDelete";var Ve=ca.a;null!=Ve&&(sd.UserSessionId=Ve);var Se=ca.b;null!=Se&&(sd.UserId=Se);var sf=ca.c;null!=sf&&(sd.Context=sf);var Of=ca.d;null!=Of&&(sd.Reason=Of);var qg=null==ca.e?null:Tg.a.yxa(ca.e.getTime());null!=qg&&(sd.Time=qg);break;case 23:Lg="EditorEvent";var yg=ca.a;null!=yg&&(sd.UserSessionId=yg);var lg=
ca.b;null!=lg&&(sd.UserId=lg);var Cg=ca.c;null!=Cg&&(sd.Context=Cg);var ri=null==ca.d?null:Tg.a.yxa(ca.d.getTime());null!=ri&&(sd.Time=ri);break;case 24:Lg="EditorTime";var xi=ca.a;null!=xi&&(sd.UserSessionId=xi);var Q=ca.b;null!=Q&&(sd.UserId=Q);var Ja=null==ca.c?null:ca.c.toString();null!=Ja&&(sd.DurationInMs=Ja);break;case 25:Lg="GridScreenReaderOps";var kb=ca.a;null!=kb&&(sd.UserSessionId=kb);var ec=ca.b;null!=ec&&(sd.CommandTaskId=ec);var Ic=null==ca.c?null:ca.c.toString();null!=Ic&&(sd.CommandId=
Ic);var Ad=null==ca.d?null:ca.d.toString();null!=Ad&&(sd.ClientSideOnly=Ad);var md=null==ca.e?null:ca.e.toString();null!=md&&(sd.DurationInMS=md);var Rd=null==ca.f?null:ca.f.toString();null!=Rd&&(sd.ReachedMaxReadoutCells=Rd);var Pc=null==ca.g?null:ca.g.toString();null!=Pc&&(sd.RequstedCellCount=Pc);var Kd=null==ca.h?null:ca.h.toString();null!=Kd&&(sd.NonEmptyCellCount=Kd);var ye=null==ca.i?null:ca.i.toString();null!=ye&&(sd.Succeeded=ye);var ke=null==ca.j?null:ca.j.toString();null!=ke&&(sd.Canceled=
ke);var we=ca.k;null!=we&&(sd.ErrorType=we);break;case 26:Lg="SendPresenceToService";var Ye=ca.a;null!=Ye&&(sd.UserSessionId=Ye);var rf=null==ca.b?null:ca.b.toString();null!=rf&&(sd.TotalCount=rf);var Cf=null==ca.c?null:ca.c.toString();null!=Cf&&(sd.SendCount=Cf);break;case 27:Lg="IME";var Yf=ca.a;null!=Yf&&(sd.UserSessionId=Yf);break;case 28:Lg="FreezePaneFloatingObjects";var vf=ca.a;null!=vf&&(sd.UserSessionId=vf);var Df=null==ca.b?null:ca.b.toString();null!=Df&&(sd.ObjectType=Df);var Rf=ca.c;null!=
Rf&&(sd.ObjectID=Rf);var hh=null==ca.d?null:ca.d.toString();null!=hh&&(sd.SpannedPanesCount=hh);break;case 29:Lg="CustomizeStatusBar";var Qg=ca.a;null!=Qg&&(sd.UserSessionId=Qg);var Ah=ca.b;null!=Ah&&(sd.UIControlName=Ah);var Ih=null==ca.c?null:ca.c.toString();null!=Ih&&(sd.IsControlVisible=Ih);break;case 30:Lg="ClientWebRequests";var di=ca.a;null!=di&&(sd.Path=di);var vh=ca.b;null!=vh&&(sd.ProxyStopwatchId=vh);var ai=ca.c;null!=ai&&(sd.RequestStatus=ai);var Ci=null==ca.d?null:ca.d.toString();null!=
Ci&&(sd.ResponseSizeInBytes=Ci);var ei=ca.e;null!=ei&&(sd.ClientRequestId=ei);var Bi=null==ca.f?null:ca.f.toString();null!=Bi&&(sd.StateId=Bi);break;case 31:Lg="ShowCommentTaskPane";var Mg=ca.a;null!=Mg&&(sd.UserSessionId=Mg);var hg=null==ca.b?null:ca.b.toString();null!=hg&&(sd.IsFromKeyboardShortcut=hg);var gg=null==ca.c?null:ca.c.toString();null!=gg&&(sd.IsShowPane=gg);var Hf=null==ca.d?null:ca.d.toString();null!=Hf&&(sd.ShowForDeepLink=Hf);var Kg=null==ca.e?null:ca.e.toString();null!=Kg&&(sd.DeepLinkFound=
Kg);break;case 32:Lg="ApplyThreadedCommentChange";var ng=ca.a;null!=ng&&(sd.UserSessionId=ng);var Pg=null==ca.b?null:ca.b.toString();null!=Pg&&(sd.Operation=Pg);var Hh=ca.c;null!=Hh&&(sd.CommentId=Hh);var fi=null==ca.d?null:ca.d.toString();null!=fi&&(sd.CommentsCount=fi);break;case 33:Lg="UpgradeLegacyCommentsChange";var ph=ca.a;null!=ph&&(sd.UserSessionId=ph);var Ri=null==ca.b?null:ca.b.toString();null!=Ri&&(sd.OperationSuccessful=Ri);break;case 34:Lg="FindNextOrPreviousComment";var Xi=ca.a;null!=
Xi&&(sd.UserSessionId=Xi);var Ii=null==ca.b?null:ca.b.toString();null!=Ii&&(sd.Succeeded=Ii);break;case 35:Lg="Goto";var Si=ca.a;null!=Si&&(sd.UserSessionId=Si);var Ng=null==ca.b?null:ca.b.toString();null!=Ng&&(sd.IsSucceeded=Ng);var Dh=null==ca.c?null:ca.c.toString();null!=Dh&&(sd.IsNOVMode=Dh);break;case 36:Lg="LaunchOfficeAddInDialog";var li=ca.a;null!=li&&(sd.UserSessionId=li);var sh=ca.b;null!=sh&&(sd.SourceId=sh);var bi=ca.c;null!=bi&&(sd.SourceLabel=bi);var vi=ca.d;null!=vi&&(sd.Flight=vi);
var Uh=ca.e;null!=Uh&&(sd.Experiment=Uh);var hj=ca.f;null!=hj&&(sd.UICultureTag=hj);var qi=null==ca.g?null:ca.g.toString();null!=qi&&(sd.UICultureTagLcid=qi);var dk=null==ca.h?null:ca.h.toString();null!=dk&&(sd.WacHostId=dk);break;case 37:Lg="RichApiInvocation";var ek=ca.a;null!=ek&&(sd.UserSessionId=ek);var Mi=null==ca.b?null:ca.b.toString();null!=Mi&&(sd.Succeeded=Mi);var uj=ca.c;null!=uj&&(sd.ErrorType=uj);var fk=ca.d;null!=fk&&(sd.ResultInfo=fk);var Gj=ca.e;null!=Gj&&(sd.Source=Gj);break;case 38:Lg=
"FxLibrary";var yi=ca.a;null!=yi&&(sd.EntityName=yi);var Pi=null==ca.b?null:ca.b.toString();null!=Pi&&(sd.EntryPoint=Pi);var Rj=null==ca.c?null:ca.c.toString();null!=Rj&&(sd.Action=Rj);var rj=null==ca.d?null:ca.d.toString();null!=rj&&(sd.InsertLocation=rj);break;case 39:Lg="EmbeddedApiSession";var Sj=ca.a;null!=Sj&&(sd.UserSessionId=Sj);break;case 40:Lg="NumberFormattingCalculator";var Ej=ca.a;null!=Ej&&(sd.Id=Ej);var Tj=ca.b;null!=Tj&&(sd.CounterName=Tj);var gk=ca.c;null!=gk&&(sd.Values=gk);break;
case 41:Lg="RequestDataAfterSend";var hk=ca.a;null!=hk&&(sd.ClientStopwatchId=hk);var Jj=ca.b;null!=Jj&&(sd.RequestStatus=Jj);var mk=null==ca.c?null:ca.c.toString();null!=mk&&(sd.SendDuration=mk);var Fj=null==ca.d?null:ca.d.toString();null!=Fj&&(sd.RequestId=Fj);break;case 42:Lg="FloatingObjectsStopwatchData";var Uj=ca.a;null!=Uj&&(sd.StopMessage=Uj);var Vj=null==ca.b?null:ca.b.toString();null!=Vj&&(sd.Type=Vj);var Wj=ca.c;null!=Wj&&(sd.GUID=Wj);var Aj=null==ca.d?null:ca.d.toString();null!=Aj&&(sd.Pane=
Aj);var nk=null==ca.e?null:ca.e.toString();null!=nk&&(sd.IsAboveGrid=nk);var Xj=ca.f;null!=Xj&&(sd.StartCorrelation=Xj);var vj=ca.g;null!=vj&&(sd.LoadImageCorrelation=vj);var ik=null==ca.h?null:ca.h.toString();null!=ik&&(sd.SkippedGetEffectsExtents=ik);var Yj=null==ca.i?null:ca.i.toString();null!=Yj&&(sd.Version=Yj);break;case 43:Lg="Copy";var Kj=ca.a;null!=Kj&&(sd.UserSessionId=Kj);var Zj=ca.b;null!=Zj&&(sd.Trigger=Zj);var wj=ca.c;null!=wj&&(sd.RibbonCommandName=wj);var ak=ca.d;null!=ak&&(sd.SourceItem=
ak);var Lj=null==ca.e?null:ca.e.toString();null!=Lj&&(sd.SourceRangeCellCount=Lj);var ok=ca.f;null!=ok&&(sd.ClientSideStopwatchId=ok);var bk=ca.g;null!=bk&&(sd.CopyOperationId=bk);var jk=null==ca.h?null:ca.h.toString();null!=jk&&(sd.IsAsync=jk);var si=null==ca.i?null:ca.i.toString();null!=si&&(sd.IsFromCache=si);var ck=null==ca.j?null:ca.j.toString();null!=ck&&(sd.IsSuccessiveCopy=ck);var Mj=null==ca.k?null:ca.k.toString();null!=Mj&&(sd.IsSelectionAllowed=Mj);var Nj=null==ca.l?null:ca.l.toString();
null!=Nj&&(sd.IsSuccess=Nj);var kk=null==ca.m?null:ca.m.toString();null!=kk&&(sd.IsExpectedError=kk);var lk=ca.n;null!=lk&&(sd.ExpectedErrorReason=lk);var xj=ca.o;null!=xj&&(sd.ErrorMessage=xj);var Dg=null==ca.p?null:ca.p.toString();null!=Dg&&(sd.ClientSideCopyTimeInMs=Dg);var Oj=null==ca.q?null:ca.q.toString();null!=Oj&&(sd.TotalTimeInMs=Oj);var M=null==ca.r?null:ca.r.toString();null!=M&&(sd.PlainTextPayloadSize=M);var Ca=ca.s;null!=Ca&&(sd.CopyPasteTargetType=Ca);var xb=null==ca.t?null:ca.t.toString();
null!=xb&&(sd.ShadowWorkbookPayloadSize=xb);var hc=null==ca.u?null:ca.u.toString();null!=hc&&(sd.HtmlPayloadSize=hc);var Qc=null==ca.v?null:ca.v.toString();null!=Qc&&(sd.HtmlSizeExceedsLimit=Qc);var ud=null==ca.w?null:ca.w.toString();null!=ud&&(sd.CopyTotalSizeExceedsLimit=ud);var Id=null==ca.x?null:ca.x.toString();null!=Id&&(sd.ErrorReason=Id);var Pd=ca.y;null!=Pd&&(sd.ErrorName=Pd);var xe=null==ca.z?null:ca.z.toString();null!=xe&&(sd.IsSucceededWithAlert=xe);var Fe=null==ca.ba?null:ca.ba.toString();
null!=Fe&&(sd.EncounteredDeploymentErrors=Fe);var zf=null==ca.bb?null:ca.bb.toString();null!=zf&&(sd.ShadowWorkbookSizeExceedsLimit=zf);var Af=ca.bc;null!=Af&&(sd.CopyPasteTargetName=Af);var dg=ca.bd;null!=dg&&(sd.CCPSliceName=dg);var mh=ca.be;null!=mh&&(sd.SyncClipboardItemsKeys=mh);var nh=ca.bf;null!=nh&&(sd.AsyncClipboardItemsKeys=nh);var Vg=ca.bg;null!=Vg&&(sd.CopyPasteHandlerName=Vg);var jh=ca.bh;null!=jh&&(sd.SucceededPopulatingSystemClipboardSync=jh);var Fh=ca.bi;null!=Fh&&(sd.SucceededPopulatingSystemClipboardAsync=
Fh);var E=ca.bj;null!=E&&(sd.Location=E);var ma=ca.bk;null!=ma&&(sd.CopyContextId=ma);var Ya=null==ca.bl?null:ca.bl.toString();null!=Ya&&(sd.ServerRequestTimeInMs=Ya);var Ub=null==ca.bm?null:ca.bm.toString();null!=Ub&&(sd.EcsOperationDuration=Ub);var Hc=null==ca.bn?null:ca.bn.toString();null!=Hc&&(sd.EcsRequestDuration=Hc);var Gd=null==ca.bo?null:ca.bo.toString();null!=Gd&&(sd.WfeRequestDuration=Gd);var he=null==ca.bp?null:ca.bp.toString();null!=he&&(sd.OriginalSourceRangesCountExceedsLimit=he);var Ke=
null==ca.bq?null:ca.bq.toString();null!=Ke&&(sd.UploadToClipServiceAttempted=Ke);var af=null==ca.br?null:ca.br.toString();null!=af&&(sd.FloatingObjectType=af);break;case 44:Lg="Paste";var xf=ca.a;null!=xf&&(sd.UserSessionId=xf);var wg=ca.b;null!=wg&&(sd.Trigger=wg);var Ig=ca.c;null!=Ig&&(sd.RibbonCommandName=Ig);var Jh=null==ca.d?null:ca.d.toString();null!=Jh&&(sd.PasteTypeFlagValue=Jh);var Bh=ca.e;null!=Bh&&(sd.PasteOperationId=Bh);var Wh=ca.f;null!=Wh&&(sd.CopyOperationId=Wh);var Hj=ca.g;null!=
Hj&&(sd.ClientSideStopwatchId=Hj);var Ij=ca.h;null!=Ij&&(sd.OriginalDestinationRange=Ij);var Pj=ca.i;null!=Pj&&(sd.ExpandDestinationRange=Pj);var gj=ca.j;null!=gj&&(sd.SourceItem=gj);var yj=null==ca.k?null:ca.k.toString();null!=yj&&(sd.SourceRangeCellCount=yj);var Ui=null==ca.l?null:ca.l.toString();null!=Ui&&(sd.IsSuccess=Ui);var Bj=null==ca.m?null:ca.m.toString();null!=Bj&&(sd.IsExpectedError=Bj);var Qj=ca.n;null!=Qj&&(sd.ClipboardFormatReadTimeInMs=Qj);var pk=ca.o;null!=pk&&(sd.ClipboardFormatReadStatus=
pk);var qk=null==ca.p?null:ca.p.toString();null!=qk&&(sd.ClipboardReadPermissionPromptShown=qk);var wk=null==ca.q?null:ca.q.toString();null!=wk&&(sd.AsyncApiReadTimedOut=wk);var xk=ca.r;null!=xk&&(sd.ExpectedErrorReason=xk);var yk=ca.s;null!=yk&&(sd.ErrorMessage=yk);var zk=null==ca.t?null:ca.t.toString();null!=zk&&(sd.TotalTimeInMs=zk);var Ak=null==ca.u?null:ca.u.toString();null!=Ak&&(sd.PlainTextPayloadSize=Ak);var Bk=null==ca.v?null:ca.v.toString();null!=Bk&&(sd.ShadowWorkbookPayloadSize=Bk);var Ck=
null==ca.w?null:ca.w.toString();null!=Ck&&(sd.HtmlPayloadSize=Ck);var Dk=ca.x;null!=Dk&&(sd.CopyPasteTargetType=Dk);var Ek=null==ca.y?null:ca.y.toString();null!=Ek&&(sd.IsLastCopyWasExternal=Ek);var Fk=null==ca.z?null:ca.z.toString();null!=Fk&&(sd.IsClipboardDataContainShadowWorkbook=Fk);var Gk=null==ca.ba?null:ca.ba.toString();null!=Gk&&(sd.IsShadowWorkbookParsedSuccessfully=Gk);var Hk=ca.bb;null!=Hk&&(sd.ActiveSelectionType=Hk);var Ik=ca.bc;null!=Ik&&(sd.PasteResult=Ik);var Jk=null==ca.bd?null:
ca.bd.toString();null!=Jk&&(sd.ErrorReason=Jk);var Kk=ca.be;null!=Kk&&(sd.ErrorName=Kk);var Lk=null==ca.bf?null:ca.bf.toString();null!=Lk&&(sd.IsSucceededWithAlert=Lk);var Mk=null==ca.bg?null:ca.bg.toString();null!=Mk&&(sd.IsAfterCut=Mk);var Nk=null==ca.bh?null:ca.bh.toString();null!=Nk&&(sd.EncounteredDeploymentErrors=Nk);var Ok=null==ca.bi?null:ca.bi.toString();null!=Ok&&(sd.IsCrossSession=Ok);var Pk=null==ca.bj?null:ca.bj.toString();null!=Pk&&(sd.ShadowWorkbookSizeExceedsLimit=Pk);var Qk=null==
ca.bk?null:ca.bk.toString();null!=Qk&&(sd.ClipboardContainXLOPayload=Qk);var Rk=ca.bl;null!=Rk&&(sd.CopyPasteTargetName=Rk);var Sk=ca.bm;null!=Sk&&(sd.ChromeExtensionId=Sk);var Tk=ca.bn;null!=Tk&&(sd.PayloadOrigin=Tk);var Uk=ca.bo;null!=Uk&&(sd.PayloadType=Uk);var Vk=ca.bp;null!=Vk&&(sd.CCPSliceName=Vk);var Wk=ca.bq;null!=Wk&&(sd.ClipboardItemsKeys=Wk);var Xk=ca.br;null!=Xk&&(sd.CopyPasteHandlerName=Xk);var Yk=null==ca.bs?null:ca.bs.toString();null!=Yk&&(sd.IsSourceItemOriginSameSession=Yk);var Zk=
ca.bt;null!=Zk&&(sd.Location=Zk);var $k=ca.bu;null!=$k&&(sd.ExternalAppSource=$k);var al=ca.bv;null!=al&&(sd.PasteContextId=al);var bl=null==ca.bw?null:ca.bw.toString();null!=bl&&(sd.ServerRequestTimeInMs=bl);var cl=null==ca.bx?null:ca.bx.toString();null!=cl&&(sd.IndicationDisplayScheduled=cl);var dl=ca.by;null!=dl&&(sd.PasteIndicationDisplayStatus=dl);var el=null==ca.bz?null:ca.bz.toString();null!=el&&(sd.PasteRecoveryUIDisplayed=el);var fl=null==ca.ca?null:ca.ca.toString();null!=fl&&(sd.IsFromPasteRecoveryUI=
fl);var gl=null==ca.cb?null:ca.cb.toString();null!=gl&&(sd.EcsOperationDuration=gl);var hl=null==ca.cc?null:ca.cc.toString();null!=hl&&(sd.EcsRequestDuration=hl);var il=null==ca.cd?null:ca.cd.toString();null!=il&&(sd.WfeRequestDuration=il);var jl=null==ca.ce?null:ca.ce.toString();null!=jl&&(sd.OriginalSourceRangesCountExceedsLimit=jl);var kl=ca.cf;null!=kl&&(sd.PasteRecoveryUndoStopwatchId=kl);var ll=null==ca.cg?null:ca.cg.toString();null!=ll&&(sd.PasteRecoveryUndoTimeInMs=ll);var ml=null==ca.ch?
null:ca.ch.toString();null!=ml&&(sd.PasteCSEPerformed=ml);var nl=null==ca.ci?null:ca.ci.toString();null!=nl&&(sd.CSEStatus=nl);var ol=null==ca.cj?null:ca.cj.toString();null!=ol&&(sd.IsFromEnterShortcut=ol);var pl=null==ca.ck?null:ca.ck.toString();null!=pl&&(sd.pasteDestinationHasMergedCells=pl);break;case 45:Lg="DragDrop";var ql=ca.a;null!=ql&&(sd.UserSessionId=ql);var rl=ca.b;null!=rl&&(sd.Trigger=rl);var sl=ca.c;null!=sl&&(sd.RibbonCommandName=sl);var tl=ca.d;null!=tl&&(sd.OperationId=tl);var ul=
ca.e;null!=ul&&(sd.ClientSideStopwatchId=ul);var vl=ca.f;null!=vl&&(sd.SourceRange=vl);var wl=ca.g;null!=wl&&(sd.DestinationRange=wl);var xl=ca.h;null!=xl&&(sd.CutCopyType=xl);var yl=null==ca.i?null:ca.i.toString();null!=yl&&(sd.IsShiftKeyDown=yl);var zl=null==ca.j?null:ca.j.toString();null!=zl&&(sd.IsDragInsert=zl);var Al=null==ca.k?null:ca.k.toString();null!=Al&&(sd.IsSuccess=Al);var Bl=null==ca.l?null:ca.l.toString();null!=Bl&&(sd.IsExpectedError=Bl);var Cl=ca.m;null!=Cl&&(sd.ExpectedErrorReason=
Cl);var Dl=ca.n;null!=Dl&&(sd.ErrorMessage=Dl);var El=null==ca.o?null:ca.o.toString();null!=El&&(sd.TotalTimeInMs=El);var Fl=ca.p;null!=Fl&&(sd.ErrorName=Fl);var Gl=null==ca.q?null:ca.q.toString();null!=Gl&&(sd.IsSucceededWithAlert=Gl);var Hl=ca.r;null!=Hl&&(sd.CopyPasteTargetType=Hl);var Il=null==ca.s?null:ca.s.toString();null!=Il&&(sd.EncounteredDeploymentErrors=Il);break;case 46:Lg="ClearCopyState";var Jl=ca.a;null!=Jl&&(sd.UserSessionId=Jl);var Kl=ca.b;null!=Kl&&(sd.ClientSideStopwatchId=Kl);
var Ll=ca.c;null!=Ll&&(sd.Trigger=Ll);var Ml=null==ca.d?null:ca.d.toString();null!=Ml&&(sd.IsClearClipboard=Ml);var Nl=null==ca.e?null:ca.e.toString();null!=Nl&&(sd.IsExplicit=Nl);var Ol=null==ca.f?null:ca.f.toString();null!=Ol&&(sd.IsSuccess=Ol);var Pl=ca.g;null!=Pl&&(sd.ErrorMessage=Pl);var Ql=ca.h;null!=Ql&&(sd.ErrorName=Ql);var Rl=null==ca.i?null:ca.i.toString();null!=Rl&&(sd.TotalTimeInMs=Rl);var Sl=ca.j;null!=Sl&&(sd.CopyPasteTargetType=Sl);break;case 47:Lg="WebWorkerRecalcStats";var Tl=null==
ca.a?null:ca.a.toString();null!=Tl&&(sd.SuccessCount=Tl);var Ul=null==ca.b?null:ca.b.toString();null!=Ul&&(sd.FailureCount=Ul);var Vl=null==ca.c?null:ca.c.toString();null!=Vl&&(sd.ValueTypeMismatchCount=Vl);var Wl=null==ca.d?null:ca.d.toString();null!=Wl&&(sd.CellValueMismatchCount=Wl);var Xl=null==ca.e?null:ca.e.toString();null!=Xl&&(sd.IfmtMismatchCount=Xl);var Yl=null==ca.f?null:ca.f.toString();null!=Yl&&(sd.FormattedTextMismatchCount=Yl);var Zl=null==ca.g?null:ca.g.toString();null!=Zl&&(sd.CellValueStringMismatchCount=
Zl);var $l=null==ca.h?null:ca.h.toString();null!=$l&&(sd.CellValueNumberMismatchCount=$l);var am=null==ca.i?null:ca.i.toString();null!=am&&(sd.CellValueBooleanMismatchCount=am);var bm=null==ca.j?null:ca.j.toString();null!=bm&&(sd.CellValueBlankMismatchCount=bm);var cm=null==ca.k?null:ca.k.toString();null!=cm&&(sd.CellValueErrorMismatchCount=cm);var dm=null==ca.l?null:ca.l.toString();null!=dm&&(sd.FormattedTextStringMismatchCount=dm);var em=null==ca.m?null:ca.m.toString();null!=em&&(sd.FormattedTextNumberMismatchCount=
em);var fm=null==ca.n?null:ca.n.toString();null!=fm&&(sd.FormattedTextBooleanMismatchCount=fm);var gm=null==ca.o?null:ca.o.toString();null!=gm&&(sd.FormattedTextBlankMismatchCount=gm);var hm=null==ca.p?null:ca.p.toString();null!=hm&&(sd.FormattedTextErrorMismatchCount=hm);var im=null==ca.q?null:ca.q.toString();null!=im&&(sd.StringMismatchCount=im);var jm=null==ca.r?null:ca.r.toString();null!=jm&&(sd.NumericMismatchCount=jm);var km=null==ca.s?null:ca.s.toString();null!=km&&(sd.ErrorMismatchCount=km);
var lm=null==ca.t?null:ca.t.toString();null!=lm&&(sd.StringValuesCount=lm);var mm=null==ca.u?null:ca.u.toString();null!=mm&&(sd.NumericValuesCount=mm);var nm=null==ca.v?null:ca.v.toString();null!=nm&&(sd.BooleanValuesCount=nm);var om=null==ca.w?null:ca.w.toString();null!=om&&(sd.BlankValuesCount=om);var pm=null==ca.x?null:ca.x.toString();null!=pm&&(sd.ErrorValuesCount=pm);var qm=null==ca.y?null:ca.y.toString();null!=qm&&(sd.NumericValuesDiffAverage=qm);var rm=ca.z;null!=rm&&(sd.NumericEvaluatedValuesMismatchSamples=
rm);var sm=ca.ba;null!=sm&&(sd.NumericFormattedTextMismatchSamples=sm);var tm=ca.bb;null!=tm&&(sd.NumericMismatchSamples=tm);var um=ca.bc;null!=um&&(sd.CellValueTypeMismatchSamples=um);var vm=ca.bd;null!=vm&&(sd.IfmtMismatchSamples=vm);var wm=ca.be;null!=wm&&(sd.BlockHashCode=wm);break;case 48:Lg="DataValidationEditOpenDialog";var xm=ca.a;null!=xm&&(sd.ServerCommand=xm);var ym=null==ca.b?null:ca.b.toString();null!=ym&&(sd.SubDialogOpened=ym);var zm=ca.c;null!=zm&&(sd.SubDialogButtonClicked=zm);var Am=
null==ca.d?null:ca.d.toString();null!=Am&&(sd.DialogOpened=Am);var Bm=ca.e;null!=Bm&&(sd.RuleType=Bm);var Cm=ca.f;null!=Cm&&(sd.ConditionType=Cm);var Dm=null==ca.g?null:ca.g.toString();null!=Dm&&(sd.LowerBoundaryFilled=Dm);var Em=null==ca.h?null:ca.h.toString();null!=Em&&(sd.UpperBoundaryFilled=Em);var Fm=null==ca.i?null:ca.i.toString();null!=Fm&&(sd.IgnoreBlank=Fm);var Gm=null==ca.j?null:ca.j.toString();null!=Gm&&(sd.InCellDropdown=Gm);var Hm=null==ca.k?null:ca.k.toString();null!=Hm&&(sd.ShowInputMessage=
Hm);var Im=null==ca.l?null:ca.l.toString();null!=Im&&(sd.InputTitleFilled=Im);var Jm=null==ca.m?null:ca.m.toString();null!=Jm&&(sd.InputMessageFilled=Jm);var Km=null==ca.n?null:ca.n.toString();null!=Km&&(sd.ShowErrorAlert=Km);var Lm=null==ca.o?null:ca.o.toString();null!=Lm&&(sd.AlertBlocking=Lm);var Mm=null==ca.p?null:ca.p.toString();null!=Mm&&(sd.AlertTitleFilled=Mm);var Nm=null==ca.q?null:ca.q.toString();null!=Nm&&(sd.AlertMessageFilled=Nm);var Om=ca.r;null!=Om&&(sd.StopWatchId=Om);break;case 49:Lg=
"DataValidationEditSubmitRule";var Pm=ca.a;null!=Pm&&(sd.RuleType=Pm);var Qm=ca.b;null!=Qm&&(sd.ConditionType=Qm);var Rm=null==ca.c?null:ca.c.toString();null!=Rm&&(sd.LowerBoundaryFilled=Rm);var Sm=null==ca.d?null:ca.d.toString();null!=Sm&&(sd.UpperBoundaryFilled=Sm);var Tm=null==ca.e?null:ca.e.toString();null!=Tm&&(sd.IgnoreBlank=Tm);var Um=null==ca.f?null:ca.f.toString();null!=Um&&(sd.InCellDropdown=Um);var Vm=null==ca.g?null:ca.g.toString();null!=Vm&&(sd.ShowInputMessage=Vm);var Wm=null==ca.h?
null:ca.h.toString();null!=Wm&&(sd.InputTitleFilled=Wm);var Xm=null==ca.i?null:ca.i.toString();null!=Xm&&(sd.InputMessageFilled=Xm);var Ym=null==ca.j?null:ca.j.toString();null!=Ym&&(sd.ShowErrorAlert=Ym);var Zm=null==ca.k?null:ca.k.toString();null!=Zm&&(sd.AlertBlocking=Zm);var $m=null==ca.l?null:ca.l.toString();null!=$m&&(sd.AlertTitleFilled=$m);var an=null==ca.m?null:ca.m.toString();null!=an&&(sd.AlertMessageFilled=an);var bn=null==ca.n?null:ca.n.toString();null!=bn&&(sd.ClearAllPressed=bn);var cn=
ca.o;null!=cn&&(sd.ActionStatus=cn);var dn=ca.p;null!=dn&&(sd.Error=dn);var en=ca.q;null!=en&&(sd.StopWatchId=en);var fn=null==ca.r?null:ca.r.toString();null!=fn&&(sd.InsertDropdownButton=fn);break;case 50:Lg="CustomSort";var gn=ca.a;null!=gn&&(sd.RangeType=gn);var hn=null==ca.b?null:ca.b.toString();null!=hn&&(sd.HasHeaders=hn);var jn=null==ca.c?null:ca.c.toString();null!=jn&&(sd.SortTopToBottom=jn);var kn=null==ca.d?null:ca.d.toString();null!=kn&&(sd.ColumnCount=kn);var ln=null==ca.e?null:ca.e.toString();
null!=ln&&(sd.RowCount=ln);var mn=null==ca.f?null:ca.f.toString();null!=mn&&(sd.RangeLimitExceeded=mn);var nn=null==ca.g?null:ca.g.toString();null!=nn&&(sd.CaseSensitive=nn);var on=null==ca.h?null:ca.h.toString();null!=on&&(sd.GetSortInfoDuration=on);var pn=null==ca.i?null:ca.i.toString();null!=pn&&(sd.LevelCount=pn);var qn=null==ca.j?null:ca.j.toString();null!=qn&&(sd.SortOnValuesCount=qn);var rn=null==ca.k?null:ca.k.toString();null!=rn&&(sd.SortOnCellColorCount=rn);var sn=null==ca.l?null:ca.l.toString();
null!=sn&&(sd.SortOnFontColorCount=sn);var tn=null==ca.m?null:ca.m.toString();null!=tn&&(sd.SortOnIconCount=tn);var un=null==ca.n?null:ca.n.toString();null!=un&&(sd.CustomOrderCount=un);var vn=null==ca.o?null:ca.o.toString();null!=vn&&(sd.AvgCellColorCount=vn);var wn=null==ca.p?null:ca.p.toString();null!=wn&&(sd.MaxCellColorCount=wn);var xn=null==ca.q?null:ca.q.toString();null!=xn&&(sd.AvgFontColorCount=xn);var yn=null==ca.r?null:ca.r.toString();null!=yn&&(sd.MaxFontColorCount=yn);var zn=null==ca.s?
null:ca.s.toString();null!=zn&&(sd.AvgIconsCount=zn);var An=null==ca.t?null:ca.t.toString();null!=An&&(sd.MaxIconsCount=An);var Bn=null==ca.u?null:ca.u.toString();null!=Bn&&(sd.Executed=Bn);break;case 51:Lg="NamedSheetViewUserAction";var Cn=ca.a;null!=Cn&&(sd.UserSessionId=Cn);var Dn=ca.b;null!=Dn&&(sd.UserActionName=Dn);var En=null==ca.c?null:ca.c.toString();null!=En&&(sd.UserActionSource=En);var Fn=ca.d;null!=Fn&&(sd.UserActionData=Fn);var Gn=ca.e;null!=Gn&&(sd.OtherData=Gn);break;case 52:Lg="NamedSheetViewTeachingCallout";
var Hn=ca.a;null!=Hn&&(sd.UserSessionId=Hn);var In=null==ca.b?null:ca.b.toString();null!=In&&(sd.TeachingCalloutSequence=In);var Jn=null==ca.c?null:ca.c.toString();null!=Jn&&(sd.TeachingCalloutIndex=Jn);var Kn=null==ca.d?null:ca.d.toString();null!=Kn&&(sd.UserActionName=Kn);var Ln=ca.e;null!=Ln&&(sd.UserActionData=Ln);var Mn=null==ca.f?null:ca.f.toString();null!=Mn&&(sd.DurationInMs=Mn);break;case 53:Lg="NamedSheetViewTeachingDialog";var Nn=ca.a;null!=Nn&&(sd.UserSessionId=Nn);var On=ca.b;null!=On&&
(sd.UserActionName=On);var Pn=ca.c;null!=Pn&&(sd.ButtonClicked=Pn);var Qn=null==ca.d?null:ca.d.toString();null!=Qn&&(sd.DurationInMs=Qn);var Rn=null==ca.e?null:ca.e.toString();null!=Rn&&(sd.IsNewTeachingDialog=Rn);break;case 54:Lg="NamedSheetViewOptionsDialog";var Sn=ca.a;null!=Sn&&(sd.UserSessionId=Sn);var Tn=null==ca.b?null:ca.b.toString();null!=Tn&&(sd.OptionsAction=Tn);var Un=ca.c;null!=Un&&(sd.OptionsActionData=Un);var Vn=ca.d;null!=Vn&&(sd.OptionsOtherData=Vn);var Wn=null==ca.e?null:ca.e.toString();
null!=Wn&&(sd.DurationInMs=Wn);break;case 55:Lg="NamedSheetViewTempViewSaveDialog";var Xn=ca.a;null!=Xn&&(sd.UserSessionId=Xn);var Yn=ca.b;null!=Yn&&(sd.TriggeredFrom=Yn);var Zn=ca.c;null!=Zn&&(sd.ButtonClicked=Zn);var $n=null==ca.d?null:ca.d.toString();null!=$n&&(sd.NameUpdated=$n);var ao=null==ca.e?null:ca.e.toString();null!=ao&&(sd.DurationInMs=ao);break;case 56:Lg="TemporaryViewStartedDataRestore";var bo=ca.a;null!=bo&&(sd.UserSessionId=bo);var co=null==ca.b?null:ca.b.toString();null!=co&&(sd.CountOfTempViews=
co);break;case 57:Lg="TemporaryViewFetchedVersion";var eo=ca.a;null!=eo&&(sd.UserSessionId=eo);var fo=null==ca.b?null:ca.b.toString();null!=fo&&(sd.NumberOfBytes=fo);break;case 58:Lg="RaiseEventsAndGenerateBlockRequests";var go=null==ca.a?null:ca.a.toString();null!=go&&(sd.ReturnContentStatus=go);var ho=null==ca.b?null:ca.b.toString();null!=ho&&(sd.CacheState=ho);var io=null==ca.c?null:ca.c.toString();null!=io&&(sd.FromXhrCallback=io);var jo=null==ca.d?null:ca.d.toString();null!=jo&&(sd.AreGeneralErrorsPresent=
jo);var ko=ca.e;null!=ko&&(sd.BlockCacheItemHash=ko);var lo=ca.f;null!=lo&&(sd.StopwatchId=lo);var mo=ca.g;null!=mo&&(sd.BlockCacheItemProcessingStopwatchId=mo);var no=null==ca.h?null:ca.h.toString();null!=no&&(sd.StateId=no);var oo=null==ca.i?null:ca.i.toString();null!=oo&&(sd.IsHighPriority=oo);var po=null==ca.j?null:ca.j.toString();null!=po&&(sd.CalcComplete=po);var qo=null==ca.k?null:ca.k.toString();null!=qo&&(sd.EditedCellsUpdatedByCse=qo);var ro=null==ca.l?null:ca.l.toString();null!=ro&&(sd.DependentCellsUpdatedByCse=
ro);var so=null==ca.m?null:ca.m.toString();null!=so&&(sd.Revision=so);var to=null==ca.n?null:ca.n.toString();null!=to&&(sd.SheetProcessedDataVersion=to);var uo=null==ca.o?null:ca.o.toString();null!=uo&&(sd.RefCount=uo);var vo=null==ca.p?null:ca.p.toString();null!=vo&&(sd.ExistsInView=vo);var wo=null==ca.q?null:ca.q.toString();null!=wo&&(sd.ContentSource=wo);break;case 59:Lg="LaunchMakerCodeEditor";var xo=ca.a;null!=xo&&(sd.SessionId=xo);var yo=ca.b;null!=yo&&(sd.Command=yo);var zo=null==ca.c?null:
ca.c.toString();null!=zo&&(sd.IsPreviewGallery=zo);var Ao=ca.d;null!=Ao&&(sd.MenuItemId=Ao);var Bo=ca.e;null!=Bo&&(sd.ScriptId=Bo);var Co=ca.f;null!=Co&&(sd.ShareId=Co);var Do=null==ca.g?null:ca.g.toString();null!=Do&&(sd.IsOwner=Do);var Eo=null==ca.h?null:ca.h.toString();null!=Eo&&(sd.PublishedScriptCount=Eo);var Fo=null==ca.i?null:ca.i.toString();null!=Fo&&(sd.RecentScriptCount=Fo);var Go=null==ca.j?null:ca.j.toString();null!=Go&&(sd.WorkbookScriptCount=Go)}sd.Table=Lg;var Mo=Sys.Serialization.JavaScriptSerializer.serialize(sd);
Od.call(Uc,3704927,0,50,Mo)}}catch(sd){x.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${X} exception: ${sd}`)}}Rid(X,ca,Qb){if(this.Ozc){const Uc=this.k1a[X+ca];Uc&&(Uc.e=Qb,this.Qld(Uc));delete this.k1a[X+ca]}}AGd(X,ca){dh[X]in this.nEf||this.Wg(X,ca)}zlj(){this.oj.appStart&&this.yng(Fg.EPd,this.oj.appStart)}YUi(X){const ca={};ca.a=X.i;ca.b=X.o;ca.c=X.t;ca.d=Sh.a(X.s,X.p||this.oj.appStart);ca.e=Sh.a(X.e,X.s);ca.f=X.c;ca.g=X.a;ca.h=X.h;this.Wg(0,ca,this.oIi(ca.b,ca.c))}oIi(X,
ca){return["CommandTask","QueuedTask","Task"].includes(X)&&!this.ySh.includes(ca)?!1:!0}hD(X,ca,Qb,Uc,Od){if(X&&ca){const me={};me.a=X;me.b=ca;me.c=Qb.toString();me.d=Uc.toString();this.Wg(15,me,void 0===Od?!0:Od)}}WDf(X,ca,Qb,Uc){const Od={};X&&(Od.c=Sh.a(X,this.oj.appStart));Od.b=ca;Od.a=Qb;Od.d=Uc;this.Wg(17,Od)}dispose(){this.sEa.execute(X=>{X.deactivate(!0);X.BBj(this.oTf)});this.Mf&&this.Mf.QVa(this.pI);super.dispose()}yjf(){return this.vzg=this.vzg||new Ug}CUe(X,ca,Qb,Uc,Od){const me={};me.o=
X;me.t=ca;me.p=void 0===Od?null:Od;me.s=(void 0===Uc?null:Uc)||this.oj.eg;this.Sxd(me,void 0===Qb?null:Qb);return me}rQe(X,ca){X&&(X.e=(void 0===ca?null:ca)||this.oj.eg,X.i=X.i||this.R5a.mdb(),X.c=X.c||this.gVe,X.a=X.a||this.qVe,X.h=void 0!==X.h&&null!==X.h?X.h:this.Mf?this.Mf.Ui:!1,this.Qld(X))}cEf(X){const ca=X.context;X.duration>Fg.VDh&&(ca.methodName===$c.a.PDb||ca.methodName===$c.a.Oza)&&this.CDc(1,Fg.pfi);if("GetSessionStatus"!==ca.methodName){const Qb={};Qb.a=ca.methodName;Qb.b=ca.stopwatch.id;
Qb.c=X.ODc;Qb.d=X.responseSize;Qb.e=ca.fMa;Qb.f=X.rf?X.rf.StateId:$c.a.U9d;this.Wg(30,Qb,!0);this.hD(Qb.b,X.rf.ServerCorrelationId,"clientWebRequests","ServerActions")}}oog(){if(this.Ozc){const X=this.k1a.LoadingUIShownSplashScreen;X&&Nc.PageLoadTrackingInfo.instance.tSj(X.s)}}CDc(X,ca){this.byg.wRb(X,ca,null)}k9f(X,ca){this.gNc.tFj(X,void 0===ca?null:ca)}j9f(X,ca,Qb){this.gNc.sFj(X,ca,void 0===Qb?null:Qb)}l9f(X){this.gNc.DRb(X,null)}m9f(X,ca){this.gNc.wRb(X,ca,null)}zDc(X,ca,Qb){this.qZa.zDc(X,ca,
void 0===Qb?null:Qb)}GDc(X,ca,Qb){this.qZa.GDc(X,ca,void 0===Qb?null:Qb)}fTb(X,ca,Qb,Uc,Od,me,Oe,...jf){this.qZa.fTb(X,ca,Qb,Uc,Od,me,Oe,...jf)}FFc(X,ca,Qb,Uc,Od,me,Oe){this.qZa.FFc(X,ca,Qb,Uc,Od,me,Oe)}hTb(X,ca,Qb,Uc,Od,me){this.qZa.hTb(X,ca,Qb,Uc,Od,me)}gTb(X,ca,Qb,Uc,Od,me,...Oe){this.qZa.gTb(X,ca,Qb,Uc,Od,me,...Oe)}iTb(X,ca,Qb,Uc,Od,me){this.byg.iTb(X,ca,Qb,Uc,Od,me)}GFc(X,ca,Qb,Uc){this.qZa.GFc(X,ca,Qb,Uc)}Qld(X){this.y6j.YUi(X)}Alj(){if(this.Ozc){Stw.swpc=null;const X=this.Ozc;for(let ca in X)this.Sxd(X[ca])}}JVh(){const X=
window[$g.a.namespace];if(X){const ca=X[$g.a.vPe];ca&&(delete X[$g.a.vPe],ca.forEach(Qb=>{this.Sxd(Qb);this.Qld(Qb)}))}}FJi(X,ca){if("about:blank"===X||"renamehandler.ashx"===ca&&"2"===F.a.Tv(X,"u"))return!0;for(X=0;X<this.EXd.length;X++)if(ca.endsWith(this.EXd[X]))return!0;return!1}sSi(){this.sEa.execute(X=>{X.Oj(Fg.q7g,0);X.BZg(this.oTf);X.activate()})}kSi(){const X={};X.a=new Date(Fc.EcmaDateClock.instance.appStart.m);X.b=this.userSessionId;X.c=this.oj.grg;X.d=Fg.Cxh*y.devicePixelRatio;X.e=td.a.$a.appStart.m;
this.Wg(14,X,!0);this.tpa(td.a.$a.appStart.m,Object($a.a)(O.a.instance,O.a.instance.uvj,"recordAppInitStart"))}yng(X,ca){this.Olb=this.R5a.mdb();this.PXb=this.R5a.mdb();this.JHa=X;this.WIc("UserAction",X,this.PXb,ca);this.VCf(X,this.Olb)}T8j(){const X=window[$g.a.namespace];X&&!Fg.LSe&&(X[$g.a.y5j]=(ca,Qb)=>this.CUe(ca,Qb),X[$g.a.lGh]=ca=>{this.rQe(ca)},Fg.LSe=!0)}Xgk(X){const ca=Lh.bah(X.o,X.t),Qb=new Lh(Sh.a(X.e,X.s)),Uc=ca in this.t6d?this.t6d[ca].Hjh(Qb):Qb;this.t6d[ca]=Uc;if(Qb===Uc||Qb.average!==
Uc.average)X=Object(Le.a)(new rh,{operation:X.o,target:X.t,E0i:Uc.average,sender:this}),this.raiseEvent(ca,X)}VCf(X,ca){const Qb={};Qb.a=ca;Qb.b=this.userSessionId;Qb.c=X;this.Wg(1,Qb,!0)}$wi(){this.EXd=[$c.a.gzj,$c.a.getSessionStatus,$c.a.Oza,$c.a.wjh,$c.a.kgh,$c.a.Glb,$c.a.Vkc,$c.a.getObjectMetadata,$c.a.bdi,$c.a.setRichTextCell,$c.a.Tza,$c.a.elk,$c.a.pollSessionStatus,$c.a.vii,$c.a.xgi,$c.a.dai]}Sxd(X,ca){X.i=(void 0===ca?null:ca)||this.R5a.mdb();X.a=this.qVe;X.c=this.gVe;X.h=this.Mf?this.Mf.Ui:
!1}static la(X){const ca=new Fg(X.xa.UserSessionId,X.ea,void 0,void 0,void 0,!0);ca.VCf(Fg.pJf,ca.aWe);x.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");ca.sSi();ca.T8j();ca.zlj();ca.kSi();ca.JVh();ca.Alj();ca.$wi();Fg.aQj(X);od.a.Ln.Ja(41,ca)}static aQj(X){const ca=y.devicePixelRatio;1<ca&&X.ae.xz(!0,2<=ca?8388608:4194304)}}Fg.pJf="UnassignedUserAction";Fg.EPd="PageLoad";Fg.bud="GridUpdateOperation";Fg.VDh=5E3;Fg.pfi="MoreThan_5000_Ms";Fg.Cxh=
96;Fg.q7g=30;Fg.LSe=!1;Object(v.a)(Fg,"TelemetryManager",nc.a,[12,13,377,378]);var Ph=a(213),bg=a(113);class xa{constructor(X,ca,Qb){this.rnk=X;this.LX=ca;this.name=Qb}}Object(v.a)(xa,"Validation",null,[]);var Ab;let sc=Ab=class{constructor(X){this.heb=()=>{this.nYf(this.z8e)};this.Uj=()=>{this.nYf(this.A8g)};this.$=X;this.A8g=new Na.a;this.z8e=new Na.a;qd.h(this.$).za.su(this.Uj);qd.h(this.$).za.JBe(this.heb)}u4c(X,ca,Qb,Uc,Od){if(X&&Uc){const me=Ph.a.EB(ca,Qb);this.W6b(()=>!!bg.a(X).Ws(me),Uc.StateId,
Od)}}W6b(X,ca,Qb){this.pYg(this.z8e,X,ca,Qb)}pYg(X,ca,Qb,Uc){X&&ca&&Qb!==$c.a.$f&&X.add(new xa(ca,Qb,Uc))}nYf(X){if(X){var ca=new Na.a;for(let Qb of X){if(Qb.LX===this.$.da.mg)try{Qb.rnk()||x.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${Qb.name}]`)}catch(Uc){x.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${Qb.name}]. Exception: [${Uc}]`)}ca.add(Qb)}for(let Qb of ca)X.remove(Qb)}else x.ULS.shipAssertTag(537151011,
0,!!X,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){qd.h(this.$)&&qd.h(this.$).za&&(qd.h(this.$).za.eu(this.Uj),qd.h(this.$).za.JVd(this.heb));this.$=null}static la(X){const ca=new Ab(X);X.ea.Ja(277,ca)}};sc=Ab=Object(Gb.a)([Object(yc.d)(Zc.Mc),Object(Gb.b)(0,Object(Zc.R)())],sc);Object(v.a)(sc,"ValidationTelemetryManager",null,[269,5]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");J.main();Type.registerNamespace("CNT");
Ka.main();Type.registerNamespace("CACPU");vc.main();Type.registerNamespace("Common.App.EventsCacheManager");Ga.main();(()=>{Eb.a.Fa(X=>{X.ea.Ja(137,new Z(X))})})();(()=>{Eb.a.Fa(X=>{X.ea.Ja(37,new cc(X))})})();(()=>{Eb.a.Fa(X=>{Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||te.la(X)})})();(()=>{Eb.a.Fa(X=>{Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||le.la(X)})})();(()=>{Eb.a.Fa(X=>
{X.ea.Ja(40,new ve(X,new Pb.a(()=>We.GetServiceTaskFactory.create(X.ea,137,X.ka,1))))})})();(()=>{Eb.a.Fa(X=>{X.ea.Ja(276,new uc(X))})})();(()=>{Eb.a.Fa(X=>{od.a.Ln.Zc(135,()=>{Fg.la(X);Nf.la(X);Jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)||sc.la(X);Jf.la(X);Wf.la(X);Pf.RenderingFidelityTracker.la(X)})})})();String(d);String(h);String(f);String(e);String(r);String(n);String(u);window.___1688279196376_closurehack=d;window.___1688279196376_closurehack=
h;window.___1688279196376_closurehack=f;window.___1688279196376_closurehack=e;window.___1688279196376_closurehack=r;window.___1688279196376_closurehack=n;window.___1688279196376_closurehack=u},737:function(w,D,a){a.d(D,"a",function(){return b});const b=(c,e,f)=>c.Ba(e)||c.Ja(e,f())},765:function(w,D,a){w=a(0);var b=a(80),c=a(6),e=a(63),f=a(33),d=a(32),h=a(178);class r{constructor(m,t){this.message=m;this.Fya=t}}Object(w.a)(r,"CrossDocumentEventArgs",null,[]);var n=a(780),u=a(386),v=a(268),x=a(779);
a.d(D,"a",function(){return k});class k{constructor(m,t,z,y){this._name="";this.jv={};this.L5=null;this.wJ=[];this.kJ=[];this.lJ=[];this.tJ=[];this.Nva=m;this.Lva=t;this.uq={};this.nv={};this.qJ=z;k._id++;y&&y();this.qq=this.enable()}get targetOrigin(){return this.Lva}get CFa(){return this.Nva}enable(){if(!v.a())return x.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.qGb();x.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.qq}qGb(){x.a.debugAssertTag(5018253,
!!this.qJ,null);this.L5=Object(b.a)(this,this.CLb,"messageListener");this.qJ.iLa(this.L5,null)}disable(){this.qq=!1;this.wJ=[];this.kJ=[];this.lJ=[];this.tJ=[];this.Nva=null;this.Lva="";this.qJ.nNa(this.L5);this.uq={};this.nv={}}dispose(){this.disable()}dBa(m){return!!this.wJ&&Array.contains(this.wJ,m)||this.cBa(m)}cBa(m){return!!this.kJ&&Array.contains(this.kJ,m)}Vn(m){x.a.debugAssertTag(5018259,!!this.wJ,null);Array.add(this.wJ,m);x.a.sendTraceTag(5018260,2,"Allow receiving : {0}",m)}G2a(m){x.a.debugAssertTag(5018261,
!!this.kJ,null);Array.add(this.kJ,m);x.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",m)}dIb(m){return!!this.lJ&&Array.contains(this.lJ,m)}oW(m){x.a.debugAssertTag(5018263,!!this.lJ,null);Array.add(this.lJ,m);x.a.sendTraceTag(5018264,2,"Allow free sending: {0}",m)}oIb(m){m=e.a.ZM(m);return!!m&&!!this.tJ&&Array.contains(this.tJ,m)}pS(m){x.a.debugAssertTag(5018265,!!this.tJ,null);if(m===k.mM)return x.a.debugAssertTag(5018266,!1,null),!1;let t=e.a.ZM(m);if(!t)return x.a.sendTraceTag(5018267,4,
"Get origin fail:{0}",m),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(t=d.a.Im(t));Array.add(this.tJ,t);x.a.sendTraceTag(5018268,2,"Add origin:{0}",t);return!0}send(m,t){t=void 0===t?null:t;let z=this.targetOrigin;if(t){t=e.a.ZM(t);if(!t)return!1;z=t}return this.waa(m,this.CFa,z)}sendMessage(m,t,z){z=(z=void 0===z?"":z)&&""!==z?z:h.a.create().toString();return this.send(this.z$(m,t,z,c.AFrameworkApplication.userSessionId))}postMessage(m){const t=
h.a.create().toString();if(!c.AFrameworkApplication.fa.qa("RetryablePostMessagingIsEnabled")||!m.shouldRetry)return this.send(this.z$(m.messageId,m.values,t,m.userSessionId));if(!this.uq[m.s0]){this.Vn(m.s0);const z=Object(b.a)(this,this.ackMessageHandler,"ackMessageHandler");this.em(m.s0,z)}this.jv[t]="";return this.BDa(m,t,1)}BDa(m,t,z){if(""!==t&&t in this.jv&&"ACK_RECEIVED"===this.jv[t])return delete this.jv[t],!0;if(z>m.jI)return x.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',
m.s0,t),delete this.jv[t],!1;x.a.sendTraceTag(40716251,1<z?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',m.jI-z,m.messageId,t);z++;window.setTimeout(()=>{this.BDa(m,t,z)},m.n3c);m.values[u.a.l3c]=!0;return this.send(this.z$(m.messageId,m.values,t,m.userSessionId))}ackMessageHandler(m){m=m.CorrelationId;""!==m&&m in this.jv&&(x.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.jv[m],m),this.jv[m]="ACK_RECEIVED")}z$(m,t,z,
y){m=new n.a(m);m.CorrelationId=z;t&&(m.Values=t);m.Values.wdUserSession=y;return m}waa(m,t,z){x.a.debugAssertTag(5018269,!!m,null);if(!this.qq)return!1;x.a.debugAssertTag(5018270,!!t,null);x.a.debugAssertTag(5018271,!!z,null);if(!t||!z)return x.a.debugAssertTag(5018272,!1,null),!1;if(z===k.mM&&!this.dIb(m.MessageId))return x.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:m.MessageId}),!1;m.SendTime=(new Date).getTime();let y="";try{y=Sys.Serialization.JavaScriptSerializer.serialize(m)}catch(C){return x.a.sendTraceTag(5018274,
4,"JSON Ser failed {0}",{["Exception"]:C.message}),!1}t=k.sendMessage(t,y,z);x.a.sendTraceTag(5018275,2,"Send {0}. {1}",t?"succeeded":"failed",{["id"]:m.MessageId,["origin"]:z});return t}em(m,t){x.a.debugAssertTag(5018304,!!t,null);x.a.debugAssertTag(5018305,!!this.uq&&!!this.nv,null);if(!this.qq)return!1;if(!this.dBa(m))return x.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:m}),!1;this.uq[m]!==t&&(x.a.debugAssertTag(5018307,!this.uq[m]&&!this.nv[m],null),this.uq[m]=t,delete this.nv[m]);
return!0}l_(m){this.qq&&(this.uq[m]&&delete this.uq[m],this.nv[m]&&delete this.nv[m])}CLb(m){const t=this.uDb(m);if(!t)return!1;if(this.uq[t.MessageId])return this.qJ.GAa(this.uq[t.MessageId],t),!0;if(this.nv[t.MessageId]){let z=this.nv[t.MessageId];m=new r(t,m);this.qJ.yGb(z,m);return!0}return!1}uDb(m){const t=new Date;this.IKb(m);if(!m.origin||!m.source||void 0===m.data||null===m.data)return x.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const z=this.xJb(m.data);if(!z)return null;
if(!this.oIb(m.origin)){if(!this.cBa(z.MessageId))return x.a.sendTraceTag(5018309,1,"{0}",{["id"]:z.MessageId}),null;if(!f.a.BY&&m.source!==this.CFa)return x.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}x.a.debugAssertTag(5018311,!!z.Values,null);z.Values.m_Source=m.source;z.Values.m_Origin=m.origin;z.Values.m_ReceivedTime=t.getTime();return z}xJb(m){if(!m)return null;let t=null;try{t=Sys.Serialization.JavaScriptSerializer.deserialize(m,!0)}catch(C){return 2>
k.jua&&(x.a.sendTraceTag(5018312,2,"Deser failed"),k.jua++),null}if(!t)return x.a.debugAssertTag(5018313,!1,null),null;for(m=0;m<k.VS.length;m++)if(!t[k.VS[m]])return"MessageId"!==k.VS[m]&&x.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",k.VS[m]),null;if(t.Values)try{t.Values}catch(C){return x.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",C.message),null}else x.a.sendTraceTag(41502556,2,"No values in message");m=t.MessageId;if(!this.dBa(m))return x.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:m}),null;const z=t.SendTime,y=(new Date).getTime()-z;if(0>z)return x.a.sendTraceTag(520435660,2,"{0}",{["t"]:z,["id"]:m}),null;6E4<y&&x.a.sendTraceTag(520435659,2,"{0}",{["t"]:z,["delta"]:y,["id"]:m});-300>y&&x.a.sendTraceTag(520435658,2,"{0}",{["t"]:z,["delta"]:y,["id"]:m});m=new n.a;m.MessageId=t.MessageId;m.SendTime=t.SendTime;m.CorrelationId=t.CorrelationId;t.Values&&(m.Values=t.Values);x.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
m.MessageId,m.SendTime,m.CorrelationId);return m}IKb(m){x.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:m.origin,["data"]:m.data,["source"]:m.source}))}static sendMessage(m,t,z){if(!v.a())return x.a.debugAssertTag(5018319,!1,null),!1;try{return m.postMessage(t,z),!0}catch(y){x.a.sendTraceTag(5018320,4,"{0}",{["exception"]:y.message})}return!1}}k.VS=["MessageId","SendTime"];k.mM="*";k._id=0;k.jua=0;Object(w.a)(k,"CrossDocumentMessenger",null,[5,387])},770:function(w,D,a){a.d(D,
"a",function(){return f});w=a(0);var b=a(1),c=a(151),e=a(19);class f{static Mpf(d){f.$=d;b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void c.a.resolve(e.K).then(h=>{f.Mf=h}):f.$.ea.Zc(291,h=>{f.Mf=h})}static tna(d,h){return d[Math.round((d.length-1)*h/100)]}static OF(d){return f.Mf?f.Mf.OF(d):!1}}f.Mf=null;f.$=null;Object(w.a)(f,"SessionStatisticsManagerHelper",null,[])},779:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{static eTb(){}static Zyb(){}}
b.sendTraceTag=b.eTb;b.debugAssertTag=b.Zyb;Object(w.a)(b,"BULS",null,[])},780:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{constructor(c){this.MessageId=c;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(w.a)(b,"CrossDocumentMessage",null,[])},811:function(w,D,a){a.d(D,"a",function(){return b});const b=c=>{if(Object.keys)c=Object.keys(c);else{const e=[];for(const f in c)e.push(f);c=e}return c}},908:function(w,D,a){w=a(0);var b=a(15),c=a(765),e=a(80),f=a(564),d=a(6),
h=a(14),r=a(114);class n{constructor(k,m,t,z){this.origin=k;this.data=m;this.source=t;this.Ca=void 0===z?null:z}}Object(w.a)(n,"MessageEventArgs",null,[]);class u{constructor(k,m){this.g6=null;this.Lsb=k;this.Uf=m;this.cS=null}get e_(){return this.Lsb.value}get taskManager(){return this.Uf.value}iLa(k,m){this.cS=k;this.g6=Object(e.a)(this,this.kPb,"postMessageEventHandler");this.e_.addHandler(h.a.message,this.g6,m)}nNa(){this.cS=null;this.e_.removeHandler(h.a.message,this.g6)}GAa(k,m){const t=new r.a(0,
1,1,()=>{k(m)},7);this.taskManager.Ah(t)}yGb(k,m){const t=new r.a(0,1,1,()=>{k(m)},7);this.taskManager.Ah(t)}kPb(k){return this.cS?this.cS(new n(k.origin,k.data,k.source,k.Ca)):!1}static get instance(){return u.jna()}static jna(){return new u(new f.a(()=>d.AFrameworkApplication.e_),new f.a(()=>d.AFrameworkApplication.Lj))}}Object(w.a)(u,"MessageEventHandler",null,[385]);var v=a(779);a.d(D,"a",function(){return x});class x extends c.a{constructor(k,m,t){super(k,m,(void 0===t?null:t)||u.instance,x.hGb)}static hGb(){v.a.sendTraceTag=
x.dTb;v.a.debugAssertTag=x.Yyb}static dTb(k,m,t,...z){b.ULS.sendTraceTag.apply(null,[k,204,x.yyb(m),t].concat(z))}static Yyb(){}static yyb(k){switch(k){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}x.zPb="wdPreviousSession";x.Jyb="wdUserSession";Object(w.a)(x,"CommonCrossDocumentMessenger",c.a,[])},971:function(w,D,a){a.d(D,"a",function(){return b});w=a(0);class b{}b.Zhd="stid";b.Xhd="iid";b.Yhd="DynamicImageProvider.aspx";b.is1JSBundlesEnabled=
"Is1JSBundlesEnabled";Object(w.a)(b,"WebServiceConstants",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/351a0feac3f46991ce850f4b558e004e/EwaTS.tm.js.map